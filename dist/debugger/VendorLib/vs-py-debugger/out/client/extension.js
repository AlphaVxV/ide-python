'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // This line should always be right on top.
// tslint:disable-next-line:no-any

if (Reflect.metadata === undefined) {
  // tslint:disable-next-line:no-require-imports no-var-requires
  require('reflect-metadata');
}

const durations = {};

const stopWatch_1 = require("./common/utils/stopWatch"); // Do not move this linne of code (used to measure extension load times).


const stopWatch = new stopWatch_1.StopWatch();

const inversify_1 = require("inversify");

const vscode_1 = require("vscode");

const serviceRegistry_1 = require("./activation/serviceRegistry");

const types_1 = require("./activation/types");

const serviceRegistry_2 = require("./application/serviceRegistry");

const types_2 = require("./application/types");

const debugService_1 = require("./common/application/debugService");

const types_3 = require("./common/application/types");

const constants_1 = require("./common/constants");

const serviceRegistry_3 = require("./common/installer/serviceRegistry");

const serviceRegistry_4 = require("./common/platform/serviceRegistry");

const serviceRegistry_5 = require("./common/process/serviceRegistry");

const serviceRegistry_6 = require("./common/serviceRegistry");

const types_4 = require("./common/terminal/types");

const types_5 = require("./common/types");

const async_1 = require("./common/utils/async");

const serviceRegistry_7 = require("./common/variables/serviceRegistry");

const serviceRegistry_8 = require("./datascience/serviceRegistry");

const types_6 = require("./datascience/types");

const constants_2 = require("./debugger/constants");

const eventHandlerDispatcher_1 = require("./debugger/extension/hooks/eventHandlerDispatcher");

const types_7 = require("./debugger/extension/hooks/types");

const serviceRegistry_9 = require("./debugger/extension/serviceRegistry");

const types_8 = require("./debugger/extension/types");

const serviceRegistry_10 = require("./formatters/serviceRegistry");

const types_9 = require("./interpreter/configuration/types");

const contracts_1 = require("./interpreter/contracts");

const serviceRegistry_11 = require("./interpreter/serviceRegistry");

const container_1 = require("./ioc/container");

const serviceManager_1 = require("./ioc/serviceManager");

const types_10 = require("./ioc/types");

const linterCommands_1 = require("./linters/linterCommands");

const serviceRegistry_12 = require("./linters/serviceRegistry");

const types_11 = require("./linters/types");

const codeActionsProvider_1 = require("./providers/codeActionsProvider");

const formatProvider_1 = require("./providers/formatProvider");

const linterProvider_1 = require("./providers/linterProvider");

const replProvider_1 = require("./providers/replProvider");

const serviceRegistry_13 = require("./providers/serviceRegistry");

const simpleRefactorProvider_1 = require("./providers/simpleRefactorProvider");

const terminalProvider_1 = require("./providers/terminalProvider");

const types_12 = require("./providers/types");

const updateSparkLibraryProvider_1 = require("./providers/updateSparkLibraryProvider");

const telemetry_1 = require("./telemetry");

const constants_3 = require("./telemetry/constants");

const serviceRegistry_14 = require("./terminals/serviceRegistry");

const types_13 = require("./terminals/types");

const constants_4 = require("./unittests/common/constants");

const serviceRegistry_15 = require("./unittests/serviceRegistry");

durations.codeLoadingTime = stopWatch.elapsedTime;
const activationDeferred = async_1.createDeferred(); // tslint:disable-next-line:max-func-body-length

function activate(context) {
  return __awaiter(this, void 0, void 0, function* () {
    durations.startActivateTime = stopWatch.elapsedTime;
    const cont = new inversify_1.Container();
    const serviceManager = new serviceManager_1.ServiceManager(cont);
    const serviceContainer = new container_1.ServiceContainer(cont);
    registerServices(context, serviceManager, serviceContainer);
    initializeServices(context, serviceManager, serviceContainer); // When testing, do not perform health checks, as modal dialogs can be displayed.

    if (!constants_1.isTestExecution()) {
      const appDiagnostics = serviceContainer.get(types_2.IApplicationDiagnostics);
      yield appDiagnostics.performPreStartupHealthCheck();
    }

    const interpreterManager = serviceContainer.get(contracts_1.IInterpreterService);
    yield interpreterManager.autoSetInterpreter();
    serviceManager.get(types_13.ITerminalAutoActivation).register();
    const configuration = serviceManager.get(types_5.IConfigurationService);
    const pythonSettings = configuration.getSettings();
    const standardOutputChannel = serviceContainer.get(types_5.IOutputChannel, constants_1.STANDARD_OUTPUT_CHANNEL);
    simpleRefactorProvider_1.activateSimplePythonRefactorProvider(context, standardOutputChannel, serviceContainer);
    const activationService = serviceContainer.get(types_1.IExtensionActivationService);
    yield activationService.activate();
    const sortImports = serviceContainer.get(types_12.ISortImportsEditingProvider);
    sortImports.registerCommands();
    serviceManager.get(types_13.ICodeExecutionManager).registerCommands();
    sendStartupTelemetry(activationDeferred.promise, serviceContainer).ignoreErrors();
    const workspaceService = serviceContainer.get(types_3.IWorkspaceService);
    interpreterManager.refresh(workspaceService.hasWorkspaceFolders ? workspaceService.workspaceFolders[0].uri : undefined).catch(ex => console.error('Python Extension: interpreterManager.refresh', ex));
    const jupyterExtension = vscode_1.extensions.getExtension('donjayamanne.jupyter');
    const lintingEngine = serviceManager.get(types_11.ILintingEngine);
    lintingEngine.linkJupyterExtension(jupyterExtension).ignoreErrors(); // Activate data science features

    const dataScience = serviceManager.get(types_6.IDataScience);
    dataScience.activate().ignoreErrors();
    context.subscriptions.push(new linterCommands_1.LinterCommands(serviceManager));
    const linterProvider = new linterProvider_1.LinterProvider(context, serviceManager);
    context.subscriptions.push(linterProvider); // Enable indentAction
    // tslint:disable-next-line:no-non-null-assertion

    vscode_1.languages.setLanguageConfiguration(constants_1.PYTHON_LANGUAGE, {
      onEnterRules: [{
        beforeText: /^\s*(?:def|class|for|if|elif|else|while|try|with|finally|except|async)\b.*:\s*/,
        action: {
          indentAction: vscode_1.IndentAction.Indent
        }
      }, {
        beforeText: /^\s*#.*/,
        afterText: /.+$/,
        action: {
          indentAction: vscode_1.IndentAction.None,
          appendText: '# '
        }
      }, {
        beforeText: /^\s+(continue|break|return)\b.*/,
        afterText: /\s+$/,
        action: {
          indentAction: vscode_1.IndentAction.Outdent
        }
      }]
    });

    if (pythonSettings && pythonSettings.formatting && pythonSettings.formatting.provider !== 'none') {
      const formatProvider = new formatProvider_1.PythonFormattingEditProvider(context, serviceContainer);
      context.subscriptions.push(vscode_1.languages.registerDocumentFormattingEditProvider(constants_1.PYTHON, formatProvider));
      context.subscriptions.push(vscode_1.languages.registerDocumentRangeFormattingEditProvider(constants_1.PYTHON, formatProvider));
    }

    const deprecationMgr = serviceContainer.get(types_5.IFeatureDeprecationManager);
    deprecationMgr.initialize();
    context.subscriptions.push(deprecationMgr);
    context.subscriptions.push(updateSparkLibraryProvider_1.activateUpdateSparkLibraryProvider());
    context.subscriptions.push(new replProvider_1.ReplProvider(serviceContainer));
    context.subscriptions.push(new terminalProvider_1.TerminalProvider(serviceContainer));
    context.subscriptions.push(vscode_1.languages.registerCodeActionsProvider(constants_1.PYTHON, new codeActionsProvider_1.PythonCodeActionProvider(), {
      providedCodeActionKinds: [vscode_1.CodeActionKind.SourceOrganizeImports]
    }));
    serviceContainer.getAll(types_8.IDebugConfigurationProvider).forEach(debugConfig => {
      context.subscriptions.push(vscode_1.debug.registerDebugConfigurationProvider(constants_2.DebuggerTypeName, debugConfig));
    });
    serviceContainer.get(types_8.IDebuggerBanner).initialize();
    durations.endActivateTime = stopWatch.elapsedTime;
    activationDeferred.resolve();
    const api = {
      ready: activationDeferred.promise
    }; // In test environment return the DI Container.

    if (constants_1.isTestExecution()) {
      // tslint:disable-next-line:no-any
      api.serviceContainer = serviceContainer;
    }

    return api;
  });
}

exports.activate = activate;

function registerServices(context, serviceManager, serviceContainer) {
  serviceManager.addSingletonInstance(types_10.IServiceContainer, serviceContainer);
  serviceManager.addSingletonInstance(types_10.IServiceManager, serviceManager);
  serviceManager.addSingletonInstance(types_5.IDisposableRegistry, context.subscriptions);
  serviceManager.addSingletonInstance(types_5.IMemento, context.globalState, types_5.GLOBAL_MEMENTO);
  serviceManager.addSingletonInstance(types_5.IMemento, context.workspaceState, types_5.WORKSPACE_MEMENTO);
  serviceManager.addSingletonInstance(types_5.IExtensionContext, context);
  const standardOutputChannel = vscode_1.window.createOutputChannel('Python');
  const unitTestOutChannel = vscode_1.window.createOutputChannel('Python Test Log');
  serviceManager.addSingletonInstance(types_5.IOutputChannel, standardOutputChannel, constants_1.STANDARD_OUTPUT_CHANNEL);
  serviceManager.addSingletonInstance(types_5.IOutputChannel, unitTestOutChannel, constants_4.TEST_OUTPUT_CHANNEL);
  serviceRegistry_1.registerTypes(serviceManager);
  serviceRegistry_6.registerTypes(serviceManager);
  serviceRegistry_5.registerTypes(serviceManager);
  serviceRegistry_7.registerTypes(serviceManager);
  serviceRegistry_15.registerTypes(serviceManager);
  serviceRegistry_12.registerTypes(serviceManager);
  serviceRegistry_11.registerTypes(serviceManager);
  serviceRegistry_10.registerTypes(serviceManager);
  serviceRegistry_4.registerTypes(serviceManager);
  serviceRegistry_3.registerTypes(serviceManager);
  serviceRegistry_14.registerTypes(serviceManager);
  serviceRegistry_8.registerTypes(serviceManager);
  serviceRegistry_9.registerTypes(serviceManager);
  serviceRegistry_2.registerTypes(serviceManager);
  serviceRegistry_13.registerTypes(serviceManager);
}

function initializeServices(context, serviceManager, serviceContainer) {
  const selector = serviceContainer.get(types_9.IInterpreterSelector);
  selector.initialize();
  context.subscriptions.push(selector);
  const interpreterManager = serviceContainer.get(contracts_1.IInterpreterService);
  interpreterManager.initialize();
  const handlers = serviceManager.getAll(types_7.IDebugSessionEventHandlers);
  const disposables = serviceManager.get(types_5.IDisposableRegistry);
  const dispatcher = new eventHandlerDispatcher_1.DebugSessionEventDispatcher(handlers, debugService_1.DebugService.instance, disposables);
  dispatcher.registerEventHandlers(); // Display progress of interpreter refreshes only after extension has activated.

  serviceContainer.get(contracts_1.InterpreterLocatorProgressHandler).register();
  serviceContainer.get(contracts_1.IInterpreterLocatorProgressService).register(); // Get latest interpreter list.

  const workspaceService = serviceContainer.get(types_3.IWorkspaceService);
  const mainWorkspaceUri = workspaceService.hasWorkspaceFolders ? workspaceService.workspaceFolders[0].uri : undefined;
  const interpreterService = serviceContainer.get(contracts_1.IInterpreterService);
  interpreterService.getInterpreters(mainWorkspaceUri).ignoreErrors();
}

function sendStartupTelemetry(activatedPromise, serviceContainer) {
  return __awaiter(this, void 0, void 0, function* () {
    const logger = serviceContainer.get(types_5.ILogger);

    try {
      yield activatedPromise;
      const terminalHelper = serviceContainer.get(types_4.ITerminalHelper);
      const terminalShellType = terminalHelper.identifyTerminalShell(terminalHelper.getTerminalShellPath());
      const condaLocator = serviceContainer.get(contracts_1.ICondaService);
      const interpreterService = serviceContainer.get(contracts_1.IInterpreterService);
      const workspaceService = serviceContainer.get(types_3.IWorkspaceService);
      const mainWorkspaceUri = workspaceService.hasWorkspaceFolders ? workspaceService.workspaceFolders[0].uri : undefined;
      const [condaVersion, interpreter, interpreters] = yield Promise.all([condaLocator.getCondaVersion().then(ver => ver ? ver.raw : '').catch(() => ''), interpreterService.getActiveInterpreter().catch(() => undefined), interpreterService.getInterpreters(mainWorkspaceUri).catch(() => [])]);
      const workspaceFolderCount = workspaceService.hasWorkspaceFolders ? workspaceService.workspaceFolders.length : 0;
      const pythonVersion = interpreter ? interpreter.version_info.join('.') : undefined;
      const interpreterType = interpreter ? interpreter.type : undefined;
      const hasPython3 = interpreters.filter(item => item && Array.isArray(item.version_info) ? item.version_info[0] === 3 : false).length > 0;
      const props = {
        condaVersion,
        terminal: terminalShellType,
        pythonVersion,
        interpreterType,
        workspaceFolderCount,
        hasPython3
      };
      telemetry_1.sendTelemetryEvent(constants_3.EDITOR_LOAD, durations, props);
    } catch (ex) {
      logger.logError('sendStartupTelemetry failed.', ex);
    }
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImV4dGVuc2lvbi5qcyJdLCJuYW1lcyI6WyJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwiUmVmbGVjdCIsIm1ldGFkYXRhIiwidW5kZWZpbmVkIiwicmVxdWlyZSIsImR1cmF0aW9ucyIsInN0b3BXYXRjaF8xIiwic3RvcFdhdGNoIiwiU3RvcFdhdGNoIiwiaW52ZXJzaWZ5XzEiLCJ2c2NvZGVfMSIsInNlcnZpY2VSZWdpc3RyeV8xIiwidHlwZXNfMSIsInNlcnZpY2VSZWdpc3RyeV8yIiwidHlwZXNfMiIsImRlYnVnU2VydmljZV8xIiwidHlwZXNfMyIsImNvbnN0YW50c18xIiwic2VydmljZVJlZ2lzdHJ5XzMiLCJzZXJ2aWNlUmVnaXN0cnlfNCIsInNlcnZpY2VSZWdpc3RyeV81Iiwic2VydmljZVJlZ2lzdHJ5XzYiLCJ0eXBlc180IiwidHlwZXNfNSIsImFzeW5jXzEiLCJzZXJ2aWNlUmVnaXN0cnlfNyIsInNlcnZpY2VSZWdpc3RyeV84IiwidHlwZXNfNiIsImNvbnN0YW50c18yIiwiZXZlbnRIYW5kbGVyRGlzcGF0Y2hlcl8xIiwidHlwZXNfNyIsInNlcnZpY2VSZWdpc3RyeV85IiwidHlwZXNfOCIsInNlcnZpY2VSZWdpc3RyeV8xMCIsInR5cGVzXzkiLCJjb250cmFjdHNfMSIsInNlcnZpY2VSZWdpc3RyeV8xMSIsImNvbnRhaW5lcl8xIiwic2VydmljZU1hbmFnZXJfMSIsInR5cGVzXzEwIiwibGludGVyQ29tbWFuZHNfMSIsInNlcnZpY2VSZWdpc3RyeV8xMiIsInR5cGVzXzExIiwiY29kZUFjdGlvbnNQcm92aWRlcl8xIiwiZm9ybWF0UHJvdmlkZXJfMSIsImxpbnRlclByb3ZpZGVyXzEiLCJyZXBsUHJvdmlkZXJfMSIsInNlcnZpY2VSZWdpc3RyeV8xMyIsInNpbXBsZVJlZmFjdG9yUHJvdmlkZXJfMSIsInRlcm1pbmFsUHJvdmlkZXJfMSIsInR5cGVzXzEyIiwidXBkYXRlU3BhcmtMaWJyYXJ5UHJvdmlkZXJfMSIsInRlbGVtZXRyeV8xIiwiY29uc3RhbnRzXzMiLCJzZXJ2aWNlUmVnaXN0cnlfMTQiLCJ0eXBlc18xMyIsImNvbnN0YW50c180Iiwic2VydmljZVJlZ2lzdHJ5XzE1IiwiY29kZUxvYWRpbmdUaW1lIiwiZWxhcHNlZFRpbWUiLCJhY3RpdmF0aW9uRGVmZXJyZWQiLCJjcmVhdGVEZWZlcnJlZCIsImFjdGl2YXRlIiwiY29udGV4dCIsInN0YXJ0QWN0aXZhdGVUaW1lIiwiY29udCIsIkNvbnRhaW5lciIsInNlcnZpY2VNYW5hZ2VyIiwiU2VydmljZU1hbmFnZXIiLCJzZXJ2aWNlQ29udGFpbmVyIiwiU2VydmljZUNvbnRhaW5lciIsInJlZ2lzdGVyU2VydmljZXMiLCJpbml0aWFsaXplU2VydmljZXMiLCJpc1Rlc3RFeGVjdXRpb24iLCJhcHBEaWFnbm9zdGljcyIsImdldCIsIklBcHBsaWNhdGlvbkRpYWdub3N0aWNzIiwicGVyZm9ybVByZVN0YXJ0dXBIZWFsdGhDaGVjayIsImludGVycHJldGVyTWFuYWdlciIsIklJbnRlcnByZXRlclNlcnZpY2UiLCJhdXRvU2V0SW50ZXJwcmV0ZXIiLCJJVGVybWluYWxBdXRvQWN0aXZhdGlvbiIsInJlZ2lzdGVyIiwiY29uZmlndXJhdGlvbiIsIklDb25maWd1cmF0aW9uU2VydmljZSIsInB5dGhvblNldHRpbmdzIiwiZ2V0U2V0dGluZ3MiLCJzdGFuZGFyZE91dHB1dENoYW5uZWwiLCJJT3V0cHV0Q2hhbm5lbCIsIlNUQU5EQVJEX09VVFBVVF9DSEFOTkVMIiwiYWN0aXZhdGVTaW1wbGVQeXRob25SZWZhY3RvclByb3ZpZGVyIiwiYWN0aXZhdGlvblNlcnZpY2UiLCJJRXh0ZW5zaW9uQWN0aXZhdGlvblNlcnZpY2UiLCJzb3J0SW1wb3J0cyIsIklTb3J0SW1wb3J0c0VkaXRpbmdQcm92aWRlciIsInJlZ2lzdGVyQ29tbWFuZHMiLCJJQ29kZUV4ZWN1dGlvbk1hbmFnZXIiLCJzZW5kU3RhcnR1cFRlbGVtZXRyeSIsInByb21pc2UiLCJpZ25vcmVFcnJvcnMiLCJ3b3Jrc3BhY2VTZXJ2aWNlIiwiSVdvcmtzcGFjZVNlcnZpY2UiLCJyZWZyZXNoIiwiaGFzV29ya3NwYWNlRm9sZGVycyIsIndvcmtzcGFjZUZvbGRlcnMiLCJ1cmkiLCJjYXRjaCIsImV4IiwiY29uc29sZSIsImVycm9yIiwianVweXRlckV4dGVuc2lvbiIsImV4dGVuc2lvbnMiLCJnZXRFeHRlbnNpb24iLCJsaW50aW5nRW5naW5lIiwiSUxpbnRpbmdFbmdpbmUiLCJsaW5rSnVweXRlckV4dGVuc2lvbiIsImRhdGFTY2llbmNlIiwiSURhdGFTY2llbmNlIiwic3Vic2NyaXB0aW9ucyIsInB1c2giLCJMaW50ZXJDb21tYW5kcyIsImxpbnRlclByb3ZpZGVyIiwiTGludGVyUHJvdmlkZXIiLCJsYW5ndWFnZXMiLCJzZXRMYW5ndWFnZUNvbmZpZ3VyYXRpb24iLCJQWVRIT05fTEFOR1VBR0UiLCJvbkVudGVyUnVsZXMiLCJiZWZvcmVUZXh0IiwiYWN0aW9uIiwiaW5kZW50QWN0aW9uIiwiSW5kZW50QWN0aW9uIiwiSW5kZW50IiwiYWZ0ZXJUZXh0IiwiTm9uZSIsImFwcGVuZFRleHQiLCJPdXRkZW50IiwiZm9ybWF0dGluZyIsInByb3ZpZGVyIiwiZm9ybWF0UHJvdmlkZXIiLCJQeXRob25Gb3JtYXR0aW5nRWRpdFByb3ZpZGVyIiwicmVnaXN0ZXJEb2N1bWVudEZvcm1hdHRpbmdFZGl0UHJvdmlkZXIiLCJQWVRIT04iLCJyZWdpc3RlckRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyIiwiZGVwcmVjYXRpb25NZ3IiLCJJRmVhdHVyZURlcHJlY2F0aW9uTWFuYWdlciIsImluaXRpYWxpemUiLCJhY3RpdmF0ZVVwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyIiwiUmVwbFByb3ZpZGVyIiwiVGVybWluYWxQcm92aWRlciIsInJlZ2lzdGVyQ29kZUFjdGlvbnNQcm92aWRlciIsIlB5dGhvbkNvZGVBY3Rpb25Qcm92aWRlciIsInByb3ZpZGVkQ29kZUFjdGlvbktpbmRzIiwiQ29kZUFjdGlvbktpbmQiLCJTb3VyY2VPcmdhbml6ZUltcG9ydHMiLCJnZXRBbGwiLCJJRGVidWdDb25maWd1cmF0aW9uUHJvdmlkZXIiLCJmb3JFYWNoIiwiZGVidWdDb25maWciLCJkZWJ1ZyIsInJlZ2lzdGVyRGVidWdDb25maWd1cmF0aW9uUHJvdmlkZXIiLCJEZWJ1Z2dlclR5cGVOYW1lIiwiSURlYnVnZ2VyQmFubmVyIiwiZW5kQWN0aXZhdGVUaW1lIiwiYXBpIiwicmVhZHkiLCJhZGRTaW5nbGV0b25JbnN0YW5jZSIsIklTZXJ2aWNlQ29udGFpbmVyIiwiSVNlcnZpY2VNYW5hZ2VyIiwiSURpc3Bvc2FibGVSZWdpc3RyeSIsIklNZW1lbnRvIiwiZ2xvYmFsU3RhdGUiLCJHTE9CQUxfTUVNRU5UTyIsIndvcmtzcGFjZVN0YXRlIiwiV09SS1NQQUNFX01FTUVOVE8iLCJJRXh0ZW5zaW9uQ29udGV4dCIsIndpbmRvdyIsImNyZWF0ZU91dHB1dENoYW5uZWwiLCJ1bml0VGVzdE91dENoYW5uZWwiLCJURVNUX09VVFBVVF9DSEFOTkVMIiwicmVnaXN0ZXJUeXBlcyIsInNlbGVjdG9yIiwiSUludGVycHJldGVyU2VsZWN0b3IiLCJoYW5kbGVycyIsIklEZWJ1Z1Nlc3Npb25FdmVudEhhbmRsZXJzIiwiZGlzcG9zYWJsZXMiLCJkaXNwYXRjaGVyIiwiRGVidWdTZXNzaW9uRXZlbnREaXNwYXRjaGVyIiwiRGVidWdTZXJ2aWNlIiwiaW5zdGFuY2UiLCJyZWdpc3RlckV2ZW50SGFuZGxlcnMiLCJJbnRlcnByZXRlckxvY2F0b3JQcm9ncmVzc0hhbmRsZXIiLCJJSW50ZXJwcmV0ZXJMb2NhdG9yUHJvZ3Jlc3NTZXJ2aWNlIiwibWFpbldvcmtzcGFjZVVyaSIsImludGVycHJldGVyU2VydmljZSIsImdldEludGVycHJldGVycyIsImFjdGl2YXRlZFByb21pc2UiLCJsb2dnZXIiLCJJTG9nZ2VyIiwidGVybWluYWxIZWxwZXIiLCJJVGVybWluYWxIZWxwZXIiLCJ0ZXJtaW5hbFNoZWxsVHlwZSIsImlkZW50aWZ5VGVybWluYWxTaGVsbCIsImdldFRlcm1pbmFsU2hlbGxQYXRoIiwiY29uZGFMb2NhdG9yIiwiSUNvbmRhU2VydmljZSIsImNvbmRhVmVyc2lvbiIsImludGVycHJldGVyIiwiaW50ZXJwcmV0ZXJzIiwiYWxsIiwiZ2V0Q29uZGFWZXJzaW9uIiwidmVyIiwicmF3IiwiZ2V0QWN0aXZlSW50ZXJwcmV0ZXIiLCJ3b3Jrc3BhY2VGb2xkZXJDb3VudCIsImxlbmd0aCIsInB5dGhvblZlcnNpb24iLCJ2ZXJzaW9uX2luZm8iLCJqb2luIiwiaW50ZXJwcmV0ZXJUeXBlIiwidHlwZSIsImhhc1B5dGhvbjMiLCJmaWx0ZXIiLCJpdGVtIiwiQXJyYXkiLCJpc0FycmF5IiwicHJvcHMiLCJ0ZXJtaW5hbCIsInNlbmRUZWxlbWV0cnlFdmVudCIsIkVESVRPUl9MT0FEIiwibG9nRXJyb3IiXSwibWFwcGluZ3MiOiJBQUFBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFKO0FBQThCLE9BQXBDLENBQXFDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FB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QUFBLE1BQU0sQ0FBQ2lDLFFBQVAsQ0FBZ0IsOEJBQWhCLEVBQWdEMUgsRUFBaEQ7QUFDSDtBQUNKLEdBM0JlLENBQWhCO0FBNEJIIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbi8vIFRoaXMgbGluZSBzaG91bGQgYWx3YXlzIGJlIHJpZ2h0IG9uIHRvcC5cclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG5pZiAoUmVmbGVjdC5tZXRhZGF0YSA9PT0gdW5kZWZpbmVkKSB7XHJcbiAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tcmVxdWlyZS1pbXBvcnRzIG5vLXZhci1yZXF1aXJlc1xyXG4gICAgcmVxdWlyZSgncmVmbGVjdC1tZXRhZGF0YScpO1xyXG59XHJcbmNvbnN0IGR1cmF0aW9ucyA9IHt9O1xyXG5jb25zdCBzdG9wV2F0Y2hfMSA9IHJlcXVpcmUoXCIuL2NvbW1vbi91dGlscy9zdG9wV2F0Y2hcIik7XHJcbi8vIERvIG5vdCBtb3ZlIHRoaXMgbGlubmUgb2YgY29kZSAodXNlZCB0byBtZWFzdXJlIGV4dGVuc2lvbiBsb2FkIHRpbWVzKS5cclxuY29uc3Qgc3RvcFdhdGNoID0gbmV3IHN0b3BXYXRjaF8xLlN0b3BXYXRjaCgpO1xyXG5jb25zdCBpbnZlcnNpZnlfMSA9IHJlcXVpcmUoXCJpbnZlcnNpZnlcIik7XHJcbmNvbnN0IHZzY29kZV8xID0gcmVxdWlyZShcInZzY29kZVwiKTtcclxuY29uc3Qgc2VydmljZVJlZ2lzdHJ5XzEgPSByZXF1aXJlKFwiLi9hY3RpdmF0aW9uL3NlcnZpY2VSZWdpc3RyeVwiKTtcclxuY29uc3QgdHlwZXNfMSA9IHJlcXVpcmUoXCIuL2FjdGl2YXRpb24vdHlwZXNcIik7XHJcbmNvbnN0IHNlcnZpY2VSZWdpc3RyeV8yID0gcmVxdWlyZShcIi4vYXBwbGljYXRpb24vc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4vYXBwbGljYXRpb24vdHlwZXNcIik7XHJcbmNvbnN0IGRlYnVnU2VydmljZV8xID0gcmVxdWlyZShcIi4vY29tbW9uL2FwcGxpY2F0aW9uL2RlYnVnU2VydmljZVwiKTtcclxuY29uc3QgdHlwZXNfMyA9IHJlcXVpcmUoXCIuL2NvbW1vbi9hcHBsaWNhdGlvbi90eXBlc1wiKTtcclxuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi9jb21tb24vY29uc3RhbnRzXCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfMyA9IHJlcXVpcmUoXCIuL2NvbW1vbi9pbnN0YWxsZXIvc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfNCA9IHJlcXVpcmUoXCIuL2NvbW1vbi9wbGF0Zm9ybS9zZXJ2aWNlUmVnaXN0cnlcIik7XHJcbmNvbnN0IHNlcnZpY2VSZWdpc3RyeV81ID0gcmVxdWlyZShcIi4vY29tbW9uL3Byb2Nlc3Mvc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfNiA9IHJlcXVpcmUoXCIuL2NvbW1vbi9zZXJ2aWNlUmVnaXN0cnlcIik7XHJcbmNvbnN0IHR5cGVzXzQgPSByZXF1aXJlKFwiLi9jb21tb24vdGVybWluYWwvdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzUgPSByZXF1aXJlKFwiLi9jb21tb24vdHlwZXNcIik7XHJcbmNvbnN0IGFzeW5jXzEgPSByZXF1aXJlKFwiLi9jb21tb24vdXRpbHMvYXN5bmNcIik7XHJcbmNvbnN0IHNlcnZpY2VSZWdpc3RyeV83ID0gcmVxdWlyZShcIi4vY29tbW9uL3ZhcmlhYmxlcy9zZXJ2aWNlUmVnaXN0cnlcIik7XHJcbmNvbnN0IHNlcnZpY2VSZWdpc3RyeV84ID0gcmVxdWlyZShcIi4vZGF0YXNjaWVuY2Uvc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCB0eXBlc182ID0gcmVxdWlyZShcIi4vZGF0YXNjaWVuY2UvdHlwZXNcIik7XHJcbmNvbnN0IGNvbnN0YW50c18yID0gcmVxdWlyZShcIi4vZGVidWdnZXIvY29uc3RhbnRzXCIpO1xyXG5jb25zdCBldmVudEhhbmRsZXJEaXNwYXRjaGVyXzEgPSByZXF1aXJlKFwiLi9kZWJ1Z2dlci9leHRlbnNpb24vaG9va3MvZXZlbnRIYW5kbGVyRGlzcGF0Y2hlclwiKTtcclxuY29uc3QgdHlwZXNfNyA9IHJlcXVpcmUoXCIuL2RlYnVnZ2VyL2V4dGVuc2lvbi9ob29rcy90eXBlc1wiKTtcclxuY29uc3Qgc2VydmljZVJlZ2lzdHJ5XzkgPSByZXF1aXJlKFwiLi9kZWJ1Z2dlci9leHRlbnNpb24vc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCB0eXBlc184ID0gcmVxdWlyZShcIi4vZGVidWdnZXIvZXh0ZW5zaW9uL3R5cGVzXCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfMTAgPSByZXF1aXJlKFwiLi9mb3JtYXR0ZXJzL3NlcnZpY2VSZWdpc3RyeVwiKTtcclxuY29uc3QgdHlwZXNfOSA9IHJlcXVpcmUoXCIuL2ludGVycHJldGVyL2NvbmZpZ3VyYXRpb24vdHlwZXNcIik7XHJcbmNvbnN0IGNvbnRyYWN0c18xID0gcmVxdWlyZShcIi4vaW50ZXJwcmV0ZXIvY29udHJhY3RzXCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfMTEgPSByZXF1aXJlKFwiLi9pbnRlcnByZXRlci9zZXJ2aWNlUmVnaXN0cnlcIik7XHJcbmNvbnN0IGNvbnRhaW5lcl8xID0gcmVxdWlyZShcIi4vaW9jL2NvbnRhaW5lclwiKTtcclxuY29uc3Qgc2VydmljZU1hbmFnZXJfMSA9IHJlcXVpcmUoXCIuL2lvYy9zZXJ2aWNlTWFuYWdlclwiKTtcclxuY29uc3QgdHlwZXNfMTAgPSByZXF1aXJlKFwiLi9pb2MvdHlwZXNcIik7XHJcbmNvbnN0IGxpbnRlckNvbW1hbmRzXzEgPSByZXF1aXJlKFwiLi9saW50ZXJzL2xpbnRlckNvbW1hbmRzXCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfMTIgPSByZXF1aXJlKFwiLi9saW50ZXJzL3NlcnZpY2VSZWdpc3RyeVwiKTtcclxuY29uc3QgdHlwZXNfMTEgPSByZXF1aXJlKFwiLi9saW50ZXJzL3R5cGVzXCIpO1xyXG5jb25zdCBjb2RlQWN0aW9uc1Byb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9wcm92aWRlcnMvY29kZUFjdGlvbnNQcm92aWRlclwiKTtcclxuY29uc3QgZm9ybWF0UHJvdmlkZXJfMSA9IHJlcXVpcmUoXCIuL3Byb3ZpZGVycy9mb3JtYXRQcm92aWRlclwiKTtcclxuY29uc3QgbGludGVyUHJvdmlkZXJfMSA9IHJlcXVpcmUoXCIuL3Byb3ZpZGVycy9saW50ZXJQcm92aWRlclwiKTtcclxuY29uc3QgcmVwbFByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9wcm92aWRlcnMvcmVwbFByb3ZpZGVyXCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfMTMgPSByZXF1aXJlKFwiLi9wcm92aWRlcnMvc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCBzaW1wbGVSZWZhY3RvclByb3ZpZGVyXzEgPSByZXF1aXJlKFwiLi9wcm92aWRlcnMvc2ltcGxlUmVmYWN0b3JQcm92aWRlclwiKTtcclxuY29uc3QgdGVybWluYWxQcm92aWRlcl8xID0gcmVxdWlyZShcIi4vcHJvdmlkZXJzL3Rlcm1pbmFsUHJvdmlkZXJcIik7XHJcbmNvbnN0IHR5cGVzXzEyID0gcmVxdWlyZShcIi4vcHJvdmlkZXJzL3R5cGVzXCIpO1xyXG5jb25zdCB1cGRhdGVTcGFya0xpYnJhcnlQcm92aWRlcl8xID0gcmVxdWlyZShcIi4vcHJvdmlkZXJzL3VwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyXCIpO1xyXG5jb25zdCB0ZWxlbWV0cnlfMSA9IHJlcXVpcmUoXCIuL3RlbGVtZXRyeVwiKTtcclxuY29uc3QgY29uc3RhbnRzXzMgPSByZXF1aXJlKFwiLi90ZWxlbWV0cnkvY29uc3RhbnRzXCIpO1xyXG5jb25zdCBzZXJ2aWNlUmVnaXN0cnlfMTQgPSByZXF1aXJlKFwiLi90ZXJtaW5hbHMvc2VydmljZVJlZ2lzdHJ5XCIpO1xyXG5jb25zdCB0eXBlc18xMyA9IHJlcXVpcmUoXCIuL3Rlcm1pbmFscy90eXBlc1wiKTtcclxuY29uc3QgY29uc3RhbnRzXzQgPSByZXF1aXJlKFwiLi91bml0dGVzdHMvY29tbW9uL2NvbnN0YW50c1wiKTtcclxuY29uc3Qgc2VydmljZVJlZ2lzdHJ5XzE1ID0gcmVxdWlyZShcIi4vdW5pdHRlc3RzL3NlcnZpY2VSZWdpc3RyeVwiKTtcclxuZHVyYXRpb25zLmNvZGVMb2FkaW5nVGltZSA9IHN0b3BXYXRjaC5lbGFwc2VkVGltZTtcclxuY29uc3QgYWN0aXZhdGlvbkRlZmVycmVkID0gYXN5bmNfMS5jcmVhdGVEZWZlcnJlZCgpO1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWZ1bmMtYm9keS1sZW5ndGhcclxuZnVuY3Rpb24gYWN0aXZhdGUoY29udGV4dCkge1xyXG4gICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBkdXJhdGlvbnMuc3RhcnRBY3RpdmF0ZVRpbWUgPSBzdG9wV2F0Y2guZWxhcHNlZFRpbWU7XHJcbiAgICAgICAgY29uc3QgY29udCA9IG5ldyBpbnZlcnNpZnlfMS5Db250YWluZXIoKTtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlTWFuYWdlciA9IG5ldyBzZXJ2aWNlTWFuYWdlcl8xLlNlcnZpY2VNYW5hZ2VyKGNvbnQpO1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2VDb250YWluZXIgPSBuZXcgY29udGFpbmVyXzEuU2VydmljZUNvbnRhaW5lcihjb250KTtcclxuICAgICAgICByZWdpc3RlclNlcnZpY2VzKGNvbnRleHQsIHNlcnZpY2VNYW5hZ2VyLCBzZXJ2aWNlQ29udGFpbmVyKTtcclxuICAgICAgICBpbml0aWFsaXplU2VydmljZXMoY29udGV4dCwgc2VydmljZU1hbmFnZXIsIHNlcnZpY2VDb250YWluZXIpO1xyXG4gICAgICAgIC8vIFdoZW4gdGVzdGluZywgZG8gbm90IHBlcmZvcm0gaGVhbHRoIGNoZWNrcywgYXMgbW9kYWwgZGlhbG9ncyBjYW4gYmUgZGlzcGxheWVkLlxyXG4gICAgICAgIGlmICghY29uc3RhbnRzXzEuaXNUZXN0RXhlY3V0aW9uKCkpIHtcclxuICAgICAgICAgICAgY29uc3QgYXBwRGlhZ25vc3RpY3MgPSBzZXJ2aWNlQ29udGFpbmVyLmdldCh0eXBlc18yLklBcHBsaWNhdGlvbkRpYWdub3N0aWNzKTtcclxuICAgICAgICAgICAgeWllbGQgYXBwRGlhZ25vc3RpY3MucGVyZm9ybVByZVN0YXJ0dXBIZWFsdGhDaGVjaygpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBpbnRlcnByZXRlck1hbmFnZXIgPSBzZXJ2aWNlQ29udGFpbmVyLmdldChjb250cmFjdHNfMS5JSW50ZXJwcmV0ZXJTZXJ2aWNlKTtcclxuICAgICAgICB5aWVsZCBpbnRlcnByZXRlck1hbmFnZXIuYXV0b1NldEludGVycHJldGVyKCk7XHJcbiAgICAgICAgc2VydmljZU1hbmFnZXIuZ2V0KHR5cGVzXzEzLklUZXJtaW5hbEF1dG9BY3RpdmF0aW9uKS5yZWdpc3RlcigpO1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZ3VyYXRpb24gPSBzZXJ2aWNlTWFuYWdlci5nZXQodHlwZXNfNS5JQ29uZmlndXJhdGlvblNlcnZpY2UpO1xyXG4gICAgICAgIGNvbnN0IHB5dGhvblNldHRpbmdzID0gY29uZmlndXJhdGlvbi5nZXRTZXR0aW5ncygpO1xyXG4gICAgICAgIGNvbnN0IHN0YW5kYXJkT3V0cHV0Q2hhbm5lbCA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzUuSU91dHB1dENoYW5uZWwsIGNvbnN0YW50c18xLlNUQU5EQVJEX09VVFBVVF9DSEFOTkVMKTtcclxuICAgICAgICBzaW1wbGVSZWZhY3RvclByb3ZpZGVyXzEuYWN0aXZhdGVTaW1wbGVQeXRob25SZWZhY3RvclByb3ZpZGVyKGNvbnRleHQsIHN0YW5kYXJkT3V0cHV0Q2hhbm5lbCwgc2VydmljZUNvbnRhaW5lcik7XHJcbiAgICAgICAgY29uc3QgYWN0aXZhdGlvblNlcnZpY2UgPSBzZXJ2aWNlQ29udGFpbmVyLmdldCh0eXBlc18xLklFeHRlbnNpb25BY3RpdmF0aW9uU2VydmljZSk7XHJcbiAgICAgICAgeWllbGQgYWN0aXZhdGlvblNlcnZpY2UuYWN0aXZhdGUoKTtcclxuICAgICAgICBjb25zdCBzb3J0SW1wb3J0cyA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzEyLklTb3J0SW1wb3J0c0VkaXRpbmdQcm92aWRlcik7XHJcbiAgICAgICAgc29ydEltcG9ydHMucmVnaXN0ZXJDb21tYW5kcygpO1xyXG4gICAgICAgIHNlcnZpY2VNYW5hZ2VyLmdldCh0eXBlc18xMy5JQ29kZUV4ZWN1dGlvbk1hbmFnZXIpLnJlZ2lzdGVyQ29tbWFuZHMoKTtcclxuICAgICAgICBzZW5kU3RhcnR1cFRlbGVtZXRyeShhY3RpdmF0aW9uRGVmZXJyZWQucHJvbWlzZSwgc2VydmljZUNvbnRhaW5lcikuaWdub3JlRXJyb3JzKCk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlU2VydmljZSA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzMuSVdvcmtzcGFjZVNlcnZpY2UpO1xyXG4gICAgICAgIGludGVycHJldGVyTWFuYWdlci5yZWZyZXNoKHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycyA/IHdvcmtzcGFjZVNlcnZpY2Uud29ya3NwYWNlRm9sZGVyc1swXS51cmkgOiB1bmRlZmluZWQpXHJcbiAgICAgICAgICAgIC5jYXRjaChleCA9PiBjb25zb2xlLmVycm9yKCdQeXRob24gRXh0ZW5zaW9uOiBpbnRlcnByZXRlck1hbmFnZXIucmVmcmVzaCcsIGV4KSk7XHJcbiAgICAgICAgY29uc3QganVweXRlckV4dGVuc2lvbiA9IHZzY29kZV8xLmV4dGVuc2lvbnMuZ2V0RXh0ZW5zaW9uKCdkb25qYXlhbWFubmUuanVweXRlcicpO1xyXG4gICAgICAgIGNvbnN0IGxpbnRpbmdFbmdpbmUgPSBzZXJ2aWNlTWFuYWdlci5nZXQodHlwZXNfMTEuSUxpbnRpbmdFbmdpbmUpO1xyXG4gICAgICAgIGxpbnRpbmdFbmdpbmUubGlua0p1cHl0ZXJFeHRlbnNpb24oanVweXRlckV4dGVuc2lvbikuaWdub3JlRXJyb3JzKCk7XHJcbiAgICAgICAgLy8gQWN0aXZhdGUgZGF0YSBzY2llbmNlIGZlYXR1cmVzXHJcbiAgICAgICAgY29uc3QgZGF0YVNjaWVuY2UgPSBzZXJ2aWNlTWFuYWdlci5nZXQodHlwZXNfNi5JRGF0YVNjaWVuY2UpO1xyXG4gICAgICAgIGRhdGFTY2llbmNlLmFjdGl2YXRlKCkuaWdub3JlRXJyb3JzKCk7XHJcbiAgICAgICAgY29udGV4dC5zdWJzY3JpcHRpb25zLnB1c2gobmV3IGxpbnRlckNvbW1hbmRzXzEuTGludGVyQ29tbWFuZHMoc2VydmljZU1hbmFnZXIpKTtcclxuICAgICAgICBjb25zdCBsaW50ZXJQcm92aWRlciA9IG5ldyBsaW50ZXJQcm92aWRlcl8xLkxpbnRlclByb3ZpZGVyKGNvbnRleHQsIHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgICAgICBjb250ZXh0LnN1YnNjcmlwdGlvbnMucHVzaChsaW50ZXJQcm92aWRlcik7XHJcbiAgICAgICAgLy8gRW5hYmxlIGluZGVudEFjdGlvblxyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1ub24tbnVsbC1hc3NlcnRpb25cclxuICAgICAgICB2c2NvZGVfMS5sYW5ndWFnZXMuc2V0TGFuZ3VhZ2VDb25maWd1cmF0aW9uKGNvbnN0YW50c18xLlBZVEhPTl9MQU5HVUFHRSwge1xyXG4gICAgICAgICAgICBvbkVudGVyUnVsZXM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBiZWZvcmVUZXh0OiAvXlxccyooPzpkZWZ8Y2xhc3N8Zm9yfGlmfGVsaWZ8ZWxzZXx3aGlsZXx0cnl8d2l0aHxmaW5hbGx5fGV4Y2VwdHxhc3luYylcXGIuKjpcXHMqLyxcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb246IHsgaW5kZW50QWN0aW9uOiB2c2NvZGVfMS5JbmRlbnRBY3Rpb24uSW5kZW50IH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlVGV4dDogL15cXHMqIy4qLyxcclxuICAgICAgICAgICAgICAgICAgICBhZnRlclRleHQ6IC8uKyQvLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogeyBpbmRlbnRBY3Rpb246IHZzY29kZV8xLkluZGVudEFjdGlvbi5Ob25lLCBhcHBlbmRUZXh0OiAnIyAnIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgYmVmb3JlVGV4dDogL15cXHMrKGNvbnRpbnVlfGJyZWFrfHJldHVybilcXGIuKi8sXHJcbiAgICAgICAgICAgICAgICAgICAgYWZ0ZXJUZXh0OiAvXFxzKyQvLFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbjogeyBpbmRlbnRBY3Rpb246IHZzY29kZV8xLkluZGVudEFjdGlvbi5PdXRkZW50IH1cclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXVxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIGlmIChweXRob25TZXR0aW5ncyAmJiBweXRob25TZXR0aW5ncy5mb3JtYXR0aW5nICYmIHB5dGhvblNldHRpbmdzLmZvcm1hdHRpbmcucHJvdmlkZXIgIT09ICdub25lJykge1xyXG4gICAgICAgICAgICBjb25zdCBmb3JtYXRQcm92aWRlciA9IG5ldyBmb3JtYXRQcm92aWRlcl8xLlB5dGhvbkZvcm1hdHRpbmdFZGl0UHJvdmlkZXIoY29udGV4dCwgc2VydmljZUNvbnRhaW5lcik7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Vic2NyaXB0aW9ucy5wdXNoKHZzY29kZV8xLmxhbmd1YWdlcy5yZWdpc3RlckRvY3VtZW50Rm9ybWF0dGluZ0VkaXRQcm92aWRlcihjb25zdGFudHNfMS5QWVRIT04sIGZvcm1hdFByb3ZpZGVyKSk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuc3Vic2NyaXB0aW9ucy5wdXNoKHZzY29kZV8xLmxhbmd1YWdlcy5yZWdpc3RlckRvY3VtZW50UmFuZ2VGb3JtYXR0aW5nRWRpdFByb3ZpZGVyKGNvbnN0YW50c18xLlBZVEhPTiwgZm9ybWF0UHJvdmlkZXIpKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZGVwcmVjYXRpb25NZ3IgPSBzZXJ2aWNlQ29udGFpbmVyLmdldCh0eXBlc181LklGZWF0dXJlRGVwcmVjYXRpb25NYW5hZ2VyKTtcclxuICAgICAgICBkZXByZWNhdGlvbk1nci5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgY29udGV4dC5zdWJzY3JpcHRpb25zLnB1c2goZGVwcmVjYXRpb25NZ3IpO1xyXG4gICAgICAgIGNvbnRleHQuc3Vic2NyaXB0aW9ucy5wdXNoKHVwZGF0ZVNwYXJrTGlicmFyeVByb3ZpZGVyXzEuYWN0aXZhdGVVcGRhdGVTcGFya0xpYnJhcnlQcm92aWRlcigpKTtcclxuICAgICAgICBjb250ZXh0LnN1YnNjcmlwdGlvbnMucHVzaChuZXcgcmVwbFByb3ZpZGVyXzEuUmVwbFByb3ZpZGVyKHNlcnZpY2VDb250YWluZXIpKTtcclxuICAgICAgICBjb250ZXh0LnN1YnNjcmlwdGlvbnMucHVzaChuZXcgdGVybWluYWxQcm92aWRlcl8xLlRlcm1pbmFsUHJvdmlkZXIoc2VydmljZUNvbnRhaW5lcikpO1xyXG4gICAgICAgIGNvbnRleHQuc3Vic2NyaXB0aW9ucy5wdXNoKHZzY29kZV8xLmxhbmd1YWdlcy5yZWdpc3RlckNvZGVBY3Rpb25zUHJvdmlkZXIoY29uc3RhbnRzXzEuUFlUSE9OLCBuZXcgY29kZUFjdGlvbnNQcm92aWRlcl8xLlB5dGhvbkNvZGVBY3Rpb25Qcm92aWRlcigpLCB7IHByb3ZpZGVkQ29kZUFjdGlvbktpbmRzOiBbdnNjb2RlXzEuQ29kZUFjdGlvbktpbmQuU291cmNlT3JnYW5pemVJbXBvcnRzXSB9KSk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5nZXRBbGwodHlwZXNfOC5JRGVidWdDb25maWd1cmF0aW9uUHJvdmlkZXIpLmZvckVhY2goZGVidWdDb25maWcgPT4ge1xyXG4gICAgICAgICAgICBjb250ZXh0LnN1YnNjcmlwdGlvbnMucHVzaCh2c2NvZGVfMS5kZWJ1Zy5yZWdpc3RlckRlYnVnQ29uZmlndXJhdGlvblByb3ZpZGVyKGNvbnN0YW50c18yLkRlYnVnZ2VyVHlwZU5hbWUsIGRlYnVnQ29uZmlnKSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5nZXQodHlwZXNfOC5JRGVidWdnZXJCYW5uZXIpLmluaXRpYWxpemUoKTtcclxuICAgICAgICBkdXJhdGlvbnMuZW5kQWN0aXZhdGVUaW1lID0gc3RvcFdhdGNoLmVsYXBzZWRUaW1lO1xyXG4gICAgICAgIGFjdGl2YXRpb25EZWZlcnJlZC5yZXNvbHZlKCk7XHJcbiAgICAgICAgY29uc3QgYXBpID0geyByZWFkeTogYWN0aXZhdGlvbkRlZmVycmVkLnByb21pc2UgfTtcclxuICAgICAgICAvLyBJbiB0ZXN0IGVudmlyb25tZW50IHJldHVybiB0aGUgREkgQ29udGFpbmVyLlxyXG4gICAgICAgIGlmIChjb25zdGFudHNfMS5pc1Rlc3RFeGVjdXRpb24oKSkge1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tYW55XHJcbiAgICAgICAgICAgIGFwaS5zZXJ2aWNlQ29udGFpbmVyID0gc2VydmljZUNvbnRhaW5lcjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGFwaTtcclxuICAgIH0pO1xyXG59XHJcbmV4cG9ydHMuYWN0aXZhdGUgPSBhY3RpdmF0ZTtcclxuZnVuY3Rpb24gcmVnaXN0ZXJTZXJ2aWNlcyhjb250ZXh0LCBzZXJ2aWNlTWFuYWdlciwgc2VydmljZUNvbnRhaW5lcikge1xyXG4gICAgc2VydmljZU1hbmFnZXIuYWRkU2luZ2xldG9uSW5zdGFuY2UodHlwZXNfMTAuSVNlcnZpY2VDb250YWluZXIsIHNlcnZpY2VDb250YWluZXIpO1xyXG4gICAgc2VydmljZU1hbmFnZXIuYWRkU2luZ2xldG9uSW5zdGFuY2UodHlwZXNfMTAuSVNlcnZpY2VNYW5hZ2VyLCBzZXJ2aWNlTWFuYWdlcik7XHJcbiAgICBzZXJ2aWNlTWFuYWdlci5hZGRTaW5nbGV0b25JbnN0YW5jZSh0eXBlc181LklEaXNwb3NhYmxlUmVnaXN0cnksIGNvbnRleHQuc3Vic2NyaXB0aW9ucyk7XHJcbiAgICBzZXJ2aWNlTWFuYWdlci5hZGRTaW5nbGV0b25JbnN0YW5jZSh0eXBlc181LklNZW1lbnRvLCBjb250ZXh0Lmdsb2JhbFN0YXRlLCB0eXBlc181LkdMT0JBTF9NRU1FTlRPKTtcclxuICAgIHNlcnZpY2VNYW5hZ2VyLmFkZFNpbmdsZXRvbkluc3RhbmNlKHR5cGVzXzUuSU1lbWVudG8sIGNvbnRleHQud29ya3NwYWNlU3RhdGUsIHR5cGVzXzUuV09SS1NQQUNFX01FTUVOVE8pO1xyXG4gICAgc2VydmljZU1hbmFnZXIuYWRkU2luZ2xldG9uSW5zdGFuY2UodHlwZXNfNS5JRXh0ZW5zaW9uQ29udGV4dCwgY29udGV4dCk7XHJcbiAgICBjb25zdCBzdGFuZGFyZE91dHB1dENoYW5uZWwgPSB2c2NvZGVfMS53aW5kb3cuY3JlYXRlT3V0cHV0Q2hhbm5lbCgnUHl0aG9uJyk7XHJcbiAgICBjb25zdCB1bml0VGVzdE91dENoYW5uZWwgPSB2c2NvZGVfMS53aW5kb3cuY3JlYXRlT3V0cHV0Q2hhbm5lbCgnUHl0aG9uIFRlc3QgTG9nJyk7XHJcbiAgICBzZXJ2aWNlTWFuYWdlci5hZGRTaW5nbGV0b25JbnN0YW5jZSh0eXBlc181LklPdXRwdXRDaGFubmVsLCBzdGFuZGFyZE91dHB1dENoYW5uZWwsIGNvbnN0YW50c18xLlNUQU5EQVJEX09VVFBVVF9DSEFOTkVMKTtcclxuICAgIHNlcnZpY2VNYW5hZ2VyLmFkZFNpbmdsZXRvbkluc3RhbmNlKHR5cGVzXzUuSU91dHB1dENoYW5uZWwsIHVuaXRUZXN0T3V0Q2hhbm5lbCwgY29uc3RhbnRzXzQuVEVTVF9PVVRQVVRfQ0hBTk5FTCk7XHJcbiAgICBzZXJ2aWNlUmVnaXN0cnlfMS5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV82LnJlZ2lzdGVyVHlwZXMoc2VydmljZU1hbmFnZXIpO1xyXG4gICAgc2VydmljZVJlZ2lzdHJ5XzUucmVnaXN0ZXJUeXBlcyhzZXJ2aWNlTWFuYWdlcik7XHJcbiAgICBzZXJ2aWNlUmVnaXN0cnlfNy5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV8xNS5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV8xMi5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV8xMS5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV8xMC5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV80LnJlZ2lzdGVyVHlwZXMoc2VydmljZU1hbmFnZXIpO1xyXG4gICAgc2VydmljZVJlZ2lzdHJ5XzMucmVnaXN0ZXJUeXBlcyhzZXJ2aWNlTWFuYWdlcik7XHJcbiAgICBzZXJ2aWNlUmVnaXN0cnlfMTQucmVnaXN0ZXJUeXBlcyhzZXJ2aWNlTWFuYWdlcik7XHJcbiAgICBzZXJ2aWNlUmVnaXN0cnlfOC5yZWdpc3RlclR5cGVzKHNlcnZpY2VNYW5hZ2VyKTtcclxuICAgIHNlcnZpY2VSZWdpc3RyeV85LnJlZ2lzdGVyVHlwZXMoc2VydmljZU1hbmFnZXIpO1xyXG4gICAgc2VydmljZVJlZ2lzdHJ5XzIucmVnaXN0ZXJUeXBlcyhzZXJ2aWNlTWFuYWdlcik7XHJcbiAgICBzZXJ2aWNlUmVnaXN0cnlfMTMucmVnaXN0ZXJUeXBlcyhzZXJ2aWNlTWFuYWdlcik7XHJcbn1cclxuZnVuY3Rpb24gaW5pdGlhbGl6ZVNlcnZpY2VzKGNvbnRleHQsIHNlcnZpY2VNYW5hZ2VyLCBzZXJ2aWNlQ29udGFpbmVyKSB7XHJcbiAgICBjb25zdCBzZWxlY3RvciA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzkuSUludGVycHJldGVyU2VsZWN0b3IpO1xyXG4gICAgc2VsZWN0b3IuaW5pdGlhbGl6ZSgpO1xyXG4gICAgY29udGV4dC5zdWJzY3JpcHRpb25zLnB1c2goc2VsZWN0b3IpO1xyXG4gICAgY29uc3QgaW50ZXJwcmV0ZXJNYW5hZ2VyID0gc2VydmljZUNvbnRhaW5lci5nZXQoY29udHJhY3RzXzEuSUludGVycHJldGVyU2VydmljZSk7XHJcbiAgICBpbnRlcnByZXRlck1hbmFnZXIuaW5pdGlhbGl6ZSgpO1xyXG4gICAgY29uc3QgaGFuZGxlcnMgPSBzZXJ2aWNlTWFuYWdlci5nZXRBbGwodHlwZXNfNy5JRGVidWdTZXNzaW9uRXZlbnRIYW5kbGVycyk7XHJcbiAgICBjb25zdCBkaXNwb3NhYmxlcyA9IHNlcnZpY2VNYW5hZ2VyLmdldCh0eXBlc181LklEaXNwb3NhYmxlUmVnaXN0cnkpO1xyXG4gICAgY29uc3QgZGlzcGF0Y2hlciA9IG5ldyBldmVudEhhbmRsZXJEaXNwYXRjaGVyXzEuRGVidWdTZXNzaW9uRXZlbnREaXNwYXRjaGVyKGhhbmRsZXJzLCBkZWJ1Z1NlcnZpY2VfMS5EZWJ1Z1NlcnZpY2UuaW5zdGFuY2UsIGRpc3Bvc2FibGVzKTtcclxuICAgIGRpc3BhdGNoZXIucmVnaXN0ZXJFdmVudEhhbmRsZXJzKCk7XHJcbiAgICAvLyBEaXNwbGF5IHByb2dyZXNzIG9mIGludGVycHJldGVyIHJlZnJlc2hlcyBvbmx5IGFmdGVyIGV4dGVuc2lvbiBoYXMgYWN0aXZhdGVkLlxyXG4gICAgc2VydmljZUNvbnRhaW5lci5nZXQoY29udHJhY3RzXzEuSW50ZXJwcmV0ZXJMb2NhdG9yUHJvZ3Jlc3NIYW5kbGVyKS5yZWdpc3RlcigpO1xyXG4gICAgc2VydmljZUNvbnRhaW5lci5nZXQoY29udHJhY3RzXzEuSUludGVycHJldGVyTG9jYXRvclByb2dyZXNzU2VydmljZSkucmVnaXN0ZXIoKTtcclxuICAgIC8vIEdldCBsYXRlc3QgaW50ZXJwcmV0ZXIgbGlzdC5cclxuICAgIGNvbnN0IHdvcmtzcGFjZVNlcnZpY2UgPSBzZXJ2aWNlQ29udGFpbmVyLmdldCh0eXBlc18zLklXb3Jrc3BhY2VTZXJ2aWNlKTtcclxuICAgIGNvbnN0IG1haW5Xb3Jrc3BhY2VVcmkgPSB3b3Jrc3BhY2VTZXJ2aWNlLmhhc1dvcmtzcGFjZUZvbGRlcnMgPyB3b3Jrc3BhY2VTZXJ2aWNlLndvcmtzcGFjZUZvbGRlcnNbMF0udXJpIDogdW5kZWZpbmVkO1xyXG4gICAgY29uc3QgaW50ZXJwcmV0ZXJTZXJ2aWNlID0gc2VydmljZUNvbnRhaW5lci5nZXQoY29udHJhY3RzXzEuSUludGVycHJldGVyU2VydmljZSk7XHJcbiAgICBpbnRlcnByZXRlclNlcnZpY2UuZ2V0SW50ZXJwcmV0ZXJzKG1haW5Xb3Jrc3BhY2VVcmkpLmlnbm9yZUVycm9ycygpO1xyXG59XHJcbmZ1bmN0aW9uIHNlbmRTdGFydHVwVGVsZW1ldHJ5KGFjdGl2YXRlZFByb21pc2UsIHNlcnZpY2VDb250YWluZXIpIHtcclxuICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgbG9nZ2VyID0gc2VydmljZUNvbnRhaW5lci5nZXQodHlwZXNfNS5JTG9nZ2VyKTtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICB5aWVsZCBhY3RpdmF0ZWRQcm9taXNlO1xyXG4gICAgICAgICAgICBjb25zdCB0ZXJtaW5hbEhlbHBlciA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzQuSVRlcm1pbmFsSGVscGVyKTtcclxuICAgICAgICAgICAgY29uc3QgdGVybWluYWxTaGVsbFR5cGUgPSB0ZXJtaW5hbEhlbHBlci5pZGVudGlmeVRlcm1pbmFsU2hlbGwodGVybWluYWxIZWxwZXIuZ2V0VGVybWluYWxTaGVsbFBhdGgoKSk7XHJcbiAgICAgICAgICAgIGNvbnN0IGNvbmRhTG9jYXRvciA9IHNlcnZpY2VDb250YWluZXIuZ2V0KGNvbnRyYWN0c18xLklDb25kYVNlcnZpY2UpO1xyXG4gICAgICAgICAgICBjb25zdCBpbnRlcnByZXRlclNlcnZpY2UgPSBzZXJ2aWNlQ29udGFpbmVyLmdldChjb250cmFjdHNfMS5JSW50ZXJwcmV0ZXJTZXJ2aWNlKTtcclxuICAgICAgICAgICAgY29uc3Qgd29ya3NwYWNlU2VydmljZSA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzMuSVdvcmtzcGFjZVNlcnZpY2UpO1xyXG4gICAgICAgICAgICBjb25zdCBtYWluV29ya3NwYWNlVXJpID0gd29ya3NwYWNlU2VydmljZS5oYXNXb3Jrc3BhY2VGb2xkZXJzID8gd29ya3NwYWNlU2VydmljZS53b3Jrc3BhY2VGb2xkZXJzWzBdLnVyaSA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgY29uc3QgW2NvbmRhVmVyc2lvbiwgaW50ZXJwcmV0ZXIsIGludGVycHJldGVyc10gPSB5aWVsZCBQcm9taXNlLmFsbChbXHJcbiAgICAgICAgICAgICAgICBjb25kYUxvY2F0b3IuZ2V0Q29uZGFWZXJzaW9uKCkudGhlbih2ZXIgPT4gdmVyID8gdmVyLnJhdyA6ICcnKS5jYXRjaCgoKSA9PiAnJyksXHJcbiAgICAgICAgICAgICAgICBpbnRlcnByZXRlclNlcnZpY2UuZ2V0QWN0aXZlSW50ZXJwcmV0ZXIoKS5jYXRjaCgoKSA9PiB1bmRlZmluZWQpLFxyXG4gICAgICAgICAgICAgICAgaW50ZXJwcmV0ZXJTZXJ2aWNlLmdldEludGVycHJldGVycyhtYWluV29ya3NwYWNlVXJpKS5jYXRjaCgoKSA9PiBbXSlcclxuICAgICAgICAgICAgXSk7XHJcbiAgICAgICAgICAgIGNvbnN0IHdvcmtzcGFjZUZvbGRlckNvdW50ID0gd29ya3NwYWNlU2VydmljZS5oYXNXb3Jrc3BhY2VGb2xkZXJzID8gd29ya3NwYWNlU2VydmljZS53b3Jrc3BhY2VGb2xkZXJzLmxlbmd0aCA6IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHB5dGhvblZlcnNpb24gPSBpbnRlcnByZXRlciA/IGludGVycHJldGVyLnZlcnNpb25faW5mby5qb2luKCcuJykgOiB1bmRlZmluZWQ7XHJcbiAgICAgICAgICAgIGNvbnN0IGludGVycHJldGVyVHlwZSA9IGludGVycHJldGVyID8gaW50ZXJwcmV0ZXIudHlwZSA6IHVuZGVmaW5lZDtcclxuICAgICAgICAgICAgY29uc3QgaGFzUHl0aG9uMyA9IGludGVycHJldGVyc1xyXG4gICAgICAgICAgICAgICAgLmZpbHRlcihpdGVtID0+IGl0ZW0gJiYgQXJyYXkuaXNBcnJheShpdGVtLnZlcnNpb25faW5mbykgPyBpdGVtLnZlcnNpb25faW5mb1swXSA9PT0gMyA6IGZhbHNlKVxyXG4gICAgICAgICAgICAgICAgLmxlbmd0aCA+IDA7XHJcbiAgICAgICAgICAgIGNvbnN0IHByb3BzID0geyBjb25kYVZlcnNpb24sIHRlcm1pbmFsOiB0ZXJtaW5hbFNoZWxsVHlwZSwgcHl0aG9uVmVyc2lvbiwgaW50ZXJwcmV0ZXJUeXBlLCB3b3Jrc3BhY2VGb2xkZXJDb3VudCwgaGFzUHl0aG9uMyB9O1xyXG4gICAgICAgICAgICB0ZWxlbWV0cnlfMS5zZW5kVGVsZW1ldHJ5RXZlbnQoY29uc3RhbnRzXzMuRURJVE9SX0xPQUQsIGR1cmF0aW9ucywgcHJvcHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjYXRjaCAoZXgpIHtcclxuICAgICAgICAgICAgbG9nZ2VyLmxvZ0Vycm9yKCdzZW5kU3RhcnR1cFRlbGVtZXRyeSBmYWlsZWQuJywgZXgpO1xyXG4gICAgICAgIH1cclxuICAgIH0pO1xyXG59XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWV4dGVuc2lvbi5qcy5tYXAiXX0=