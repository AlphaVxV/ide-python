'use strict';

var __decorate = void 0 && (void 0).__decorate || function (decorators, target, key, desc) {
  var c = arguments.length,
      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,
      d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var __param = void 0 && (void 0).__param || function (paramIndex, decorator) {
  return function (target, key) {
    decorator(target, key, paramIndex);
  };
};

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const inversify_1 = require("inversify");

const types_1 = require("../../common/platform/types");

const misc_1 = require("../../common/utils/misc");

const types_2 = require("../../ioc/types");

const constants_1 = require("../common/constants");

const types_3 = require("../common/types");

const types_4 = require("../types");

const JunitXmlArg = '--junitxml';
let TestManagerRunner = class TestManagerRunner {
  constructor(serviceContainer) {
    this.serviceContainer = serviceContainer;
    this.argsService = serviceContainer.get(types_4.IArgumentsService, constants_1.PYTEST_PROVIDER);
    this.argsHelper = serviceContainer.get(types_4.IArgumentsHelper);
    this.testRunner = serviceContainer.get(types_3.ITestRunner);
    this.xUnitParser = this.serviceContainer.get(types_3.IXUnitParser);
    this.fs = this.serviceContainer.get(types_1.IFileSystem);
  }

  runTest(testResultsService, options, _) {
    return __awaiter(this, void 0, void 0, function* () {
      let testPaths = [];

      if (options.testsToRun && options.testsToRun.testFolder) {
        testPaths = testPaths.concat(options.testsToRun.testFolder.map(f => f.nameToRun));
      }

      if (options.testsToRun && options.testsToRun.testFile) {
        testPaths = testPaths.concat(options.testsToRun.testFile.map(f => f.nameToRun));
      }

      if (options.testsToRun && options.testsToRun.testSuite) {
        testPaths = testPaths.concat(options.testsToRun.testSuite.map(f => f.nameToRun));
      }

      if (options.testsToRun && options.testsToRun.testFunction) {
        testPaths = testPaths.concat(options.testsToRun.testFunction.map(f => f.nameToRun));
      }

      let deleteJUnitXmlFile = misc_1.noop;
      const args = options.args;

      try {
        const xmlLogResult = yield this.getJUnitXmlFile(args);
        const xmlLogFile = xmlLogResult.filePath;
        deleteJUnitXmlFile = xmlLogResult.dispose; // Remove the '--junixml' if it exists, and add it with our path.

        const testArgs = this.argsService.filterArguments(args, [JunitXmlArg]);
        testArgs.splice(0, 0, `${JunitXmlArg}=${xmlLogFile}`); // Positional arguments control the tests to be run.

        testArgs.push(...testPaths);

        if (options.debug) {
          const debugLauncher = this.serviceContainer.get(types_3.ITestDebugLauncher);
          const debuggerArgs = [options.cwd, 'pytest'].concat(testArgs);
          const launchOptions = {
            cwd: options.cwd,
            args: debuggerArgs,
            token: options.token,
            outChannel: options.outChannel,
            testProvider: constants_1.PYTEST_PROVIDER
          };
          yield debugLauncher.launchDebugger(launchOptions);
        } else {
          const runOptions = {
            args: testArgs,
            cwd: options.cwd,
            outChannel: options.outChannel,
            token: options.token,
            workspaceFolder: options.workspaceFolder
          };
          yield this.testRunner.run(constants_1.PYTEST_PROVIDER, runOptions);
        }

        return options.debug ? options.tests : yield this.updateResultsFromLogFiles(options.tests, xmlLogFile, testResultsService);
      } catch (ex) {
        return Promise.reject(ex);
      } finally {
        deleteJUnitXmlFile();
      }
    });
  }

  updateResultsFromLogFiles(tests, outputXmlFile, testResultsService) {
    return __awaiter(this, void 0, void 0, function* () {
      yield this.xUnitParser.updateResultsFromXmlLogFile(tests, outputXmlFile, types_3.PassCalculationFormulae.pytest);
      testResultsService.updateResults(tests);
      return tests;
    });
  }

  getJUnitXmlFile(args) {
    return __awaiter(this, void 0, void 0, function* () {
      const xmlFile = this.argsHelper.getOptionValues(args, JunitXmlArg);

      if (typeof xmlFile === 'string') {
        return {
          filePath: xmlFile,
          dispose: misc_1.noop
        };
      }

      return this.fs.createTemporaryFile('.xml');
    });
  }

};
TestManagerRunner = __decorate([inversify_1.injectable(), __param(0, inversify_1.inject(types_2.IServiceContainer))], TestManagerRunner);
exports.TestManagerRunner = TestManagerRunner;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInJ1bm5lci5qcyJdLCJuYW1lcyI6WyJfX2RlY29yYXRlIiwiZGVjb3JhdG9ycyIsInRhcmdldCIsImtleSIsImRlc2MiLCJjIiwiYXJndW1lbnRzIiwibGVuZ3RoIiwiciIsIk9iamVjdCIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImQiLCJSZWZsZWN0IiwiZGVjb3JhdGUiLCJpIiwiZGVmaW5lUHJvcGVydHkiLCJfX3BhcmFtIiwicGFyYW1JbmRleCIsImRlY29yYXRvciIsIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJleHBvcnRzIiwiaW52ZXJzaWZ5XzEiLCJyZXF1aXJlIiwidHlwZXNfMSIsIm1pc2NfMSIsInR5cGVzXzIiLCJjb25zdGFudHNfMSIsInR5cGVzXzMiLCJ0eXBlc180IiwiSnVuaXRYbWxBcmciLCJUZXN0TWFuYWdlclJ1bm5lciIsImNvbnN0cnVjdG9yIiwic2VydmljZUNvbnRhaW5lciIsImFyZ3NTZXJ2aWNlIiwiZ2V0IiwiSUFyZ3VtZW50c1NlcnZpY2UiLCJQWVRFU1RfUFJPVklERVIiLCJhcmdzSGVscGVyIiwiSUFyZ3VtZW50c0hlbHBlciIsInRlc3RSdW5uZXIiLCJJVGVzdFJ1bm5lciIsInhVbml0UGFyc2VyIiwiSVhVbml0UGFyc2VyIiwiZnMiLCJJRmlsZVN5c3RlbSIsInJ1blRlc3QiLCJ0ZXN0UmVzdWx0c1NlcnZpY2UiLCJvcHRpb25zIiwiXyIsInRlc3RQYXRocyIsInRlc3RzVG9SdW4iLCJ0ZXN0Rm9sZGVyIiwiY29uY2F0IiwibWFwIiwiZiIsIm5hbWVUb1J1biIsInRlc3RGaWxlIiwidGVzdFN1aXRlIiwidGVzdEZ1bmN0aW9uIiwiZGVsZXRlSlVuaXRYbWxGaWxlIiwibm9vcCIsImFyZ3MiLCJ4bWxMb2dSZXN1bHQiLCJnZXRKVW5pdFhtbEZpbGUiLCJ4bWxMb2dGaWxlIiwiZmlsZVBhdGgiLCJkaXNwb3NlIiwidGVzdEFyZ3MiLCJmaWx0ZXJBcmd1bWVudHMiLCJzcGxpY2UiLCJwdXNoIiwiZGVidWciLCJkZWJ1Z0xhdW5jaGVyIiwiSVRlc3REZWJ1Z0xhdW5jaGVyIiwiZGVidWdnZXJBcmdzIiwiY3dkIiwibGF1bmNoT3B0aW9ucyIsInRva2VuIiwib3V0Q2hhbm5lbCIsInRlc3RQcm92aWRlciIsImxhdW5jaERlYnVnZ2VyIiwicnVuT3B0aW9ucyIsIndvcmtzcGFjZUZvbGRlciIsInJ1biIsInRlc3RzIiwidXBkYXRlUmVzdWx0c0Zyb21Mb2dGaWxlcyIsImV4Iiwib3V0cHV0WG1sRmlsZSIsInVwZGF0ZVJlc3VsdHNGcm9tWG1sTG9nRmlsZSIsIlBhc3NDYWxjdWxhdGlvbkZvcm11bGFlIiwicHl0ZXN0IiwidXBkYXRlUmVzdWx0cyIsInhtbEZpbGUiLCJnZXRPcHRpb25WYWx1ZXMiLCJjcmVhdGVUZW1wb3JhcnlGaWxlIiwiaW5qZWN0YWJsZSIsImluamVjdCIsIklTZXJ2aWNlQ29udGFpbmVyIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFDQSxJQUFJQSxVQUFVLEdBQUksVUFBUSxTQUFLQSxVQUFkLElBQTZCLFVBQVVDLFVBQVYsRUFBc0JDLE1BQXRCLEVBQThCQyxHQUE5QixFQUFtQ0MsSUFBbkMsRUFBeUM7QUFDbkYsTUFBSUMsQ0FBQyxHQUFHQyxTQUFTLENBQUNDLE1BQWxCO0FBQUEsTUFBMEJDLENBQUMsR0FBR0gsQ0FBQyxHQUFHLENBQUosR0FBUUgsTUFBUixHQUFpQkUsSUFBSSxLQUFLLElBQVQsR0FBZ0JBLElBQUksR0FBR0ssTUFBTSxDQUFDQyx3QkFBUCxDQUFnQ1IsTUFBaEMsRUFBd0NDLEdBQXhDLENBQXZCLEdBQXNFQyxJQUFySDtBQUFBLE1BQTJITyxDQUEzSDtBQUNBLE1BQUksT0FBT0MsT0FBUCxLQUFtQixRQUFuQixJQUErQixPQUFPQSxPQUFPLENBQUNDLFFBQWYsS0FBNEIsVUFBL0QsRUFBMkVMLENBQUMsR0FBR0ksT0FBTyxDQUFDQyxRQUFSLENBQWlCWixVQUFqQixFQUE2QkMsTUFBN0IsRUFBcUNDLEdBQXJDLEVBQTBDQyxJQUExQyxDQUFKLENBQTNFLEtBQ0ssS0FBSyxJQUFJVSxDQUFDLEdBQUdiLFVBQVUsQ0FBQ00sTUFBWCxHQUFvQixDQUFqQyxFQUFvQ08sQ0FBQyxJQUFJLENBQXpDLEVBQTRDQSxDQUFDLEVBQTdDLEVBQWlELElBQUlILENBQUMsR0FBR1YsVUFBVSxDQUFDYSxDQUFELENBQWxCLEVBQXVCTixDQUFDLEdBQUcsQ0FBQ0gsQ0FBQyxHQUFHLENBQUosR0FBUU0sQ0FBQyxDQUFDSCxDQUFELENBQVQsR0FBZUgsQ0FBQyxHQUFHLENBQUosR0FBUU0sQ0FBQyxDQUFDVCxNQUFELEVBQVNDLEdBQVQsRUFBY0ssQ0FBZCxDQUFULEdBQTRCRyxDQUFDLENBQUNULE1BQUQsRUFBU0MsR0FBVCxDQUE3QyxLQUErREssQ0FBbkU7QUFDN0UsU0FBT0gsQ0FBQyxHQUFHLENBQUosSUFBU0csQ0FBVCxJQUFjQyxNQUFNLENBQUNNLGNBQVAsQ0FBc0JiLE1BQXRCLEVBQThCQyxHQUE5QixFQUFtQ0ssQ0FBbkMsQ0FBZCxFQUFxREEsQ0FBNUQ7QUFDSCxDQUxEOztBQU1BLElBQUlRLE9BQU8sR0FBSSxVQUFRLFNBQUtBLE9BQWQsSUFBMEIsVUFBVUMsVUFBVixFQUFzQkMsU0FBdEIsRUFBaUM7QUFDckUsU0FBTyxVQUFVaEIsTUFBVixFQUFrQkMsR0FBbEIsRUFBdUI7QUFBRWUsSUFBQUEsU0FBUyxDQUFDaEIsTUFBRCxFQUFTQyxHQUFULEVBQWNjLFVBQWQsQ0FBVDtBQUFxQyxHQUFyRTtBQUNILENBRkQ7O0FBR0EsSUFBSUUsU0FBUyxHQUFJLFVBQVEsU0FBS0EsU0FBZCxJQUE0QixVQUFVQyxPQUFWLEVBQW1CQyxVQUFuQixFQUErQkMsQ0FBL0IsRUFBa0NDLFNBQWxDLEVBQTZDO0FBQ3JGLFNBQU8sS0FBS0QsQ0FBQyxLQUFLQSxDQUFDLEdBQUdFLE9BQVQsQ0FBTixFQUF5QixVQUFVQyxPQUFWLEVBQW1CQyxNQUFuQixFQUEyQjtBQUN2RCxhQUFTQyxTQUFULENBQW1CQyxLQUFuQixFQUEwQjtBQUFFLFVBQUk7QUFBRUMsUUFBQUEsSUFBSSxDQUFDTixTQUFTLENBQUNPLElBQVYsQ0FBZUYsS0FBZixDQUFELENBQUo7QUFBOEIsT0FBcEMsQ0FBcUMsT0FBT0csQ0FBUCxFQUFVO0FBQUVMLFFBQUFBLE1BQU0sQ0FBQ0ssQ0FBRCxDQUFOO0FBQVk7QUFBRTs7QUFDM0YsYUFBU0MsUUFBVCxDQUFrQkosS0FBbEIsRUFBeUI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDLE9BQUQsQ0FBVCxDQUFtQkssS0FBbkIsQ0FBRCxDQUFKO0FBQWtDLE9BQXhDLENBQXlDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzlGLGFBQVNGLElBQVQsQ0FBY0ksTUFBZCxFQUFzQjtBQUFFQSxNQUFBQSxNQUFNLENBQUNDLElBQVAsR0FBY1QsT0FBTyxDQUFDUSxNQUFNLENBQUNMLEtBQVIsQ0FBckIsR0FBc0MsSUFBSU4sQ0FBSixDQUFNLFVBQVVHLE9BQVYsRUFBbUI7QUFBRUEsUUFBQUEsT0FBTyxDQUFDUSxNQUFNLENBQUNMLEtBQVIsQ0FBUDtBQUF3QixPQUFuRCxFQUFxRE8sSUFBckQsQ0FBMERSLFNBQTFELEVBQXFFSyxRQUFyRSxDQUF0QztBQUF1SDs7QUFDL0lILElBQUFBLElBQUksQ0FBQyxDQUFDTixTQUFTLEdBQUdBLFNBQVMsQ0FBQ2EsS0FBVixDQUFnQmhCLE9BQWhCLEVBQXlCQyxVQUFVLElBQUksRUFBdkMsQ0FBYixFQUF5RFMsSUFBekQsRUFBRCxDQUFKO0FBQ0gsR0FMTSxDQUFQO0FBTUgsQ0FQRDs7QUFRQXJCLE1BQU0sQ0FBQ00sY0FBUCxDQUFzQnNCLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQUVULEVBQUFBLEtBQUssRUFBRTtBQUFULENBQTdDOztBQUNBLE1BQU1VLFdBQVcsR0FBR0MsT0FBTyxDQUFDLFdBQUQsQ0FBM0I7O0FBQ0EsTUFBTUMsT0FBTyxHQUFHRCxPQUFPLENBQUMsNkJBQUQsQ0FBdkI7O0FBQ0EsTUFBTUUsTUFBTSxHQUFHRixPQUFPLENBQUMseUJBQUQsQ0FBdEI7O0FBQ0EsTUFBTUcsT0FBTyxHQUFHSCxPQUFPLENBQUMsaUJBQUQsQ0FBdkI7O0FBQ0EsTUFBTUksV0FBVyxHQUFHSixPQUFPLENBQUMscUJBQUQsQ0FBM0I7O0FBQ0EsTUFBTUssT0FBTyxHQUFHTCxPQUFPLENBQUMsaUJBQUQsQ0FBdkI7O0FBQ0EsTUFBTU0sT0FBTyxHQUFHTixPQUFPLENBQUMsVUFBRCxDQUF2Qjs7QUFDQSxNQUFNTyxXQUFXLEdBQUcsWUFBcEI7QUFDQSxJQUFJQyxpQkFBaUIsR0FBRyxNQUFNQSxpQkFBTixDQUF3QjtBQUM1Q0MsRUFBQUEsV0FBVyxDQUFDQyxnQkFBRCxFQUFtQjtBQUMxQixTQUFLQSxnQkFBTCxHQUF3QkEsZ0JBQXhCO0FBQ0EsU0FBS0MsV0FBTCxHQUFtQkQsZ0JBQWdCLENBQUNFLEdBQWpCLENBQXFCTixPQUFPLENBQUNPLGlCQUE3QixFQUFnRFQsV0FBVyxDQUFDVSxlQUE1RCxDQUFuQjtBQUNBLFNBQUtDLFVBQUwsR0FBa0JMLGdCQUFnQixDQUFDRSxHQUFqQixDQUFxQk4sT0FBTyxDQUFDVSxnQkFBN0IsQ0FBbEI7QUFDQSxTQUFLQyxVQUFMLEdBQWtCUCxnQkFBZ0IsQ0FBQ0UsR0FBakIsQ0FBcUJQLE9BQU8sQ0FBQ2EsV0FBN0IsQ0FBbEI7QUFDQSxTQUFLQyxXQUFMLEdBQW1CLEtBQUtULGdCQUFMLENBQXNCRSxHQUF0QixDQUEwQlAsT0FBTyxDQUFDZSxZQUFsQyxDQUFuQjtBQUNBLFNBQUtDLEVBQUwsR0FBVSxLQUFLWCxnQkFBTCxDQUFzQkUsR0FBdEIsQ0FBMEJYLE9BQU8sQ0FBQ3FCLFdBQWxDLENBQVY7QUFDSDs7QUFDREMsRUFBQUEsT0FBTyxDQUFDQyxrQkFBRCxFQUFxQkMsT0FBckIsRUFBOEJDLENBQTlCLEVBQWlDO0FBQ3BDLFdBQU85QyxTQUFTLENBQUMsSUFBRCxFQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUNoRCxVQUFJK0MsU0FBUyxHQUFHLEVBQWhCOztBQUNBLFVBQUlGLE9BQU8sQ0FBQ0csVUFBUixJQUFzQkgsT0FBTyxDQUFDRyxVQUFSLENBQW1CQyxVQUE3QyxFQUF5RDtBQUNyREYsUUFBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUNHLE1BQVYsQ0FBaUJMLE9BQU8sQ0FBQ0csVUFBUixDQUFtQkMsVUFBbkIsQ0FBOEJFLEdBQTlCLENBQWtDQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsU0FBekMsQ0FBakIsQ0FBWjtBQUNIOztBQUNELFVBQUlSLE9BQU8sQ0FBQ0csVUFBUixJQUFzQkgsT0FBTyxDQUFDRyxVQUFSLENBQW1CTSxRQUE3QyxFQUF1RDtBQUNuRFAsUUFBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUNHLE1BQVYsQ0FBaUJMLE9BQU8sQ0FBQ0csVUFBUixDQUFtQk0sUUFBbkIsQ0FBNEJILEdBQTVCLENBQWdDQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsU0FBdkMsQ0FBakIsQ0FBWjtBQUNIOztBQUNELFVBQUlSLE9BQU8sQ0FBQ0csVUFBUixJQUFzQkgsT0FBTyxDQUFDRyxVQUFSLENBQW1CTyxTQUE3QyxFQUF3RDtBQUNwRFIsUUFBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUNHLE1BQVYsQ0FBaUJMLE9BQU8sQ0FBQ0csVUFBUixDQUFtQk8sU0FBbkIsQ0FBNkJKLEdBQTdCLENBQWlDQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsU0FBeEMsQ0FBakIsQ0FBWjtBQUNIOztBQUNELFVBQUlSLE9BQU8sQ0FBQ0csVUFBUixJQUFzQkgsT0FBTyxDQUFDRyxVQUFSLENBQW1CUSxZQUE3QyxFQUEyRDtBQUN2RFQsUUFBQUEsU0FBUyxHQUFHQSxTQUFTLENBQUNHLE1BQVYsQ0FBaUJMLE9BQU8sQ0FBQ0csVUFBUixDQUFtQlEsWUFBbkIsQ0FBZ0NMLEdBQWhDLENBQW9DQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsU0FBM0MsQ0FBakIsQ0FBWjtBQUNIOztBQUNELFVBQUlJLGtCQUFrQixHQUFHbkMsTUFBTSxDQUFDb0MsSUFBaEM7QUFDQSxZQUFNQyxJQUFJLEdBQUdkLE9BQU8sQ0FBQ2MsSUFBckI7O0FBQ0EsVUFBSTtBQUNBLGNBQU1DLFlBQVksR0FBRyxNQUFNLEtBQUtDLGVBQUwsQ0FBcUJGLElBQXJCLENBQTNCO0FBQ0EsY0FBTUcsVUFBVSxHQUFHRixZQUFZLENBQUNHLFFBQWhDO0FBQ0FOLFFBQUFBLGtCQUFrQixHQUFHRyxZQUFZLENBQUNJLE9BQWxDLENBSEEsQ0FJQTs7QUFDQSxjQUFNQyxRQUFRLEdBQUcsS0FBS2xDLFdBQUwsQ0FBaUJtQyxlQUFqQixDQUFpQ1AsSUFBakMsRUFBdUMsQ0FBQ2hDLFdBQUQsQ0FBdkMsQ0FBakI7QUFDQXNDLFFBQUFBLFFBQVEsQ0FBQ0UsTUFBVCxDQUFnQixDQUFoQixFQUFtQixDQUFuQixFQUF1QixHQUFFeEMsV0FBWSxJQUFHbUMsVUFBVyxFQUFuRCxFQU5BLENBT0E7O0FBQ0FHLFFBQUFBLFFBQVEsQ0FBQ0csSUFBVCxDQUFjLEdBQUdyQixTQUFqQjs7QUFDQSxZQUFJRixPQUFPLENBQUN3QixLQUFaLEVBQW1CO0FBQ2YsZ0JBQU1DLGFBQWEsR0FBRyxLQUFLeEMsZ0JBQUwsQ0FBc0JFLEdBQXRCLENBQTBCUCxPQUFPLENBQUM4QyxrQkFBbEMsQ0FBdEI7QUFDQSxnQkFBTUMsWUFBWSxHQUFHLENBQUMzQixPQUFPLENBQUM0QixHQUFULEVBQWMsUUFBZCxFQUF3QnZCLE1BQXhCLENBQStCZSxRQUEvQixDQUFyQjtBQUNBLGdCQUFNUyxhQUFhLEdBQUc7QUFBRUQsWUFBQUEsR0FBRyxFQUFFNUIsT0FBTyxDQUFDNEIsR0FBZjtBQUFvQmQsWUFBQUEsSUFBSSxFQUFFYSxZQUExQjtBQUF3Q0csWUFBQUEsS0FBSyxFQUFFOUIsT0FBTyxDQUFDOEIsS0FBdkQ7QUFBOERDLFlBQUFBLFVBQVUsRUFBRS9CLE9BQU8sQ0FBQytCLFVBQWxGO0FBQThGQyxZQUFBQSxZQUFZLEVBQUVyRCxXQUFXLENBQUNVO0FBQXhILFdBQXRCO0FBQ0EsZ0JBQU1vQyxhQUFhLENBQUNRLGNBQWQsQ0FBNkJKLGFBQTdCLENBQU47QUFDSCxTQUxELE1BTUs7QUFDRCxnQkFBTUssVUFBVSxHQUFHO0FBQ2ZwQixZQUFBQSxJQUFJLEVBQUVNLFFBRFM7QUFFZlEsWUFBQUEsR0FBRyxFQUFFNUIsT0FBTyxDQUFDNEIsR0FGRTtBQUdmRyxZQUFBQSxVQUFVLEVBQUUvQixPQUFPLENBQUMrQixVQUhMO0FBSWZELFlBQUFBLEtBQUssRUFBRTlCLE9BQU8sQ0FBQzhCLEtBSkE7QUFLZkssWUFBQUEsZUFBZSxFQUFFbkMsT0FBTyxDQUFDbUM7QUFMVixXQUFuQjtBQU9BLGdCQUFNLEtBQUszQyxVQUFMLENBQWdCNEMsR0FBaEIsQ0FBb0J6RCxXQUFXLENBQUNVLGVBQWhDLEVBQWlENkMsVUFBakQsQ0FBTjtBQUNIOztBQUNELGVBQU9sQyxPQUFPLENBQUN3QixLQUFSLEdBQWdCeEIsT0FBTyxDQUFDcUMsS0FBeEIsR0FBZ0MsTUFBTSxLQUFLQyx5QkFBTCxDQUErQnRDLE9BQU8sQ0FBQ3FDLEtBQXZDLEVBQThDcEIsVUFBOUMsRUFBMERsQixrQkFBMUQsQ0FBN0M7QUFDSCxPQTFCRCxDQTJCQSxPQUFPd0MsRUFBUCxFQUFXO0FBQ1AsZUFBTy9FLE9BQU8sQ0FBQ0UsTUFBUixDQUFlNkUsRUFBZixDQUFQO0FBQ0gsT0E3QkQsU0E4QlE7QUFDSjNCLFFBQUFBLGtCQUFrQjtBQUNyQjtBQUNKLEtBakRlLENBQWhCO0FBa0RIOztBQUNEMEIsRUFBQUEseUJBQXlCLENBQUNELEtBQUQsRUFBUUcsYUFBUixFQUF1QnpDLGtCQUF2QixFQUEyQztBQUNoRSxXQUFPNUMsU0FBUyxDQUFDLElBQUQsRUFBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDaEQsWUFBTSxLQUFLdUMsV0FBTCxDQUFpQitDLDJCQUFqQixDQUE2Q0osS0FBN0MsRUFBb0RHLGFBQXBELEVBQW1FNUQsT0FBTyxDQUFDOEQsdUJBQVIsQ0FBZ0NDLE1BQW5HLENBQU47QUFDQTVDLE1BQUFBLGtCQUFrQixDQUFDNkMsYUFBbkIsQ0FBaUNQLEtBQWpDO0FBQ0EsYUFBT0EsS0FBUDtBQUNILEtBSmUsQ0FBaEI7QUFLSDs7QUFDRHJCLEVBQUFBLGVBQWUsQ0FBQ0YsSUFBRCxFQUFPO0FBQ2xCLFdBQU8zRCxTQUFTLENBQUMsSUFBRCxFQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUNoRCxZQUFNMEYsT0FBTyxHQUFHLEtBQUt2RCxVQUFMLENBQWdCd0QsZUFBaEIsQ0FBZ0NoQyxJQUFoQyxFQUFzQ2hDLFdBQXRDLENBQWhCOztBQUNBLFVBQUksT0FBTytELE9BQVAsS0FBbUIsUUFBdkIsRUFBaUM7QUFDN0IsZUFBTztBQUFFM0IsVUFBQUEsUUFBUSxFQUFFMkIsT0FBWjtBQUFxQjFCLFVBQUFBLE9BQU8sRUFBRTFDLE1BQU0sQ0FBQ29DO0FBQXJDLFNBQVA7QUFDSDs7QUFDRCxhQUFPLEtBQUtqQixFQUFMLENBQVFtRCxtQkFBUixDQUE0QixNQUE1QixDQUFQO0FBQ0gsS0FOZSxDQUFoQjtBQU9IOztBQTVFMkMsQ0FBaEQ7QUE4RUFoRSxpQkFBaUIsR0FBRy9DLFVBQVUsQ0FBQyxDQUMzQnNDLFdBQVcsQ0FBQzBFLFVBQVosRUFEMkIsRUFFM0JoRyxPQUFPLENBQUMsQ0FBRCxFQUFJc0IsV0FBVyxDQUFDMkUsTUFBWixDQUFtQnZFLE9BQU8sQ0FBQ3dFLGlCQUEzQixDQUFKLENBRm9CLENBQUQsRUFHM0JuRSxpQkFIMkIsQ0FBOUI7QUFJQVYsT0FBTyxDQUFDVSxpQkFBUixHQUE0QkEsaUJBQTVCIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xyXG52YXIgX19kZWNvcmF0ZSA9ICh0aGlzICYmIHRoaXMuX19kZWNvcmF0ZSkgfHwgZnVuY3Rpb24gKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59O1xyXG52YXIgX19wYXJhbSA9ICh0aGlzICYmIHRoaXMuX19wYXJhbSkgfHwgZnVuY3Rpb24gKHBhcmFtSW5kZXgsIGRlY29yYXRvcikge1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uICh0YXJnZXQsIGtleSkgeyBkZWNvcmF0b3IodGFyZ2V0LCBrZXksIHBhcmFtSW5kZXgpOyB9XHJcbn07XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgaW52ZXJzaWZ5XzEgPSByZXF1aXJlKFwiaW52ZXJzaWZ5XCIpO1xyXG5jb25zdCB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uL2NvbW1vbi9wbGF0Zm9ybS90eXBlc1wiKTtcclxuY29uc3QgbWlzY18xID0gcmVxdWlyZShcIi4uLy4uL2NvbW1vbi91dGlscy9taXNjXCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4uLy4uL2lvYy90eXBlc1wiKTtcclxuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi4vY29tbW9uL2NvbnN0YW50c1wiKTtcclxuY29uc3QgdHlwZXNfMyA9IHJlcXVpcmUoXCIuLi9jb21tb24vdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzQgPSByZXF1aXJlKFwiLi4vdHlwZXNcIik7XHJcbmNvbnN0IEp1bml0WG1sQXJnID0gJy0tanVuaXR4bWwnO1xyXG5sZXQgVGVzdE1hbmFnZXJSdW5uZXIgPSBjbGFzcyBUZXN0TWFuYWdlclJ1bm5lciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzZXJ2aWNlQ29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5zZXJ2aWNlQ29udGFpbmVyID0gc2VydmljZUNvbnRhaW5lcjtcclxuICAgICAgICB0aGlzLmFyZ3NTZXJ2aWNlID0gc2VydmljZUNvbnRhaW5lci5nZXQodHlwZXNfNC5JQXJndW1lbnRzU2VydmljZSwgY29uc3RhbnRzXzEuUFlURVNUX1BST1ZJREVSKTtcclxuICAgICAgICB0aGlzLmFyZ3NIZWxwZXIgPSBzZXJ2aWNlQ29udGFpbmVyLmdldCh0eXBlc180LklBcmd1bWVudHNIZWxwZXIpO1xyXG4gICAgICAgIHRoaXMudGVzdFJ1bm5lciA9IHNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzMuSVRlc3RSdW5uZXIpO1xyXG4gICAgICAgIHRoaXMueFVuaXRQYXJzZXIgPSB0aGlzLnNlcnZpY2VDb250YWluZXIuZ2V0KHR5cGVzXzMuSVhVbml0UGFyc2VyKTtcclxuICAgICAgICB0aGlzLmZzID0gdGhpcy5zZXJ2aWNlQ29udGFpbmVyLmdldCh0eXBlc18xLklGaWxlU3lzdGVtKTtcclxuICAgIH1cclxuICAgIHJ1blRlc3QodGVzdFJlc3VsdHNTZXJ2aWNlLCBvcHRpb25zLCBfKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgbGV0IHRlc3RQYXRocyA9IFtdO1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy50ZXN0c1RvUnVuICYmIG9wdGlvbnMudGVzdHNUb1J1bi50ZXN0Rm9sZGVyKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXN0UGF0aHMgPSB0ZXN0UGF0aHMuY29uY2F0KG9wdGlvbnMudGVzdHNUb1J1bi50ZXN0Rm9sZGVyLm1hcChmID0+IGYubmFtZVRvUnVuKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMudGVzdHNUb1J1biAmJiBvcHRpb25zLnRlc3RzVG9SdW4udGVzdEZpbGUpIHtcclxuICAgICAgICAgICAgICAgIHRlc3RQYXRocyA9IHRlc3RQYXRocy5jb25jYXQob3B0aW9ucy50ZXN0c1RvUnVuLnRlc3RGaWxlLm1hcChmID0+IGYubmFtZVRvUnVuKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKG9wdGlvbnMudGVzdHNUb1J1biAmJiBvcHRpb25zLnRlc3RzVG9SdW4udGVzdFN1aXRlKSB7XHJcbiAgICAgICAgICAgICAgICB0ZXN0UGF0aHMgPSB0ZXN0UGF0aHMuY29uY2F0KG9wdGlvbnMudGVzdHNUb1J1bi50ZXN0U3VpdGUubWFwKGYgPT4gZi5uYW1lVG9SdW4pKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy50ZXN0c1RvUnVuICYmIG9wdGlvbnMudGVzdHNUb1J1bi50ZXN0RnVuY3Rpb24pIHtcclxuICAgICAgICAgICAgICAgIHRlc3RQYXRocyA9IHRlc3RQYXRocy5jb25jYXQob3B0aW9ucy50ZXN0c1RvUnVuLnRlc3RGdW5jdGlvbi5tYXAoZiA9PiBmLm5hbWVUb1J1bikpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGxldCBkZWxldGVKVW5pdFhtbEZpbGUgPSBtaXNjXzEubm9vcDtcclxuICAgICAgICAgICAgY29uc3QgYXJncyA9IG9wdGlvbnMuYXJncztcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHhtbExvZ1Jlc3VsdCA9IHlpZWxkIHRoaXMuZ2V0SlVuaXRYbWxGaWxlKGFyZ3MpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeG1sTG9nRmlsZSA9IHhtbExvZ1Jlc3VsdC5maWxlUGF0aDtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZUpVbml0WG1sRmlsZSA9IHhtbExvZ1Jlc3VsdC5kaXNwb3NlO1xyXG4gICAgICAgICAgICAgICAgLy8gUmVtb3ZlIHRoZSAnLS1qdW5peG1sJyBpZiBpdCBleGlzdHMsIGFuZCBhZGQgaXQgd2l0aCBvdXIgcGF0aC5cclxuICAgICAgICAgICAgICAgIGNvbnN0IHRlc3RBcmdzID0gdGhpcy5hcmdzU2VydmljZS5maWx0ZXJBcmd1bWVudHMoYXJncywgW0p1bml0WG1sQXJnXSk7XHJcbiAgICAgICAgICAgICAgICB0ZXN0QXJncy5zcGxpY2UoMCwgMCwgYCR7SnVuaXRYbWxBcmd9PSR7eG1sTG9nRmlsZX1gKTtcclxuICAgICAgICAgICAgICAgIC8vIFBvc2l0aW9uYWwgYXJndW1lbnRzIGNvbnRyb2wgdGhlIHRlc3RzIHRvIGJlIHJ1bi5cclxuICAgICAgICAgICAgICAgIHRlc3RBcmdzLnB1c2goLi4udGVzdFBhdGhzKTtcclxuICAgICAgICAgICAgICAgIGlmIChvcHRpb25zLmRlYnVnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZGVidWdMYXVuY2hlciA9IHRoaXMuc2VydmljZUNvbnRhaW5lci5nZXQodHlwZXNfMy5JVGVzdERlYnVnTGF1bmNoZXIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGRlYnVnZ2VyQXJncyA9IFtvcHRpb25zLmN3ZCwgJ3B5dGVzdCddLmNvbmNhdCh0ZXN0QXJncyk7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGF1bmNoT3B0aW9ucyA9IHsgY3dkOiBvcHRpb25zLmN3ZCwgYXJnczogZGVidWdnZXJBcmdzLCB0b2tlbjogb3B0aW9ucy50b2tlbiwgb3V0Q2hhbm5lbDogb3B0aW9ucy5vdXRDaGFubmVsLCB0ZXN0UHJvdmlkZXI6IGNvbnN0YW50c18xLlBZVEVTVF9QUk9WSURFUiB9O1xyXG4gICAgICAgICAgICAgICAgICAgIHlpZWxkIGRlYnVnTGF1bmNoZXIubGF1bmNoRGVidWdnZXIobGF1bmNoT3B0aW9ucyk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCBydW5PcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBhcmdzOiB0ZXN0QXJncyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgY3dkOiBvcHRpb25zLmN3ZCxcclxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0Q2hhbm5lbDogb3B0aW9ucy5vdXRDaGFubmVsLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB0b2tlbjogb3B0aW9ucy50b2tlbixcclxuICAgICAgICAgICAgICAgICAgICAgICAgd29ya3NwYWNlRm9sZGVyOiBvcHRpb25zLndvcmtzcGFjZUZvbGRlclxyXG4gICAgICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICAgICAgeWllbGQgdGhpcy50ZXN0UnVubmVyLnJ1bihjb25zdGFudHNfMS5QWVRFU1RfUFJPVklERVIsIHJ1bk9wdGlvbnMpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIG9wdGlvbnMuZGVidWcgPyBvcHRpb25zLnRlc3RzIDogeWllbGQgdGhpcy51cGRhdGVSZXN1bHRzRnJvbUxvZ0ZpbGVzKG9wdGlvbnMudGVzdHMsIHhtbExvZ0ZpbGUsIHRlc3RSZXN1bHRzU2VydmljZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY2F0Y2ggKGV4KSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoZXgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlSlVuaXRYbWxGaWxlKCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHVwZGF0ZVJlc3VsdHNGcm9tTG9nRmlsZXModGVzdHMsIG91dHB1dFhtbEZpbGUsIHRlc3RSZXN1bHRzU2VydmljZSkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIHlpZWxkIHRoaXMueFVuaXRQYXJzZXIudXBkYXRlUmVzdWx0c0Zyb21YbWxMb2dGaWxlKHRlc3RzLCBvdXRwdXRYbWxGaWxlLCB0eXBlc18zLlBhc3NDYWxjdWxhdGlvbkZvcm11bGFlLnB5dGVzdCk7XHJcbiAgICAgICAgICAgIHRlc3RSZXN1bHRzU2VydmljZS51cGRhdGVSZXN1bHRzKHRlc3RzKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRlc3RzO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgZ2V0SlVuaXRYbWxGaWxlKGFyZ3MpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBjb25zdCB4bWxGaWxlID0gdGhpcy5hcmdzSGVscGVyLmdldE9wdGlvblZhbHVlcyhhcmdzLCBKdW5pdFhtbEFyZyk7XHJcbiAgICAgICAgICAgIGlmICh0eXBlb2YgeG1sRmlsZSA9PT0gJ3N0cmluZycpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IGZpbGVQYXRoOiB4bWxGaWxlLCBkaXNwb3NlOiBtaXNjXzEubm9vcCB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmZzLmNyZWF0ZVRlbXBvcmFyeUZpbGUoJy54bWwnKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufTtcclxuVGVzdE1hbmFnZXJSdW5uZXIgPSBfX2RlY29yYXRlKFtcclxuICAgIGludmVyc2lmeV8xLmluamVjdGFibGUoKSxcclxuICAgIF9fcGFyYW0oMCwgaW52ZXJzaWZ5XzEuaW5qZWN0KHR5cGVzXzIuSVNlcnZpY2VDb250YWluZXIpKVxyXG5dLCBUZXN0TWFuYWdlclJ1bm5lcik7XHJcbmV4cG9ydHMuVGVzdE1hbmFnZXJSdW5uZXIgPSBUZXN0TWFuYWdlclJ1bm5lcjtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cnVubmVyLmpzLm1hcCJdfQ==