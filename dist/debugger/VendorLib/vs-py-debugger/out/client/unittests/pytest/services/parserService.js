"use strict"; // Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

var __decorate = void 0 && (void 0).__decorate || function (decorators, target, key, desc) {
  var c = arguments.length,
      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,
      d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var __param = void 0 && (void 0).__param || function (paramIndex, decorator) {
  return function (target, key) {
    decorator(target, key, paramIndex);
  };
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const inversify_1 = require("inversify");

const os = require("os");

const path = require("path");

const testUtils_1 = require("../../common/testUtils");

const types_1 = require("../../common/types");

const DELIMITER = '\'';
let TestsParser = class TestsParser {
  constructor(testsHelper) {
    this.testsHelper = testsHelper;
  }

  parse(content, options) {
    const testFiles = this.getTestFiles(content, options);
    return this.testsHelper.flattenTestFiles(testFiles);
  }

  getTestFiles(content, options) {
    let logOutputLines = [''];
    const testFiles = [];
    const parentNodes = [];
    const errorLine = /==*( *)ERRORS( *)=*/;
    const errorFileLine = /__*( *)ERROR collecting (.*)/;
    const lastLineWithErrors = /==*.*/;
    let haveErrors = false;
    let packagePrefix = '';
    content.split(/\r?\n/g).forEach((line, index, lines) => {
      if (options.token && options.token.isCancellationRequested) {
        return;
      }

      const trimmedLine = line.trim();

      if (trimmedLine.startsWith('<Package \'')) {
        // Process the previous lines.
        this.parsePyTestModuleCollectionResult(options.cwd, logOutputLines, testFiles, parentNodes, packagePrefix);
        logOutputLines = [''];
        packagePrefix = this.extractPackageName(trimmedLine, options.cwd);
      }

      if (trimmedLine.startsWith('<Module \'') || index === lines.length - 1) {
        // Process the previous lines.
        this.parsePyTestModuleCollectionResult(options.cwd, logOutputLines, testFiles, parentNodes, packagePrefix);
        logOutputLines = [''];
      }

      if (errorLine.test(line)) {
        haveErrors = true;
        logOutputLines = [''];
        return;
      }

      if (errorFileLine.test(line)) {
        haveErrors = true;

        if (logOutputLines.length !== 1 && logOutputLines[0].length !== 0) {
          this.parsePyTestModuleCollectionError(options.cwd, logOutputLines, testFiles, parentNodes);
          logOutputLines = [''];
        }
      }

      if (lastLineWithErrors.test(line) && haveErrors) {
        this.parsePyTestModuleCollectionError(options.cwd, logOutputLines, testFiles, parentNodes);
        logOutputLines = [''];
      }

      if (index === 0) {
        if (content.startsWith(os.EOL) || lines.length > 1) {
          logOutputLines[logOutputLines.length - 1] += line;
          logOutputLines.push('');
          return;
        }

        logOutputLines[logOutputLines.length - 1] += line;
        return;
      }

      if (index === lines.length - 1) {
        logOutputLines[logOutputLines.length - 1] += line;
        return;
      }

      logOutputLines[logOutputLines.length - 1] += line;
      logOutputLines.push('');
      return;
    });
    return testFiles;
  }

  parsePyTestModuleCollectionError(rootDirectory, lines, testFiles, parentNodes) {
    lines = lines.filter(line => line.trim().length > 0);

    if (lines.length <= 1) {
      return;
    }

    const errorFileLine = lines[0];
    let fileName = errorFileLine.substring(errorFileLine.indexOf('ERROR collecting') + 'ERROR collecting'.length).trim();
    fileName = fileName.substr(0, fileName.lastIndexOf(' '));
    const currentPackage = testUtils_1.convertFileToPackage(fileName);
    const fullyQualifiedName = path.isAbsolute(fileName) ? fileName : path.resolve(rootDirectory, fileName);
    const testFile = {
      functions: [],
      suites: [],
      name: fileName,
      fullPath: fullyQualifiedName,
      nameToRun: fileName,
      xmlName: currentPackage,
      time: 0,
      errorsWhenDiscovering: lines.join('\n')
    };
    testFiles.push(testFile);
    parentNodes.push({
      indent: 0,
      item: testFile
    });
    return;
  }
  /**
   * Extract the 'package' name from a given PyTest (>= 3.7) output line.
   *
   * @param packageLine A single line of output from pytest that starts with `<Package` (may have leading white space).
   * @param rootDir Value is pytest's `--rootdir=` parameter.
   */


  extractPackageName(packageLine, rootDir) {
    const packagePath = testUtils_1.extractBetweenDelimiters(packageLine, DELIMITER, DELIMITER);
    let packageName = path.normalize(packagePath);
    const tmpRoot = path.normalize(rootDir);

    if (packageName.indexOf(tmpRoot) === 0) {
      packageName = packageName.substring(tmpRoot.length);

      if (packageName.startsWith(path.sep)) {
        packageName = packageName.substring(1);
      }

      if (packageName.endsWith(path.sep)) {
        packageName = packageName.substring(0, packageName.length - 1);
      }
    }

    packageName = packageName.replace(/\\/g, '/');
    return packageName;
  }

  parsePyTestModuleCollectionResult(rootDirectory, lines, testFiles, parentNodes, packagePrefix = '') {
    let currentPackage = '';
    lines.forEach(line => {
      const trimmedLine = line.trim();
      let name = testUtils_1.extractBetweenDelimiters(trimmedLine, DELIMITER, DELIMITER);
      const indent = line.indexOf('<');

      if (trimmedLine.startsWith('<Module \'')) {
        if (packagePrefix && packagePrefix.length > 0) {
          name = packagePrefix.concat('/', name);
        }

        currentPackage = testUtils_1.convertFileToPackage(name);
        const fullyQualifiedName = path.isAbsolute(name) ? name : path.resolve(rootDirectory, name);
        const testFile = {
          functions: [],
          suites: [],
          name: name,
          fullPath: fullyQualifiedName,
          nameToRun: name,
          xmlName: currentPackage,
          time: 0
        };
        testFiles.push(testFile);
        parentNodes.push({
          indent: indent,
          item: testFile
        });
        return;
      }

      const parentNode = this.findParentOfCurrentItem(indent, parentNodes);

      if (parentNode && trimmedLine.startsWith('<Class \'') || trimmedLine.startsWith('<UnitTestCase \'')) {
        const isUnitTest = trimmedLine.startsWith('<UnitTestCase \'');
        const rawName = `${parentNode.item.nameToRun}::${name}`;
        const xmlName = `${parentNode.item.xmlName}.${name}`;
        const testSuite = {
          name: name,
          nameToRun: rawName,
          functions: [],
          suites: [],
          isUnitTest: isUnitTest,
          isInstance: false,
          xmlName: xmlName,
          time: 0
        };
        parentNode.item.suites.push(testSuite);
        parentNodes.push({
          indent: indent,
          item: testSuite
        });
        return;
      }

      if (parentNode && trimmedLine.startsWith('<Instance \'')) {
        // tslint:disable-next-line:prefer-type-cast
        const suite = parentNode.item; // suite.rawName = suite.rawName + '::()';
        // suite.xmlName = suite.xmlName + '.()';

        suite.isInstance = true;
        return;
      }

      if (parentNode && trimmedLine.startsWith('<TestCaseFunction \'') || trimmedLine.startsWith('<Function \'')) {
        const rawName = `${parentNode.item.nameToRun}::${name}`;
        const fn = {
          name: name,
          nameToRun: rawName,
          time: 0
        };
        parentNode.item.functions.push(fn);
        return;
      }
    });
  }

  findParentOfCurrentItem(indentOfCurrentItem, parentNodes) {
    while (parentNodes.length > 0) {
      const parentNode = parentNodes[parentNodes.length - 1];

      if (parentNode.indent < indentOfCurrentItem) {
        return parentNode;
      }

      parentNodes.pop();
      continue;
    }

    return;
  }

};
TestsParser = __decorate([inversify_1.injectable(), __param(0, inversify_1.inject(types_1.ITestsHelper))], TestsParser);
exports.TestsParser = TestsParser;
/* Sample output from pytest --collect-only
<Module 'test_another.py'>
  <Class 'Test_CheckMyApp'>
    <Instance '()'>
      <Function 'test_simple_check'>
      <Function 'test_complex_check'>
<Module 'test_one.py'>
  <UnitTestCase 'Test_test1'>
    <TestCaseFunction 'test_A'>
    <TestCaseFunction 'test_B'>
<Module 'test_two.py'>
  <UnitTestCase 'Test_test1'>
    <TestCaseFunction 'test_A2'>
    <TestCaseFunction 'test_B2'>
<Module 'testPasswords/test_Pwd.py'>
  <UnitTestCase 'Test_Pwd'>
    <TestCaseFunction 'test_APwd'>
    <TestCaseFunction 'test_BPwd'>
<Module 'testPasswords/test_multi.py'>
  <Class 'Test_CheckMyApp'>
    <Instance '()'>
      <Function 'test_simple_check'>
      <Function 'test_complex_check'>
      <Class 'Test_NestedClassA'>
        <Instance '()'>
          <Function 'test_nested_class_methodB'>
          <Class 'Test_nested_classB_Of_A'>
            <Instance '()'>
              <Function 'test_d'>
  <Function 'test_username'>
  <Function 'test_parametrized_username[one]'>
  <Function 'test_parametrized_username[two]'>
  <Function 'test_parametrized_username[three]'>
*/
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInBhcnNlclNlcnZpY2UuanMiXSwibmFtZXMiOlsiX19kZWNvcmF0ZSIsImRlY29yYXRvcnMiLCJ0YXJnZXQiLCJrZXkiLCJkZXNjIiwiYyIsImFyZ3VtZW50cyIsImxlbmd0aCIsInIiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJkIiwiUmVmbGVjdCIsImRlY29yYXRlIiwiaSIsImRlZmluZVByb3BlcnR5IiwiX19wYXJhbSIsInBhcmFtSW5kZXgiLCJkZWNvcmF0b3IiLCJleHBvcnRzIiwidmFsdWUiLCJpbnZlcnNpZnlfMSIsInJlcXVpcmUiLCJvcyIsInBhdGgiLCJ0ZXN0VXRpbHNfMSIsInR5cGVzXzEiLCJERUxJTUlURVIiLCJUZXN0c1BhcnNlciIsImNvbnN0cnVjdG9yIiwidGVzdHNIZWxwZXIiLCJwYXJzZSIsImNvbnRlbnQiLCJvcHRpb25zIiwidGVzdEZpbGVzIiwiZ2V0VGVzdEZpbGVzIiwiZmxhdHRlblRlc3RGaWxlcyIsImxvZ091dHB1dExpbmVzIiwicGFyZW50Tm9kZXMiLCJlcnJvckxpbmUiLCJlcnJvckZpbGVMaW5lIiwibGFzdExpbmVXaXRoRXJyb3JzIiwiaGF2ZUVycm9ycyIsInBhY2thZ2VQcmVmaXgiLCJzcGxpdCIsImZvckVhY2giLCJsaW5lIiwiaW5kZXgiLCJsaW5lcyIsInRva2VuIiwiaXNDYW5jZWxsYXRpb25SZXF1ZXN0ZWQiLCJ0cmltbWVkTGluZSIsInRyaW0iLCJzdGFydHNXaXRoIiwicGFyc2VQeVRlc3RNb2R1bGVDb2xsZWN0aW9uUmVzdWx0IiwiY3dkIiwiZXh0cmFjdFBhY2thZ2VOYW1lIiwidGVzdCIsInBhcnNlUHlUZXN0TW9kdWxlQ29sbGVjdGlvbkVycm9yIiwiRU9MIiwicHVzaCIsInJvb3REaXJlY3RvcnkiLCJmaWx0ZXIiLCJmaWxlTmFtZSIsInN1YnN0cmluZyIsImluZGV4T2YiLCJzdWJzdHIiLCJsYXN0SW5kZXhPZiIsImN1cnJlbnRQYWNrYWdlIiwiY29udmVydEZpbGVUb1BhY2thZ2UiLCJmdWxseVF1YWxpZmllZE5hbWUiLCJpc0Fic29sdXRlIiwicmVzb2x2ZSIsInRlc3RGaWxlIiwiZnVuY3Rpb25zIiwic3VpdGVzIiwibmFtZSIsImZ1bGxQYXRoIiwibmFtZVRvUnVuIiwieG1sTmFtZSIsInRpbWUiLCJlcnJvcnNXaGVuRGlzY292ZXJpbmciLCJqb2luIiwiaW5kZW50IiwiaXRlbSIsInBhY2thZ2VMaW5lIiwicm9vdERpciIsInBhY2thZ2VQYXRoIiwiZXh0cmFjdEJldHdlZW5EZWxpbWl0ZXJzIiwicGFja2FnZU5hbWUiLCJub3JtYWxpemUiLCJ0bXBSb290Iiwic2VwIiwiZW5kc1dpdGgiLCJyZXBsYWNlIiwiY29uY2F0IiwicGFyZW50Tm9kZSIsImZpbmRQYXJlbnRPZkN1cnJlbnRJdGVtIiwiaXNVbml0VGVzdCIsInJhd05hbWUiLCJ0ZXN0U3VpdGUiLCJpc0luc3RhbmNlIiwic3VpdGUiLCJmbiIsImluZGVudE9mQ3VycmVudEl0ZW0iLCJwb3AiLCJpbmplY3RhYmxlIiwiaW5qZWN0IiwiSVRlc3RzSGVscGVyIl0sIm1hcHBpbmdzIjoiQUFBQSxhLENBQ0E7QUFDQTs7QUFDQSxJQUFJQSxVQUFVLEdBQUksVUFBUSxTQUFLQSxVQUFkLElBQTZCLFVBQVVDLFVBQVYsRUFBc0JDLE1BQXRCLEVBQThCQyxHQUE5QixFQUFtQ0MsSUFBbkMsRUFBeUM7QUFDbkYsTUFBSUMsQ0FBQyxHQUFHQyxTQUFTLENBQUNDLE1BQWxCO0FBQUEsTUFBMEJDLENBQUMsR0FBR0gsQ0FBQyxHQUFHLENBQUosR0FBUUgsTUFBUixHQUFpQkUsSUFBSSxLQUFLLElBQVQsR0FBZ0JBLElBQUksR0FBR0ssTUFBTSxDQUFDQyx3QkFBUCxDQUFnQ1IsTUFBaEMsRUFBd0NDLEdBQXhDLENBQXZCLEdBQXNFQyxJQUFySDtBQUFBLE1BQTJITyxDQUEzSDtBQUNBLE1BQUksT0FBT0MsT0FBUCxLQUFtQixRQUFuQixJQUErQixPQUFPQSxPQUFPLENBQUNDLFFBQWYsS0FBNEIsVUFBL0QsRUFBMkVM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RCxFQUFzQmxFLFdBQXRCLEVBQW1DO0FBQ3RELFdBQU9BLFdBQVcsQ0FBQy9CLE1BQVosR0FBcUIsQ0FBNUIsRUFBK0I7QUFDM0IsWUFBTXlGLFVBQVUsR0FBRzFELFdBQVcsQ0FBQ0EsV0FBVyxDQUFDL0IsTUFBWixHQUFxQixDQUF0QixDQUE5Qjs7QUFDQSxVQUFJeUYsVUFBVSxDQUFDYixNQUFYLEdBQW9CcUIsbUJBQXhCLEVBQTZDO0FBQ3pDLGVBQU9SLFVBQVA7QUFDSDs7QUFDRDFELE1BQUFBLFdBQVcsQ0FBQ21FLEdBQVo7QUFDQTtBQUNIOztBQUNEO0FBQ0g7O0FBcEsrQixDQUFwQztBQXNLQTdFLFdBQVcsR0FBRzVCLFVBQVUsQ0FBQyxDQUNyQnFCLFdBQVcsQ0FBQ3FGLFVBQVosRUFEcUIsRUFFckIxRixPQUFPLENBQUMsQ0FBRCxFQUFJSyxXQUFXLENBQUNzRixNQUFaLENBQW1CakYsT0FBTyxDQUFDa0YsWUFBM0IsQ0FBSixDQUZjLENBQUQsRUFHckJoRixXQUhxQixDQUF4QjtBQUlBVCxPQUFPLENBQUNTLFdBQVIsR0FBc0JBLFdBQXRCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxuLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxudmFyIF9fcGFyYW0gPSAodGhpcyAmJiB0aGlzLl9fcGFyYW0pIHx8IGZ1bmN0aW9uIChwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IGludmVyc2lmeV8xID0gcmVxdWlyZShcImludmVyc2lmeVwiKTtcclxuY29uc3Qgb3MgPSByZXF1aXJlKFwib3NcIik7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKFwicGF0aFwiKTtcclxuY29uc3QgdGVzdFV0aWxzXzEgPSByZXF1aXJlKFwiLi4vLi4vY29tbW9uL3Rlc3RVdGlsc1wiKTtcclxuY29uc3QgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi9jb21tb24vdHlwZXNcIik7XHJcbmNvbnN0IERFTElNSVRFUiA9ICdcXCcnO1xyXG5sZXQgVGVzdHNQYXJzZXIgPSBjbGFzcyBUZXN0c1BhcnNlciB7XHJcbiAgICBjb25zdHJ1Y3Rvcih0ZXN0c0hlbHBlcikge1xyXG4gICAgICAgIHRoaXMudGVzdHNIZWxwZXIgPSB0ZXN0c0hlbHBlcjtcclxuICAgIH1cclxuICAgIHBhcnNlKGNvbnRlbnQsIG9wdGlvbnMpIHtcclxuICAgICAgICBjb25zdCB0ZXN0RmlsZXMgPSB0aGlzLmdldFRlc3RGaWxlcyhjb250ZW50LCBvcHRpb25zKTtcclxuICAgICAgICByZXR1cm4gdGhpcy50ZXN0c0hlbHBlci5mbGF0dGVuVGVzdEZpbGVzKHRlc3RGaWxlcyk7XHJcbiAgICB9XHJcbiAgICBnZXRUZXN0RmlsZXMoY29udGVudCwgb3B0aW9ucykge1xyXG4gICAgICAgIGxldCBsb2dPdXRwdXRMaW5lcyA9IFsnJ107XHJcbiAgICAgICAgY29uc3QgdGVzdEZpbGVzID0gW107XHJcbiAgICAgICAgY29uc3QgcGFyZW50Tm9kZXMgPSBbXTtcclxuICAgICAgICBjb25zdCBlcnJvckxpbmUgPSAvPT0qKCAqKUVSUk9SUyggKik9Ki87XHJcbiAgICAgICAgY29uc3QgZXJyb3JGaWxlTGluZSA9IC9fXyooICopRVJST1IgY29sbGVjdGluZyAoLiopLztcclxuICAgICAgICBjb25zdCBsYXN0TGluZVdpdGhFcnJvcnMgPSAvPT0qLiovO1xyXG4gICAgICAgIGxldCBoYXZlRXJyb3JzID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IHBhY2thZ2VQcmVmaXggPSAnJztcclxuICAgICAgICBjb250ZW50LnNwbGl0KC9cXHI/XFxuL2cpLmZvckVhY2goKGxpbmUsIGluZGV4LCBsaW5lcykgPT4ge1xyXG4gICAgICAgICAgICBpZiAob3B0aW9ucy50b2tlbiAmJiBvcHRpb25zLnRva2VuLmlzQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgdHJpbW1lZExpbmUgPSBsaW5lLnRyaW0oKTtcclxuICAgICAgICAgICAgaWYgKHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJzxQYWNrYWdlIFxcJycpKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIHRoZSBwcmV2aW91cyBsaW5lcy5cclxuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VQeVRlc3RNb2R1bGVDb2xsZWN0aW9uUmVzdWx0KG9wdGlvbnMuY3dkLCBsb2dPdXRwdXRMaW5lcywgdGVzdEZpbGVzLCBwYXJlbnROb2RlcywgcGFja2FnZVByZWZpeCk7XHJcbiAgICAgICAgICAgICAgICBsb2dPdXRwdXRMaW5lcyA9IFsnJ107XHJcbiAgICAgICAgICAgICAgICBwYWNrYWdlUHJlZml4ID0gdGhpcy5leHRyYWN0UGFja2FnZU5hbWUodHJpbW1lZExpbmUsIG9wdGlvbnMuY3dkKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAodHJpbW1lZExpbmUuc3RhcnRzV2l0aCgnPE1vZHVsZSBcXCcnKSB8fCBpbmRleCA9PT0gbGluZXMubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyB0aGUgcHJldmlvdXMgbGluZXMuXHJcbiAgICAgICAgICAgICAgICB0aGlzLnBhcnNlUHlUZXN0TW9kdWxlQ29sbGVjdGlvblJlc3VsdChvcHRpb25zLmN3ZCwgbG9nT3V0cHV0TGluZXMsIHRlc3RGaWxlcywgcGFyZW50Tm9kZXMsIHBhY2thZ2VQcmVmaXgpO1xyXG4gICAgICAgICAgICAgICAgbG9nT3V0cHV0TGluZXMgPSBbJyddO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChlcnJvckxpbmUudGVzdChsaW5lKSkge1xyXG4gICAgICAgICAgICAgICAgaGF2ZUVycm9ycyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBsb2dPdXRwdXRMaW5lcyA9IFsnJ107XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGVycm9yRmlsZUxpbmUudGVzdChsaW5lKSkge1xyXG4gICAgICAgICAgICAgICAgaGF2ZUVycm9ycyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICBpZiAobG9nT3V0cHV0TGluZXMubGVuZ3RoICE9PSAxICYmIGxvZ091dHB1dExpbmVzWzBdLmxlbmd0aCAhPT0gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGFyc2VQeVRlc3RNb2R1bGVDb2xsZWN0aW9uRXJyb3Iob3B0aW9ucy5jd2QsIGxvZ091dHB1dExpbmVzLCB0ZXN0RmlsZXMsIHBhcmVudE5vZGVzKTtcclxuICAgICAgICAgICAgICAgICAgICBsb2dPdXRwdXRMaW5lcyA9IFsnJ107XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKGxhc3RMaW5lV2l0aEVycm9ycy50ZXN0KGxpbmUpICYmIGhhdmVFcnJvcnMpIHtcclxuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VQeVRlc3RNb2R1bGVDb2xsZWN0aW9uRXJyb3Iob3B0aW9ucy5jd2QsIGxvZ091dHB1dExpbmVzLCB0ZXN0RmlsZXMsIHBhcmVudE5vZGVzKTtcclxuICAgICAgICAgICAgICAgIGxvZ091dHB1dExpbmVzID0gWycnXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoaW5kZXggPT09IDApIHtcclxuICAgICAgICAgICAgICAgIGlmIChjb250ZW50LnN0YXJ0c1dpdGgob3MuRU9MKSB8fCBsaW5lcy5sZW5ndGggPiAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbG9nT3V0cHV0TGluZXNbbG9nT3V0cHV0TGluZXMubGVuZ3RoIC0gMV0gKz0gbGluZTtcclxuICAgICAgICAgICAgICAgICAgICBsb2dPdXRwdXRMaW5lcy5wdXNoKCcnKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBsb2dPdXRwdXRMaW5lc1tsb2dPdXRwdXRMaW5lcy5sZW5ndGggLSAxXSArPSBsaW5lO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChpbmRleCA9PT0gbGluZXMubGVuZ3RoIC0gMSkge1xyXG4gICAgICAgICAgICAgICAgbG9nT3V0cHV0TGluZXNbbG9nT3V0cHV0TGluZXMubGVuZ3RoIC0gMV0gKz0gbGluZTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBsb2dPdXRwdXRMaW5lc1tsb2dPdXRwdXRMaW5lcy5sZW5ndGggLSAxXSArPSBsaW5lO1xyXG4gICAgICAgICAgICBsb2dPdXRwdXRMaW5lcy5wdXNoKCcnKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHJldHVybiB0ZXN0RmlsZXM7XHJcbiAgICB9XHJcbiAgICBwYXJzZVB5VGVzdE1vZHVsZUNvbGxlY3Rpb25FcnJvcihyb290RGlyZWN0b3J5LCBsaW5lcywgdGVzdEZpbGVzLCBwYXJlbnROb2Rlcykge1xyXG4gICAgICAgIGxpbmVzID0gbGluZXMuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkubGVuZ3RoID4gMCk7XHJcbiAgICAgICAgaWYgKGxpbmVzLmxlbmd0aCA8PSAxKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgZXJyb3JGaWxlTGluZSA9IGxpbmVzWzBdO1xyXG4gICAgICAgIGxldCBmaWxlTmFtZSA9IGVycm9yRmlsZUxpbmUuc3Vic3RyaW5nKGVycm9yRmlsZUxpbmUuaW5kZXhPZignRVJST1IgY29sbGVjdGluZycpICsgJ0VSUk9SIGNvbGxlY3RpbmcnLmxlbmd0aCkudHJpbSgpO1xyXG4gICAgICAgIGZpbGVOYW1lID0gZmlsZU5hbWUuc3Vic3RyKDAsIGZpbGVOYW1lLmxhc3RJbmRleE9mKCcgJykpO1xyXG4gICAgICAgIGNvbnN0IGN1cnJlbnRQYWNrYWdlID0gdGVzdFV0aWxzXzEuY29udmVydEZpbGVUb1BhY2thZ2UoZmlsZU5hbWUpO1xyXG4gICAgICAgIGNvbnN0IGZ1bGx5UXVhbGlmaWVkTmFtZSA9IHBhdGguaXNBYnNvbHV0ZShmaWxlTmFtZSkgPyBmaWxlTmFtZSA6IHBhdGgucmVzb2x2ZShyb290RGlyZWN0b3J5LCBmaWxlTmFtZSk7XHJcbiAgICAgICAgY29uc3QgdGVzdEZpbGUgPSB7XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uczogW10sIHN1aXRlczogW10sIG5hbWU6IGZpbGVOYW1lLCBmdWxsUGF0aDogZnVsbHlRdWFsaWZpZWROYW1lLFxyXG4gICAgICAgICAgICBuYW1lVG9SdW46IGZpbGVOYW1lLCB4bWxOYW1lOiBjdXJyZW50UGFja2FnZSwgdGltZTogMCwgZXJyb3JzV2hlbkRpc2NvdmVyaW5nOiBsaW5lcy5qb2luKCdcXG4nKVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGVzdEZpbGVzLnB1c2godGVzdEZpbGUpO1xyXG4gICAgICAgIHBhcmVudE5vZGVzLnB1c2goeyBpbmRlbnQ6IDAsIGl0ZW06IHRlc3RGaWxlIH0pO1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIC8qKlxyXG4gICAgICogRXh0cmFjdCB0aGUgJ3BhY2thZ2UnIG5hbWUgZnJvbSBhIGdpdmVuIFB5VGVzdCAoPj0gMy43KSBvdXRwdXQgbGluZS5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gcGFja2FnZUxpbmUgQSBzaW5nbGUgbGluZSBvZiBvdXRwdXQgZnJvbSBweXRlc3QgdGhhdCBzdGFydHMgd2l0aCBgPFBhY2thZ2VgIChtYXkgaGF2ZSBsZWFkaW5nIHdoaXRlIHNwYWNlKS5cclxuICAgICAqIEBwYXJhbSByb290RGlyIFZhbHVlIGlzIHB5dGVzdCdzIGAtLXJvb3RkaXI9YCBwYXJhbWV0ZXIuXHJcbiAgICAgKi9cclxuICAgIGV4dHJhY3RQYWNrYWdlTmFtZShwYWNrYWdlTGluZSwgcm9vdERpcikge1xyXG4gICAgICAgIGNvbnN0IHBhY2thZ2VQYXRoID0gdGVzdFV0aWxzXzEuZXh0cmFjdEJldHdlZW5EZWxpbWl0ZXJzKHBhY2thZ2VMaW5lLCBERUxJTUlURVIsIERFTElNSVRFUik7XHJcbiAgICAgICAgbGV0IHBhY2thZ2VOYW1lID0gcGF0aC5ub3JtYWxpemUocGFja2FnZVBhdGgpO1xyXG4gICAgICAgIGNvbnN0IHRtcFJvb3QgPSBwYXRoLm5vcm1hbGl6ZShyb290RGlyKTtcclxuICAgICAgICBpZiAocGFja2FnZU5hbWUuaW5kZXhPZih0bXBSb290KSA9PT0gMCkge1xyXG4gICAgICAgICAgICBwYWNrYWdlTmFtZSA9IHBhY2thZ2VOYW1lLnN1YnN0cmluZyh0bXBSb290Lmxlbmd0aCk7XHJcbiAgICAgICAgICAgIGlmIChwYWNrYWdlTmFtZS5zdGFydHNXaXRoKHBhdGguc2VwKSkge1xyXG4gICAgICAgICAgICAgICAgcGFja2FnZU5hbWUgPSBwYWNrYWdlTmFtZS5zdWJzdHJpbmcoMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKHBhY2thZ2VOYW1lLmVuZHNXaXRoKHBhdGguc2VwKSkge1xyXG4gICAgICAgICAgICAgICAgcGFja2FnZU5hbWUgPSBwYWNrYWdlTmFtZS5zdWJzdHJpbmcoMCwgcGFja2FnZU5hbWUubGVuZ3RoIC0gMSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcGFja2FnZU5hbWUgPSBwYWNrYWdlTmFtZS5yZXBsYWNlKC9cXFxcL2csICcvJyk7XHJcbiAgICAgICAgcmV0dXJuIHBhY2thZ2VOYW1lO1xyXG4gICAgfVxyXG4gICAgcGFyc2VQeVRlc3RNb2R1bGVDb2xsZWN0aW9uUmVzdWx0KHJvb3REaXJlY3RvcnksIGxpbmVzLCB0ZXN0RmlsZXMsIHBhcmVudE5vZGVzLCBwYWNrYWdlUHJlZml4ID0gJycpIHtcclxuICAgICAgICBsZXQgY3VycmVudFBhY2thZ2UgPSAnJztcclxuICAgICAgICBsaW5lcy5mb3JFYWNoKGxpbmUgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB0cmltbWVkTGluZSA9IGxpbmUudHJpbSgpO1xyXG4gICAgICAgICAgICBsZXQgbmFtZSA9IHRlc3RVdGlsc18xLmV4dHJhY3RCZXR3ZWVuRGVsaW1pdGVycyh0cmltbWVkTGluZSwgREVMSU1JVEVSLCBERUxJTUlURVIpO1xyXG4gICAgICAgICAgICBjb25zdCBpbmRlbnQgPSBsaW5lLmluZGV4T2YoJzwnKTtcclxuICAgICAgICAgICAgaWYgKHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJzxNb2R1bGUgXFwnJykpIHtcclxuICAgICAgICAgICAgICAgIGlmIChwYWNrYWdlUHJlZml4ICYmIHBhY2thZ2VQcmVmaXgubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICAgICAgICAgIG5hbWUgPSBwYWNrYWdlUHJlZml4LmNvbmNhdCgnLycsIG5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY3VycmVudFBhY2thZ2UgPSB0ZXN0VXRpbHNfMS5jb252ZXJ0RmlsZVRvUGFja2FnZShuYW1lKTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZ1bGx5UXVhbGlmaWVkTmFtZSA9IHBhdGguaXNBYnNvbHV0ZShuYW1lKSA/IG5hbWUgOiBwYXRoLnJlc29sdmUocm9vdERpcmVjdG9yeSwgbmFtZSk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB0ZXN0RmlsZSA9IHtcclxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbnM6IFtdLCBzdWl0ZXM6IFtdLCBuYW1lOiBuYW1lLCBmdWxsUGF0aDogZnVsbHlRdWFsaWZpZWROYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWVUb1J1bjogbmFtZSwgeG1sTmFtZTogY3VycmVudFBhY2thZ2UsIHRpbWU6IDBcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICB0ZXN0RmlsZXMucHVzaCh0ZXN0RmlsZSk7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnROb2Rlcy5wdXNoKHsgaW5kZW50OiBpbmRlbnQsIGl0ZW06IHRlc3RGaWxlIH0pO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNvbnN0IHBhcmVudE5vZGUgPSB0aGlzLmZpbmRQYXJlbnRPZkN1cnJlbnRJdGVtKGluZGVudCwgcGFyZW50Tm9kZXMpO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50Tm9kZSAmJiB0cmltbWVkTGluZS5zdGFydHNXaXRoKCc8Q2xhc3MgXFwnJykgfHwgdHJpbW1lZExpbmUuc3RhcnRzV2l0aCgnPFVuaXRUZXN0Q2FzZSBcXCcnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgaXNVbml0VGVzdCA9IHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJzxVbml0VGVzdENhc2UgXFwnJyk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByYXdOYW1lID0gYCR7cGFyZW50Tm9kZS5pdGVtLm5hbWVUb1J1bn06OiR7bmFtZX1gO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgeG1sTmFtZSA9IGAke3BhcmVudE5vZGUuaXRlbS54bWxOYW1lfS4ke25hbWV9YDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRlc3RTdWl0ZSA9IHsgbmFtZTogbmFtZSwgbmFtZVRvUnVuOiByYXdOYW1lLCBmdW5jdGlvbnM6IFtdLCBzdWl0ZXM6IFtdLCBpc1VuaXRUZXN0OiBpc1VuaXRUZXN0LCBpc0luc3RhbmNlOiBmYWxzZSwgeG1sTmFtZTogeG1sTmFtZSwgdGltZTogMCB9O1xyXG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5pdGVtLnN1aXRlcy5wdXNoKHRlc3RTdWl0ZSk7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnROb2Rlcy5wdXNoKHsgaW5kZW50OiBpbmRlbnQsIGl0ZW06IHRlc3RTdWl0ZSB9KTtcclxuICAgICAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAocGFyZW50Tm9kZSAmJiB0cmltbWVkTGluZS5zdGFydHNXaXRoKCc8SW5zdGFuY2UgXFwnJykpIHtcclxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpwcmVmZXItdHlwZS1jYXN0XHJcbiAgICAgICAgICAgICAgICBjb25zdCBzdWl0ZSA9IHBhcmVudE5vZGUuaXRlbTtcclxuICAgICAgICAgICAgICAgIC8vIHN1aXRlLnJhd05hbWUgPSBzdWl0ZS5yYXdOYW1lICsgJzo6KCknO1xyXG4gICAgICAgICAgICAgICAgLy8gc3VpdGUueG1sTmFtZSA9IHN1aXRlLnhtbE5hbWUgKyAnLigpJztcclxuICAgICAgICAgICAgICAgIHN1aXRlLmlzSW5zdGFuY2UgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChwYXJlbnROb2RlICYmIHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJzxUZXN0Q2FzZUZ1bmN0aW9uIFxcJycpIHx8IHRyaW1tZWRMaW5lLnN0YXJ0c1dpdGgoJzxGdW5jdGlvbiBcXCcnKSkge1xyXG4gICAgICAgICAgICAgICAgY29uc3QgcmF3TmFtZSA9IGAke3BhcmVudE5vZGUuaXRlbS5uYW1lVG9SdW59Ojoke25hbWV9YDtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZuID0geyBuYW1lOiBuYW1lLCBuYW1lVG9SdW46IHJhd05hbWUsIHRpbWU6IDAgfTtcclxuICAgICAgICAgICAgICAgIHBhcmVudE5vZGUuaXRlbS5mdW5jdGlvbnMucHVzaChmbik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZpbmRQYXJlbnRPZkN1cnJlbnRJdGVtKGluZGVudE9mQ3VycmVudEl0ZW0sIHBhcmVudE5vZGVzKSB7XHJcbiAgICAgICAgd2hpbGUgKHBhcmVudE5vZGVzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgY29uc3QgcGFyZW50Tm9kZSA9IHBhcmVudE5vZGVzW3BhcmVudE5vZGVzLmxlbmd0aCAtIDFdO1xyXG4gICAgICAgICAgICBpZiAocGFyZW50Tm9kZS5pbmRlbnQgPCBpbmRlbnRPZkN1cnJlbnRJdGVtKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcGFyZW50Tm9kZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBwYXJlbnROb2Rlcy5wb3AoKTtcclxuICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxufTtcclxuVGVzdHNQYXJzZXIgPSBfX2RlY29yYXRlKFtcclxuICAgIGludmVyc2lmeV8xLmluamVjdGFibGUoKSxcclxuICAgIF9fcGFyYW0oMCwgaW52ZXJzaWZ5XzEuaW5qZWN0KHR5cGVzXzEuSVRlc3RzSGVscGVyKSlcclxuXSwgVGVzdHNQYXJzZXIpO1xyXG5leHBvcnRzLlRlc3RzUGFyc2VyID0gVGVzdHNQYXJzZXI7XHJcbi8qIFNhbXBsZSBvdXRwdXQgZnJvbSBweXRlc3QgLS1jb2xsZWN0LW9ubHlcclxuPE1vZHVsZSAndGVzdF9hbm90aGVyLnB5Jz5cclxuICA8Q2xhc3MgJ1Rlc3RfQ2hlY2tNeUFwcCc+XHJcbiAgICA8SW5zdGFuY2UgJygpJz5cclxuICAgICAgPEZ1bmN0aW9uICd0ZXN0X3NpbXBsZV9jaGVjayc+XHJcbiAgICAgIDxGdW5jdGlvbiAndGVzdF9jb21wbGV4X2NoZWNrJz5cclxuPE1vZHVsZSAndGVzdF9vbmUucHknPlxyXG4gIDxVbml0VGVzdENhc2UgJ1Rlc3RfdGVzdDEnPlxyXG4gICAgPFRlc3RDYXNlRnVuY3Rpb24gJ3Rlc3RfQSc+XHJcbiAgICA8VGVzdENhc2VGdW5jdGlvbiAndGVzdF9CJz5cclxuPE1vZHVsZSAndGVzdF90d28ucHknPlxyXG4gIDxVbml0VGVzdENhc2UgJ1Rlc3RfdGVzdDEnPlxyXG4gICAgPFRlc3RDYXNlRnVuY3Rpb24gJ3Rlc3RfQTInPlxyXG4gICAgPFRlc3RDYXNlRnVuY3Rpb24gJ3Rlc3RfQjInPlxyXG48TW9kdWxlICd0ZXN0UGFzc3dvcmRzL3Rlc3RfUHdkLnB5Jz5cclxuICA8VW5pdFRlc3RDYXNlICdUZXN0X1B3ZCc+XHJcbiAgICA8VGVzdENhc2VGdW5jdGlvbiAndGVzdF9BUHdkJz5cclxuICAgIDxUZXN0Q2FzZUZ1bmN0aW9uICd0ZXN0X0JQd2QnPlxyXG48TW9kdWxlICd0ZXN0UGFzc3dvcmRzL3Rlc3RfbXVsdGkucHknPlxyXG4gIDxDbGFzcyAnVGVzdF9DaGVja015QXBwJz5cclxuICAgIDxJbnN0YW5jZSAnKCknPlxyXG4gICAgICA8RnVuY3Rpb24gJ3Rlc3Rfc2ltcGxlX2NoZWNrJz5cclxuICAgICAgPEZ1bmN0aW9uICd0ZXN0X2NvbXBsZXhfY2hlY2snPlxyXG4gICAgICA8Q2xhc3MgJ1Rlc3RfTmVzdGVkQ2xhc3NBJz5cclxuICAgICAgICA8SW5zdGFuY2UgJygpJz5cclxuICAgICAgICAgIDxGdW5jdGlvbiAndGVzdF9uZXN0ZWRfY2xhc3NfbWV0aG9kQic+XHJcbiAgICAgICAgICA8Q2xhc3MgJ1Rlc3RfbmVzdGVkX2NsYXNzQl9PZl9BJz5cclxuICAgICAgICAgICAgPEluc3RhbmNlICcoKSc+XHJcbiAgICAgICAgICAgICAgPEZ1bmN0aW9uICd0ZXN0X2QnPlxyXG4gIDxGdW5jdGlvbiAndGVzdF91c2VybmFtZSc+XHJcbiAgPEZ1bmN0aW9uICd0ZXN0X3BhcmFtZXRyaXplZF91c2VybmFtZVtvbmVdJz5cclxuICA8RnVuY3Rpb24gJ3Rlc3RfcGFyYW1ldHJpemVkX3VzZXJuYW1lW3R3b10nPlxyXG4gIDxGdW5jdGlvbiAndGVzdF9wYXJhbWV0cml6ZWRfdXNlcm5hbWVbdGhyZWVdJz5cclxuKi9cclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFyc2VyU2VydmljZS5qcy5tYXAiXX0=