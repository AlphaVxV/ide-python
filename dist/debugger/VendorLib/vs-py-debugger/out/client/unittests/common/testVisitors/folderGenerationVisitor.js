"use strict";

var __decorate = void 0 && (void 0).__decorate || function (decorators, target, key, desc) {
  var c = arguments.length,
      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,
      d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const inversify_1 = require("inversify");

const path = require("path");

let TestFolderGenerationVisitor = class TestFolderGenerationVisitor {
  constructor() {
    // tslint:disable-next-line:variable-name
    this._testFolders = []; // tslint:disable-next-line:variable-name

    this._rootTestFolders = [];
    this.folderMap = new Map();
  }

  get testFolders() {
    return [...this._testFolders];
  }

  get rootTestFolders() {
    return [...this._rootTestFolders];
  } // tslint:disable-next-line:no-empty


  visitTestFunction(testFunction) {} // tslint:disable-next-line:no-empty


  visitTestSuite(testSuite) {}

  visitTestFile(testFile) {
    // First get all the unique folders
    const dir = path.dirname(testFile.name);

    if (this.folderMap.has(dir)) {
      const folder = this.folderMap.get(dir);
      folder.testFiles.push(testFile);
      return;
    }

    dir.split(path.sep).reduce((accumulatedPath, currentName, index) => {
      let newPath = currentName;
      let parentFolder;

      if (accumulatedPath.length > 0) {
        parentFolder = this.folderMap.get(accumulatedPath);
        newPath = path.join(accumulatedPath, currentName);
      }

      if (!this.folderMap.has(newPath)) {
        const testFolder = {
          name: newPath,
          testFiles: [],
          folders: [],
          nameToRun: newPath,
          time: 0
        };
        this.folderMap.set(newPath, testFolder);

        if (parentFolder) {
          parentFolder.folders.push(testFolder);
        } else {
          this._rootTestFolders.push(testFolder);
        }

        this._testFolders.push(testFolder);
      }

      return newPath;
    }, ''); // tslint:disable-next-line:no-non-null-assertion

    this.folderMap.get(dir).testFiles.push(testFile);
  } // tslint:disable-next-line:no-empty


  visitTestFolder(testFile) {}

};
TestFolderGenerationVisitor = __decorate([inversify_1.injectable()], TestFolderGenerationVisitor);
exports.TestFolderGenerationVisitor = TestFolderGenerationVisitor;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImZvbGRlckdlbmVyYXRpb25WaXNpdG9yLmpzIl0sIm5hbWVzIjpbIl9fZGVjb3JhdGUiLCJkZWNvcmF0b3JzIiwidGFyZ2V0Iiwia2V5IiwiZGVzYyIsImMiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJyIiwiT2JqZWN0IiwiZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yIiwiZCIsIlJlZmxlY3QiLCJkZWNvcmF0ZSIsImkiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImludmVyc2lmeV8xIiwicmVxdWlyZSIsInBhdGgiLCJUZXN0Rm9sZGVyR2VuZXJhdGlvblZpc2l0b3IiLCJjb25zdHJ1Y3RvciIsIl90ZXN0Rm9sZGVycyIsIl9yb290VGVzdEZvbGRlcnMiLCJmb2xkZXJNYXAiLCJNYXAiLCJ0ZXN0Rm9sZGVycyIsInJvb3RUZXN0Rm9sZGVycyIsInZpc2l0VGVzdEZ1bmN0aW9uIiwidGVzdEZ1bmN0aW9uIiwidmlzaXRUZXN0U3VpdGUiLCJ0ZXN0U3VpdGUiLCJ2aXNpdFRlc3RGaWxlIiwidGVzdEZpbGUiLCJkaXIiLCJkaXJuYW1lIiwibmFtZSIsImhhcyIsImZvbGRlciIsImdldCIsInRlc3RGaWxlcyIsInB1c2giLCJzcGxpdCIsInNlcCIsInJlZHVjZSIsImFjY3VtdWxhdGVkUGF0aCIsImN1cnJlbnROYW1lIiwiaW5kZXgiLCJuZXdQYXRoIiwicGFyZW50Rm9sZGVyIiwiam9pbiIsInRlc3RGb2xkZXIiLCJmb2xkZXJzIiwibmFtZVRvUnVuIiwidGltZSIsInNldCIsInZpc2l0VGVzdEZvbGRlciIsImluamVjdGFibGUiXSwibWFwcGluZ3MiOiJBQUFBOztBQUNBLElBQUlBLFVBQVUsR0FBSSxVQUFRLFNBQUtBLFVBQWQsSUFBNkIsVUFBVUMsVUFBVixFQUFzQkMsTUFBdEIsRUFBOEJDLEdBQTlCLEVBQW1DQyxJQUFuQyxFQUF5QztBQUNuRixNQUFJQyxDQUFDLEdBQUdDLFNBQVMsQ0FBQ0MsTUFBbEI7QUFBQSxNQUEwQkMsQ0FB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QXBFO0FBb0RBYiwyQkFBMkIsR0FBR3JCLFVBQVUsQ0FBQyxDQUNyQ2tCLFdBQVcsQ0FBQ3dDLFVBQVosRUFEcUMsQ0FBRCxFQUVyQ3JDLDJCQUZxQyxDQUF4QztBQUdBTCxPQUFPLENBQUNLLDJCQUFSLEdBQXNDQSwyQkFBdEMiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fZGVjb3JhdGUgPSAodGhpcyAmJiB0aGlzLl9fZGVjb3JhdGUpIHx8IGZ1bmN0aW9uIChkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYykge1xyXG4gICAgdmFyIGMgPSBhcmd1bWVudHMubGVuZ3RoLCByID0gYyA8IDMgPyB0YXJnZXQgOiBkZXNjID09PSBudWxsID8gZGVzYyA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IodGFyZ2V0LCBrZXkpIDogZGVzYywgZDtcclxuICAgIGlmICh0eXBlb2YgUmVmbGVjdCA9PT0gXCJvYmplY3RcIiAmJiB0eXBlb2YgUmVmbGVjdC5kZWNvcmF0ZSA9PT0gXCJmdW5jdGlvblwiKSByID0gUmVmbGVjdC5kZWNvcmF0ZShkZWNvcmF0b3JzLCB0YXJnZXQsIGtleSwgZGVzYyk7XHJcbiAgICBlbHNlIGZvciAodmFyIGkgPSBkZWNvcmF0b3JzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSBpZiAoZCA9IGRlY29yYXRvcnNbaV0pIHIgPSAoYyA8IDMgPyBkKHIpIDogYyA+IDMgPyBkKHRhcmdldCwga2V5LCByKSA6IGQodGFyZ2V0LCBrZXkpKSB8fCByO1xyXG4gICAgcmV0dXJuIGMgPiAzICYmIHIgJiYgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwga2V5LCByKSwgcjtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBpbnZlcnNpZnlfMSA9IHJlcXVpcmUoXCJpbnZlcnNpZnlcIik7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKFwicGF0aFwiKTtcclxubGV0IFRlc3RGb2xkZXJHZW5lcmF0aW9uVmlzaXRvciA9IGNsYXNzIFRlc3RGb2xkZXJHZW5lcmF0aW9uVmlzaXRvciB7XHJcbiAgICBjb25zdHJ1Y3RvcigpIHtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6dmFyaWFibGUtbmFtZVxyXG4gICAgICAgIHRoaXMuX3Rlc3RGb2xkZXJzID0gW107XHJcbiAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOnZhcmlhYmxlLW5hbWVcclxuICAgICAgICB0aGlzLl9yb290VGVzdEZvbGRlcnMgPSBbXTtcclxuICAgICAgICB0aGlzLmZvbGRlck1hcCA9IG5ldyBNYXAoKTtcclxuICAgIH1cclxuICAgIGdldCB0ZXN0Rm9sZGVycygpIHtcclxuICAgICAgICByZXR1cm4gWy4uLnRoaXMuX3Rlc3RGb2xkZXJzXTtcclxuICAgIH1cclxuICAgIGdldCByb290VGVzdEZvbGRlcnMoKSB7XHJcbiAgICAgICAgcmV0dXJuIFsuLi50aGlzLl9yb290VGVzdEZvbGRlcnNdO1xyXG4gICAgfVxyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWVtcHR5XHJcbiAgICB2aXNpdFRlc3RGdW5jdGlvbih0ZXN0RnVuY3Rpb24pIHsgfVxyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWVtcHR5XHJcbiAgICB2aXNpdFRlc3RTdWl0ZSh0ZXN0U3VpdGUpIHsgfVxyXG4gICAgdmlzaXRUZXN0RmlsZSh0ZXN0RmlsZSkge1xyXG4gICAgICAgIC8vIEZpcnN0IGdldCBhbGwgdGhlIHVuaXF1ZSBmb2xkZXJzXHJcbiAgICAgICAgY29uc3QgZGlyID0gcGF0aC5kaXJuYW1lKHRlc3RGaWxlLm5hbWUpO1xyXG4gICAgICAgIGlmICh0aGlzLmZvbGRlck1hcC5oYXMoZGlyKSkge1xyXG4gICAgICAgICAgICBjb25zdCBmb2xkZXIgPSB0aGlzLmZvbGRlck1hcC5nZXQoZGlyKTtcclxuICAgICAgICAgICAgZm9sZGVyLnRlc3RGaWxlcy5wdXNoKHRlc3RGaWxlKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBkaXIuc3BsaXQocGF0aC5zZXApLnJlZHVjZSgoYWNjdW11bGF0ZWRQYXRoLCBjdXJyZW50TmFtZSwgaW5kZXgpID0+IHtcclxuICAgICAgICAgICAgbGV0IG5ld1BhdGggPSBjdXJyZW50TmFtZTtcclxuICAgICAgICAgICAgbGV0IHBhcmVudEZvbGRlcjtcclxuICAgICAgICAgICAgaWYgKGFjY3VtdWxhdGVkUGF0aC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBwYXJlbnRGb2xkZXIgPSB0aGlzLmZvbGRlck1hcC5nZXQoYWNjdW11bGF0ZWRQYXRoKTtcclxuICAgICAgICAgICAgICAgIG5ld1BhdGggPSBwYXRoLmpvaW4oYWNjdW11bGF0ZWRQYXRoLCBjdXJyZW50TmFtZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCF0aGlzLmZvbGRlck1hcC5oYXMobmV3UGF0aCkpIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHRlc3RGb2xkZXIgPSB7IG5hbWU6IG5ld1BhdGgsIHRlc3RGaWxlczogW10sIGZvbGRlcnM6IFtdLCBuYW1lVG9SdW46IG5ld1BhdGgsIHRpbWU6IDAgfTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZm9sZGVyTWFwLnNldChuZXdQYXRoLCB0ZXN0Rm9sZGVyKTtcclxuICAgICAgICAgICAgICAgIGlmIChwYXJlbnRGb2xkZXIpIHtcclxuICAgICAgICAgICAgICAgICAgICBwYXJlbnRGb2xkZXIuZm9sZGVycy5wdXNoKHRlc3RGb2xkZXIpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcm9vdFRlc3RGb2xkZXJzLnB1c2godGVzdEZvbGRlcik7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB0aGlzLl90ZXN0Rm9sZGVycy5wdXNoKHRlc3RGb2xkZXIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBuZXdQYXRoO1xyXG4gICAgICAgIH0sICcnKTtcclxuICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tbm9uLW51bGwtYXNzZXJ0aW9uXHJcbiAgICAgICAgdGhpcy5mb2xkZXJNYXAuZ2V0KGRpcikudGVzdEZpbGVzLnB1c2godGVzdEZpbGUpO1xyXG4gICAgfVxyXG4gICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWVtcHR5XHJcbiAgICB2aXNpdFRlc3RGb2xkZXIodGVzdEZpbGUpIHsgfVxyXG59O1xyXG5UZXN0Rm9sZGVyR2VuZXJhdGlvblZpc2l0b3IgPSBfX2RlY29yYXRlKFtcclxuICAgIGludmVyc2lmeV8xLmluamVjdGFibGUoKVxyXG5dLCBUZXN0Rm9sZGVyR2VuZXJhdGlvblZpc2l0b3IpO1xyXG5leHBvcnRzLlRlc3RGb2xkZXJHZW5lcmF0aW9uVmlzaXRvciA9IFRlc3RGb2xkZXJHZW5lcmF0aW9uVmlzaXRvcjtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Zm9sZGVyR2VuZXJhdGlvblZpc2l0b3IuanMubWFwIl19