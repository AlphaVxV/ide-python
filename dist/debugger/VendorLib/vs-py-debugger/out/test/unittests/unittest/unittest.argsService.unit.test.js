// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

const chai_1 = require("chai");

const path = require("path");

const typeMoq = require("typemoq");

const types_1 = require("../../../client/common/types");

const argumentsHelper_1 = require("../../../client/unittests/common/argumentsHelper");

const types_2 = require("../../../client/unittests/types");

const argsService_1 = require("../../../client/unittests/unittest/services/argsService");

suite('ArgsService: unittest', () => {
  let argumentsService;
  suiteSetup(() => {
    const serviceContainer = typeMoq.Mock.ofType();
    const logger = typeMoq.Mock.ofType();
    serviceContainer.setup(s => s.get(typeMoq.It.isValue(types_1.ILogger), typeMoq.It.isAny())).returns(() => logger.object);
    const argsHelper = new argumentsHelper_1.ArgumentsHelper(serviceContainer.object);
    serviceContainer.setup(s => s.get(typeMoq.It.isValue(types_2.IArgumentsHelper), typeMoq.It.isAny())).returns(() => argsHelper);
    argumentsService = new argsService_1.ArgumentsService(serviceContainer.object);
  });
  test('Test getting the test folder in unittest with -s', () => {
    const dir = path.join('a', 'b', 'c');
    const args = ['anzy', '--one', '--three', '-s', dir];
    const testDirs = argumentsService.getTestFolders(args);
    chai_1.expect(testDirs).to.be.lengthOf(1);
    chai_1.expect(testDirs[0]).to.equal(dir);
  });
  test('Test getting the test folder in unittest with -s in the middle', () => {
    const dir = path.join('a', 'b', 'c');
    const args = ['anzy', '--one', '--three', '-s', dir, 'some other', '--value', '1234'];
    const testDirs = argumentsService.getTestFolders(args);
    chai_1.expect(testDirs).to.be.lengthOf(1);
    chai_1.expect(testDirs[0]).to.equal(dir);
  });
  test('Test getting the test folder in unittest with --start-directory', () => {
    const dir = path.join('a', 'b', 'c');
    const args = ['anzy', '--one', '--three', '--start-directory', dir];
    const testDirs = argumentsService.getTestFolders(args);
    chai_1.expect(testDirs).to.be.lengthOf(1);
    chai_1.expect(testDirs[0]).to.equal(dir);
  });
  test('Test getting the test folder in unittest with --start-directory in the middle', () => {
    const dir = path.join('a', 'b', 'c');
    const args = ['anzy', '--one', '--three', '--start-directory', dir, 'some other', '--value', '1234'];
    const testDirs = argumentsService.getTestFolders(args);
    chai_1.expect(testDirs).to.be.lengthOf(1);
    chai_1.expect(testDirs[0]).to.equal(dir);
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInVuaXR0ZXN0LmFyZ3NTZXJ2aWNlLnVuaXQudGVzdC5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImNoYWlfMSIsInJlcXVpcmUiLCJwYXRoIiwidHlwZU1vcSIsInR5cGVzXzEiLCJhcmd1bWVudHNIZWxwZXJfMSIsInR5cGVzXzIiLCJhcmdzU2VydmljZV8xIiwic3VpdGUiLCJhcmd1bWVudHNTZXJ2aWNlIiwic3VpdGVTZXR1cCIsInNlcnZpY2VDb250YWluZXIiLCJNb2NrIiwib2ZUeXBlIiwibG9nZ2VyIiwic2V0dXAiLCJzIiwiZ2V0IiwiSXQiLCJpc1ZhbHVlIiwiSUxvZ2dlciIsImlzQW55IiwicmV0dXJucyIsIm9iamVjdCIsImFyZ3NIZWxwZXIiLCJBcmd1bWVudHNIZWxwZXIiLCJJQXJndW1lbnRzSGVscGVyIiwiQXJndW1lbnRzU2VydmljZSIsInRlc3QiLCJkaXIiLCJqb2luIiwiYXJncyIsInRlc3REaXJzIiwiZ2V0VGVzdEZvbGRlcnMiLCJleHBlY3QiLCJ0byIsImJlIiwibGVuZ3RoT2YiLCJlcXVhbCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQUVDLEVBQUFBLEtBQUssRUFBRTtBQUFULENBQTdDOztBQUNBLE1BQU1DLE1BQU0sR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBdEI7O0FBQ0EsTUFBTUMsSUFBSSxHQUFHRCxPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxNQUFNRSxPQUFPLEdBQUdGLE9BQU8sQ0FBQyxTQUFELENBQXZCOztBQUNBLE1BQU1HLE9BQU8sR0FBR0gsT0FBTyxDQUFDLDhCQUFELENBQXZCOztBQUNBLE1BQU1JLGlCQUFpQixHQUFHSixPQUFPLENBQUMsa0RBQUQsQ0FBakM7O0FBQ0EsTUFBTUssT0FBTyxHQUFHTCxPQUFPLENBQUMsaUNBQUQs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LENBQUQsQ0FBdEIsRUFBMkJHLEVBQTNCLENBQThCRyxLQUE5QixDQUFvQ1QsR0FBcEM7QUFDSCxHQU5HLENBQUo7QUFPSCxDQTFDSSxDQUFMIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuJ3VzZSBzdHJpY3QnO1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IGNoYWlfMSA9IHJlcXVpcmUoXCJjaGFpXCIpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZShcInBhdGhcIik7XHJcbmNvbnN0IHR5cGVNb3EgPSByZXF1aXJlKFwidHlwZW1vcVwiKTtcclxuY29uc3QgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL3R5cGVzXCIpO1xyXG5jb25zdCBhcmd1bWVudHNIZWxwZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvdW5pdHRlc3RzL2NvbW1vbi9hcmd1bWVudHNIZWxwZXJcIik7XHJcbmNvbnN0IHR5cGVzXzIgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L3VuaXR0ZXN0cy90eXBlc1wiKTtcclxuY29uc3QgYXJnc1NlcnZpY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvdW5pdHRlc3RzL3VuaXR0ZXN0L3NlcnZpY2VzL2FyZ3NTZXJ2aWNlXCIpO1xyXG5zdWl0ZSgnQXJnc1NlcnZpY2U6IHVuaXR0ZXN0JywgKCkgPT4ge1xyXG4gICAgbGV0IGFyZ3VtZW50c1NlcnZpY2U7XHJcbiAgICBzdWl0ZVNldHVwKCgpID0+IHtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlQ29udGFpbmVyID0gdHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGNvbnN0IGxvZ2dlciA9IHR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyXHJcbiAgICAgICAgICAgIC5zZXR1cChzID0+IHMuZ2V0KHR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18xLklMb2dnZXIpLCB0eXBlTW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBsb2dnZXIub2JqZWN0KTtcclxuICAgICAgICBjb25zdCBhcmdzSGVscGVyID0gbmV3IGFyZ3VtZW50c0hlbHBlcl8xLkFyZ3VtZW50c0hlbHBlcihzZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lclxyXG4gICAgICAgICAgICAuc2V0dXAocyA9PiBzLmdldCh0eXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMi5JQXJndW1lbnRzSGVscGVyKSwgdHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gYXJnc0hlbHBlcik7XHJcbiAgICAgICAgYXJndW1lbnRzU2VydmljZSA9IG5ldyBhcmdzU2VydmljZV8xLkFyZ3VtZW50c1NlcnZpY2Uoc2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdUZXN0IGdldHRpbmcgdGhlIHRlc3QgZm9sZGVyIGluIHVuaXR0ZXN0IHdpdGggLXMnLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZGlyID0gcGF0aC5qb2luKCdhJywgJ2InLCAnYycpO1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBbJ2FuenknLCAnLS1vbmUnLCAnLS10aHJlZScsICctcycsIGRpcl07XHJcbiAgICAgICAgY29uc3QgdGVzdERpcnMgPSBhcmd1bWVudHNTZXJ2aWNlLmdldFRlc3RGb2xkZXJzKGFyZ3MpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QodGVzdERpcnMpLnRvLmJlLmxlbmd0aE9mKDEpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QodGVzdERpcnNbMF0pLnRvLmVxdWFsKGRpcik7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ1Rlc3QgZ2V0dGluZyB0aGUgdGVzdCBmb2xkZXIgaW4gdW5pdHRlc3Qgd2l0aCAtcyBpbiB0aGUgbWlkZGxlJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRpciA9IHBhdGguam9pbignYScsICdiJywgJ2MnKTtcclxuICAgICAgICBjb25zdCBhcmdzID0gWydhbnp5JywgJy0tb25lJywgJy0tdGhyZWUnLCAnLXMnLCBkaXIsICdzb21lIG90aGVyJywgJy0tdmFsdWUnLCAnMTIzNCddO1xyXG4gICAgICAgIGNvbnN0IHRlc3REaXJzID0gYXJndW1lbnRzU2VydmljZS5nZXRUZXN0Rm9sZGVycyhhcmdzKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHRlc3REaXJzKS50by5iZS5sZW5ndGhPZigxKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHRlc3REaXJzWzBdKS50by5lcXVhbChkaXIpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdUZXN0IGdldHRpbmcgdGhlIHRlc3QgZm9sZGVyIGluIHVuaXR0ZXN0IHdpdGggLS1zdGFydC1kaXJlY3RvcnknLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZGlyID0gcGF0aC5qb2luKCdhJywgJ2InLCAnYycpO1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBbJ2FuenknLCAnLS1vbmUnLCAnLS10aHJlZScsICctLXN0YXJ0LWRpcmVjdG9yeScsIGRpcl07XHJcbiAgICAgICAgY29uc3QgdGVzdERpcnMgPSBhcmd1bWVudHNTZXJ2aWNlLmdldFRlc3RGb2xkZXJzKGFyZ3MpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QodGVzdERpcnMpLnRvLmJlLmxlbmd0aE9mKDEpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QodGVzdERpcnNbMF0pLnRvLmVxdWFsKGRpcik7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ1Rlc3QgZ2V0dGluZyB0aGUgdGVzdCBmb2xkZXIgaW4gdW5pdHRlc3Qgd2l0aCAtLXN0YXJ0LWRpcmVjdG9yeSBpbiB0aGUgbWlkZGxlJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGRpciA9IHBhdGguam9pbignYScsICdiJywgJ2MnKTtcclxuICAgICAgICBjb25zdCBhcmdzID0gWydhbnp5JywgJy0tb25lJywgJy0tdGhyZWUnLCAnLS1zdGFydC1kaXJlY3RvcnknLCBkaXIsICdzb21lIG90aGVyJywgJy0tdmFsdWUnLCAnMTIzNCddO1xyXG4gICAgICAgIGNvbnN0IHRlc3REaXJzID0gYXJndW1lbnRzU2VydmljZS5nZXRUZXN0Rm9sZGVycyhhcmdzKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHRlc3REaXJzKS50by5iZS5sZW5ndGhPZigxKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHRlc3REaXJzWzBdKS50by5lcXVhbChkaXIpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD11bml0dGVzdC5hcmdzU2VydmljZS51bml0LnRlc3QuanMubWFwIl19