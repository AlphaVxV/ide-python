// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const chai_1 = require("chai");

const chaiAsPromised = require("chai-as-promised");

const typeMoq = require("typemoq");

const vscode_1 = require("vscode");

const types_1 = require("../../client/common/types");

const constants_1 = require("../../client/unittests/common/constants");

const types_2 = require("../../client/unittests/common/types");

const configurationFactory_1 = require("../../client/unittests/configurationFactory");

const nose = require("../../client/unittests/nosetest/testConfigurationManager");

const pytest = require("../../client/unittests/pytest/testConfigurationManager");

const unittest = require("../../client/unittests/unittest/testConfigurationManager");

chai_1.use(chaiAsPromised);
suite('Unit Tests - ConfigurationManagerFactory', () => {
  let factory;
  setup(() => {
    const serviceContainer = typeMoq.Mock.ofType();
    const outputChannel = typeMoq.Mock.ofType();
    const installer = typeMoq.Mock.ofType();
    const testConfigService = typeMoq.Mock.ofType();
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.IOutputChannel), typeMoq.It.isValue(constants_1.TEST_OUTPUT_CHANNEL))).returns(() => outputChannel.object);
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.IInstaller))).returns(() => installer.object);
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_2.ITestConfigSettingsService))).returns(() => testConfigService.object);
    factory = new configurationFactory_1.TestConfigurationManagerFactory(serviceContainer.object);
  });
  test('Create Unit Test Configuration', () => __awaiter(void 0, void 0, void 0, function* () {
    const configMgr = factory.create(vscode_1.Uri.file(__filename), types_1.Product.unittest);
    chai_1.expect(configMgr).to.be.instanceOf(unittest.ConfigurationManager);
  }));
  test('Create pytest Configuration', () => __awaiter(void 0, void 0, void 0, function* () {
    const configMgr = factory.create(vscode_1.Uri.file(__filename), types_1.Product.pytest);
    chai_1.expect(configMgr).to.be.instanceOf(pytest.ConfigurationManager);
  }));
  test('Create nose Configuration', () => __awaiter(void 0, void 0, void 0, function* () {
    const configMgr = factory.create(vscode_1.Uri.file(__filename), types_1.Product.nosetest);
    chai_1.expect(configMgr).to.be.instanceOf(nose.ConfigurationManager);
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZ3VyYXRpb25GYWN0b3J5LnVuaXQudGVzdC5qcyJdLCJuYW1lcyI6WyJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwiY2hhaV8xIiwicmVxdWlyZSIsImNoYWlBc1Byb21pc2VkIiwidHlwZU1vcSIsInZzY29kZV8xIiwidHlwZXNfMSIsImNvbnN0YW50c18xIiwidHlwZXNfMiIsImNvbmZpZ3VyYXRpb25GYWN0b3J5XzEiLCJub3NlIiwicHl0ZXN0IiwidW5pdHRlc3QiLCJ1c2UiLCJzdWl0ZSIsImZhY3RvcnkiLCJzZXR1cCIsInNlcnZpY2VDb250YWluZXIiLCJNb2NrIiwib2ZUeXBlIiwib3V0cHV0Q2hhbm5lbCIsImluc3RhbGxlciIsInRlc3RDb25maWdTZXJ2aWNlIiwiYyIsImdldCIsIkl0IiwiaXNWYWx1ZSIsIklPdXRwdXRDaGFubmVsIiwiVEVTVF9PVVRQVVRfQ0hBTk5FTCIsInJldHVybnMiLCJvYmplY3QiLCJJSW5zdGFsbGVyIiwiSVRlc3RDb25maWdTZXR0aW5nc1NlcnZpY2UiLCJUZXN0Q29uZmlndXJhdGlvbk1hbmFnZXJGYWN0b3J5IiwidGVzdCIsImNvbmZpZ01nciIsImNyZWF0ZSIsIlVyaSIsImZpbGUiLCJfX2ZpbGVuYW1lIiwiUHJvZHVjdCIsImV4cGVjdCIsInRvIiwiYmUiLCJpbnN0YW5jZU9mIiwiQ29uZmlndXJhdGlvbk1hbmFnZXIiLCJub3NldGVzdCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFt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TCIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbid1c2Ugc3RyaWN0JztcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBjaGFpXzEgPSByZXF1aXJlKFwiY2hhaVwiKTtcclxuY29uc3QgY2hhaUFzUHJvbWlzZWQgPSByZXF1aXJlKFwiY2hhaS1hcy1wcm9taXNlZFwiKTtcclxuY29uc3QgdHlwZU1vcSA9IHJlcXVpcmUoXCJ0eXBlbW9xXCIpO1xyXG5jb25zdCB2c2NvZGVfMSA9IHJlcXVpcmUoXCJ2c2NvZGVcIik7XHJcbmNvbnN0IHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L2NvbW1vbi90eXBlc1wiKTtcclxuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L3VuaXR0ZXN0cy9jb21tb24vY29uc3RhbnRzXCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC91bml0dGVzdHMvY29tbW9uL3R5cGVzXCIpO1xyXG5jb25zdCBjb25maWd1cmF0aW9uRmFjdG9yeV8xID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC91bml0dGVzdHMvY29uZmlndXJhdGlvbkZhY3RvcnlcIik7XHJcbmNvbnN0IG5vc2UgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L3VuaXR0ZXN0cy9ub3NldGVzdC90ZXN0Q29uZmlndXJhdGlvbk1hbmFnZXJcIik7XHJcbmNvbnN0IHB5dGVzdCA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvdW5pdHRlc3RzL3B5dGVzdC90ZXN0Q29uZmlndXJhdGlvbk1hbmFnZXJcIik7XHJcbmNvbnN0IHVuaXR0ZXN0ID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC91bml0dGVzdHMvdW5pdHRlc3QvdGVzdENvbmZpZ3VyYXRpb25NYW5hZ2VyXCIpO1xyXG5jaGFpXzEudXNlKGNoYWlBc1Byb21pc2VkKTtcclxuc3VpdGUoJ1VuaXQgVGVzdHMgLSBDb25maWd1cmF0aW9uTWFuYWdlckZhY3RvcnknLCAoKSA9PiB7XHJcbiAgICBsZXQgZmFjdG9yeTtcclxuICAgIHNldHVwKCgpID0+IHtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlQ29udGFpbmVyID0gdHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGNvbnN0IG91dHB1dENoYW5uZWwgPSB0eXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgY29uc3QgaW5zdGFsbGVyID0gdHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGNvbnN0IHRlc3RDb25maWdTZXJ2aWNlID0gdHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldCh0eXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMS5JT3V0cHV0Q2hhbm5lbCksIHR5cGVNb3EuSXQuaXNWYWx1ZShjb25zdGFudHNfMS5URVNUX09VVFBVVF9DSEFOTkVMKSkpLnJldHVybnMoKCkgPT4gb3V0cHV0Q2hhbm5lbC5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldCh0eXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMS5JSW5zdGFsbGVyKSkpLnJldHVybnMoKCkgPT4gaW5zdGFsbGVyLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KHR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18yLklUZXN0Q29uZmlnU2V0dGluZ3NTZXJ2aWNlKSkpLnJldHVybnMoKCkgPT4gdGVzdENvbmZpZ1NlcnZpY2Uub2JqZWN0KTtcclxuICAgICAgICBmYWN0b3J5ID0gbmV3IGNvbmZpZ3VyYXRpb25GYWN0b3J5XzEuVGVzdENvbmZpZ3VyYXRpb25NYW5hZ2VyRmFjdG9yeShzZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ0NyZWF0ZSBVbml0IFRlc3QgQ29uZmlndXJhdGlvbicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBjb25maWdNZ3IgPSBmYWN0b3J5LmNyZWF0ZSh2c2NvZGVfMS5VcmkuZmlsZShfX2ZpbGVuYW1lKSwgdHlwZXNfMS5Qcm9kdWN0LnVuaXR0ZXN0KTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGNvbmZpZ01ncikudG8uYmUuaW5zdGFuY2VPZih1bml0dGVzdC5Db25maWd1cmF0aW9uTWFuYWdlcik7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdDcmVhdGUgcHl0ZXN0IENvbmZpZ3VyYXRpb24nLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgY29uZmlnTWdyID0gZmFjdG9yeS5jcmVhdGUodnNjb2RlXzEuVXJpLmZpbGUoX19maWxlbmFtZSksIHR5cGVzXzEuUHJvZHVjdC5weXRlc3QpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoY29uZmlnTWdyKS50by5iZS5pbnN0YW5jZU9mKHB5dGVzdC5Db25maWd1cmF0aW9uTWFuYWdlcik7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdDcmVhdGUgbm9zZSBDb25maWd1cmF0aW9uJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IGNvbmZpZ01nciA9IGZhY3RvcnkuY3JlYXRlKHZzY29kZV8xLlVyaS5maWxlKF9fZmlsZW5hbWUpLCB0eXBlc18xLlByb2R1Y3Qubm9zZXRlc3QpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoY29uZmlnTWdyKS50by5iZS5pbnN0YW5jZU9mKG5vc2UuQ29uZmlndXJhdGlvbk1hbmFnZXIpO1xyXG4gICAgfSkpO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9Y29uZmlndXJhdGlvbkZhY3RvcnkudW5pdC50ZXN0LmpzLm1hcCJdfQ==