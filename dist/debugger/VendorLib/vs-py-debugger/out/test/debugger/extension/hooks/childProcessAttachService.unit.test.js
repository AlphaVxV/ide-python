// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:no-any max-func-body-length

const chai_1 = require("chai");

const ts_mockito_1 = require("ts-mockito");

const vscode_1 = require("vscode");

const applicationShell_1 = require("../../../../client/common/application/applicationShell");

const debugService_1 = require("../../../../client/common/application/debugService");

const workspace_1 = require("../../../../client/common/application/workspace");

const childProcessAttachService_1 = require("../../../../client/debugger/extension/hooks/childProcessAttachService");

suite('Debug - Attach to Child Process', () => {
  test('Message is not displayed if debugger is launched', () => __awaiter(void 0, void 0, void 0, function* () {
    const shell = ts_mockito_1.mock(applicationShell_1.ApplicationShell);
    const debugService = ts_mockito_1.mock(debugService_1.DebugService);
    const workspaceService = ts_mockito_1.mock(workspace_1.WorkspaceService);
    const service = new childProcessAttachService_1.ChildProcessAttachService(ts_mockito_1.instance(shell), ts_mockito_1.instance(debugService), ts_mockito_1.instance(workspaceService));
    const args = {
      request: 'launch',
      type: 'python',
      name: ''
    };
    const data = {
      rootProcessId: 1,
      parentProcessId: 1,
      port: 1234,
      processId: 2,
      rootStartRequest: {
        seq: 1,
        type: 'python',
        arguments: args,
        command: 'request'
      }
    };
    ts_mockito_1.when(workspaceService.hasWorkspaceFolders).thenReturn(false);
    ts_mockito_1.when(debugService.startDebugging(ts_mockito_1.anything(), ts_mockito_1.anything())).thenResolve(true);
    yield service.attach(data);
    ts_mockito_1.verify(workspaceService.hasWorkspaceFolders).once();
    ts_mockito_1.verify(debugService.startDebugging(ts_mockito_1.anything(), ts_mockito_1.anything())).once();
  }));
  test('Message is displayed if debugger is not launched', () => __awaiter(void 0, void 0, void 0, function* () {
    const shell = ts_mockito_1.mock(applicationShell_1.ApplicationShell);
    const debugService = ts_mockito_1.mock(debugService_1.DebugService);
    const workspaceService = ts_mockito_1.mock(workspace_1.WorkspaceService);
    const service = new childProcessAttachService_1.ChildProcessAttachService(ts_mockito_1.instance(shell), ts_mockito_1.instance(debugService), ts_mockito_1.instance(workspaceService));
    const args = {
      request: 'launch',
      type: 'python',
      name: ''
    };
    const data = {
      rootProcessId: 1,
      parentProcessId: 1,
      port: 1234,
      processId: 2,
      rootStartRequest: {
        seq: 1,
        type: 'python',
        arguments: args,
        command: 'request'
      }
    };
    ts_mockito_1.when(workspaceService.hasWorkspaceFolders).thenReturn(false);
    ts_mockito_1.when(debugService.startDebugging(ts_mockito_1.anything(), ts_mockito_1.anything())).thenResolve(false);
    ts_mockito_1.when(shell.showErrorMessage(ts_mockito_1.anything())).thenResolve();
    yield service.attach(data);
    ts_mockito_1.verify(workspaceService.hasWorkspaceFolders).once();
    ts_mockito_1.verify(debugService.startDebugging(ts_mockito_1.anything(), ts_mockito_1.anything())).once();
    ts_mockito_1.verify(shell.showErrorMessage(ts_mockito_1.anything())).once();
  }));
  test('Use correct workspace folder', () => __awaiter(void 0, void 0, void 0, function* () {
    const shell = ts_mockito_1.mock(applicationShell_1.ApplicationShell);
    const debugService = ts_mockito_1.mock(debugService_1.DebugService);
    const workspaceService = ts_mockito_1.mock(workspace_1.WorkspaceService);
    const service = new childProcessAttachService_1.ChildProcessAttachService(ts_mockito_1.instance(shell), ts_mockito_1.instance(debugService), ts_mockito_1.instance(workspaceService));
    const rightWorkspaceFolder = {
      name: '1',
      index: 1,
      uri: vscode_1.Uri.file('a')
    };
    const wkspace1 = {
      name: '0',
      index: 0,
      uri: vscode_1.Uri.file('0')
    };
    const wkspace2 = {
      name: '2',
      index: 2,
      uri: vscode_1.Uri.file('2')
    };
    const args = {
      request: 'launch',
      type: 'python',
      name: '',
      workspaceFolder: rightWorkspaceFolder.uri.fsPath
    };
    const data = {
      rootProcessId: 1,
      parentProcessId: 1,
      port: 1234,
      processId: 2,
      rootStartRequest: {
        seq: 1,
        type: 'python',
        arguments: args,
        command: 'request'
      }
    };
    ts_mockito_1.when(workspaceService.hasWorkspaceFolders).thenReturn(true);
    ts_mockito_1.when(workspaceService.workspaceFolders).thenReturn([wkspace1, rightWorkspaceFolder, wkspace2]);
    ts_mockito_1.when(debugService.startDebugging(rightWorkspaceFolder, ts_mockito_1.anything())).thenResolve(true);
    yield service.attach(data);
    ts_mockito_1.verify(workspaceService.hasWorkspaceFolders).once();
    ts_mockito_1.verify(debugService.startDebugging(rightWorkspaceFolder, ts_mockito_1.anything())).once();
    ts_mockito_1.verify(shell.showErrorMessage(ts_mockito_1.anything())).never();
  }));
  test('Use empty workspace folder if right one is not found', () => __awaiter(void 0, void 0, void 0, function* () {
    const shell = ts_mockito_1.mock(applicationShell_1.ApplicationShell);
    const debugService = ts_mockito_1.mock(debugService_1.DebugService);
    const workspaceService = ts_mockito_1.mock(workspace_1.WorkspaceService);
    const service = new childProcessAttachService_1.ChildProcessAttachService(ts_mockito_1.instance(shell), ts_mockito_1.instance(debugService), ts_mockito_1.instance(workspaceService));
    const rightWorkspaceFolder = {
      name: '1',
      index: 1,
      uri: vscode_1.Uri.file('a')
    };
    const wkspace1 = {
      name: '0',
      index: 0,
      uri: vscode_1.Uri.file('0')
    };
    const wkspace2 = {
      name: '2',
      index: 2,
      uri: vscode_1.Uri.file('2')
    };
    const args = {
      request: 'launch',
      type: 'python',
      name: '',
      workspaceFolder: rightWorkspaceFolder.uri.fsPath
    };
    const data = {
      rootProcessId: 1,
      parentProcessId: 1,
      port: 1234,
      processId: 2,
      rootStartRequest: {
        seq: 1,
        type: 'python',
        arguments: args,
        command: 'request'
      }
    };
    ts_mockito_1.when(workspaceService.hasWorkspaceFolders).thenReturn(true);
    ts_mockito_1.when(workspaceService.workspaceFolders).thenReturn([wkspace1, wkspace2]);
    ts_mockito_1.when(debugService.startDebugging(undefined, ts_mockito_1.anything())).thenResolve(true);
    yield service.attach(data);
    ts_mockito_1.verify(workspaceService.hasWorkspaceFolders).once();
    ts_mockito_1.verify(debugService.startDebugging(undefined, ts_mockito_1.anything())).once();
    ts_mockito_1.verify(shell.showErrorMessage(ts_mockito_1.anything())).never();
  }));
  test('Validate debug config when parent/root parent was launched', () => __awaiter(void 0, void 0, void 0, function* () {
    const shell = ts_mockito_1.mock(applicationShell_1.ApplicationShell);
    const debugService = ts_mockito_1.mock(debugService_1.DebugService);
    const workspaceService = ts_mockito_1.mock(workspace_1.WorkspaceService);
    const service = new childProcessAttachService_1.ChildProcessAttachService(ts_mockito_1.instance(shell), ts_mockito_1.instance(debugService), ts_mockito_1.instance(workspaceService));
    const args = {
      request: 'launch',
      type: 'python',
      name: ''
    };
    const data = {
      rootProcessId: 1,
      parentProcessId: 1,
      port: 1234,
      processId: 2,
      rootStartRequest: {
        seq: 1,
        type: 'python',
        arguments: args,
        command: 'request'
      }
    };
    const debugConfig = JSON.parse(JSON.stringify(args));
    debugConfig.host = 'localhost';
    debugConfig.port = data.port;
    debugConfig.name = `Child Process ${data.processId}`;
    debugConfig.request = 'attach';
    ts_mockito_1.when(workspaceService.hasWorkspaceFolders).thenReturn(false);
    ts_mockito_1.when(debugService.startDebugging(undefined, ts_mockito_1.anything())).thenResolve(true); // when(debugService.startDebugging(undefined, debugConfig)).thenResolve(true as any);

    yield service.attach(data);
    ts_mockito_1.verify(workspaceService.hasWorkspaceFolders).once();
    ts_mockito_1.verify(debugService.startDebugging(undefined, ts_mockito_1.anything())).once();
    const [, secondArg] = ts_mockito_1.capture(debugService.startDebugging).last();
    chai_1.expect(secondArg).to.deep.equal(debugConfig);
    ts_mockito_1.verify(shell.showErrorMessage(ts_mockito_1.anything())).never();
  }));
  test('Validate debug config when parent/root parent was attached', () => __awaiter(void 0, void 0, void 0, function* () {
    const shell = ts_mockito_1.mock(applicationShell_1.ApplicationShell);
    const debugService = ts_mockito_1.mock(debugService_1.DebugService);
    const workspaceService = ts_mockito_1.mock(workspace_1.WorkspaceService);
    const service = new childProcessAttachService_1.ChildProcessAttachService(ts_mockito_1.instance(shell), ts_mockito_1.instance(debugService), ts_mockito_1.instance(workspaceService));
    const args = {
      request: 'attach',
      type: 'python',
      name: '',
      host: '123.123.123.123'
    };
    const data = {
      rootProcessId: 1,
      parentProcessId: 1,
      port: 1234,
      processId: 2,
      rootStartRequest: {
        seq: 1,
        type: 'python',
        arguments: args,
        command: 'request'
      }
    };
    const debugConfig = JSON.parse(JSON.stringify(args));
    debugConfig.host = args.host;
    debugConfig.port = data.port;
    debugConfig.name = `Child Process ${data.processId}`;
    debugConfig.request = 'attach';
    ts_mockito_1.when(workspaceService.hasWorkspaceFolders).thenReturn(false);
    ts_mockito_1.when(debugService.startDebugging(undefined, ts_mockito_1.anything())).thenResolve(true); // when(debugService.startDebugging(undefined, debugConfig)).thenResolve(true as any);

    yield service.attach(data);
    ts_mockito_1.verify(workspaceService.hasWorkspaceFolders).once();
    ts_mockito_1.verify(debugService.startDebugging(undefined, ts_mockito_1.anything())).once();
    const [, secondArg] = ts_mockito_1.capture(debugService.startDebugging).last();
    chai_1.expect(secondArg).to.deep.equal(debugConfig);
    ts_mockito_1.verify(shell.showErrorMessage(ts_mockito_1.anything())).never();
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2UudW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJjaGFpXzEiLCJyZXF1aXJlIiwidHNfbW9ja2l0b18xIiwidnNjb2RlXzEiLCJhcHBsaWNhdGlvblNoZWxsXzEiLCJkZWJ1Z1NlcnZpY2VfMSIsIndvcmtzcGFjZV8xIiwiY2hpbGRQcm9jZXNzQXR0YWNoU2VydmljZV8xIiwic3VpdGUiLCJ0ZXN0Iiwic2hlbGwiLCJtb2NrIiwiQXBwbGljYXRpb25TaGVsbCIsImRlYnVnU2VydmljZSIsIkRlYnVnU2VydmljZSIsIndvcmtzcGFjZVNlcnZpY2UiLCJXb3Jrc3BhY2VTZXJ2aWNlIiwic2VydmljZSIsIkNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2UiLCJpbnN0YW5jZSIsImFyZ3MiLCJyZXF1ZXN0IiwidHlwZSIsIm5hbWUiLCJkYXRhIiwicm9vdFByb2Nlc3NJZCIsInBhcmVudFByb2Nlc3NJZCIsInBvcnQiLCJwcm9jZXNzSWQiLCJyb290U3RhcnRSZXF1ZXN0Iiwic2VxIiwiYXJndW1lbnRzIiwiY29tbWFuZCIsIndoZW4iLCJoYXNXb3Jrc3BhY2VGb2xkZXJzIiwidGhlblJldHVybiIsInN0YXJ0RGVidWdnaW5nIiwiYW55dGhpbmciLCJ0aGVuUmVzb2x2ZSIsImF0dGFjaCIsInZlcmlmeSIsIm9uY2UiLCJzaG93RXJyb3JNZXNzYWdlIiwicmlnaHRXb3Jrc3BhY2VGb2xkZXIiLCJpbmRleCIsInVyaSIsIlVyaSIsImZpbGUiLCJ3a3NwYWNlMSIsIndrc3BhY2UyIiwid29ya3NwYWNlRm9sZGVyIiwiZnNQYXRoIiwid29ya3NwYWNlRm9sZGVycyIsIm5ldmVyIiwidW5kZWZpbmVkIiwiZGVidWdDb25maWciLCJKU09OIiwicGFyc2UiLCJzdHJpbmdpZnkiLCJob3N0Iiwic2Vjb25kQXJnIiwiY2FwdHVyZSIsImxhc3QiLCJleHBlY3QiLCJ0byIsImRlZXAiLCJlcXVhbCJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFKO0FBQThCLE9BQXBDLENBQXFDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzNGLGFBQVNDLFFBQVQsQ0FBa0JKLEtBQWxCLEVBQXlCO0FBQUUsVUFBSTtBQUFFQyxRQUFBQSxJQUFJLENBQUNOLFNBQVMsQ0FBQyxPQUFELENBQVQsQ0FBbUJLLEtBQW5CLENBQUQsQ0FBSjtBQUFrQyxPQUF4QyxDQUF5QyxPQUFPRyxDQUFQLEVBQVU7QUFBRUwsUUFBQUEsTUFBTSxDQUFDSyxDQUFELENBQU47QUFBWTtBQUFFOztBQUM5RixhQUFTRixJQUFULENBQWNJLE1BQWQsRUFBc0I7QUFBRUEsTUFBQUEsTUFBTSxDQUFDQyxJQUFQLEdBQWNULE9BQU8sQ0FBQ1EsTUFBTSxDQUFDTCxLQUFSLENBQXJCLEdBQXNDLElBQUlOLENBQUosQ0FBTSxVQUFVRyxPQUFWLEVBQW1C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QixLQUFyRTtBQUNILEdBckNpRixDQUE5RSxDQUFKO0FBc0NILENBMU1JLENBQUwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuLy8gdHNsaW50OmRpc2FibGU6bm8tYW55IG1heC1mdW5jLWJvZHktbGVuZ3RoXHJcbmNvbnN0IGNoYWlfMSA9IHJlcXVpcmUoXCJjaGFpXCIpO1xyXG5jb25zdCB0c19tb2NraXRvXzEgPSByZXF1aXJlKFwidHMtbW9ja2l0b1wiKTtcclxuY29uc3QgdnNjb2RlXzEgPSByZXF1aXJlKFwidnNjb2RlXCIpO1xyXG5jb25zdCBhcHBsaWNhdGlvblNoZWxsXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2NvbW1vbi9hcHBsaWNhdGlvbi9hcHBsaWNhdGlvblNoZWxsXCIpO1xyXG5jb25zdCBkZWJ1Z1NlcnZpY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9jbGllbnQvY29tbW9uL2FwcGxpY2F0aW9uL2RlYnVnU2VydmljZVwiKTtcclxuY29uc3Qgd29ya3NwYWNlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2NvbW1vbi9hcHBsaWNhdGlvbi93b3Jrc3BhY2VcIik7XHJcbmNvbnN0IGNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9jbGllbnQvZGVidWdnZXIvZXh0ZW5zaW9uL2hvb2tzL2NoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2VcIik7XHJcbnN1aXRlKCdEZWJ1ZyAtIEF0dGFjaCB0byBDaGlsZCBQcm9jZXNzJywgKCkgPT4ge1xyXG4gICAgdGVzdCgnTWVzc2FnZSBpcyBub3QgZGlzcGxheWVkIGlmIGRlYnVnZ2VyIGlzIGxhdW5jaGVkJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHNoZWxsID0gdHNfbW9ja2l0b18xLm1vY2soYXBwbGljYXRpb25TaGVsbF8xLkFwcGxpY2F0aW9uU2hlbGwpO1xyXG4gICAgICAgIGNvbnN0IGRlYnVnU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKGRlYnVnU2VydmljZV8xLkRlYnVnU2VydmljZSk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKHdvcmtzcGFjZV8xLldvcmtzcGFjZVNlcnZpY2UpO1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgY2hpbGRQcm9jZXNzQXR0YWNoU2VydmljZV8xLkNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2UodHNfbW9ja2l0b18xLmluc3RhbmNlKHNoZWxsKSwgdHNfbW9ja2l0b18xLmluc3RhbmNlKGRlYnVnU2VydmljZSksIHRzX21vY2tpdG9fMS5pbnN0YW5jZSh3b3Jrc3BhY2VTZXJ2aWNlKSk7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IHtcclxuICAgICAgICAgICAgcmVxdWVzdDogJ2xhdW5jaCcsXHJcbiAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICBuYW1lOiAnJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgcm9vdFByb2Nlc3NJZDogMSxcclxuICAgICAgICAgICAgcGFyZW50UHJvY2Vzc0lkOiAxLFxyXG4gICAgICAgICAgICBwb3J0OiAxMjM0LFxyXG4gICAgICAgICAgICBwcm9jZXNzSWQ6IDIsXHJcbiAgICAgICAgICAgIHJvb3RTdGFydFJlcXVlc3Q6IHtcclxuICAgICAgICAgICAgICAgIHNlcTogMSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBhcmdzLFxyXG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3JlcXVlc3QnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycykudGhlblJldHVybihmYWxzZSk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLndoZW4oZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKHRzX21vY2tpdG9fMS5hbnl0aGluZygpLCB0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLnRoZW5SZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIHlpZWxkIHNlcnZpY2UuYXR0YWNoKGRhdGEpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS52ZXJpZnkod29ya3NwYWNlU2VydmljZS5oYXNXb3Jrc3BhY2VGb2xkZXJzKS5vbmNlKCk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLnZlcmlmeShkZWJ1Z1NlcnZpY2Uuc3RhcnREZWJ1Z2dpbmcodHNfbW9ja2l0b18xLmFueXRoaW5nKCksIHRzX21vY2tpdG9fMS5hbnl0aGluZygpKSkub25jZSgpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnTWVzc2FnZSBpcyBkaXNwbGF5ZWQgaWYgZGVidWdnZXIgaXMgbm90IGxhdW5jaGVkJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHNoZWxsID0gdHNfbW9ja2l0b18xLm1vY2soYXBwbGljYXRpb25TaGVsbF8xLkFwcGxpY2F0aW9uU2hlbGwpO1xyXG4gICAgICAgIGNvbnN0IGRlYnVnU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKGRlYnVnU2VydmljZV8xLkRlYnVnU2VydmljZSk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKHdvcmtzcGFjZV8xLldvcmtzcGFjZVNlcnZpY2UpO1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgY2hpbGRQcm9jZXNzQXR0YWNoU2VydmljZV8xLkNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2UodHNfbW9ja2l0b18xLmluc3RhbmNlKHNoZWxsKSwgdHNfbW9ja2l0b18xLmluc3RhbmNlKGRlYnVnU2VydmljZSksIHRzX21vY2tpdG9fMS5pbnN0YW5jZSh3b3Jrc3BhY2VTZXJ2aWNlKSk7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IHtcclxuICAgICAgICAgICAgcmVxdWVzdDogJ2xhdW5jaCcsXHJcbiAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICBuYW1lOiAnJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgcm9vdFByb2Nlc3NJZDogMSxcclxuICAgICAgICAgICAgcGFyZW50UHJvY2Vzc0lkOiAxLFxyXG4gICAgICAgICAgICBwb3J0OiAxMjM0LFxyXG4gICAgICAgICAgICBwcm9jZXNzSWQ6IDIsXHJcbiAgICAgICAgICAgIHJvb3RTdGFydFJlcXVlc3Q6IHtcclxuICAgICAgICAgICAgICAgIHNlcTogMSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBhcmdzLFxyXG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3JlcXVlc3QnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycykudGhlblJldHVybihmYWxzZSk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLndoZW4oZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKHRzX21vY2tpdG9fMS5hbnl0aGluZygpLCB0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLnRoZW5SZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB0c19tb2NraXRvXzEud2hlbihzaGVsbC5zaG93RXJyb3JNZXNzYWdlKHRzX21vY2tpdG9fMS5hbnl0aGluZygpKSkudGhlblJlc29sdmUoKTtcclxuICAgICAgICB5aWVsZCBzZXJ2aWNlLmF0dGFjaChkYXRhKTtcclxuICAgICAgICB0c19tb2NraXRvXzEudmVyaWZ5KHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycykub25jZSgpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS52ZXJpZnkoZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKHRzX21vY2tpdG9fMS5hbnl0aGluZygpLCB0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLm9uY2UoKTtcclxuICAgICAgICB0c19tb2NraXRvXzEudmVyaWZ5KHNoZWxsLnNob3dFcnJvck1lc3NhZ2UodHNfbW9ja2l0b18xLmFueXRoaW5nKCkpKS5vbmNlKCk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdVc2UgY29ycmVjdCB3b3Jrc3BhY2UgZm9sZGVyJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHNoZWxsID0gdHNfbW9ja2l0b18xLm1vY2soYXBwbGljYXRpb25TaGVsbF8xLkFwcGxpY2F0aW9uU2hlbGwpO1xyXG4gICAgICAgIGNvbnN0IGRlYnVnU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKGRlYnVnU2VydmljZV8xLkRlYnVnU2VydmljZSk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKHdvcmtzcGFjZV8xLldvcmtzcGFjZVNlcnZpY2UpO1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgY2hpbGRQcm9jZXNzQXR0YWNoU2VydmljZV8xLkNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2UodHNfbW9ja2l0b18xLmluc3RhbmNlKHNoZWxsKSwgdHNfbW9ja2l0b18xLmluc3RhbmNlKGRlYnVnU2VydmljZSksIHRzX21vY2tpdG9fMS5pbnN0YW5jZSh3b3Jrc3BhY2VTZXJ2aWNlKSk7XHJcbiAgICAgICAgY29uc3QgcmlnaHRXb3Jrc3BhY2VGb2xkZXIgPSB7IG5hbWU6ICcxJywgaW5kZXg6IDEsIHVyaTogdnNjb2RlXzEuVXJpLmZpbGUoJ2EnKSB9O1xyXG4gICAgICAgIGNvbnN0IHdrc3BhY2UxID0geyBuYW1lOiAnMCcsIGluZGV4OiAwLCB1cmk6IHZzY29kZV8xLlVyaS5maWxlKCcwJykgfTtcclxuICAgICAgICBjb25zdCB3a3NwYWNlMiA9IHsgbmFtZTogJzInLCBpbmRleDogMiwgdXJpOiB2c2NvZGVfMS5VcmkuZmlsZSgnMicpIH07XHJcbiAgICAgICAgY29uc3QgYXJncyA9IHtcclxuICAgICAgICAgICAgcmVxdWVzdDogJ2xhdW5jaCcsXHJcbiAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICBuYW1lOiAnJyxcclxuICAgICAgICAgICAgd29ya3NwYWNlRm9sZGVyOiByaWdodFdvcmtzcGFjZUZvbGRlci51cmkuZnNQYXRoXHJcbiAgICAgICAgfTtcclxuICAgICAgICBjb25zdCBkYXRhID0ge1xyXG4gICAgICAgICAgICByb290UHJvY2Vzc0lkOiAxLFxyXG4gICAgICAgICAgICBwYXJlbnRQcm9jZXNzSWQ6IDEsXHJcbiAgICAgICAgICAgIHBvcnQ6IDEyMzQsXHJcbiAgICAgICAgICAgIHByb2Nlc3NJZDogMixcclxuICAgICAgICAgICAgcm9vdFN0YXJ0UmVxdWVzdDoge1xyXG4gICAgICAgICAgICAgICAgc2VxOiAxLFxyXG4gICAgICAgICAgICAgICAgdHlwZTogJ3B5dGhvbicsXHJcbiAgICAgICAgICAgICAgICBhcmd1bWVudHM6IGFyZ3MsXHJcbiAgICAgICAgICAgICAgICBjb21tYW5kOiAncmVxdWVzdCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLndoZW4od29ya3NwYWNlU2VydmljZS5oYXNXb3Jrc3BhY2VGb2xkZXJzKS50aGVuUmV0dXJuKHRydWUpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKHdvcmtzcGFjZVNlcnZpY2Uud29ya3NwYWNlRm9sZGVycykudGhlblJldHVybihbd2tzcGFjZTEsIHJpZ2h0V29ya3NwYWNlRm9sZGVyLCB3a3NwYWNlMl0pO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKGRlYnVnU2VydmljZS5zdGFydERlYnVnZ2luZyhyaWdodFdvcmtzcGFjZUZvbGRlciwgdHNfbW9ja2l0b18xLmFueXRoaW5nKCkpKS50aGVuUmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICB5aWVsZCBzZXJ2aWNlLmF0dGFjaChkYXRhKTtcclxuICAgICAgICB0c19tb2NraXRvXzEudmVyaWZ5KHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycykub25jZSgpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS52ZXJpZnkoZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKHJpZ2h0V29ya3NwYWNlRm9sZGVyLCB0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLm9uY2UoKTtcclxuICAgICAgICB0c19tb2NraXRvXzEudmVyaWZ5KHNoZWxsLnNob3dFcnJvck1lc3NhZ2UodHNfbW9ja2l0b18xLmFueXRoaW5nKCkpKS5uZXZlcigpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnVXNlIGVtcHR5IHdvcmtzcGFjZSBmb2xkZXIgaWYgcmlnaHQgb25lIGlzIG5vdCBmb3VuZCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBzaGVsbCA9IHRzX21vY2tpdG9fMS5tb2NrKGFwcGxpY2F0aW9uU2hlbGxfMS5BcHBsaWNhdGlvblNoZWxsKTtcclxuICAgICAgICBjb25zdCBkZWJ1Z1NlcnZpY2UgPSB0c19tb2NraXRvXzEubW9jayhkZWJ1Z1NlcnZpY2VfMS5EZWJ1Z1NlcnZpY2UpO1xyXG4gICAgICAgIGNvbnN0IHdvcmtzcGFjZVNlcnZpY2UgPSB0c19tb2NraXRvXzEubW9jayh3b3Jrc3BhY2VfMS5Xb3Jrc3BhY2VTZXJ2aWNlKTtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlID0gbmV3IGNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2VfMS5DaGlsZFByb2Nlc3NBdHRhY2hTZXJ2aWNlKHRzX21vY2tpdG9fMS5pbnN0YW5jZShzaGVsbCksIHRzX21vY2tpdG9fMS5pbnN0YW5jZShkZWJ1Z1NlcnZpY2UpLCB0c19tb2NraXRvXzEuaW5zdGFuY2Uod29ya3NwYWNlU2VydmljZSkpO1xyXG4gICAgICAgIGNvbnN0IHJpZ2h0V29ya3NwYWNlRm9sZGVyID0geyBuYW1lOiAnMScsIGluZGV4OiAxLCB1cmk6IHZzY29kZV8xLlVyaS5maWxlKCdhJykgfTtcclxuICAgICAgICBjb25zdCB3a3NwYWNlMSA9IHsgbmFtZTogJzAnLCBpbmRleDogMCwgdXJpOiB2c2NvZGVfMS5VcmkuZmlsZSgnMCcpIH07XHJcbiAgICAgICAgY29uc3Qgd2tzcGFjZTIgPSB7IG5hbWU6ICcyJywgaW5kZXg6IDIsIHVyaTogdnNjb2RlXzEuVXJpLmZpbGUoJzInKSB9O1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSB7XHJcbiAgICAgICAgICAgIHJlcXVlc3Q6ICdsYXVuY2gnLFxyXG4gICAgICAgICAgICB0eXBlOiAncHl0aG9uJyxcclxuICAgICAgICAgICAgbmFtZTogJycsXHJcbiAgICAgICAgICAgIHdvcmtzcGFjZUZvbGRlcjogcmlnaHRXb3Jrc3BhY2VGb2xkZXIudXJpLmZzUGF0aFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgcm9vdFByb2Nlc3NJZDogMSxcclxuICAgICAgICAgICAgcGFyZW50UHJvY2Vzc0lkOiAxLFxyXG4gICAgICAgICAgICBwb3J0OiAxMjM0LFxyXG4gICAgICAgICAgICBwcm9jZXNzSWQ6IDIsXHJcbiAgICAgICAgICAgIHJvb3RTdGFydFJlcXVlc3Q6IHtcclxuICAgICAgICAgICAgICAgIHNlcTogMSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBhcmdzLFxyXG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3JlcXVlc3QnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycykudGhlblJldHVybih0cnVlKTtcclxuICAgICAgICB0c19tb2NraXRvXzEud2hlbih3b3Jrc3BhY2VTZXJ2aWNlLndvcmtzcGFjZUZvbGRlcnMpLnRoZW5SZXR1cm4oW3drc3BhY2UxLCB3a3NwYWNlMl0pO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKGRlYnVnU2VydmljZS5zdGFydERlYnVnZ2luZyh1bmRlZmluZWQsIHRzX21vY2tpdG9fMS5hbnl0aGluZygpKSkudGhlblJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5hdHRhY2goZGF0YSk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLnZlcmlmeSh3b3Jrc3BhY2VTZXJ2aWNlLmhhc1dvcmtzcGFjZUZvbGRlcnMpLm9uY2UoKTtcclxuICAgICAgICB0c19tb2NraXRvXzEudmVyaWZ5KGRlYnVnU2VydmljZS5zdGFydERlYnVnZ2luZyh1bmRlZmluZWQsIHRzX21vY2tpdG9fMS5hbnl0aGluZygpKSkub25jZSgpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS52ZXJpZnkoc2hlbGwuc2hvd0Vycm9yTWVzc2FnZSh0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLm5ldmVyKCk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdWYWxpZGF0ZSBkZWJ1ZyBjb25maWcgd2hlbiBwYXJlbnQvcm9vdCBwYXJlbnQgd2FzIGxhdW5jaGVkJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHNoZWxsID0gdHNfbW9ja2l0b18xLm1vY2soYXBwbGljYXRpb25TaGVsbF8xLkFwcGxpY2F0aW9uU2hlbGwpO1xyXG4gICAgICAgIGNvbnN0IGRlYnVnU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKGRlYnVnU2VydmljZV8xLkRlYnVnU2VydmljZSk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlU2VydmljZSA9IHRzX21vY2tpdG9fMS5tb2NrKHdvcmtzcGFjZV8xLldvcmtzcGFjZVNlcnZpY2UpO1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2UgPSBuZXcgY2hpbGRQcm9jZXNzQXR0YWNoU2VydmljZV8xLkNoaWxkUHJvY2Vzc0F0dGFjaFNlcnZpY2UodHNfbW9ja2l0b18xLmluc3RhbmNlKHNoZWxsKSwgdHNfbW9ja2l0b18xLmluc3RhbmNlKGRlYnVnU2VydmljZSksIHRzX21vY2tpdG9fMS5pbnN0YW5jZSh3b3Jrc3BhY2VTZXJ2aWNlKSk7XHJcbiAgICAgICAgY29uc3QgYXJncyA9IHtcclxuICAgICAgICAgICAgcmVxdWVzdDogJ2xhdW5jaCcsXHJcbiAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICBuYW1lOiAnJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgcm9vdFByb2Nlc3NJZDogMSxcclxuICAgICAgICAgICAgcGFyZW50UHJvY2Vzc0lkOiAxLFxyXG4gICAgICAgICAgICBwb3J0OiAxMjM0LFxyXG4gICAgICAgICAgICBwcm9jZXNzSWQ6IDIsXHJcbiAgICAgICAgICAgIHJvb3RTdGFydFJlcXVlc3Q6IHtcclxuICAgICAgICAgICAgICAgIHNlcTogMSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBhcmdzLFxyXG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3JlcXVlc3QnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGRlYnVnQ29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcmdzKSk7XHJcbiAgICAgICAgZGVidWdDb25maWcuaG9zdCA9ICdsb2NhbGhvc3QnO1xyXG4gICAgICAgIGRlYnVnQ29uZmlnLnBvcnQgPSBkYXRhLnBvcnQ7XHJcbiAgICAgICAgZGVidWdDb25maWcubmFtZSA9IGBDaGlsZCBQcm9jZXNzICR7ZGF0YS5wcm9jZXNzSWR9YDtcclxuICAgICAgICBkZWJ1Z0NvbmZpZy5yZXF1ZXN0ID0gJ2F0dGFjaCc7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLndoZW4od29ya3NwYWNlU2VydmljZS5oYXNXb3Jrc3BhY2VGb2xkZXJzKS50aGVuUmV0dXJuKGZhbHNlKTtcclxuICAgICAgICB0c19tb2NraXRvXzEud2hlbihkZWJ1Z1NlcnZpY2Uuc3RhcnREZWJ1Z2dpbmcodW5kZWZpbmVkLCB0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLnRoZW5SZXNvbHZlKHRydWUpO1xyXG4gICAgICAgIC8vIHdoZW4oZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKHVuZGVmaW5lZCwgZGVidWdDb25maWcpKS50aGVuUmVzb2x2ZSh0cnVlIGFzIGFueSk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5hdHRhY2goZGF0YSk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLnZlcmlmeSh3b3Jrc3BhY2VTZXJ2aWNlLmhhc1dvcmtzcGFjZUZvbGRlcnMpLm9uY2UoKTtcclxuICAgICAgICB0c19tb2NraXRvXzEudmVyaWZ5KGRlYnVnU2VydmljZS5zdGFydERlYnVnZ2luZyh1bmRlZmluZWQsIHRzX21vY2tpdG9fMS5hbnl0aGluZygpKSkub25jZSgpO1xyXG4gICAgICAgIGNvbnN0IFssIHNlY29uZEFyZ10gPSB0c19tb2NraXRvXzEuY2FwdHVyZShkZWJ1Z1NlcnZpY2Uuc3RhcnREZWJ1Z2dpbmcpLmxhc3QoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHNlY29uZEFyZykudG8uZGVlcC5lcXVhbChkZWJ1Z0NvbmZpZyk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLnZlcmlmeShzaGVsbC5zaG93RXJyb3JNZXNzYWdlKHRzX21vY2tpdG9fMS5hbnl0aGluZygpKSkubmV2ZXIoKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ1ZhbGlkYXRlIGRlYnVnIGNvbmZpZyB3aGVuIHBhcmVudC9yb290IHBhcmVudCB3YXMgYXR0YWNoZWQnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc2hlbGwgPSB0c19tb2NraXRvXzEubW9jayhhcHBsaWNhdGlvblNoZWxsXzEuQXBwbGljYXRpb25TaGVsbCk7XHJcbiAgICAgICAgY29uc3QgZGVidWdTZXJ2aWNlID0gdHNfbW9ja2l0b18xLm1vY2soZGVidWdTZXJ2aWNlXzEuRGVidWdTZXJ2aWNlKTtcclxuICAgICAgICBjb25zdCB3b3Jrc3BhY2VTZXJ2aWNlID0gdHNfbW9ja2l0b18xLm1vY2sod29ya3NwYWNlXzEuV29ya3NwYWNlU2VydmljZSk7XHJcbiAgICAgICAgY29uc3Qgc2VydmljZSA9IG5ldyBjaGlsZFByb2Nlc3NBdHRhY2hTZXJ2aWNlXzEuQ2hpbGRQcm9jZXNzQXR0YWNoU2VydmljZSh0c19tb2NraXRvXzEuaW5zdGFuY2Uoc2hlbGwpLCB0c19tb2NraXRvXzEuaW5zdGFuY2UoZGVidWdTZXJ2aWNlKSwgdHNfbW9ja2l0b18xLmluc3RhbmNlKHdvcmtzcGFjZVNlcnZpY2UpKTtcclxuICAgICAgICBjb25zdCBhcmdzID0ge1xyXG4gICAgICAgICAgICByZXF1ZXN0OiAnYXR0YWNoJyxcclxuICAgICAgICAgICAgdHlwZTogJ3B5dGhvbicsXHJcbiAgICAgICAgICAgIG5hbWU6ICcnLFxyXG4gICAgICAgICAgICBob3N0OiAnMTIzLjEyMy4xMjMuMTIzJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgY29uc3QgZGF0YSA9IHtcclxuICAgICAgICAgICAgcm9vdFByb2Nlc3NJZDogMSxcclxuICAgICAgICAgICAgcGFyZW50UHJvY2Vzc0lkOiAxLFxyXG4gICAgICAgICAgICBwb3J0OiAxMjM0LFxyXG4gICAgICAgICAgICBwcm9jZXNzSWQ6IDIsXHJcbiAgICAgICAgICAgIHJvb3RTdGFydFJlcXVlc3Q6IHtcclxuICAgICAgICAgICAgICAgIHNlcTogMSxcclxuICAgICAgICAgICAgICAgIHR5cGU6ICdweXRob24nLFxyXG4gICAgICAgICAgICAgICAgYXJndW1lbnRzOiBhcmdzLFxyXG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3JlcXVlc3QnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgICAgIGNvbnN0IGRlYnVnQ29uZmlnID0gSlNPTi5wYXJzZShKU09OLnN0cmluZ2lmeShhcmdzKSk7XHJcbiAgICAgICAgZGVidWdDb25maWcuaG9zdCA9IGFyZ3MuaG9zdDtcclxuICAgICAgICBkZWJ1Z0NvbmZpZy5wb3J0ID0gZGF0YS5wb3J0O1xyXG4gICAgICAgIGRlYnVnQ29uZmlnLm5hbWUgPSBgQ2hpbGQgUHJvY2VzcyAke2RhdGEucHJvY2Vzc0lkfWA7XHJcbiAgICAgICAgZGVidWdDb25maWcucmVxdWVzdCA9ICdhdHRhY2gnO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS53aGVuKHdvcmtzcGFjZVNlcnZpY2UuaGFzV29ya3NwYWNlRm9sZGVycykudGhlblJldHVybihmYWxzZSk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLndoZW4oZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKHVuZGVmaW5lZCwgdHNfbW9ja2l0b18xLmFueXRoaW5nKCkpKS50aGVuUmVzb2x2ZSh0cnVlKTtcclxuICAgICAgICAvLyB3aGVuKGRlYnVnU2VydmljZS5zdGFydERlYnVnZ2luZyh1bmRlZmluZWQsIGRlYnVnQ29uZmlnKSkudGhlblJlc29sdmUodHJ1ZSBhcyBhbnkpO1xyXG4gICAgICAgIHlpZWxkIHNlcnZpY2UuYXR0YWNoKGRhdGEpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS52ZXJpZnkod29ya3NwYWNlU2VydmljZS5oYXNXb3Jrc3BhY2VGb2xkZXJzKS5vbmNlKCk7XHJcbiAgICAgICAgdHNfbW9ja2l0b18xLnZlcmlmeShkZWJ1Z1NlcnZpY2Uuc3RhcnREZWJ1Z2dpbmcodW5kZWZpbmVkLCB0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLm9uY2UoKTtcclxuICAgICAgICBjb25zdCBbLCBzZWNvbmRBcmddID0gdHNfbW9ja2l0b18xLmNhcHR1cmUoZGVidWdTZXJ2aWNlLnN0YXJ0RGVidWdnaW5nKS5sYXN0KCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChzZWNvbmRBcmcpLnRvLmRlZXAuZXF1YWwoZGVidWdDb25maWcpO1xyXG4gICAgICAgIHRzX21vY2tpdG9fMS52ZXJpZnkoc2hlbGwuc2hvd0Vycm9yTWVzc2FnZSh0c19tb2NraXRvXzEuYW55dGhpbmcoKSkpLm5ldmVyKCk7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jaGlsZFByb2Nlc3NBdHRhY2hTZXJ2aWNlLnVuaXQudGVzdC5qcy5tYXAiXX0=