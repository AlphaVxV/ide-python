/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:all

var vscMockArrays;

(function (vscMockArrays) {
  /**
   * Returns the last element of an array.
   * @param array The array.
   * @param n Which element from the end (default is zero).
   */
  function tail(array, n = 0) {
    return array[array.length - (1 + n)];
  }

  vscMockArrays.tail = tail;

  function equals(one, other, itemEquals = (a, b) => a === b) {
    if (one.length !== other.length) {
      return false;
    }

    for (let i = 0, len = one.length; i < len; i++) {
      if (!itemEquals(one[i], other[i])) {
        return false;
      }
    }

    return true;
  }

  vscMockArrays.equals = equals;

  function binarySearch(array, key, comparator) {
    let low = 0,
        high = array.length - 1;

    while (low <= high) {
      let mid = (low + high) / 2 | 0;
      let comp = comparator(array[mid], key);

      if (comp < 0) {
        low = mid + 1;
      } else if (comp > 0) {
        high = mid - 1;
      } else {
        return mid;
      }
    }

    return -(low + 1);
  }

  vscMockArrays.binarySearch = binarySearch;
  /**
   * Takes a sorted array and a function p. The array is sorted in such a way that all elements where p(x) is false
   * are located before all elements where p(x) is true.
   * @returns the least x for which p(x) is true or array.length if no element fullfills the given function.
   */

  function findFirst(array, p) {
    let low = 0,
        high = array.length;

    if (high === 0) {
      return 0; // no children
    }

    while (low < high) {
      let mid = Math.floor((low + high) / 2);

      if (p(array[mid])) {
        high = mid;
      } else {
        low = mid + 1;
      }
    }

    return low;
  }

  vscMockArrays.findFirst = findFirst;
  /**
   * Like `Array#sort` but always stable. Usually runs a little slower `than Array#sort`
   * so only use this when actually needing stable sort.
   */

  function mergeSort(data, compare) {
    _divideAndMerge(data, compare);

    return data;
  }

  vscMockArrays.mergeSort = mergeSort;

  function _divideAndMerge(data, compare) {
    if (data.length <= 1) {
      // sorted
      return;
    }

    const p = data.length / 2 | 0;
    const left = data.slice(0, p);
    const right = data.slice(p);

    _divideAndMerge(left, compare);

    _divideAndMerge(right, compare);

    let leftIdx = 0;
    let rightIdx = 0;
    let i = 0;

    while (leftIdx < left.length && rightIdx < right.length) {
      let ret = compare(left[leftIdx], right[rightIdx]);

      if (ret <= 0) {
        // smaller_equal -> take left to preserve order
        data[i++] = left[leftIdx++];
      } else {
        // greater -> take right
        data[i++] = right[rightIdx++];
      }
    }

    while (leftIdx < left.length) {
      data[i++] = left[leftIdx++];
    }

    while (rightIdx < right.length) {
      data[i++] = right[rightIdx++];
    }
  }

  function groupBy(data, compare) {
    const result = [];
    let currentGroup;

    for (const element of mergeSort(data.slice(0), compare)) {
      if (!currentGroup || compare(currentGroup[0], element) !== 0) {
        currentGroup = [element];
        result.push(currentGroup);
      } else {
        currentGroup.push(element);
      }
    }

    return result;
  }

  vscMockArrays.groupBy = groupBy;
  /**
   * Diffs two *sorted* arrays and computes the splices which apply the diff.
   */

  function sortedDiff(before, after, compare) {
    const result = [];

    function pushSplice(start, deleteCount, toInsert) {
      if (deleteCount === 0 && toInsert.length === 0) {
        return;
      }

      const latest = result[result.length - 1];

      if (latest && latest.start + latest.deleteCount === start) {
        latest.deleteCount += deleteCount;
        latest.toInsert.push(...toInsert);
      } else {
        result.push({
          start,
          deleteCount,
          toInsert
        });
      }
    }

    let beforeIdx = 0;
    let afterIdx = 0;

    while (true) {
      if (beforeIdx === before.length) {
        pushSplice(beforeIdx, 0, after.slice(afterIdx));
        break;
      }

      if (afterIdx === after.length) {
        pushSplice(beforeIdx, before.length - beforeIdx, []);
        break;
      }

      const beforeElement = before[beforeIdx];
      const afterElement = after[afterIdx];
      const n = compare(beforeElement, afterElement);

      if (n === 0) {
        // equal
        beforeIdx += 1;
        afterIdx += 1;
      } else if (n < 0) {
        // beforeElement is smaller -> before element removed
        pushSplice(beforeIdx, 1, []);
        beforeIdx += 1;
      } else if (n > 0) {
        // beforeElement is greater -> after element added
        pushSplice(beforeIdx, 0, [afterElement]);
        afterIdx += 1;
      }
    }

    return result;
  }

  vscMockArrays.sortedDiff = sortedDiff;
  /**
   * Takes two *sorted* arrays and computes their delta (removed, added elements).
   * Finishes in `Math.min(before.length, after.length)` steps.
   * @param before
   * @param after
   * @param compare
   */

  function delta(before, after, compare) {
    const splices = sortedDiff(before, after, compare);
    const removed = [];
    const added = [];

    for (const splice of splices) {
      removed.push(...before.slice(splice.start, splice.start + splice.deleteCount));
      added.push(...splice.toInsert);
    }

    return {
      removed,
      added
    };
  }

  vscMockArrays.delta = delta;
  /**
   * Returns the top N elements from the array.
   *
   * Faster than sorting the entire array when the array is a lot larger than N.
   *
   * @param array The unsorted array.
   * @param compare A sort function for the elements.
   * @param n The number of elements to return.
   * @return The first n elemnts from array when sorted with compare.
   */

  function top(array, compare, n) {
    if (n === 0) {
      return [];
    }

    const result = array.slice(0, n).sort(compare);
    topStep(array, compare, result, n, array.length);
    return result;
  }

  vscMockArrays.top = top;

  function topStep(array, compare, result, i, m) {
    for (const n = result.length; i < m; i++) {
      const element = array[i];

      if (compare(element, result[n - 1]) < 0) {
        result.pop();
        const j = findFirst(result, e => compare(element, e) < 0);
        result.splice(j, 0, element);
      }
    }
  }
  /**
   * @returns a new array with all undefined or null values removed. The original array is not modified at all.
   */


  function coalesce(array) {
    if (!array) {
      return array;
    }

    return array.filter(e => !!e);
  }

  vscMockArrays.coalesce = coalesce;
  /**
   * Moves the element in the array for the provided positions.
   */

  function move(array, from, to) {
    array.splice(to, 0, array.splice(from, 1)[0]);
  }

  vscMockArrays.move = move;
  /**
   * @returns {{false}} if the provided object is an array
   * 	and not empty.
   */

  function isFalsyOrEmpty(obj) {
    return !Array.isArray(obj) || obj.length === 0;
  }

  vscMockArrays.isFalsyOrEmpty = isFalsyOrEmpty;
  /**
   * Removes duplicates from the given array. The optional keyFn allows to specify
   * how elements are checked for equalness by returning a unique string for each.
   */

  function distinct(array, keyFn) {
    if (!keyFn) {
      return array.filter((element, position) => {
        return array.indexOf(element) === position;
      });
    }

    const seen = Object.create(null);
    return array.filter(elem => {
      const key = keyFn(elem);

      if (seen[key]) {
        return false;
      }

      seen[key] = true;
      return true;
    });
  }

  vscMockArrays.distinct = distinct;

  function uniqueFilter(keyFn) {
    const seen = Object.create(null);
    return element => {
      const key = keyFn(element);

      if (seen[key]) {
        return false;
      }

      seen[key] = true;
      return true;
    };
  }

  vscMockArrays.uniqueFilter = uniqueFilter;

  function firstIndex(array, fn) {
    for (let i = 0; i < array.length; i++) {
      const element = array[i];

      if (fn(element)) {
        return i;
      }
    }

    return -1;
  }

  vscMockArrays.firstIndex = firstIndex;

  function first(array, fn, notFoundValue = null) {
    const index = firstIndex(array, fn);
    return index < 0 ? notFoundValue : array[index];
  }

  vscMockArrays.first = first;

  function commonPrefixLength(one, other, equals = (a, b) => a === b) {
    let result = 0;

    for (let i = 0, len = Math.min(one.length, other.length); i < len && equals(one[i], other[i]); i++) {
      result++;
    }

    return result;
  }

  vscMockArrays.commonPrefixLength = commonPrefixLength;

  function flatten(arr) {
    return [].concat(...arr);
  }

  vscMockArrays.flatten = flatten;

  function range(arg, to) {
    let from = typeof to === 'number' ? arg : 0;

    if (typeof to === 'number') {
      from = arg;
    } else {
      from = 0;
      to = arg;
    }

    const result = [];

    if (from <= to) {
      for (let i = from; i < to; i++) {
        result.push(i);
      }
    } else {
      for (let i = from; i > to; i--) {
        result.push(i);
      }
    }

    return result;
  }

  vscMockArrays.range = range;

  function fill(num, valueFn, arr = []) {
    for (let i = 0; i < num; i++) {
      arr[i] = valueFn();
    }

    return arr;
  }

  vscMockArrays.fill = fill;

  function index(array, indexer, merger = t => t) {
    return array.reduce((r, t) => {
      const key = indexer(t);
      r[key] = merger(t, r[key]);
      return r;
    }, Object.create(null));
  }

  vscMockArrays.index = index;
  /**
   * Inserts an element into an array. Returns a function which, when
   * called, will remove that element from the array.
   */

  function insert(array, element) {
    array.push(element);
    return () => {
      const index = array.indexOf(element);

      if (index > -1) {
        array.splice(index, 1);
      }
    };
  }

  vscMockArrays.insert = insert;
  /**
   * Insert `insertArr` inside `target` at `insertIndex`.
   * Please don't touch unless you understand https://jsperf.com/inserting-an-array-within-an-array
   */

  function arrayInsert(target, insertIndex, insertArr) {
    const before = target.slice(0, insertIndex);
    const after = target.slice(insertIndex);
    return before.concat(insertArr, after);
  }

  vscMockArrays.arrayInsert = arrayInsert;
})(vscMockArrays = exports.vscMockArrays || (exports.vscMockArrays = {}));
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFycmF5cy5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsInZzY01vY2tBcnJheXMiLCJ0YWlsIiwiYXJyYXkiLCJuIiwibGVuZ3RoIiwiZXF1YWxzIiwib25lIiwib3RoZXIiLCJpdGVtRXF1YWxzIiwiYSIsImIiLCJpIiwibGVuIiwiYmluYXJ5U2VhcmNoIiwia2V5IiwiY29tcGFyYXRvciIsImxvdyIsImhpZ2giLCJtaWQiLCJjb21wIiwiZmluZEZpcnN0IiwicCIsIk1hdGgiLCJmbG9vciIsIm1lcmdlU29ydCIsImRhdGEiLCJjb21wYXJlIiwiX2RpdmlkZUFuZE1lcmdlIiwibGVmdCIsInNsaWNlIiwicmlnaHQiLCJsZWZ0SWR4IiwicmlnaHRJZHgiLCJyZXQiLCJncm91cEJ5IiwicmVzdWx0IiwiY3VycmVudEdyb3VwIiwiZWxlbWVudCIsInB1c2giLCJzb3J0ZWREaWZmIiwiYmVmb3JlIiwiYWZ0ZXIiLCJwdXNoU3BsaWNlIiwic3RhcnQiLCJkZWxldGVDb3VudCIsInRvSW5zZXJ0IiwibGF0ZXN0IiwiYmVmb3JlSWR4IiwiYWZ0ZXJJZHgiLCJiZWZvcmVFbGVtZW50IiwiYWZ0ZXJFbGVtZW50IiwiZGVsdGEiLCJzcGxpY2VzIiwicmVtb3ZlZCIsImFkZGVkIiwic3BsaWNlIiwidG9wIiwic29ydCIsInRvcFN0ZXAiLCJtIiwicG9wIiwiaiIsImUiLCJjb2FsZXNjZSIsImZpbHRlciIsIm1vdmUiLCJmcm9tIiwidG8iLCJpc0ZhbHN5T3JFbXB0eSIsIm9iaiIsIkFycmF5IiwiaXNBcnJheSIsImRpc3RpbmN0Iiwia2V5Rm4iLCJwb3NpdGlvbiIsImluZGV4T2YiLCJzZWVuIiwiY3JlYXRlIiwiZWxlbSIsInVuaXF1ZUZpbHRlciIsImZpcnN0SW5kZXgiLCJmbiIsImZpcnN0Iiwibm90Rm91bmRWYWx1ZSIsImluZGV4IiwiY29tbW9uUHJlZml4TGVuZ3RoIiwibWluIiwiZmxhdHRlbiIsImFyciIsImNvbmNhdCIsInJhbmdlIiwiYXJnIiwiZmlsbCIsIm51bSIsInZhbHVlRm4iLCJpbmRleGVyIiwibWVyZ2VyIiwidCIsInJlZHVjZSIsInIiLCJpbnNlcnQiLCJhcnJheUluc2VydCIsInRhcmdldCIsImluc2VydEluZGV4IiwiaW5zZXJ0QXJyIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUNBQSxNQUFNLENBQUNDLGNBQVAsQ0FBc0JDLE9BQXRCLEVBQStCLFlBQS9CLEVBQTZDO0FBQUVDLEVBQUFBLEtBQUssRUFBRTtBQUFULENBQTdDLEUsQ0FDQTs7QUFDQSxJQUFJQyxhQUFKOztBQUNBLENBQUMsVUFBVUEsYUFBVixFQUF5QjtBQUN0QjtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0ksV0FBU0MsSUFBVCxDQUFjQyxLQUFkLEVBQXFCQyxDQUFDLEdBQUcsQ0FBekIsRUFBNEI7QUFDeEIsV0FBT0QsS0FBSyxDQUFDQSxLQUFLLENBQUNFLE1BQU4sSUFBZ0IsSUFBSUQsQ0FBcEIsQ0FBRCxDQUFaO0FBQ0g7O0FBQ0RILEVBQUFBLGFBQWEsQ0FBQ0MsSUFBZCxHQUFxQkEsSUFBckI7O0FBQ0EsV0FBU0ksTUFBVCxDQUFnQkMsR0FBaEIsRUFBcUJDLEtBQXJCLEVBQTRCQyxVQUFVLEdBQUcsQ0FBQ0MsQ0FBRCxFQUFJQyxDQUFKLEtBQVVELENBQUMsS0FBS0MsQ0FBekQsRUFBNEQ7QUFDeEQsUUFBSUosR0FBRyxDQUFDRixNQUFKLEtBQWVHLEtBQUssQ0FBQ0gsTUFBekIsRUFBaUM7QUFDN0IsYUFBTyxLQUFQO0FBQ0g7O0FBQ0QsU0FBSyxJQUFJTyxDQUFDLEdBQUcsQ0FBUixFQUFXQyxHQUFHLEdBQUdOLEdBQUcsQ0FBQ0YsTUFBMUIsRUFBa0NPLENBQUMsR0FBR0MsR0FBdEMsRUFBMkNELENBQUMsRUFBNUMsRUFBZ0Q7QUFDNUMsVUFBSSxDQUFDSCxVQUFVLENBQUNGLEdBQUcsQ0FBQ0ssQ0FBRCxDQUFKLEVBQVNKLEtBQUssQ0FBQ0ksQ0FBRCxDQUFkLENBQWYs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RUFBQUEsYUFBYSxDQUFDcUcsV0FBZCxHQUE0QkEsV0FBNUI7QUFDSCxDQTFXRCxFQTBXR3JHLGFBQWEsR0FBR0YsT0FBTyxDQUFDRSxhQUFSLEtBQTBCRixPQUFPLENBQUNFLGFBQVIsR0FBd0IsRUFBbEQsQ0ExV25CIiwic291cmNlc0NvbnRlbnQiOlsiLyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cclxuICogIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4gKiAgTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLiBTZWUgTGljZW5zZS50eHQgaW4gdGhlIHByb2plY3Qgcm9vdCBmb3IgbGljZW5zZSBpbmZvcm1hdGlvbi5cclxuICotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXHJcbid1c2Ugc3RyaWN0JztcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZTphbGxcclxudmFyIHZzY01vY2tBcnJheXM7XHJcbihmdW5jdGlvbiAodnNjTW9ja0FycmF5cykge1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSBsYXN0IGVsZW1lbnQgb2YgYW4gYXJyYXkuXHJcbiAgICAgKiBAcGFyYW0gYXJyYXkgVGhlIGFycmF5LlxyXG4gICAgICogQHBhcmFtIG4gV2hpY2ggZWxlbWVudCBmcm9tIHRoZSBlbmQgKGRlZmF1bHQgaXMgemVybykuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHRhaWwoYXJyYXksIG4gPSAwKSB7XHJcbiAgICAgICAgcmV0dXJuIGFycmF5W2FycmF5Lmxlbmd0aCAtICgxICsgbildO1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy50YWlsID0gdGFpbDtcclxuICAgIGZ1bmN0aW9uIGVxdWFscyhvbmUsIG90aGVyLCBpdGVtRXF1YWxzID0gKGEsIGIpID0+IGEgPT09IGIpIHtcclxuICAgICAgICBpZiAob25lLmxlbmd0aCAhPT0gb3RoZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IG9uZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xyXG4gICAgICAgICAgICBpZiAoIWl0ZW1FcXVhbHMob25lW2ldLCBvdGhlcltpXSkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuZXF1YWxzID0gZXF1YWxzO1xyXG4gICAgZnVuY3Rpb24gYmluYXJ5U2VhcmNoKGFycmF5LCBrZXksIGNvbXBhcmF0b3IpIHtcclxuICAgICAgICBsZXQgbG93ID0gMCwgaGlnaCA9IGFycmF5Lmxlbmd0aCAtIDE7XHJcbiAgICAgICAgd2hpbGUgKGxvdyA8PSBoaWdoKSB7XHJcbiAgICAgICAgICAgIGxldCBtaWQgPSAoKGxvdyArIGhpZ2gpIC8gMikgfCAwO1xyXG4gICAgICAgICAgICBsZXQgY29tcCA9IGNvbXBhcmF0b3IoYXJyYXlbbWlkXSwga2V5KTtcclxuICAgICAgICAgICAgaWYgKGNvbXAgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICBsb3cgPSBtaWQgKyAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKGNvbXAgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBoaWdoID0gbWlkIC0gMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBtaWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIC0obG93ICsgMSk7XHJcbiAgICB9XHJcbiAgICB2c2NNb2NrQXJyYXlzLmJpbmFyeVNlYXJjaCA9IGJpbmFyeVNlYXJjaDtcclxuICAgIC8qKlxyXG4gICAgICogVGFrZXMgYSBzb3J0ZWQgYXJyYXkgYW5kIGEgZnVuY3Rpb24gcC4gVGhlIGFycmF5IGlzIHNvcnRlZCBpbiBzdWNoIGEgd2F5IHRoYXQgYWxsIGVsZW1lbnRzIHdoZXJlIHAoeCkgaXMgZmFsc2VcclxuICAgICAqIGFyZSBsb2NhdGVkIGJlZm9yZSBhbGwgZWxlbWVudHMgd2hlcmUgcCh4KSBpcyB0cnVlLlxyXG4gICAgICogQHJldHVybnMgdGhlIGxlYXN0IHggZm9yIHdoaWNoIHAoeCkgaXMgdHJ1ZSBvciBhcnJheS5sZW5ndGggaWYgbm8gZWxlbWVudCBmdWxsZmlsbHMgdGhlIGdpdmVuIGZ1bmN0aW9uLlxyXG4gICAgICovXHJcbiAgICBmdW5jdGlvbiBmaW5kRmlyc3QoYXJyYXksIHApIHtcclxuICAgICAgICBsZXQgbG93ID0gMCwgaGlnaCA9IGFycmF5Lmxlbmd0aDtcclxuICAgICAgICBpZiAoaGlnaCA9PT0gMCkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDsgLy8gbm8gY2hpbGRyZW5cclxuICAgICAgICB9XHJcbiAgICAgICAgd2hpbGUgKGxvdyA8IGhpZ2gpIHtcclxuICAgICAgICAgICAgbGV0IG1pZCA9IE1hdGguZmxvb3IoKGxvdyArIGhpZ2gpIC8gMik7XHJcbiAgICAgICAgICAgIGlmIChwKGFycmF5W21pZF0pKSB7XHJcbiAgICAgICAgICAgICAgICBoaWdoID0gbWlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgbG93ID0gbWlkICsgMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gbG93O1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5maW5kRmlyc3QgPSBmaW5kRmlyc3Q7XHJcbiAgICAvKipcclxuICAgICAqIExpa2UgYEFycmF5I3NvcnRgIGJ1dCBhbHdheXMgc3RhYmxlLiBVc3VhbGx5IHJ1bnMgYSBsaXR0bGUgc2xvd2VyIGB0aGFuIEFycmF5I3NvcnRgXHJcbiAgICAgKiBzbyBvbmx5IHVzZSB0aGlzIHdoZW4gYWN0dWFsbHkgbmVlZGluZyBzdGFibGUgc29ydC5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gbWVyZ2VTb3J0KGRhdGEsIGNvbXBhcmUpIHtcclxuICAgICAgICBfZGl2aWRlQW5kTWVyZ2UoZGF0YSwgY29tcGFyZSk7XHJcbiAgICAgICAgcmV0dXJuIGRhdGE7XHJcbiAgICB9XHJcbiAgICB2c2NNb2NrQXJyYXlzLm1lcmdlU29ydCA9IG1lcmdlU29ydDtcclxuICAgIGZ1bmN0aW9uIF9kaXZpZGVBbmRNZXJnZShkYXRhLCBjb21wYXJlKSB7XHJcbiAgICAgICAgaWYgKGRhdGEubGVuZ3RoIDw9IDEpIHtcclxuICAgICAgICAgICAgLy8gc29ydGVkXHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcCA9IChkYXRhLmxlbmd0aCAvIDIpIHwgMDtcclxuICAgICAgICBjb25zdCBsZWZ0ID0gZGF0YS5zbGljZSgwLCBwKTtcclxuICAgICAgICBjb25zdCByaWdodCA9IGRhdGEuc2xpY2UocCk7XHJcbiAgICAgICAgX2RpdmlkZUFuZE1lcmdlKGxlZnQsIGNvbXBhcmUpO1xyXG4gICAgICAgIF9kaXZpZGVBbmRNZXJnZShyaWdodCwgY29tcGFyZSk7XHJcbiAgICAgICAgbGV0IGxlZnRJZHggPSAwO1xyXG4gICAgICAgIGxldCByaWdodElkeCA9IDA7XHJcbiAgICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICAgIHdoaWxlIChsZWZ0SWR4IDwgbGVmdC5sZW5ndGggJiYgcmlnaHRJZHggPCByaWdodC5sZW5ndGgpIHtcclxuICAgICAgICAgICAgbGV0IHJldCA9IGNvbXBhcmUobGVmdFtsZWZ0SWR4XSwgcmlnaHRbcmlnaHRJZHhdKTtcclxuICAgICAgICAgICAgaWYgKHJldCA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBzbWFsbGVyX2VxdWFsIC0+IHRha2UgbGVmdCB0byBwcmVzZXJ2ZSBvcmRlclxyXG4gICAgICAgICAgICAgICAgZGF0YVtpKytdID0gbGVmdFtsZWZ0SWR4KytdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgLy8gZ3JlYXRlciAtPiB0YWtlIHJpZ2h0XHJcbiAgICAgICAgICAgICAgICBkYXRhW2krK10gPSByaWdodFtyaWdodElkeCsrXTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB3aGlsZSAobGVmdElkeCA8IGxlZnQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRhdGFbaSsrXSA9IGxlZnRbbGVmdElkeCsrXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgd2hpbGUgKHJpZ2h0SWR4IDwgcmlnaHQubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIGRhdGFbaSsrXSA9IHJpZ2h0W3JpZ2h0SWR4KytdO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdyb3VwQnkoZGF0YSwgY29tcGFyZSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGxldCBjdXJyZW50R3JvdXA7XHJcbiAgICAgICAgZm9yIChjb25zdCBlbGVtZW50IG9mIG1lcmdlU29ydChkYXRhLnNsaWNlKDApLCBjb21wYXJlKSkge1xyXG4gICAgICAgICAgICBpZiAoIWN1cnJlbnRHcm91cCB8fCBjb21wYXJlKGN1cnJlbnRHcm91cFswXSwgZWxlbWVudCkgIT09IDApIHtcclxuICAgICAgICAgICAgICAgIGN1cnJlbnRHcm91cCA9IFtlbGVtZW50XTtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKGN1cnJlbnRHcm91cCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjdXJyZW50R3JvdXAucHVzaChlbGVtZW50KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5ncm91cEJ5ID0gZ3JvdXBCeTtcclxuICAgIC8qKlxyXG4gICAgICogRGlmZnMgdHdvICpzb3J0ZWQqIGFycmF5cyBhbmQgY29tcHV0ZXMgdGhlIHNwbGljZXMgd2hpY2ggYXBwbHkgdGhlIGRpZmYuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIHNvcnRlZERpZmYoYmVmb3JlLCBhZnRlciwgY29tcGFyZSkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIGZ1bmN0aW9uIHB1c2hTcGxpY2Uoc3RhcnQsIGRlbGV0ZUNvdW50LCB0b0luc2VydCkge1xyXG4gICAgICAgICAgICBpZiAoZGVsZXRlQ291bnQgPT09IDAgJiYgdG9JbnNlcnQubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgbGF0ZXN0ID0gcmVzdWx0W3Jlc3VsdC5sZW5ndGggLSAxXTtcclxuICAgICAgICAgICAgaWYgKGxhdGVzdCAmJiBsYXRlc3Quc3RhcnQgKyBsYXRlc3QuZGVsZXRlQ291bnQgPT09IHN0YXJ0KSB7XHJcbiAgICAgICAgICAgICAgICBsYXRlc3QuZGVsZXRlQ291bnQgKz0gZGVsZXRlQ291bnQ7XHJcbiAgICAgICAgICAgICAgICBsYXRlc3QudG9JbnNlcnQucHVzaCguLi50b0luc2VydCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCh7IHN0YXJ0LCBkZWxldGVDb3VudCwgdG9JbnNlcnQgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgbGV0IGJlZm9yZUlkeCA9IDA7XHJcbiAgICAgICAgbGV0IGFmdGVySWR4ID0gMDtcclxuICAgICAgICB3aGlsZSAodHJ1ZSkge1xyXG4gICAgICAgICAgICBpZiAoYmVmb3JlSWR4ID09PSBiZWZvcmUubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBwdXNoU3BsaWNlKGJlZm9yZUlkeCwgMCwgYWZ0ZXIuc2xpY2UoYWZ0ZXJJZHgpKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChhZnRlcklkeCA9PT0gYWZ0ZXIubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgICAgICBwdXNoU3BsaWNlKGJlZm9yZUlkeCwgYmVmb3JlLmxlbmd0aCAtIGJlZm9yZUlkeCwgW10pO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgY29uc3QgYmVmb3JlRWxlbWVudCA9IGJlZm9yZVtiZWZvcmVJZHhdO1xyXG4gICAgICAgICAgICBjb25zdCBhZnRlckVsZW1lbnQgPSBhZnRlclthZnRlcklkeF07XHJcbiAgICAgICAgICAgIGNvbnN0IG4gPSBjb21wYXJlKGJlZm9yZUVsZW1lbnQsIGFmdGVyRWxlbWVudCk7XHJcbiAgICAgICAgICAgIGlmIChuID09PSAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBlcXVhbFxyXG4gICAgICAgICAgICAgICAgYmVmb3JlSWR4ICs9IDE7XHJcbiAgICAgICAgICAgICAgICBhZnRlcklkeCArPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG4gPCAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBiZWZvcmVFbGVtZW50IGlzIHNtYWxsZXIgLT4gYmVmb3JlIGVsZW1lbnQgcmVtb3ZlZFxyXG4gICAgICAgICAgICAgICAgcHVzaFNwbGljZShiZWZvcmVJZHgsIDEsIFtdKTtcclxuICAgICAgICAgICAgICAgIGJlZm9yZUlkeCArPSAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKG4gPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAvLyBiZWZvcmVFbGVtZW50IGlzIGdyZWF0ZXIgLT4gYWZ0ZXIgZWxlbWVudCBhZGRlZFxyXG4gICAgICAgICAgICAgICAgcHVzaFNwbGljZShiZWZvcmVJZHgsIDAsIFthZnRlckVsZW1lbnRdKTtcclxuICAgICAgICAgICAgICAgIGFmdGVySWR4ICs9IDE7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuc29ydGVkRGlmZiA9IHNvcnRlZERpZmY7XHJcbiAgICAvKipcclxuICAgICAqIFRha2VzIHR3byAqc29ydGVkKiBhcnJheXMgYW5kIGNvbXB1dGVzIHRoZWlyIGRlbHRhIChyZW1vdmVkLCBhZGRlZCBlbGVtZW50cykuXHJcbiAgICAgKiBGaW5pc2hlcyBpbiBgTWF0aC5taW4oYmVmb3JlLmxlbmd0aCwgYWZ0ZXIubGVuZ3RoKWAgc3RlcHMuXHJcbiAgICAgKiBAcGFyYW0gYmVmb3JlXHJcbiAgICAgKiBAcGFyYW0gYWZ0ZXJcclxuICAgICAqIEBwYXJhbSBjb21wYXJlXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGRlbHRhKGJlZm9yZSwgYWZ0ZXIsIGNvbXBhcmUpIHtcclxuICAgICAgICBjb25zdCBzcGxpY2VzID0gc29ydGVkRGlmZihiZWZvcmUsIGFmdGVyLCBjb21wYXJlKTtcclxuICAgICAgICBjb25zdCByZW1vdmVkID0gW107XHJcbiAgICAgICAgY29uc3QgYWRkZWQgPSBbXTtcclxuICAgICAgICBmb3IgKGNvbnN0IHNwbGljZSBvZiBzcGxpY2VzKSB7XHJcbiAgICAgICAgICAgIHJlbW92ZWQucHVzaCguLi5iZWZvcmUuc2xpY2Uoc3BsaWNlLnN0YXJ0LCBzcGxpY2Uuc3RhcnQgKyBzcGxpY2UuZGVsZXRlQ291bnQpKTtcclxuICAgICAgICAgICAgYWRkZWQucHVzaCguLi5zcGxpY2UudG9JbnNlcnQpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4geyByZW1vdmVkLCBhZGRlZCB9O1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5kZWx0YSA9IGRlbHRhO1xyXG4gICAgLyoqXHJcbiAgICAgKiBSZXR1cm5zIHRoZSB0b3AgTiBlbGVtZW50cyBmcm9tIHRoZSBhcnJheS5cclxuICAgICAqXHJcbiAgICAgKiBGYXN0ZXIgdGhhbiBzb3J0aW5nIHRoZSBlbnRpcmUgYXJyYXkgd2hlbiB0aGUgYXJyYXkgaXMgYSBsb3QgbGFyZ2VyIHRoYW4gTi5cclxuICAgICAqXHJcbiAgICAgKiBAcGFyYW0gYXJyYXkgVGhlIHVuc29ydGVkIGFycmF5LlxyXG4gICAgICogQHBhcmFtIGNvbXBhcmUgQSBzb3J0IGZ1bmN0aW9uIGZvciB0aGUgZWxlbWVudHMuXHJcbiAgICAgKiBAcGFyYW0gbiBUaGUgbnVtYmVyIG9mIGVsZW1lbnRzIHRvIHJldHVybi5cclxuICAgICAqIEByZXR1cm4gVGhlIGZpcnN0IG4gZWxlbW50cyBmcm9tIGFycmF5IHdoZW4gc29ydGVkIHdpdGggY29tcGFyZS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gdG9wKGFycmF5LCBjb21wYXJlLCBuKSB7XHJcbiAgICAgICAgaWYgKG4gPT09IDApIHtcclxuICAgICAgICAgICAgcmV0dXJuIFtdO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhcnJheS5zbGljZSgwLCBuKS5zb3J0KGNvbXBhcmUpO1xyXG4gICAgICAgIHRvcFN0ZXAoYXJyYXksIGNvbXBhcmUsIHJlc3VsdCwgbiwgYXJyYXkubGVuZ3RoKTtcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy50b3AgPSB0b3A7XHJcbiAgICBmdW5jdGlvbiB0b3BTdGVwKGFycmF5LCBjb21wYXJlLCByZXN1bHQsIGksIG0pIHtcclxuICAgICAgICBmb3IgKGNvbnN0IG4gPSByZXN1bHQubGVuZ3RoOyBpIDwgbTsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSBhcnJheVtpXTtcclxuICAgICAgICAgICAgaWYgKGNvbXBhcmUoZWxlbWVudCwgcmVzdWx0W24gLSAxXSkgPCAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucG9wKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBqID0gZmluZEZpcnN0KHJlc3VsdCwgZSA9PiBjb21wYXJlKGVsZW1lbnQsIGUpIDwgMCk7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQuc3BsaWNlKGosIDAsIGVsZW1lbnQpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgLyoqXHJcbiAgICAgKiBAcmV0dXJucyBhIG5ldyBhcnJheSB3aXRoIGFsbCB1bmRlZmluZWQgb3IgbnVsbCB2YWx1ZXMgcmVtb3ZlZC4gVGhlIG9yaWdpbmFsIGFycmF5IGlzIG5vdCBtb2RpZmllZCBhdCBhbGwuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGNvYWxlc2NlKGFycmF5KSB7XHJcbiAgICAgICAgaWYgKCFhcnJheSkge1xyXG4gICAgICAgICAgICByZXR1cm4gYXJyYXk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcnJheS5maWx0ZXIoZSA9PiAhIWUpO1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5jb2FsZXNjZSA9IGNvYWxlc2NlO1xyXG4gICAgLyoqXHJcbiAgICAgKiBNb3ZlcyB0aGUgZWxlbWVudCBpbiB0aGUgYXJyYXkgZm9yIHRoZSBwcm92aWRlZCBwb3NpdGlvbnMuXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIG1vdmUoYXJyYXksIGZyb20sIHRvKSB7XHJcbiAgICAgICAgYXJyYXkuc3BsaWNlKHRvLCAwLCBhcnJheS5zcGxpY2UoZnJvbSwgMSlbMF0pO1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5tb3ZlID0gbW92ZTtcclxuICAgIC8qKlxyXG4gICAgICogQHJldHVybnMge3tmYWxzZX19IGlmIHRoZSBwcm92aWRlZCBvYmplY3QgaXMgYW4gYXJyYXlcclxuICAgICAqIFx0YW5kIG5vdCBlbXB0eS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaXNGYWxzeU9yRW1wdHkob2JqKSB7XHJcbiAgICAgICAgcmV0dXJuICFBcnJheS5pc0FycmF5KG9iaikgfHwgb2JqLmxlbmd0aCA9PT0gMDtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuaXNGYWxzeU9yRW1wdHkgPSBpc0ZhbHN5T3JFbXB0eTtcclxuICAgIC8qKlxyXG4gICAgICogUmVtb3ZlcyBkdXBsaWNhdGVzIGZyb20gdGhlIGdpdmVuIGFycmF5LiBUaGUgb3B0aW9uYWwga2V5Rm4gYWxsb3dzIHRvIHNwZWNpZnlcclxuICAgICAqIGhvdyBlbGVtZW50cyBhcmUgY2hlY2tlZCBmb3IgZXF1YWxuZXNzIGJ5IHJldHVybmluZyBhIHVuaXF1ZSBzdHJpbmcgZm9yIGVhY2guXHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGRpc3RpbmN0KGFycmF5LCBrZXlGbikge1xyXG4gICAgICAgIGlmICgha2V5Rm4pIHtcclxuICAgICAgICAgICAgcmV0dXJuIGFycmF5LmZpbHRlcigoZWxlbWVudCwgcG9zaXRpb24pID0+IHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhcnJheS5pbmRleE9mKGVsZW1lbnQpID09PSBwb3NpdGlvbjtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNvbnN0IHNlZW4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHJldHVybiBhcnJheS5maWx0ZXIoKGVsZW0pID0+IHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5Rm4oZWxlbSk7XHJcbiAgICAgICAgICAgIGlmIChzZWVuW2tleV0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWVuW2tleV0gPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuZGlzdGluY3QgPSBkaXN0aW5jdDtcclxuICAgIGZ1bmN0aW9uIHVuaXF1ZUZpbHRlcihrZXlGbikge1xyXG4gICAgICAgIGNvbnN0IHNlZW4gPSBPYmplY3QuY3JlYXRlKG51bGwpO1xyXG4gICAgICAgIHJldHVybiBlbGVtZW50ID0+IHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5Rm4oZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGlmIChzZWVuW2tleV0pIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBzZWVuW2tleV0gPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy51bmlxdWVGaWx0ZXIgPSB1bmlxdWVGaWx0ZXI7XHJcbiAgICBmdW5jdGlvbiBmaXJzdEluZGV4KGFycmF5LCBmbikge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3QgZWxlbWVudCA9IGFycmF5W2ldO1xyXG4gICAgICAgICAgICBpZiAoZm4oZWxlbWVudCkpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuZmlyc3RJbmRleCA9IGZpcnN0SW5kZXg7XHJcbiAgICBmdW5jdGlvbiBmaXJzdChhcnJheSwgZm4sIG5vdEZvdW5kVmFsdWUgPSBudWxsKSB7XHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBmaXJzdEluZGV4KGFycmF5LCBmbik7XHJcbiAgICAgICAgcmV0dXJuIGluZGV4IDwgMCA/IG5vdEZvdW5kVmFsdWUgOiBhcnJheVtpbmRleF07XHJcbiAgICB9XHJcbiAgICB2c2NNb2NrQXJyYXlzLmZpcnN0ID0gZmlyc3Q7XHJcbiAgICBmdW5jdGlvbiBjb21tb25QcmVmaXhMZW5ndGgob25lLCBvdGhlciwgZXF1YWxzID0gKGEsIGIpID0+IGEgPT09IGIpIHtcclxuICAgICAgICBsZXQgcmVzdWx0ID0gMDtcclxuICAgICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gTWF0aC5taW4ob25lLmxlbmd0aCwgb3RoZXIubGVuZ3RoKTsgaSA8IGxlbiAmJiBlcXVhbHMob25lW2ldLCBvdGhlcltpXSk7IGkrKykge1xyXG4gICAgICAgICAgICByZXN1bHQrKztcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuY29tbW9uUHJlZml4TGVuZ3RoID0gY29tbW9uUHJlZml4TGVuZ3RoO1xyXG4gICAgZnVuY3Rpb24gZmxhdHRlbihhcnIpIHtcclxuICAgICAgICByZXR1cm4gW10uY29uY2F0KC4uLmFycik7XHJcbiAgICB9XHJcbiAgICB2c2NNb2NrQXJyYXlzLmZsYXR0ZW4gPSBmbGF0dGVuO1xyXG4gICAgZnVuY3Rpb24gcmFuZ2UoYXJnLCB0bykge1xyXG4gICAgICAgIGxldCBmcm9tID0gdHlwZW9mIHRvID09PSAnbnVtYmVyJyA/IGFyZyA6IDA7XHJcbiAgICAgICAgaWYgKHR5cGVvZiB0byA9PT0gJ251bWJlcicpIHtcclxuICAgICAgICAgICAgZnJvbSA9IGFyZztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGZyb20gPSAwO1xyXG4gICAgICAgICAgICB0byA9IGFyZztcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gW107XHJcbiAgICAgICAgaWYgKGZyb20gPD0gdG8pIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGZyb207IGkgPCB0bzsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IGZyb207IGkgPiB0bzsgaS0tKSB7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaChpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5yYW5nZSA9IHJhbmdlO1xyXG4gICAgZnVuY3Rpb24gZmlsbChudW0sIHZhbHVlRm4sIGFyciA9IFtdKSB7XHJcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBudW07IGkrKykge1xyXG4gICAgICAgICAgICBhcnJbaV0gPSB2YWx1ZUZuKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBhcnI7XHJcbiAgICB9XHJcbiAgICB2c2NNb2NrQXJyYXlzLmZpbGwgPSBmaWxsO1xyXG4gICAgZnVuY3Rpb24gaW5kZXgoYXJyYXksIGluZGV4ZXIsIG1lcmdlciA9IHQgPT4gdCkge1xyXG4gICAgICAgIHJldHVybiBhcnJheS5yZWR1Y2UoKHIsIHQpID0+IHtcclxuICAgICAgICAgICAgY29uc3Qga2V5ID0gaW5kZXhlcih0KTtcclxuICAgICAgICAgICAgcltrZXldID0gbWVyZ2VyKHQsIHJba2V5XSk7XHJcbiAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgIH0sIE9iamVjdC5jcmVhdGUobnVsbCkpO1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5pbmRleCA9IGluZGV4O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnNlcnRzIGFuIGVsZW1lbnQgaW50byBhbiBhcnJheS4gUmV0dXJucyBhIGZ1bmN0aW9uIHdoaWNoLCB3aGVuXHJcbiAgICAgKiBjYWxsZWQsIHdpbGwgcmVtb3ZlIHRoYXQgZWxlbWVudCBmcm9tIHRoZSBhcnJheS5cclxuICAgICAqL1xyXG4gICAgZnVuY3Rpb24gaW5zZXJ0KGFycmF5LCBlbGVtZW50KSB7XHJcbiAgICAgICAgYXJyYXkucHVzaChlbGVtZW50KTtcclxuICAgICAgICByZXR1cm4gKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCBpbmRleCA9IGFycmF5LmluZGV4T2YoZWxlbWVudCk7XHJcbiAgICAgICAgICAgIGlmIChpbmRleCA+IC0xKSB7XHJcbiAgICAgICAgICAgICAgICBhcnJheS5zcGxpY2UoaW5kZXgsIDEpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuICAgIHZzY01vY2tBcnJheXMuaW5zZXJ0ID0gaW5zZXJ0O1xyXG4gICAgLyoqXHJcbiAgICAgKiBJbnNlcnQgYGluc2VydEFycmAgaW5zaWRlIGB0YXJnZXRgIGF0IGBpbnNlcnRJbmRleGAuXHJcbiAgICAgKiBQbGVhc2UgZG9uJ3QgdG91Y2ggdW5sZXNzIHlvdSB1bmRlcnN0YW5kIGh0dHBzOi8vanNwZXJmLmNvbS9pbnNlcnRpbmctYW4tYXJyYXktd2l0aGluLWFuLWFycmF5XHJcbiAgICAgKi9cclxuICAgIGZ1bmN0aW9uIGFycmF5SW5zZXJ0KHRhcmdldCwgaW5zZXJ0SW5kZXgsIGluc2VydEFycikge1xyXG4gICAgICAgIGNvbnN0IGJlZm9yZSA9IHRhcmdldC5zbGljZSgwLCBpbnNlcnRJbmRleCk7XHJcbiAgICAgICAgY29uc3QgYWZ0ZXIgPSB0YXJnZXQuc2xpY2UoaW5zZXJ0SW5kZXgpO1xyXG4gICAgICAgIHJldHVybiBiZWZvcmUuY29uY2F0KGluc2VydEFyciwgYWZ0ZXIpO1xyXG4gICAgfVxyXG4gICAgdnNjTW9ja0FycmF5cy5hcnJheUluc2VydCA9IGFycmF5SW5zZXJ0O1xyXG59KSh2c2NNb2NrQXJyYXlzID0gZXhwb3J0cy52c2NNb2NrQXJyYXlzIHx8IChleHBvcnRzLnZzY01vY2tBcnJheXMgPSB7fSkpO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcnJheXMuanMubWFwIl19