// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:no-any

const chai_1 = require("chai");

const path = require("path");

const TypeMoq = require("typemoq");

const vscode_1 = require("vscode");

const types_1 = require("../../../client/common/application/types");

const types_2 = require("../../../client/common/platform/types");

const types_3 = require("../../../client/common/process/types");

const types_4 = require("../../../client/common/terminal/types");

const types_5 = require("../../../client/common/types");

const contracts_1 = require("../../../client/interpreter/contracts");

const virtualEnvs_1 = require("../../../client/interpreter/virtualEnvs"); // tslint:disable-next-line:max-func-body-length


suite('Virtual Environment Manager', () => {
  let process;
  let processService;
  let pathUtils;
  let virtualEnvMgr;
  let fs;
  let workspace;
  let pipEnvService;
  let terminalActivation;
  let platformService;
  setup(() => {
    const serviceContainer = TypeMoq.Mock.ofType();
    process = TypeMoq.Mock.ofType();
    processService = TypeMoq.Mock.ofType();
    const processFactory = TypeMoq.Mock.ofType();
    pathUtils = TypeMoq.Mock.ofType();
    fs = TypeMoq.Mock.ofType();
    workspace = TypeMoq.Mock.ofType();
    pipEnvService = TypeMoq.Mock.ofType();
    terminalActivation = TypeMoq.Mock.ofType();
    platformService = TypeMoq.Mock.ofType();
    processService.setup(p => p.then).returns(() => undefined);
    processFactory.setup(p => p.create(TypeMoq.It.isAny())).returns(() => Promise.resolve(processService.object));
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_3.IProcessServiceFactory))).returns(() => processFactory.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_5.ICurrentProcess))).returns(() => process.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_5.IPathUtils))).returns(() => pathUtils.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_2.IFileSystem))).returns(() => fs.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_1.IWorkspaceService))).returns(() => workspace.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(contracts_1.IPipEnvService))).returns(() => pipEnvService.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_4.ITerminalActivationCommandProvider), TypeMoq.It.isAny())).returns(() => terminalActivation.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_2.IPlatformService), TypeMoq.It.isAny())).returns(() => platformService.object);
    virtualEnvMgr = new virtualEnvs_1.VirtualEnvironmentManager(serviceContainer.object);
  });
  test('Get PyEnv Root from PYENV_ROOT', () => __awaiter(void 0, void 0, void 0, function* () {
    process.setup(p => p.env).returns(() => {
      return {
        PYENV_ROOT: 'yes'
      };
    }).verifiable(TypeMoq.Times.once());
    const pyenvRoot = yield virtualEnvMgr.getPyEnvRoot();
    process.verifyAll();
    chai_1.expect(pyenvRoot).to.equal('yes');
  }));
  test('Get PyEnv Root from current PYENV_ROOT', () => __awaiter(void 0, void 0, void 0, function* () {
    process.setup(p => p.env).returns(() => {
      return {};
    }).verifiable(TypeMoq.Times.once());
    processService.setup(p => p.exec(TypeMoq.It.isValue('pyenv'), TypeMoq.It.isValue(['root']))).returns(() => Promise.resolve({
      stdout: 'PROC'
    })).verifiable(TypeMoq.Times.once());
    const pyenvRoot = yield virtualEnvMgr.getPyEnvRoot();
    process.verifyAll();
    processService.verifyAll();
    chai_1.expect(pyenvRoot).to.equal('PROC');
  }));
  test('Get default PyEnv Root path', () => __awaiter(void 0, void 0, void 0, function* () {
    process.setup(p => p.env).returns(() => {
      return {};
    }).verifiable(TypeMoq.Times.once());
    processService.setup(p => p.exec(TypeMoq.It.isValue('pyenv'), TypeMoq.It.isValue(['root']))).returns(() => Promise.resolve({
      stdout: '',
      stderr: 'err'
    })).verifiable(TypeMoq.Times.once());
    pathUtils.setup(p => p.home).returns(() => 'HOME').verifiable(TypeMoq.Times.once());
    const pyenvRoot = yield virtualEnvMgr.getPyEnvRoot();
    process.verifyAll();
    processService.verifyAll();
    chai_1.expect(pyenvRoot).to.equal(path.join('HOME', '.pyenv'));
  }));
  test('Get Environment Type, detects venv', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('a', 'b', 'c', 'python');
    const dir = path.dirname(pythonPath);
    fs.setup(f => f.fileExists(TypeMoq.It.isValue(path.join(dir, 'pyvenv.cfg')))).returns(() => Promise.resolve(true)).verifiable(TypeMoq.Times.once());
    const isRecognized = yield virtualEnvMgr.isVenvEnvironment(pythonPath);
    chai_1.expect(isRecognized).to.be.equal(true, 'invalid value');
    fs.verifyAll();
  }));
  test('Get Environment Type, does not detect venv incorrectly', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('a', 'b', 'c', 'python');
    const dir = path.dirname(pythonPath);
    fs.setup(f => f.fileExists(TypeMoq.It.isValue(path.join(dir, 'pyvenv.cfg')))).returns(() => Promise.resolve(false)).verifiable(TypeMoq.Times.once());
    const isRecognized = yield virtualEnvMgr.isVenvEnvironment(pythonPath);
    chai_1.expect(isRecognized).to.be.equal(false, 'invalid value');
    fs.verifyAll();
  }));
  test('Get Environment Type, detects pyenv', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('py-env-root', 'b', 'c', 'python');
    process.setup(p => p.env).returns(() => {
      return {
        PYENV_ROOT: path.join('py-env-root', 'b')
      };
    }).verifiable(TypeMoq.Times.once());
    const isRecognized = yield virtualEnvMgr.isPyEnvEnvironment(pythonPath);
    chai_1.expect(isRecognized).to.be.equal(true, 'invalid value');
    process.verifyAll();
  }));
  test('Get Environment Type, does not detect pyenv incorrectly', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('a', 'b', 'c', 'python');
    process.setup(p => p.env).returns(() => {
      return {
        PYENV_ROOT: path.join('py-env-root', 'b')
      };
    }).verifiable(TypeMoq.Times.once());
    const isRecognized = yield virtualEnvMgr.isPyEnvEnvironment(pythonPath);
    chai_1.expect(isRecognized).to.be.equal(false, 'invalid value');
    process.verifyAll();
  }));
  test('Get Environment Type, detects pipenv', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('x', 'b', 'c', 'python');
    workspace.setup(w => w.hasWorkspaceFolders).returns(() => true).verifiable(TypeMoq.Times.atLeastOnce());
    const ws = [{
      uri: vscode_1.Uri.file('x')
    }];
    workspace.setup(w => w.workspaceFolders).returns(() => ws).verifiable(TypeMoq.Times.atLeastOnce());
    pipEnvService.setup(p => p.isRelatedPipEnvironment(TypeMoq.It.isAny(), TypeMoq.It.isValue(pythonPath))).returns(() => Promise.resolve(true)).verifiable(TypeMoq.Times.once());
    const isRecognized = yield virtualEnvMgr.isPipEnvironment(pythonPath);
    chai_1.expect(isRecognized).to.be.equal(true, 'invalid value');
    workspace.verifyAll();
    pipEnvService.verifyAll();
  }));
  test('Get Environment Type, does not detect pipenv incorrectly', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('x', 'b', 'c', 'python');
    workspace.setup(w => w.hasWorkspaceFolders).returns(() => true).verifiable(TypeMoq.Times.atLeastOnce());
    const ws = [{
      uri: vscode_1.Uri.file('x')
    }];
    workspace.setup(w => w.workspaceFolders).returns(() => ws).verifiable(TypeMoq.Times.atLeastOnce());
    pipEnvService.setup(p => p.isRelatedPipEnvironment(TypeMoq.It.isAny(), TypeMoq.It.isValue(pythonPath))).returns(() => Promise.resolve(false)).verifiable(TypeMoq.Times.once());
    const isRecognized = yield virtualEnvMgr.isPipEnvironment(pythonPath);
    chai_1.expect(isRecognized).to.be.equal(false, 'invalid value');
    workspace.verifyAll();
    pipEnvService.verifyAll();
  }));

  for (const isWindows of [true, false]) {
    const testTitleSuffix = `(${isWindows ? 'On Windows' : 'Non-Windows'}})`;
    test(`Get Environment Type, detects virtualenv ${testTitleSuffix}`, () => __awaiter(void 0, void 0, void 0, function* () {
      const pythonPath = path.join('x', 'b', 'c', 'python');
      terminalActivation.setup(t => t.isShellSupported(TypeMoq.It.isAny())).returns(() => true).verifiable(TypeMoq.Times.atLeastOnce());
      terminalActivation.setup(t => t.getActivationCommandsForInterpreter(TypeMoq.It.isValue(pythonPath), TypeMoq.It.isAny())).returns(() => Promise.resolve(['1'])).verifiable(TypeMoq.Times.atLeastOnce());
      const isRecognized = yield virtualEnvMgr.isVirtualEnvironment(pythonPath);
      chai_1.expect(isRecognized).to.be.equal(true, 'invalid value');
      terminalActivation.verifyAll();
    }));
    test(`Get Environment Type, does not detect virtualenv incorrectly ${testTitleSuffix}`, () => __awaiter(void 0, void 0, void 0, function* () {
      const pythonPath = path.join('x', 'b', 'c', 'python');
      terminalActivation.setup(t => t.isShellSupported(TypeMoq.It.isAny())).returns(() => true).verifiable(TypeMoq.Times.atLeastOnce());
      terminalActivation.setup(t => t.getActivationCommandsForInterpreter(TypeMoq.It.isValue(pythonPath), TypeMoq.It.isAny())).returns(() => Promise.resolve([])).verifiable(TypeMoq.Times.atLeastOnce());
      let isRecognized = yield virtualEnvMgr.isVirtualEnvironment(pythonPath);
      chai_1.expect(isRecognized).to.be.equal(false, 'invalid value');
      terminalActivation.verifyAll();
      terminalActivation.reset();
      terminalActivation.setup(t => t.isShellSupported(TypeMoq.It.isAny())).returns(() => false).verifiable(TypeMoq.Times.atLeastOnce());
      terminalActivation.setup(t => t.getActivationCommandsForInterpreter(TypeMoq.It.isValue(pythonPath), TypeMoq.It.isAny())).returns(() => Promise.resolve([])).verifiable(TypeMoq.Times.never());
      isRecognized = yield virtualEnvMgr.isVirtualEnvironment(pythonPath);
      chai_1.expect(isRecognized).to.be.equal(false, 'invalid value');
      terminalActivation.verifyAll();
    }));
  }

  test('Get Environment Type, does not detect the type', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = path.join('x', 'b', 'c', 'python');

    virtualEnvMgr.isPipEnvironment = () => Promise.resolve(false);

    virtualEnvMgr.isPyEnvEnvironment = () => Promise.resolve(false);

    virtualEnvMgr.isVenvEnvironment = () => Promise.resolve(false);

    virtualEnvMgr.isVirtualEnvironment = () => Promise.resolve(false);

    const envType = yield virtualEnvMgr.getEnvironmentType(pythonPath);
    chai_1.expect(envType).to.be.equal(contracts_1.InterpreterType.Unknown);
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImluZGV4LnVuaXQudGVzdC5qcyJdLCJuYW1lcyI6WyJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwiY2hhaV8xIiwicmVxdWlyZSIsInBhdGgiLCJUeXBlTW9xIiwidnNjb2RlXzEiLCJ0eXBlc18xIiwidHlwZXNfMiIsInR5cGVzXzMiLCJ0eXBlc180IiwidHlwZXNfNSIsImNvbnRyYWN0c18xIiwidmlydHVhbEVudnNfMSIsInN1aXRlIiwicHJvY2VzcyIsInByb2Nlc3NTZXJ2aWNlIiwicGF0aFV0aWxzIiwidmlydHVhbEVudk1nciIsImZzIiwid29ya3NwYWNlIiwicGlwRW52U2VydmljZSIsInRlcm1pbmFsQWN0aXZhdGlvbiIsInBsYXRmb3JtU2VydmljZSIsInNldHVwIiwic2VydmljZUNvbnRhaW5lciIsIk1vY2siLCJvZlR5cGUiLCJwcm9jZXNzRmFjdG9yeSIsInAiLCJyZXR1cm5zIiwidW5kZWZpbmVkIiwiY3JlYXRlIiwiSXQiLCJpc0FueSIsIm9iamVjdCIsImMiLCJnZXQiLCJpc1ZhbHVlIiwiSVByb2Nlc3NTZXJ2aWNlRmFjdG9yeSIsIklDdXJyZW50UHJvY2VzcyIsIklQYXRoVXRpbHMiLCJJRmlsZVN5c3RlbSIsIklXb3Jrc3BhY2VTZXJ2aWNlIiwiSVBpcEVudlNlcnZpY2UiLCJJVGVybWluYWxBY3RpdmF0aW9uQ29tbWFuZFByb3ZpZGVyIiwiSVBsYXRmb3JtU2VydmljZSIsIlZpcnR1YWxFbnZpcm9ubWVudE1hbmFnZXIiLCJ0ZXN0IiwiZW52IiwiUFlFTlZfUk9PVCIsInZlcmlmaWFibGUiLCJUaW1lcyIsIm9uY2UiLCJweWVudlJvb3QiLCJnZXRQeUVudlJvb3QiLCJ2ZXJpZnlBbGwiLCJleHBlY3QiLCJ0byIsImVxdWFsIiwiZXhlYyIsInN0ZG91dCIsInN0ZGVyciIsImhvbWUiLCJqb2luIiwicHl0aG9uUGF0aCIsImRpciIsImRpcm5hbWUiLCJmIiwiZmlsZUV4aXN0cyIsImlzUmVjb2duaXplZCIsImlzVmVudkVudmlyb25tZW50IiwiYmUiLCJpc1B5RW52RW52aXJvbm1lbnQiLCJ3IiwiaGFzV29ya3NwYWNlRm9sZGVycyIsImF0TGVhc3RPbmNlIiwid3MiLCJ1cmkiLCJVcmkiLCJmaWxlIiwid29ya3NwYWNlRm9sZGVycyIsImlzUmVsYXRlZFBpcEVudmlyb25tZW50IiwiaXNQaXBFbnZpcm9ubWVudCIsImlzV2luZG93cyIsInRlc3RUaXRsZVN1ZmZpeCIsInQiLCJpc1NoZWxsU3VwcG9ydGVkIiwiZ2V0QWN0aXZhdGlvbkNvbW1hbmRzRm9ySW50ZXJwcmV0ZXIiLCJpc1ZpcnR1YWxFbnZpcm9ubWVudCIsInJlc2V0IiwibmV2ZXIiLCJlbnZUeXBlIiwiZ2V0RW52aXJvbm1lbnRUeXBlIiwiSW50ZXJwcmV0ZXJUeXBlIiwiVW5rbm93biJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFKO0FBQThCLE9BQXBDLENBQXFDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQs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N0IsQ0FBbUMvQyxXQUFXLENBQUNrRixlQUFaLENBQTRCQyxPQUEvRDtBQUNILEdBUnFFLENBQWxFLENBQUo7QUFTSCxDQWhOSSxDQUFMIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuJ3VzZSBzdHJpY3QnO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbi8vIHRzbGludDpkaXNhYmxlOm5vLWFueVxyXG5jb25zdCBjaGFpXzEgPSByZXF1aXJlKFwiY2hhaVwiKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xyXG5jb25zdCBUeXBlTW9xID0gcmVxdWlyZShcInR5cGVtb3FcIik7XHJcbmNvbnN0IHZzY29kZV8xID0gcmVxdWlyZShcInZzY29kZVwiKTtcclxuY29uc3QgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL2FwcGxpY2F0aW9uL3R5cGVzXCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vcGxhdGZvcm0vdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzMgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2NvbW1vbi9wcm9jZXNzL3R5cGVzXCIpO1xyXG5jb25zdCB0eXBlc180ID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vdGVybWluYWwvdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzUgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2NvbW1vbi90eXBlc1wiKTtcclxuY29uc3QgY29udHJhY3RzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2ludGVycHJldGVyL2NvbnRyYWN0c1wiKTtcclxuY29uc3QgdmlydHVhbEVudnNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvaW50ZXJwcmV0ZXIvdmlydHVhbEVudnNcIik7XHJcbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTptYXgtZnVuYy1ib2R5LWxlbmd0aFxyXG5zdWl0ZSgnVmlydHVhbCBFbnZpcm9ubWVudCBNYW5hZ2VyJywgKCkgPT4ge1xyXG4gICAgbGV0IHByb2Nlc3M7XHJcbiAgICBsZXQgcHJvY2Vzc1NlcnZpY2U7XHJcbiAgICBsZXQgcGF0aFV0aWxzO1xyXG4gICAgbGV0IHZpcnR1YWxFbnZNZ3I7XHJcbiAgICBsZXQgZnM7XHJcbiAgICBsZXQgd29ya3NwYWNlO1xyXG4gICAgbGV0IHBpcEVudlNlcnZpY2U7XHJcbiAgICBsZXQgdGVybWluYWxBY3RpdmF0aW9uO1xyXG4gICAgbGV0IHBsYXRmb3JtU2VydmljZTtcclxuICAgIHNldHVwKCgpID0+IHtcclxuICAgICAgICBjb25zdCBzZXJ2aWNlQ29udGFpbmVyID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHByb2Nlc3MgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgcHJvY2Vzc1NlcnZpY2UgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgY29uc3QgcHJvY2Vzc0ZhY3RvcnkgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgcGF0aFV0aWxzID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGZzID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHdvcmtzcGFjZSA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBwaXBFbnZTZXJ2aWNlID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHRlcm1pbmFsQWN0aXZhdGlvbiA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2UgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgcHJvY2Vzc1NlcnZpY2Uuc2V0dXAocCA9PiBwLnRoZW4pLnJldHVybnMoKCkgPT4gdW5kZWZpbmVkKTtcclxuICAgICAgICBwcm9jZXNzRmFjdG9yeS5zZXR1cChwID0+IHAuY3JlYXRlKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHByb2Nlc3NTZXJ2aWNlLm9iamVjdCkpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMy5JUHJvY2Vzc1NlcnZpY2VGYWN0b3J5KSkpLnJldHVybnMoKCkgPT4gcHJvY2Vzc0ZhY3Rvcnkub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzUuSUN1cnJlbnRQcm9jZXNzKSkpLnJldHVybnMoKCkgPT4gcHJvY2Vzcy5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfNS5JUGF0aFV0aWxzKSkpLnJldHVybnMoKCkgPT4gcGF0aFV0aWxzLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KFR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18yLklGaWxlU3lzdGVtKSkpLnJldHVybnMoKCkgPT4gZnMub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzEuSVdvcmtzcGFjZVNlcnZpY2UpKSkucmV0dXJucygoKSA9PiB3b3Jrc3BhY2Uub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKGNvbnRyYWN0c18xLklQaXBFbnZTZXJ2aWNlKSkpLnJldHVybnMoKCkgPT4gcGlwRW52U2VydmljZS5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfNC5JVGVybWluYWxBY3RpdmF0aW9uQ29tbWFuZFByb3ZpZGVyKSwgVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiB0ZXJtaW5hbEFjdGl2YXRpb24ub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzIuSVBsYXRmb3JtU2VydmljZSksIFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gcGxhdGZvcm1TZXJ2aWNlLm9iamVjdCk7XHJcbiAgICAgICAgdmlydHVhbEVudk1nciA9IG5ldyB2aXJ0dWFsRW52c18xLlZpcnR1YWxFbnZpcm9ubWVudE1hbmFnZXIoc2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdHZXQgUHlFbnYgUm9vdCBmcm9tIFBZRU5WX1JPT1QnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgcHJvY2Vzc1xyXG4gICAgICAgICAgICAuc2V0dXAocCA9PiBwLmVudilcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4geyByZXR1cm4geyBQWUVOVl9ST09UOiAneWVzJyB9OyB9KVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgcHllbnZSb290ID0geWllbGQgdmlydHVhbEVudk1nci5nZXRQeUVudlJvb3QoKTtcclxuICAgICAgICBwcm9jZXNzLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QocHllbnZSb290KS50by5lcXVhbCgneWVzJyk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdHZXQgUHlFbnYgUm9vdCBmcm9tIGN1cnJlbnQgUFlFTlZfUk9PVCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBwcm9jZXNzXHJcbiAgICAgICAgICAgIC5zZXR1cChwID0+IHAuZW52KVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiB7IHJldHVybiB7fTsgfSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIHByb2Nlc3NTZXJ2aWNlXHJcbiAgICAgICAgICAgIC5zZXR1cChwID0+IHAuZXhlYyhUeXBlTW9xLkl0LmlzVmFsdWUoJ3B5ZW52JyksIFR5cGVNb3EuSXQuaXNWYWx1ZShbJ3Jvb3QnXSkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdGRvdXQ6ICdQUk9DJyB9KSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IHB5ZW52Um9vdCA9IHlpZWxkIHZpcnR1YWxFbnZNZ3IuZ2V0UHlFbnZSb290KCk7XHJcbiAgICAgICAgcHJvY2Vzcy52ZXJpZnlBbGwoKTtcclxuICAgICAgICBwcm9jZXNzU2VydmljZS52ZXJpZnlBbGwoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHB5ZW52Um9vdCkudG8uZXF1YWwoJ1BST0MnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0dldCBkZWZhdWx0IFB5RW52IFJvb3QgcGF0aCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBwcm9jZXNzXHJcbiAgICAgICAgICAgIC5zZXR1cChwID0+IHAuZW52KVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiB7IHJldHVybiB7fTsgfSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIHByb2Nlc3NTZXJ2aWNlXHJcbiAgICAgICAgICAgIC5zZXR1cChwID0+IHAuZXhlYyhUeXBlTW9xLkl0LmlzVmFsdWUoJ3B5ZW52JyksIFR5cGVNb3EuSXQuaXNWYWx1ZShbJ3Jvb3QnXSkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUoeyBzdGRvdXQ6ICcnLCBzdGRlcnI6ICdlcnInIH0pKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgcGF0aFV0aWxzXHJcbiAgICAgICAgICAgIC5zZXR1cChwID0+IHAuaG9tZSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gJ0hPTUUnKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgcHllbnZSb290ID0geWllbGQgdmlydHVhbEVudk1nci5nZXRQeUVudlJvb3QoKTtcclxuICAgICAgICBwcm9jZXNzLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIHByb2Nlc3NTZXJ2aWNlLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QocHllbnZSb290KS50by5lcXVhbChwYXRoLmpvaW4oJ0hPTUUnLCAnLnB5ZW52JykpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnR2V0IEVudmlyb25tZW50IFR5cGUsIGRldGVjdHMgdmVudicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCdhJywgJ2InLCAnYycsICdweXRob24nKTtcclxuICAgICAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgZnMuc2V0dXAoZiA9PiBmLmZpbGVFeGlzdHMoVHlwZU1vcS5JdC5pc1ZhbHVlKHBhdGguam9pbihkaXIsICdweXZlbnYuY2ZnJykpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHRydWUpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgaXNSZWNvZ25pemVkID0geWllbGQgdmlydHVhbEVudk1nci5pc1ZlbnZFbnZpcm9ubWVudChweXRob25QYXRoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzUmVjb2duaXplZCkudG8uYmUuZXF1YWwodHJ1ZSwgJ2ludmFsaWQgdmFsdWUnKTtcclxuICAgICAgICBmcy52ZXJpZnlBbGwoKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0dldCBFbnZpcm9ubWVudCBUeXBlLCBkb2VzIG5vdCBkZXRlY3QgdmVudiBpbmNvcnJlY3RseScsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCdhJywgJ2InLCAnYycsICdweXRob24nKTtcclxuICAgICAgICBjb25zdCBkaXIgPSBwYXRoLmRpcm5hbWUocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgZnMuc2V0dXAoZiA9PiBmLmZpbGVFeGlzdHMoVHlwZU1vcS5JdC5pc1ZhbHVlKHBhdGguam9pbihkaXIsICdweXZlbnYuY2ZnJykpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IGlzUmVjb2duaXplZCA9IHlpZWxkIHZpcnR1YWxFbnZNZ3IuaXNWZW52RW52aXJvbm1lbnQocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc1JlY29nbml6ZWQpLnRvLmJlLmVxdWFsKGZhbHNlLCAnaW52YWxpZCB2YWx1ZScpO1xyXG4gICAgICAgIGZzLnZlcmlmeUFsbCgpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnR2V0IEVudmlyb25tZW50IFR5cGUsIGRldGVjdHMgcHllbnYnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IHBhdGguam9pbigncHktZW52LXJvb3QnLCAnYicsICdjJywgJ3B5dGhvbicpO1xyXG4gICAgICAgIHByb2Nlc3Muc2V0dXAocCA9PiBwLmVudilcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4ge1xyXG4gICAgICAgICAgICByZXR1cm4geyBQWUVOVl9ST09UOiBwYXRoLmpvaW4oJ3B5LWVudi1yb290JywgJ2InKSB9O1xyXG4gICAgICAgIH0pXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICBjb25zdCBpc1JlY29nbml6ZWQgPSB5aWVsZCB2aXJ0dWFsRW52TWdyLmlzUHlFbnZFbnZpcm9ubWVudChweXRob25QYXRoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzUmVjb2duaXplZCkudG8uYmUuZXF1YWwodHJ1ZSwgJ2ludmFsaWQgdmFsdWUnKTtcclxuICAgICAgICBwcm9jZXNzLnZlcmlmeUFsbCgpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnR2V0IEVudmlyb25tZW50IFR5cGUsIGRvZXMgbm90IGRldGVjdCBweWVudiBpbmNvcnJlY3RseScsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCdhJywgJ2InLCAnYycsICdweXRob24nKTtcclxuICAgICAgICBwcm9jZXNzLnNldHVwKHAgPT4gcC5lbnYpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgUFlFTlZfUk9PVDogcGF0aC5qb2luKCdweS1lbnYtcm9vdCcsICdiJykgfTtcclxuICAgICAgICB9KVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgaXNSZWNvZ25pemVkID0geWllbGQgdmlydHVhbEVudk1nci5pc1B5RW52RW52aXJvbm1lbnQocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc1JlY29nbml6ZWQpLnRvLmJlLmVxdWFsKGZhbHNlLCAnaW52YWxpZCB2YWx1ZScpO1xyXG4gICAgICAgIHByb2Nlc3MudmVyaWZ5QWxsKCk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdHZXQgRW52aXJvbm1lbnQgVHlwZSwgZGV0ZWN0cyBwaXBlbnYnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IHBhdGguam9pbigneCcsICdiJywgJ2MnLCAncHl0aG9uJyk7XHJcbiAgICAgICAgd29ya3NwYWNlXHJcbiAgICAgICAgICAgIC5zZXR1cCh3ID0+IHcuaGFzV29ya3NwYWNlRm9sZGVycylcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gdHJ1ZSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5hdExlYXN0T25jZSgpKTtcclxuICAgICAgICBjb25zdCB3cyA9IFt7IHVyaTogdnNjb2RlXzEuVXJpLmZpbGUoJ3gnKSB9XTtcclxuICAgICAgICB3b3Jrc3BhY2VcclxuICAgICAgICAgICAgLnNldHVwKHcgPT4gdy53b3Jrc3BhY2VGb2xkZXJzKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiB3cylcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5hdExlYXN0T25jZSgpKTtcclxuICAgICAgICBwaXBFbnZTZXJ2aWNlXHJcbiAgICAgICAgICAgIC5zZXR1cChwID0+IHAuaXNSZWxhdGVkUGlwRW52aXJvbm1lbnQoVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzVmFsdWUocHl0aG9uUGF0aCkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodHJ1ZSkpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICBjb25zdCBpc1JlY29nbml6ZWQgPSB5aWVsZCB2aXJ0dWFsRW52TWdyLmlzUGlwRW52aXJvbm1lbnQocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc1JlY29nbml6ZWQpLnRvLmJlLmVxdWFsKHRydWUsICdpbnZhbGlkIHZhbHVlJyk7XHJcbiAgICAgICAgd29ya3NwYWNlLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIHBpcEVudlNlcnZpY2UudmVyaWZ5QWxsKCk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdHZXQgRW52aXJvbm1lbnQgVHlwZSwgZG9lcyBub3QgZGV0ZWN0IHBpcGVudiBpbmNvcnJlY3RseScsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCd4JywgJ2InLCAnYycsICdweXRob24nKTtcclxuICAgICAgICB3b3Jrc3BhY2VcclxuICAgICAgICAgICAgLnNldHVwKHcgPT4gdy5oYXNXb3Jrc3BhY2VGb2xkZXJzKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiB0cnVlKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IHdzID0gW3sgdXJpOiB2c2NvZGVfMS5VcmkuZmlsZSgneCcpIH1dO1xyXG4gICAgICAgIHdvcmtzcGFjZVxyXG4gICAgICAgICAgICAuc2V0dXAodyA9PiB3LndvcmtzcGFjZUZvbGRlcnMpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IHdzKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgIHBpcEVudlNlcnZpY2VcclxuICAgICAgICAgICAgLnNldHVwKHAgPT4gcC5pc1JlbGF0ZWRQaXBFbnZpcm9ubWVudChUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNWYWx1ZShweXRob25QYXRoKSkpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IFByb21pc2UucmVzb2x2ZShmYWxzZSkpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICBjb25zdCBpc1JlY29nbml6ZWQgPSB5aWVsZCB2aXJ0dWFsRW52TWdyLmlzUGlwRW52aXJvbm1lbnQocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc1JlY29nbml6ZWQpLnRvLmJlLmVxdWFsKGZhbHNlLCAnaW52YWxpZCB2YWx1ZScpO1xyXG4gICAgICAgIHdvcmtzcGFjZS52ZXJpZnlBbGwoKTtcclxuICAgICAgICBwaXBFbnZTZXJ2aWNlLnZlcmlmeUFsbCgpO1xyXG4gICAgfSkpO1xyXG4gICAgZm9yIChjb25zdCBpc1dpbmRvd3Mgb2YgW3RydWUsIGZhbHNlXSkge1xyXG4gICAgICAgIGNvbnN0IHRlc3RUaXRsZVN1ZmZpeCA9IGAoJHtpc1dpbmRvd3MgPyAnT24gV2luZG93cycgOiAnTm9uLVdpbmRvd3MnfX0pYDtcclxuICAgICAgICB0ZXN0KGBHZXQgRW52aXJvbm1lbnQgVHlwZSwgZGV0ZWN0cyB2aXJ0dWFsZW52ICR7dGVzdFRpdGxlU3VmZml4fWAsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IHBhdGguam9pbigneCcsICdiJywgJ2MnLCAncHl0aG9uJyk7XHJcbiAgICAgICAgICAgIHRlcm1pbmFsQWN0aXZhdGlvblxyXG4gICAgICAgICAgICAgICAgLnNldHVwKHQgPT4gdC5pc1NoZWxsU3VwcG9ydGVkKFR5cGVNb3EuSXQuaXNBbnkoKSkpXHJcbiAgICAgICAgICAgICAgICAucmV0dXJucygoKSA9PiB0cnVlKVxyXG4gICAgICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5hdExlYXN0T25jZSgpKTtcclxuICAgICAgICAgICAgdGVybWluYWxBY3RpdmF0aW9uXHJcbiAgICAgICAgICAgICAgICAuc2V0dXAodCA9PiB0LmdldEFjdGl2YXRpb25Db21tYW5kc0ZvckludGVycHJldGVyKFR5cGVNb3EuSXQuaXNWYWx1ZShweXRob25QYXRoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IFByb21pc2UucmVzb2x2ZShbJzEnXSkpXHJcbiAgICAgICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgICAgICBjb25zdCBpc1JlY29nbml6ZWQgPSB5aWVsZCB2aXJ0dWFsRW52TWdyLmlzVmlydHVhbEVudmlyb25tZW50KHB5dGhvblBhdGgpO1xyXG4gICAgICAgICAgICBjaGFpXzEuZXhwZWN0KGlzUmVjb2duaXplZCkudG8uYmUuZXF1YWwodHJ1ZSwgJ2ludmFsaWQgdmFsdWUnKTtcclxuICAgICAgICAgICAgdGVybWluYWxBY3RpdmF0aW9uLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB0ZXN0KGBHZXQgRW52aXJvbm1lbnQgVHlwZSwgZG9lcyBub3QgZGV0ZWN0IHZpcnR1YWxlbnYgaW5jb3JyZWN0bHkgJHt0ZXN0VGl0bGVTdWZmaXh9YCwgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCd4JywgJ2InLCAnYycsICdweXRob24nKTtcclxuICAgICAgICAgICAgdGVybWluYWxBY3RpdmF0aW9uXHJcbiAgICAgICAgICAgICAgICAuc2V0dXAodCA9PiB0LmlzU2hlbGxTdXBwb3J0ZWQoVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IHRydWUpXHJcbiAgICAgICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgICAgICB0ZXJtaW5hbEFjdGl2YXRpb25cclxuICAgICAgICAgICAgICAgIC5zZXR1cCh0ID0+IHQuZ2V0QWN0aXZhdGlvbkNvbW1hbmRzRm9ySW50ZXJwcmV0ZXIoVHlwZU1vcS5JdC5pc1ZhbHVlKHB5dGhvblBhdGgpLCBUeXBlTW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKFtdKSlcclxuICAgICAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgICAgIGxldCBpc1JlY29nbml6ZWQgPSB5aWVsZCB2aXJ0dWFsRW52TWdyLmlzVmlydHVhbEVudmlyb25tZW50KHB5dGhvblBhdGgpO1xyXG4gICAgICAgICAgICBjaGFpXzEuZXhwZWN0KGlzUmVjb2duaXplZCkudG8uYmUuZXF1YWwoZmFsc2UsICdpbnZhbGlkIHZhbHVlJyk7XHJcbiAgICAgICAgICAgIHRlcm1pbmFsQWN0aXZhdGlvbi52ZXJpZnlBbGwoKTtcclxuICAgICAgICAgICAgdGVybWluYWxBY3RpdmF0aW9uLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIHRlcm1pbmFsQWN0aXZhdGlvblxyXG4gICAgICAgICAgICAgICAgLnNldHVwKHQgPT4gdC5pc1NoZWxsU3VwcG9ydGVkKFR5cGVNb3EuSXQuaXNBbnkoKSkpXHJcbiAgICAgICAgICAgICAgICAucmV0dXJucygoKSA9PiBmYWxzZSlcclxuICAgICAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgICAgIHRlcm1pbmFsQWN0aXZhdGlvblxyXG4gICAgICAgICAgICAgICAgLnNldHVwKHQgPT4gdC5nZXRBY3RpdmF0aW9uQ29tbWFuZHNGb3JJbnRlcnByZXRlcihUeXBlTW9xLkl0LmlzVmFsdWUocHl0aG9uUGF0aCksIFR5cGVNb3EuSXQuaXNBbnkoKSkpXHJcbiAgICAgICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUoW10pKVxyXG4gICAgICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5uZXZlcigpKTtcclxuICAgICAgICAgICAgaXNSZWNvZ25pemVkID0geWllbGQgdmlydHVhbEVudk1nci5pc1ZpcnR1YWxFbnZpcm9ubWVudChweXRob25QYXRoKTtcclxuICAgICAgICAgICAgY2hhaV8xLmV4cGVjdChpc1JlY29nbml6ZWQpLnRvLmJlLmVxdWFsKGZhbHNlLCAnaW52YWxpZCB2YWx1ZScpO1xyXG4gICAgICAgICAgICB0ZXJtaW5hbEFjdGl2YXRpb24udmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG4gICAgdGVzdCgnR2V0IEVudmlyb25tZW50IFR5cGUsIGRvZXMgbm90IGRldGVjdCB0aGUgdHlwZScsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCd4JywgJ2InLCAnYycsICdweXRob24nKTtcclxuICAgICAgICB2aXJ0dWFsRW52TWdyLmlzUGlwRW52aXJvbm1lbnQgPSAoKSA9PiBQcm9taXNlLnJlc29sdmUoZmFsc2UpO1xyXG4gICAgICAgIHZpcnR1YWxFbnZNZ3IuaXNQeUVudkVudmlyb25tZW50ID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB2aXJ0dWFsRW52TWdyLmlzVmVudkVudmlyb25tZW50ID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICB2aXJ0dWFsRW52TWdyLmlzVmlydHVhbEVudmlyb25tZW50ID0gKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKTtcclxuICAgICAgICBjb25zdCBlbnZUeXBlID0geWllbGQgdmlydHVhbEVudk1nci5nZXRFbnZpcm9ubWVudFR5cGUocHl0aG9uUGF0aCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChlbnZUeXBlKS50by5iZS5lcXVhbChjb250cmFjdHNfMS5JbnRlcnByZXRlclR5cGUuVW5rbm93bik7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1pbmRleC51bml0LnRlc3QuanMubWFwIl19