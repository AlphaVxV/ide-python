"use strict";

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const chai_1 = require("chai");

const path = require("path");

const TypeMoq = require("typemoq");

const vscode_1 = require("vscode");

const types_1 = require("../../client/common/application/types");

const types_2 = require("../../client/common/platform/types");

const types_3 = require("../../client/common/types");

const platform_1 = require("../../client/common/utils/platform");

const contracts_1 = require("../../client/interpreter/contracts");

const display_1 = require("../../client/interpreter/display");

const types_4 = require("../../client/interpreter/virtualEnvs/types"); // tslint:disable:no-any max-func-body-length


const info = {
  architecture: platform_1.Architecture.Unknown,
  companyDisplayName: '',
  displayName: '',
  envName: '',
  path: '',
  type: contracts_1.InterpreterType.Unknown,
  version: '',
  version_info: [0, 0, 0, 'alpha'],
  sysPrefix: '',
  sysVersion: ''
};
suite('Interpreters Display', () => {
  let applicationShell;
  let workspaceService;
  let serviceContainer;
  let interpreterService;
  let virtualEnvMgr;
  let fileSystem;
  let disposableRegistry;
  let statusBar;
  let pythonSettings;
  let configurationService;
  let interpreterDisplay;
  let interpreterHelper;
  let pathUtils;
  setup(() => {
    serviceContainer = TypeMoq.Mock.ofType();
    workspaceService = TypeMoq.Mock.ofType();
    applicationShell = TypeMoq.Mock.ofType();
    interpreterService = TypeMoq.Mock.ofType();
    virtualEnvMgr = TypeMoq.Mock.ofType();
    fileSystem = TypeMoq.Mock.ofType();
    interpreterHelper = TypeMoq.Mock.ofType();
    disposableRegistry = [];
    statusBar = TypeMoq.Mock.ofType();
    pythonSettings = TypeMoq.Mock.ofType();
    configurationService = TypeMoq.Mock.ofType();
    pathUtils = TypeMoq.Mock.ofType();
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_1.IWorkspaceService))).returns(() => workspaceService.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_1.IApplicationShell))).returns(() => applicationShell.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(contracts_1.IInterpreterService))).returns(() => interpreterService.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_4.IVirtualEnvironmentManager))).returns(() => virtualEnvMgr.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_2.IFileSystem))).returns(() => fileSystem.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_3.IDisposableRegistry))).returns(() => disposableRegistry);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_3.IConfigurationService))).returns(() => configurationService.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(contracts_1.IInterpreterHelper))).returns(() => interpreterHelper.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_3.IPathUtils))).returns(() => pathUtils.object);
    applicationShell.setup(a => a.createStatusBarItem(TypeMoq.It.isValue(vscode_1.StatusBarAlignment.Left), TypeMoq.It.isValue(100))).returns(() => statusBar.object);
    pathUtils.setup(p => p.getDisplayName(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(p => p);
    interpreterDisplay = new display_1.InterpreterDisplay(serviceContainer.object);
  });

  function setupWorkspaceFolder(resource, workspaceFolder) {
    if (workspaceFolder) {
      const mockFolder = TypeMoq.Mock.ofType();
      mockFolder.setup(w => w.uri).returns(() => workspaceFolder);
      workspaceService.setup(w => w.getWorkspaceFolder(TypeMoq.It.isValue(resource))).returns(() => mockFolder.object);
    } else {
      workspaceService.setup(w => w.getWorkspaceFolder(TypeMoq.It.isValue(resource))).returns(() => undefined);
    }
  }

  test('Sattusbar must be created and have command name initialized', () => {
    statusBar.verify(s => s.command = TypeMoq.It.isValue('python.setInterpreter'), TypeMoq.Times.once());
    chai_1.expect(disposableRegistry).to.be.lengthOf.above(0);
    chai_1.expect(disposableRegistry).contain(statusBar.object);
  });
  test('Display name and tooltip must come from interpreter info', () => __awaiter(void 0, void 0, void 0, function* () {
    const resource = vscode_1.Uri.file('x');
    const workspaceFolder = vscode_1.Uri.file('workspace');
    const activeInterpreter = Object.assign({}, info, {
      displayName: 'Dummy_Display_Name',
      type: contracts_1.InterpreterType.Unknown,
      path: path.join('user', 'development', 'env', 'bin', 'python')
    });
    setupWorkspaceFolder(resource, workspaceFolder);
    interpreterService.setup(i => i.getInterpreters(TypeMoq.It.isValue(workspaceFolder))).returns(() => Promise.resolve([]));
    interpreterService.setup(i => i.getActiveInterpreter(TypeMoq.It.isValue(workspaceFolder))).returns(() => Promise.resolve(activeInterpreter));
    yield interpreterDisplay.refresh(resource);
    statusBar.verify(s => s.text = TypeMoq.It.isValue(activeInterpreter.displayName), TypeMoq.Times.once());
    statusBar.verify(s => s.tooltip = TypeMoq.It.isValue(activeInterpreter.path), TypeMoq.Times.once());
  }));
  test('If interpreter is not identified then tooltip should point to python Path', () => __awaiter(void 0, void 0, void 0, function* () {
    const resource = vscode_1.Uri.file('x');
    const pythonPath = path.join('user', 'development', 'env', 'bin', 'python');
    const workspaceFolder = vscode_1.Uri.file('workspace');
    const displayName = 'This is the display name';
    setupWorkspaceFolder(resource, workspaceFolder);
    const pythonInterpreter = {
      displayName,
      path: pythonPath
    };
    interpreterService.setup(i => i.getActiveInterpreter(TypeMoq.It.isValue(workspaceFolder))).returns(() => Promise.resolve(pythonInterpreter));
    yield interpreterDisplay.refresh(resource);
    statusBar.verify(s => s.tooltip = TypeMoq.It.isValue(pythonPath), TypeMoq.Times.once());
    statusBar.verify(s => s.text = TypeMoq.It.isValue(displayName), TypeMoq.Times.once());
  }));
  test('If interpreter file does not exist then update status bar accordingly', () => __awaiter(void 0, void 0, void 0, function* () {
    const resource = vscode_1.Uri.file('x');
    const pythonPath = path.join('user', 'development', 'env', 'bin', 'python');
    const workspaceFolder = vscode_1.Uri.file('workspace');
    setupWorkspaceFolder(resource, workspaceFolder); // tslint:disable-next-line:no-any

    interpreterService.setup(i => i.getInterpreters(TypeMoq.It.isValue(workspaceFolder))).returns(() => Promise.resolve([{}]));
    interpreterService.setup(i => i.getActiveInterpreter(TypeMoq.It.isValue(workspaceFolder))).returns(() => Promise.resolve(undefined));
    configurationService.setup(c => c.getSettings(TypeMoq.It.isAny())).returns(() => pythonSettings.object);
    pythonSettings.setup(p => p.pythonPath).returns(() => pythonPath);
    fileSystem.setup(f => f.fileExists(TypeMoq.It.isValue(pythonPath))).returns(() => Promise.resolve(false));
    interpreterHelper.setup(v => v.getInterpreterInformation(TypeMoq.It.isValue(pythonPath))).returns(() => Promise.resolve(undefined));
    virtualEnvMgr.setup(v => v.getEnvironmentName(TypeMoq.It.isValue(pythonPath))).returns(() => Promise.resolve(''));
    yield interpreterDisplay.refresh(resource);
    statusBar.verify(s => s.color = TypeMoq.It.isValue('yellow'), TypeMoq.Times.once());
    statusBar.verify(s => s.text = TypeMoq.It.isValue('$(alert) Select Python Interpreter'), TypeMoq.Times.once());
  }));
  test('Ensure we try to identify the active workspace when a resource is not provided ', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceFolder = vscode_1.Uri.file('x');
    const resource = workspaceFolder;
    const pythonPath = path.join('user', 'development', 'env', 'bin', 'python');
    const activeInterpreter = Object.assign({}, info, {
      displayName: 'Dummy_Display_Name',
      type: contracts_1.InterpreterType.Unknown,
      companyDisplayName: 'Company Name',
      path: pythonPath
    });
    fileSystem.setup(fs => fs.fileExists(TypeMoq.It.isAny())).returns(() => Promise.resolve(true));
    virtualEnvMgr.setup(v => v.getEnvironmentName(TypeMoq.It.isValue(pythonPath))).returns(() => Promise.resolve(''));
    interpreterService.setup(i => i.getActiveInterpreter(TypeMoq.It.isValue(resource))).returns(() => Promise.resolve(activeInterpreter)).verifiable(TypeMoq.Times.once());
    interpreterHelper.setup(i => i.getActiveWorkspaceUri()).returns(() => {
      return {
        folderUri: workspaceFolder,
        configTarget: vscode_1.ConfigurationTarget.Workspace
      };
    }).verifiable(TypeMoq.Times.once());
    yield interpreterDisplay.refresh();
    interpreterHelper.verifyAll();
    interpreterService.verifyAll();
    statusBar.verify(s => s.text = TypeMoq.It.isValue(activeInterpreter.displayName), TypeMoq.Times.once());
    statusBar.verify(s => s.tooltip = TypeMoq.It.isValue(pythonPath), TypeMoq.Times.once());
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRpc3BsYXkudW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJjaGFpXzEiLCJyZXF1aXJlIiwicGF0aCIsIlR5cGVNb3EiLCJ2c2NvZGVfMSIsInR5cGVzXzEiLCJ0eXBlc18yIiwidHlwZXNfMyIsInBsYXRmb3JtXzEiLCJjb250cmFjdHNfMSIsImRpc3BsYXlfMSIsInR5cGVzXzQiLCJpbmZvIiwiYXJjaGl0ZWN0dXJlIiwiQXJjaGl0ZWN0dXJlIiwiVW5rbm93biIsImNvbXBhbnlEaXNwbGF5TmFtZSIsImRpc3BsYXlOYW1lIiwiZW52TmFtZSIsInR5cGUiLCJJbnRlcnByZXRlclR5cGUiLCJ2ZXJzaW9uIiwidmVyc2lvbl9pbmZvIiwic3lzUHJlZml4Iiwic3lzVmVyc2lvbiIsInN1aXRlIiwiYXBwbGljYXRpb25TaGVsbCIsIndvcmtzcGFjZVNlcnZpY2UiLCJzZXJ2aWNlQ29udGFpbmVyIiwiaW50ZXJwcmV0ZXJTZXJ2aWNlIiwidmlydHVhbEVudk1nciIsImZpbGVTeXN0ZW0iLCJkaXNwb3NhYmxlUmVnaXN0cnkiLCJzdGF0dXNCYXIiLCJweXRob25TZXR0aW5ncyIsImNvbmZpZ3VyYXRpb25TZXJ2aWNlIiwiaW50ZXJwcmV0ZXJEaXNwbGF5IiwiaW50ZXJwcmV0ZXJIZWxwZXIiLCJwYXRoVXRpbHMiLCJzZXR1cCIsIk1vY2siLCJvZlR5cGUiLCJjIiwiZ2V0IiwiSXQiLCJpc1ZhbHVlIiwiSVdvcmtzcGFjZVNlcnZpY2UiLCJyZXR1cm5zIiwib2JqZWN0IiwiSUFwcGxpY2F0aW9uU2hlbGwiLCJJSW50ZXJwcmV0ZXJTZXJ2aWNlIiwiSVZpcnR1YWxFbnZpcm9ubWVudE1hbmFnZXIiLCJJRmlsZVN5c3RlbSIsIklEaXNwb3NhYmxlUmVnaXN0cnkiLCJJQ29uZmlndXJhdGlvblNlcnZpY2UiLCJJSW50ZXJwcmV0ZXJIZWxwZXIiLCJJUGF0aFV0aWxzIiwiYSIsImNyZWF0ZVN0YXR1c0Jhckl0ZW0iLCJTdGF0dXNCYXJBbGlnbm1lbnQiLCJMZWZ0IiwicCIsImdldERpc3BsYXlOYW1lIiwiaXNBbnkiLCJJbnRlcnByZXRlckRpc3BsYXkiLCJzZXR1cFdvcmtzcGFjZUZvbGRlciIsInJlc291cmNlIiwid29ya3NwYWNlRm9sZGVyIiwibW9ja0ZvbGRlciIsInciLCJ1cmkiLCJnZXRXb3Jrc3BhY2VGb2xkZXIiLCJ1bmRlZmluZWQiLCJ0ZXN0IiwidmVyaWZ5IiwicyIsImNvbW1hbmQiLCJUaW1lcyIsIm9uY2UiLCJleHBlY3QiLCJ0byIsImJlIiwibGVuZ3RoT2YiLCJhYm92ZSIsImNvbnRhaW4iLCJVcmkiLCJmaWxlIiwiYWN0aXZlSW50ZXJwcmV0ZXIiLCJhc3NpZ24iLCJqb2luIiwiaSIsImdldEludGVycHJldGVycyIsImdldEFjdGl2ZUludGVycHJldGVyIiwicmVmcmVzaCIsInRleHQiLCJ0b29sdGlwIiwicHl0aG9uUGF0aCIsInB5dGhvbkludGVycHJldGVyIiwiZ2V0U2V0dGluZ3MiLCJmIiwiZmlsZUV4aXN0cyIsInYiLCJnZXRJbnRlcnByZXRlckluZm9ybWF0aW9uIiwiZ2V0RW52aXJvbm1lbnROYW1lIiwiY29sb3IiLCJmcyIsInZlcmlmaWFibGUiLCJnZXRBY3RpdmVXb3Jrc3BhY2VVcmkiLCJmb2xkZXJVcmkiLCJjb25maWdUYXJnZXQiLCJDb25maWd1cmF0aW9uVGFyZ2V0IiwiV29ya3NwYWNlIiwidmVyaWZ5QWxsIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFDQSxJQUFJQSxTQUFTLEdBQUksVUFBUSxTQUFLQSxTQUFkLElBQTRCLFVBQVVDLE9BQVYsRUFBbUJDLFVBQW5CLEVBQStCQyxD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WUFBWSxFQUFFekcsUUFBUSxDQUFDMEcsbUJBQVQsQ0FBNkJDO0FBQXpFLE9BQVA7QUFBOEYsS0FGbkgsRUFHS0wsVUFITCxDQUdnQnZHLE9BQU8sQ0FBQzBFLEtBQVIsQ0FBY0MsSUFBZCxFQUhoQjtBQUlBLFVBQU0xQyxrQkFBa0IsQ0FBQ3lELE9BQW5CLEVBQU47QUFDQXhELElBQUFBLGlCQUFpQixDQUFDMkUsU0FBbEI7QUFDQW5GLElBQUFBLGtCQUFrQixDQUFDbUYsU0FBbkI7QUFDQS9FLElBQUFBLFNBQVMsQ0FBQ3lDLE1BQVYsQ0FBaUJDLENBQUMsSUFBSUEsQ0FBQyxDQUFDbUIsSUFBRixHQUFTM0YsT0FBTyxDQUFDeUMsRUFBUixDQUFXQyxPQUFYLENBQW1CMEMsaUJBQWlCLENBQUN0RSxXQUFyQyxDQUEvQixFQUFrRmQsT0FBTyxDQUFDMEUsS0FBUixDQUFjQyxJQUFkLEVBQWxGO0FBQ0E3QyxJQUFBQSxTQUFTLENBQUN5QyxNQUFWLENBQWlCQyxDQUFDLElBQUlBLENBQUMsQ0FBQ29CLE9BQUYsR0FBWTVGLE9BQU8sQ0FBQ3lDLEVBQVIsQ0FBV0MsT0FBWCxDQUFtQm1ELFVBQW5CLENBQWxDLEVBQWtFN0YsT0FBTyxDQUFDMEUsS0FBUixDQUFjQyxJQUFkLEVBQWxFO0FBQ0gsR0FwQnNHLENBQW5HLENBQUo7QUFxQkgsQ0F2SEksQ0FBTCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IGNoYWlfMSA9IHJlcXVpcmUoXCJjaGFpXCIpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZShcInBhdGhcIik7XHJcbmNvbnN0IFR5cGVNb3EgPSByZXF1aXJlKFwidHlwZW1vcVwiKTtcclxuY29uc3QgdnNjb2RlXzEgPSByZXF1aXJlKFwidnNjb2RlXCIpO1xyXG5jb25zdCB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC9jb21tb24vYXBwbGljYXRpb24vdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzIgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L2NvbW1vbi9wbGF0Zm9ybS90eXBlc1wiKTtcclxuY29uc3QgdHlwZXNfMyA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvY29tbW9uL3R5cGVzXCIpO1xyXG5jb25zdCBwbGF0Zm9ybV8xID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC9jb21tb24vdXRpbHMvcGxhdGZvcm1cIik7XHJcbmNvbnN0IGNvbnRyYWN0c18xID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC9pbnRlcnByZXRlci9jb250cmFjdHNcIik7XHJcbmNvbnN0IGRpc3BsYXlfMSA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvaW50ZXJwcmV0ZXIvZGlzcGxheVwiKTtcclxuY29uc3QgdHlwZXNfNCA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvaW50ZXJwcmV0ZXIvdmlydHVhbEVudnMvdHlwZXNcIik7XHJcbi8vIHRzbGludDpkaXNhYmxlOm5vLWFueSBtYXgtZnVuYy1ib2R5LWxlbmd0aFxyXG5jb25zdCBpbmZvID0ge1xyXG4gICAgYXJjaGl0ZWN0dXJlOiBwbGF0Zm9ybV8xLkFyY2hpdGVjdHVyZS5Vbmtub3duLFxyXG4gICAgY29tcGFueURpc3BsYXlOYW1lOiAnJyxcclxuICAgIGRpc3BsYXlOYW1lOiAnJyxcclxuICAgIGVudk5hbWU6ICcnLFxyXG4gICAgcGF0aDogJycsXHJcbiAgICB0eXBlOiBjb250cmFjdHNfMS5JbnRlcnByZXRlclR5cGUuVW5rbm93bixcclxuICAgIHZlcnNpb246ICcnLFxyXG4gICAgdmVyc2lvbl9pbmZvOiBbMCwgMCwgMCwgJ2FscGhhJ10sXHJcbiAgICBzeXNQcmVmaXg6ICcnLFxyXG4gICAgc3lzVmVyc2lvbjogJydcclxufTtcclxuc3VpdGUoJ0ludGVycHJldGVycyBEaXNwbGF5JywgKCkgPT4ge1xyXG4gICAgbGV0IGFwcGxpY2F0aW9uU2hlbGw7XHJcbiAgICBsZXQgd29ya3NwYWNlU2VydmljZTtcclxuICAgIGxldCBzZXJ2aWNlQ29udGFpbmVyO1xyXG4gICAgbGV0IGludGVycHJldGVyU2VydmljZTtcclxuICAgIGxldCB2aXJ0dWFsRW52TWdyO1xyXG4gICAgbGV0IGZpbGVTeXN0ZW07XHJcbiAgICBsZXQgZGlzcG9zYWJsZVJlZ2lzdHJ5O1xyXG4gICAgbGV0IHN0YXR1c0JhcjtcclxuICAgIGxldCBweXRob25TZXR0aW5ncztcclxuICAgIGxldCBjb25maWd1cmF0aW9uU2VydmljZTtcclxuICAgIGxldCBpbnRlcnByZXRlckRpc3BsYXk7XHJcbiAgICBsZXQgaW50ZXJwcmV0ZXJIZWxwZXI7XHJcbiAgICBsZXQgcGF0aFV0aWxzO1xyXG4gICAgc2V0dXAoKCkgPT4ge1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgd29ya3NwYWNlU2VydmljZSA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBhcHBsaWNhdGlvblNoZWxsID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGludGVycHJldGVyU2VydmljZSA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICB2aXJ0dWFsRW52TWdyID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGZpbGVTeXN0ZW0gPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgaW50ZXJwcmV0ZXJIZWxwZXIgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgZGlzcG9zYWJsZVJlZ2lzdHJ5ID0gW107XHJcbiAgICAgICAgc3RhdHVzQmFyID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHB5dGhvblNldHRpbmdzID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGNvbmZpZ3VyYXRpb25TZXJ2aWNlID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHBhdGhVdGlscyA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzEuSVdvcmtzcGFjZVNlcnZpY2UpKSkucmV0dXJucygoKSA9PiB3b3Jrc3BhY2VTZXJ2aWNlLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KFR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18xLklBcHBsaWNhdGlvblNoZWxsKSkpLnJldHVybnMoKCkgPT4gYXBwbGljYXRpb25TaGVsbC5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUoY29udHJhY3RzXzEuSUludGVycHJldGVyU2VydmljZSkpKS5yZXR1cm5zKCgpID0+IGludGVycHJldGVyU2VydmljZS5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfNC5JVmlydHVhbEVudmlyb25tZW50TWFuYWdlcikpKS5yZXR1cm5zKCgpID0+IHZpcnR1YWxFbnZNZ3Iub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzIuSUZpbGVTeXN0ZW0pKSkucmV0dXJucygoKSA9PiBmaWxlU3lzdGVtLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KFR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18zLklEaXNwb3NhYmxlUmVnaXN0cnkpKSkucmV0dXJucygoKSA9PiBkaXNwb3NhYmxlUmVnaXN0cnkpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMy5JQ29uZmlndXJhdGlvblNlcnZpY2UpKSkucmV0dXJucygoKSA9PiBjb25maWd1cmF0aW9uU2VydmljZS5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUoY29udHJhY3RzXzEuSUludGVycHJldGVySGVscGVyKSkpLnJldHVybnMoKCkgPT4gaW50ZXJwcmV0ZXJIZWxwZXIub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQoVHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzMuSVBhdGhVdGlscykpKS5yZXR1cm5zKCgpID0+IHBhdGhVdGlscy5vYmplY3QpO1xyXG4gICAgICAgIGFwcGxpY2F0aW9uU2hlbGwuc2V0dXAoYSA9PiBhLmNyZWF0ZVN0YXR1c0Jhckl0ZW0oVHlwZU1vcS5JdC5pc1ZhbHVlKHZzY29kZV8xLlN0YXR1c0JhckFsaWdubWVudC5MZWZ0KSwgVHlwZU1vcS5JdC5pc1ZhbHVlKDEwMCkpKS5yZXR1cm5zKCgpID0+IHN0YXR1c0Jhci5vYmplY3QpO1xyXG4gICAgICAgIHBhdGhVdGlscy5zZXR1cChwID0+IHAuZ2V0RGlzcGxheU5hbWUoVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKHAgPT4gcCk7XHJcbiAgICAgICAgaW50ZXJwcmV0ZXJEaXNwbGF5ID0gbmV3IGRpc3BsYXlfMS5JbnRlcnByZXRlckRpc3BsYXkoc2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgfSk7XHJcbiAgICBmdW5jdGlvbiBzZXR1cFdvcmtzcGFjZUZvbGRlcihyZXNvdXJjZSwgd29ya3NwYWNlRm9sZGVyKSB7XHJcbiAgICAgICAgaWYgKHdvcmtzcGFjZUZvbGRlcikge1xyXG4gICAgICAgICAgICBjb25zdCBtb2NrRm9sZGVyID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgICAgICBtb2NrRm9sZGVyLnNldHVwKHcgPT4gdy51cmkpLnJldHVybnMoKCkgPT4gd29ya3NwYWNlRm9sZGVyKTtcclxuICAgICAgICAgICAgd29ya3NwYWNlU2VydmljZS5zZXR1cCh3ID0+IHcuZ2V0V29ya3NwYWNlRm9sZGVyKFR5cGVNb3EuSXQuaXNWYWx1ZShyZXNvdXJjZSkpKS5yZXR1cm5zKCgpID0+IG1vY2tGb2xkZXIub2JqZWN0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHdvcmtzcGFjZVNlcnZpY2Uuc2V0dXAodyA9PiB3LmdldFdvcmtzcGFjZUZvbGRlcihUeXBlTW9xLkl0LmlzVmFsdWUocmVzb3VyY2UpKSkucmV0dXJucygoKSA9PiB1bmRlZmluZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHRlc3QoJ1NhdHR1c2JhciBtdXN0IGJlIGNyZWF0ZWQgYW5kIGhhdmUgY29tbWFuZCBuYW1lIGluaXRpYWxpemVkJywgKCkgPT4ge1xyXG4gICAgICAgIHN0YXR1c0Jhci52ZXJpZnkocyA9PiBzLmNvbW1hbmQgPSBUeXBlTW9xLkl0LmlzVmFsdWUoJ3B5dGhvbi5zZXRJbnRlcnByZXRlcicpLCBUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChkaXNwb3NhYmxlUmVnaXN0cnkpLnRvLmJlLmxlbmd0aE9mLmFib3ZlKDApO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoZGlzcG9zYWJsZVJlZ2lzdHJ5KS5jb250YWluKHN0YXR1c0Jhci5vYmplY3QpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdEaXNwbGF5IG5hbWUgYW5kIHRvb2x0aXAgbXVzdCBjb21lIGZyb20gaW50ZXJwcmV0ZXIgaW5mbycsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCByZXNvdXJjZSA9IHZzY29kZV8xLlVyaS5maWxlKCd4Jyk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlRm9sZGVyID0gdnNjb2RlXzEuVXJpLmZpbGUoJ3dvcmtzcGFjZScpO1xyXG4gICAgICAgIGNvbnN0IGFjdGl2ZUludGVycHJldGVyID0gT2JqZWN0LmFzc2lnbih7fSwgaW5mbywgeyBkaXNwbGF5TmFtZTogJ0R1bW15X0Rpc3BsYXlfTmFtZScsIHR5cGU6IGNvbnRyYWN0c18xLkludGVycHJldGVyVHlwZS5Vbmtub3duLCBwYXRoOiBwYXRoLmpvaW4oJ3VzZXInLCAnZGV2ZWxvcG1lbnQnLCAnZW52JywgJ2JpbicsICdweXRob24nKSB9KTtcclxuICAgICAgICBzZXR1cFdvcmtzcGFjZUZvbGRlcihyZXNvdXJjZSwgd29ya3NwYWNlRm9sZGVyKTtcclxuICAgICAgICBpbnRlcnByZXRlclNlcnZpY2Uuc2V0dXAoaSA9PiBpLmdldEludGVycHJldGVycyhUeXBlTW9xLkl0LmlzVmFsdWUod29ya3NwYWNlRm9sZGVyKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKFtdKSk7XHJcbiAgICAgICAgaW50ZXJwcmV0ZXJTZXJ2aWNlLnNldHVwKGkgPT4gaS5nZXRBY3RpdmVJbnRlcnByZXRlcihUeXBlTW9xLkl0LmlzVmFsdWUod29ya3NwYWNlRm9sZGVyKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGFjdGl2ZUludGVycHJldGVyKSk7XHJcbiAgICAgICAgeWllbGQgaW50ZXJwcmV0ZXJEaXNwbGF5LnJlZnJlc2gocmVzb3VyY2UpO1xyXG4gICAgICAgIHN0YXR1c0Jhci52ZXJpZnkocyA9PiBzLnRleHQgPSBUeXBlTW9xLkl0LmlzVmFsdWUoYWN0aXZlSW50ZXJwcmV0ZXIuZGlzcGxheU5hbWUpLCBUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgc3RhdHVzQmFyLnZlcmlmeShzID0+IHMudG9vbHRpcCA9IFR5cGVNb3EuSXQuaXNWYWx1ZShhY3RpdmVJbnRlcnByZXRlci5wYXRoKSwgVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnSWYgaW50ZXJwcmV0ZXIgaXMgbm90IGlkZW50aWZpZWQgdGhlbiB0b29sdGlwIHNob3VsZCBwb2ludCB0byBweXRob24gUGF0aCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCByZXNvdXJjZSA9IHZzY29kZV8xLlVyaS5maWxlKCd4Jyk7XHJcbiAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IHBhdGguam9pbigndXNlcicsICdkZXZlbG9wbWVudCcsICdlbnYnLCAnYmluJywgJ3B5dGhvbicpO1xyXG4gICAgICAgIGNvbnN0IHdvcmtzcGFjZUZvbGRlciA9IHZzY29kZV8xLlVyaS5maWxlKCd3b3Jrc3BhY2UnKTtcclxuICAgICAgICBjb25zdCBkaXNwbGF5TmFtZSA9ICdUaGlzIGlzIHRoZSBkaXNwbGF5IG5hbWUnO1xyXG4gICAgICAgIHNldHVwV29ya3NwYWNlRm9sZGVyKHJlc291cmNlLCB3b3Jrc3BhY2VGb2xkZXIpO1xyXG4gICAgICAgIGNvbnN0IHB5dGhvbkludGVycHJldGVyID0ge1xyXG4gICAgICAgICAgICBkaXNwbGF5TmFtZSxcclxuICAgICAgICAgICAgcGF0aDogcHl0aG9uUGF0aFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgaW50ZXJwcmV0ZXJTZXJ2aWNlLnNldHVwKGkgPT4gaS5nZXRBY3RpdmVJbnRlcnByZXRlcihUeXBlTW9xLkl0LmlzVmFsdWUod29ya3NwYWNlRm9sZGVyKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHB5dGhvbkludGVycHJldGVyKSk7XHJcbiAgICAgICAgeWllbGQgaW50ZXJwcmV0ZXJEaXNwbGF5LnJlZnJlc2gocmVzb3VyY2UpO1xyXG4gICAgICAgIHN0YXR1c0Jhci52ZXJpZnkocyA9PiBzLnRvb2x0aXAgPSBUeXBlTW9xLkl0LmlzVmFsdWUocHl0aG9uUGF0aCksIFR5cGVNb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICBzdGF0dXNCYXIudmVyaWZ5KHMgPT4gcy50ZXh0ID0gVHlwZU1vcS5JdC5pc1ZhbHVlKGRpc3BsYXlOYW1lKSwgVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnSWYgaW50ZXJwcmV0ZXIgZmlsZSBkb2VzIG5vdCBleGlzdCB0aGVuIHVwZGF0ZSBzdGF0dXMgYmFyIGFjY29yZGluZ2x5JywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gdnNjb2RlXzEuVXJpLmZpbGUoJ3gnKTtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gcGF0aC5qb2luKCd1c2VyJywgJ2RldmVsb3BtZW50JywgJ2VudicsICdiaW4nLCAncHl0aG9uJyk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlRm9sZGVyID0gdnNjb2RlXzEuVXJpLmZpbGUoJ3dvcmtzcGFjZScpO1xyXG4gICAgICAgIHNldHVwV29ya3NwYWNlRm9sZGVyKHJlc291cmNlLCB3b3Jrc3BhY2VGb2xkZXIpO1xyXG4gICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1hbnlcclxuICAgICAgICBpbnRlcnByZXRlclNlcnZpY2Uuc2V0dXAoaSA9PiBpLmdldEludGVycHJldGVycyhUeXBlTW9xLkl0LmlzVmFsdWUod29ya3NwYWNlRm9sZGVyKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKFt7fV0pKTtcclxuICAgICAgICBpbnRlcnByZXRlclNlcnZpY2Uuc2V0dXAoaSA9PiBpLmdldEFjdGl2ZUludGVycHJldGVyKFR5cGVNb3EuSXQuaXNWYWx1ZSh3b3Jrc3BhY2VGb2xkZXIpKSkucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKSk7XHJcbiAgICAgICAgY29uZmlndXJhdGlvblNlcnZpY2Uuc2V0dXAoYyA9PiBjLmdldFNldHRpbmdzKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gcHl0aG9uU2V0dGluZ3Mub2JqZWN0KTtcclxuICAgICAgICBweXRob25TZXR0aW5ncy5zZXR1cChwID0+IHAucHl0aG9uUGF0aCkucmV0dXJucygoKSA9PiBweXRob25QYXRoKTtcclxuICAgICAgICBmaWxlU3lzdGVtLnNldHVwKGYgPT4gZi5maWxlRXhpc3RzKFR5cGVNb3EuSXQuaXNWYWx1ZShweXRob25QYXRoKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKGZhbHNlKSk7XHJcbiAgICAgICAgaW50ZXJwcmV0ZXJIZWxwZXIuc2V0dXAodiA9PiB2LmdldEludGVycHJldGVySW5mb3JtYXRpb24oVHlwZU1vcS5JdC5pc1ZhbHVlKHB5dGhvblBhdGgpKSkucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKSk7XHJcbiAgICAgICAgdmlydHVhbEVudk1nci5zZXR1cCh2ID0+IHYuZ2V0RW52aXJvbm1lbnROYW1lKFR5cGVNb3EuSXQuaXNWYWx1ZShweXRob25QYXRoKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCcnKSk7XHJcbiAgICAgICAgeWllbGQgaW50ZXJwcmV0ZXJEaXNwbGF5LnJlZnJlc2gocmVzb3VyY2UpO1xyXG4gICAgICAgIHN0YXR1c0Jhci52ZXJpZnkocyA9PiBzLmNvbG9yID0gVHlwZU1vcS5JdC5pc1ZhbHVlKCd5ZWxsb3cnKSwgVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIHN0YXR1c0Jhci52ZXJpZnkocyA9PiBzLnRleHQgPSBUeXBlTW9xLkl0LmlzVmFsdWUoJyQoYWxlcnQpIFNlbGVjdCBQeXRob24gSW50ZXJwcmV0ZXInKSwgVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5zdXJlIHdlIHRyeSB0byBpZGVudGlmeSB0aGUgYWN0aXZlIHdvcmtzcGFjZSB3aGVuIGEgcmVzb3VyY2UgaXMgbm90IHByb3ZpZGVkICcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB3b3Jrc3BhY2VGb2xkZXIgPSB2c2NvZGVfMS5VcmkuZmlsZSgneCcpO1xyXG4gICAgICAgIGNvbnN0IHJlc291cmNlID0gd29ya3NwYWNlRm9sZGVyO1xyXG4gICAgICAgIGNvbnN0IHB5dGhvblBhdGggPSBwYXRoLmpvaW4oJ3VzZXInLCAnZGV2ZWxvcG1lbnQnLCAnZW52JywgJ2JpbicsICdweXRob24nKTtcclxuICAgICAgICBjb25zdCBhY3RpdmVJbnRlcnByZXRlciA9IE9iamVjdC5hc3NpZ24oe30sIGluZm8sIHsgZGlzcGxheU5hbWU6ICdEdW1teV9EaXNwbGF5X05hbWUnLCB0eXBlOiBjb250cmFjdHNfMS5JbnRlcnByZXRlclR5cGUuVW5rbm93biwgY29tcGFueURpc3BsYXlOYW1lOiAnQ29tcGFueSBOYW1lJywgcGF0aDogcHl0aG9uUGF0aCB9KTtcclxuICAgICAgICBmaWxlU3lzdGVtLnNldHVwKGZzID0+IGZzLmZpbGVFeGlzdHMoVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodHJ1ZSkpO1xyXG4gICAgICAgIHZpcnR1YWxFbnZNZ3Iuc2V0dXAodiA9PiB2LmdldEVudmlyb25tZW50TmFtZShUeXBlTW9xLkl0LmlzVmFsdWUocHl0aG9uUGF0aCkpKS5yZXR1cm5zKCgpID0+IFByb21pc2UucmVzb2x2ZSgnJykpO1xyXG4gICAgICAgIGludGVycHJldGVyU2VydmljZVxyXG4gICAgICAgICAgICAuc2V0dXAoaSA9PiBpLmdldEFjdGl2ZUludGVycHJldGVyKFR5cGVNb3EuSXQuaXNWYWx1ZShyZXNvdXJjZSkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUoYWN0aXZlSW50ZXJwcmV0ZXIpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgaW50ZXJwcmV0ZXJIZWxwZXJcclxuICAgICAgICAgICAgLnNldHVwKGkgPT4gaS5nZXRBY3RpdmVXb3Jrc3BhY2VVcmkoKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4geyByZXR1cm4geyBmb2xkZXJVcmk6IHdvcmtzcGFjZUZvbGRlciwgY29uZmlnVGFyZ2V0OiB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZSB9OyB9KVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgeWllbGQgaW50ZXJwcmV0ZXJEaXNwbGF5LnJlZnJlc2goKTtcclxuICAgICAgICBpbnRlcnByZXRlckhlbHBlci52ZXJpZnlBbGwoKTtcclxuICAgICAgICBpbnRlcnByZXRlclNlcnZpY2UudmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgc3RhdHVzQmFyLnZlcmlmeShzID0+IHMudGV4dCA9IFR5cGVNb3EuSXQuaXNWYWx1ZShhY3RpdmVJbnRlcnByZXRlci5kaXNwbGF5TmFtZSksIFR5cGVNb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICBzdGF0dXNCYXIudmVyaWZ5KHMgPT4gcy50b29sdGlwID0gVHlwZU1vcS5JdC5pc1ZhbHVlKHB5dGhvblBhdGgpLCBUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1kaXNwbGF5LnVuaXQudGVzdC5qcy5tYXAiXX0=