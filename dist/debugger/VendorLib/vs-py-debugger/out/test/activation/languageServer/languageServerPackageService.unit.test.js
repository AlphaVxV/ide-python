// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:no-any no-invalid-this max-func-body-length

const chai_1 = require("chai");

const semver_1 = require("semver");

const typeMoq = require("typemoq");

const languageServerPackageRepository_1 = require("../../../client/activation/languageServer/languageServerPackageRepository");

const languageServerPackageService_1 = require("../../../client/activation/languageServer/languageServerPackageService");

const platformData_1 = require("../../../client/activation/platformData");

const nugetService_1 = require("../../../client/common/nuget/nugetService");

const types_1 = require("../../../client/common/nuget/types");

const types_2 = require("../../../client/common/platform/types");

const platform_1 = require("../../../client/common/utils/platform");

const downloadBaseFileName = 'Python-Language-Server';
suite('Language Server Package Service', () => {
  let serviceContainer;
  let platform;
  let lsPackageService;
  let appVersion;
  setup(() => {
    serviceContainer = typeMoq.Mock.ofType();
    platform = typeMoq.Mock.ofType();
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_2.IPlatformService))).returns(() => platform.object);
    appVersion = typeMoq.Mock.ofType();
    lsPackageService = new languageServerPackageService_1.LanguageServerPackageService(serviceContainer.object, appVersion.object);

    lsPackageService.getLanguageServerDownloadChannel = () => 'stable';
  });

  function setMinVersionOfLs(version) {
    const packageJson = {
      languageServerVersion: version
    };
    appVersion.setup(e => e.packageJson).returns(() => packageJson);
  }

  [true, false].forEach(is64Bit => {
    const bitness = is64Bit ? '64bit' : '32bit';
    const architecture = is64Bit ? platform_1.Architecture.x64 : platform_1.Architecture.x86;
    test(`Get Package name for Windows (${bitness})`, () => __awaiter(void 0, void 0, void 0, function* () {
      platform.setup(p => p.info).returns(() => {
        return {
          type: platform_1.OSType.Windows,
          architecture
        };
      }).verifiable(typeMoq.Times.atLeastOnce());
      const expectedName = is64Bit ? `${downloadBaseFileName}-${platformData_1.PlatformName.Windows64Bit}` : `${downloadBaseFileName}-${platformData_1.PlatformName.Windows32Bit}`;
      const name = lsPackageService.getNugetPackageName();
      platform.verifyAll();
      chai_1.expect(name).to.be.equal(expectedName);
    }));
    test(`Get Package name for Mac (${bitness})`, () => __awaiter(void 0, void 0, void 0, function* () {
      platform.setup(p => p.info).returns(() => {
        return {
          type: platform_1.OSType.OSX,
          architecture
        };
      }).verifiable(typeMoq.Times.atLeastOnce());
      const expectedName = `${downloadBaseFileName}-${platformData_1.PlatformName.Mac64Bit}`;
      const name = lsPackageService.getNugetPackageName();
      platform.verifyAll();
      chai_1.expect(name).to.be.equal(expectedName);
    }));
    test(`Get Package name for Linux (${bitness})`, () => __awaiter(void 0, void 0, void 0, function* () {
      platform.setup(p => p.info).returns(() => {
        return {
          type: platform_1.OSType.Linux,
          architecture
        };
      }).verifiable(typeMoq.Times.atLeastOnce());
      const expectedName = `${downloadBaseFileName}-${platformData_1.PlatformName.Linux64Bit}`;
      const name = lsPackageService.getNugetPackageName();
      platform.verifyAll();
      chai_1.expect(name).to.be.equal(expectedName);
    }));
  });
  test('Get latest nuget package version', () => __awaiter(void 0, void 0, void 0, function* () {
    const packageName = 'packageName';

    lsPackageService.getNugetPackageName = () => packageName;

    lsPackageService.maxMajorVersion = 3;
    setMinVersionOfLs('0.0.1');
    const packages = [{
      package: '',
      uri: '',
      version: new semver_1.SemVer('1.1.1')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('3.4.1')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('3.1.1')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('2.1.1')
    }];
    const expectedPackage = packages[1];
    const repo = typeMoq.Mock.ofType();
    const nuget = typeMoq.Mock.ofType();
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.INugetRepository), typeMoq.It.isAny())).returns(() => repo.object);
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.INugetService))).returns(() => nuget.object);
    repo.setup(n => n.getPackages(typeMoq.It.isValue(packageName))).returns(() => Promise.resolve(packages)).verifiable(typeMoq.Times.once());
    nuget.setup(n => n.isReleaseVersion(typeMoq.It.isAny())).returns(() => true).verifiable(typeMoq.Times.atLeastOnce());
    const info = yield lsPackageService.getLatestNugetPackageVersion();
    repo.verifyAll();
    nuget.verifyAll();
    chai_1.expect(info).to.deep.equal(expectedPackage);
  }));
  test('Get latest nuget package version (excluding non-release)', () => __awaiter(void 0, void 0, void 0, function* () {
    setMinVersionOfLs('0.0.1');
    const packageName = 'packageName';

    lsPackageService.getNugetPackageName = () => packageName;

    lsPackageService.maxMajorVersion = 1;
    const packages = [{
      package: '',
      uri: '',
      version: new semver_1.SemVer('1.1.1')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('1.3.1-alpha')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('1.4.1-preview')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('1.2.1-internal')
    }];
    const expectedPackage = packages[0];
    const repo = typeMoq.Mock.ofType();
    const nuget = new nugetService_1.NugetService();
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.INugetRepository), typeMoq.It.isAny())).returns(() => repo.object);
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.INugetService))).returns(() => nuget);
    repo.setup(n => n.getPackages(typeMoq.It.isValue(packageName))).returns(() => Promise.resolve(packages)).verifiable(typeMoq.Times.once());
    const info = yield lsPackageService.getLatestNugetPackageVersion();
    repo.verifyAll();
    chai_1.expect(info).to.deep.equal(expectedPackage);
  }));
  test('Ensure minimum version of package is used', () => __awaiter(void 0, void 0, void 0, function* () {
    const minimumVersion = '0.1.50';
    setMinVersionOfLs(minimumVersion);
    const packageName = 'packageName';

    lsPackageService.getNugetPackageName = () => packageName;

    lsPackageService.maxMajorVersion = 0;
    const packages = [{
      package: '',
      uri: '',
      version: new semver_1.SemVer('0.1.48')
    }, {
      package: '',
      uri: '',
      version: new semver_1.SemVer('0.1.49')
    }];
    const repo = typeMoq.Mock.ofType();
    const nuget = new nugetService_1.NugetService();
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.INugetRepository), typeMoq.It.isAny())).returns(() => repo.object);
    serviceContainer.setup(c => c.get(typeMoq.It.isValue(types_1.INugetService))).returns(() => nuget);
    repo.setup(n => n.getPackages(typeMoq.It.isValue(packageName))).returns(() => Promise.resolve(packages)).verifiable(typeMoq.Times.once());
    const info = yield lsPackageService.getLatestNugetPackageVersion();
    repo.verifyAll();
    const expectedPackage = {
      version: new semver_1.SemVer(minimumVersion),
      package: languageServerPackageRepository_1.LanguageServerPackageStorageContainers.stable,
      uri: `${languageServerPackageRepository_1.azureCDNBlobStorageAccount}/${languageServerPackageRepository_1.LanguageServerPackageStorageContainers.stable}/${packageName}.${minimumVersion}.nupkg`
    };
    chai_1.expect(info).to.deep.equal(expectedPackage);
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxhbmd1YWdlU2VydmVyUGFja2FnZVNlcnZpY2UudW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJjaGFpXzEiLCJyZXF1aXJlIiwic2VtdmVyXzEiLCJ0eXBlTW9xIiwibGFuZ3VhZ2VTZXJ2ZXJQYWNrYWdlUmVwb3NpdG9yeV8xIiwibGFuZ3VhZ2VTZXJ2ZXJQYWNrYWdlU2VydmljZV8xIiwicGxhdGZvcm1EYXRhXzEiLCJudWdldFNlcnZpY2VfMSIsInR5cGVzXzEiLCJ0eXBlc18yIiwicGxhdGZvcm1fMSIsImRvd25sb2FkQmFzZUZpbGVOYW1lIiwic3VpdGUiLCJzZXJ2aWNlQ29udGFpbmVyIiwicGxhdGZvcm0iLCJsc1BhY2thZ2VTZXJ2aWNlIiwiYXBwVmVyc2lvbiIsInNldHVwIiwiTW9jayIsIm9mVHlwZSIsImMiLCJnZXQiLCJJdCIsImlzVmFsdWUiLCJJUGxhdGZvcm1TZXJ2aWNlIiwicmV0dXJucyIsIm9iamVjdCIsIkxhbmd1YWdlU2VydmVyUGFja2FnZVNlcnZpY2UiLCJnZXRMYW5ndWFnZVNlcnZlckRvd25sb2FkQ2hhbm5lbCIsInNldE1pblZlcnNpb25PZkxzIiwidmVyc2lvbiIsInBhY2thZ2VKc29uIiwibGFuZ3VhZ2VTZXJ2ZXJWZXJzaW9uIiwiZm9yRWFjaCIsImlzNjRCaXQiLCJiaXRuZXNzIiwiYXJjaGl0ZWN0dXJlIiwiQXJjaGl0ZWN0dXJlIiwieDY0IiwieDg2IiwidGVzdCIsInAiLCJpbmZvIiwidHlwZSIsIk9TVHlwZSIsIldpbmRvd3MiLCJ2ZXJpZmlhYmxlIiwiVGltZXMiLCJhdExlYXN0T25jZSIsImV4cGVjdGVkTmFtZSIsIlBsYXRmb3JtTmFtZSIsIldpbmRvd3M2NEJpdCIsIldpbmRvd3MzMkJpdCIsIm5hbWUiLCJnZXROdWdldFBhY2thZ2VOYW1lIiwidmVyaWZ5QWxsIiwiZXhwZWN0IiwidG8iLCJiZSIsImVxdWFsIiwiT1NYIiwiTWFjNjRCaXQiLCJMaW51eCIsIkxpbnV4NjRCaXQiLCJwYWNrYWdlTmFtZSIsIm1heE1ham9yVmVyc2lvbiIsInBhY2thZ2VzIiwicGFja2FnZSIsInVyaSIsIlNlbVZlciIsImV4cGVjdGVkUGFja2FnZSIsInJlcG8iLCJudWdldCIsIklOdWdldFJlcG9zaXRvcnkiLCJpc0FueSIsIklOdWdldFNlcnZpY2UiLCJuIiwiZ2V0UGFja2FnZXMiLCJvbmNlIiwiaXNSZWxlYXNlVmVyc2lvbiIsImdldExhdGVzdE51Z2V0UGFja2FnZVZlcnNpb24iLCJkZWVwIiwiTnVnZXRTZXJ2aWNlIiwibWluaW11bVZlcnNpb24iLCJMYW5ndWFnZVNlcnZlclBhY2thZ2VTdG9yYWdlQ29udGFpbmVycyIsInN0YWJsZSIsImF6dXJlQ0ROQmxvYlN0b3JhZ2VBY2NvdW50Il0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBQ0EsSUFBSUEsU0FBUyxHQUFJLFVBQVEsU0FBS0EsU0FBZCxJQUE0QixVQUFVQyxPQUFWLEVBQW1CQyxVQUFuQixFQUErQkMsQ0FBL0IsRUFBa0NDLFNBQWxDLEVBQTZDO0FBQ3JGLFNBQU8sS0FBS0QsQ0FBQyxLQUFLQSxDQUFDLEdBQUdFLE9BQVQsQ0FBTixFQUF5QixVQUFVQyxPQUFWLEVBQW1CQyxNQUFuQixFQUEyQjtBQUN2RCxhQUFTQyxTQUFULENBQW1CQyxLQUFuQixFQUEwQjtBQUFFLFVBQUk7QUFBRUMsUUFBQUEsSUFBSSxDQUFDTixTQUFTLENBQUNPLElBQVYsQ0FBZUYsS0FBZixDQUFELENBQUo7QUFBOEIsT0FBcEMsQ0FBcUMsT0FBT0csQ0FBUCxFQUFVO0FBQUVMLFFBQUFBLE1BQU0sQ0FBQ0ssQ0FBRCxDQUFOO0FBQVk7QUFBRTs7QUFDM0YsYUFBU0MsUUFBVCxDQUFrQkosS0FBbEIsRUFBeUI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDLE9BQUQsQ0FBVCxDQUFtQkssS0FBbkIsQ0FBRCxDQUFKO0FBQWtDLE9BQXhDLENBQXlDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzlGLGFBQVNGLElBQVQsQ0FBY0ksTUFBZCxFQUFzQjtBQUFFQSxNQUFBQSxNQUFNLENBQUNDLElBQVAsR0FBY1QsT0FBTyxDQUFDUSxNQUFNLENBQUNMLEtBQVIsQ0FBckIsR0FBc0MsSUFBSU4sQ0FBSixDQUFNLFVBQVVHLE9BQVYsRUFBbUI7QUFBRUEsUUFBQUEsT0FBTyxDQUFDUSxNQUFNLENBQUNMLEtBQVIsQ0FBUDtBQUF3QixPQUFuRCxFQUFxRE8sSUFBckQsQ0FBMERSLFNBQTFELEVBQXFFSyxRQUFyRSxDQUF0QztBQUF1SDs7QUFDL0lILElBQUFBLElBQUksQ0FBQyxDQUFDTixTQUFTLEdBQUdBLFNBQVMsQ0FBQ2EsS0FBVixDQUFnQmhCLE9BQWhCLEVBQXlCQyxVQUFVLElBQUksRUFBdkMsQ0FBYixFQUF5RFMsSUFBekQsRUFBRCxDQUFKO0FBQ0gsR0FMTSxDQUFQO0FBTUgsQ0FQRDs7QUFRQU8sTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUFFWCxFQUFBQSxLQUFLLEVBQUU7QUFBVCxDQUE3QyxFLENBQ0E7O0FBQ0EsTUFBTVksTUFBTSxHQUFHQyxPQUFPLENBQUMsTUFBRCxDQUF0Qjs7QUFDQSxNQUFNQyxRQUFRLEdBQUdELE9BQU8sQ0FBQyxRQUFELENBQXhCOztBQUNBLE1BQU1FLE9BQU8sR0FBR0YsT0FBTyxDQUFDLFNBQUQsQ0FBdkI7O0FBQ0EsTUFBTUcsaUNBQWlDLEdBQUdILE9BQU8sQ0FBQywyRUFBRCxDQUFqRDs7QUFDQSxNQUFNSSw4QkFBOEIsR0FBR0osT0FBTyxDQUFDLHdFQUFELENBQTlDOztBQUNBLE1BQU1LLGNBQWMsR0FBR0wsT0FBTyxDQUFDLHlDQUFELENBQTlCOztBQUNBLE1BQU1NLGNBQWMsR0FBR04sT0FBTyxDQUFDLDJDQUFELENBQTlCOztBQUNBLE1BQU1PLE9BQU8sR0FBR1AsT0FBTyxDQUFDLG9DQUFELENBQXZCOztBQUNBLE1BQU1RLE9BQU8sR0FBR1IsT0FBTyxDQUFDLHVDQUFELENBQXZCOztBQUNBLE1BQU1TLFVBQVUsR0FBR1QsT0FBTyxDQUFDLHVDQUFELENBQTFCOztBQUNBLE1BQU1VLG9CQUFvQixHQUFHLHdCQUE3QjtBQUNBQyxLQUFLLENBQUMsaUNBQUQsRUFBb0MsTUFBTTtBQUMzQyxNQUFJQyxnQkFBSjtBQUNBLE1BQUlDLFFBQUo7QUFDQSxNQUFJQyxnQkFBSjtBQUNBLE1BQUlDLFVBQUo7QUFDQUMsRUFBQUEsS0FBSyxDQUFDLE1BQU07QUFDUkosSUFBQUEsZ0JBQWdCLEdBQUdWLE9BQU8sQ0FBQ2UsSUFBUixDQUFhQyxNQUFiLEVBQW5CO0FBQ0FMLElBQUFBLFFBQVEsR0FBR1gsT0FBTyxDQUFDZSxJQUFSLENBQWFDLE1BQWIsRUFBWDtBQUNBTixJQUFBQSxnQkFBZ0IsQ0FBQ0ksS0FBakIsQ0FBdUJHLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxHQUFGLENBQU1sQixPQUFPLENBQUNtQixFQUFSLENBQVdDLE9BQVgsQ0FBbUJkLE9BQU8sQ0FBQ2UsZ0JBQTNCLENBQU4sQ0FBNUIsRUFBaUZDLE9BQWpGLENBQXlGLE1BQU1YLFFBQVEsQ0FBQ1ksTUFBeEc7QUFDQVYsSUFBQUEsVUFBVSxHQUFHYixPQUFPLENBQUNlLElBQVIsQ0FBYUMsTUFBYixFQUFiO0FBQ0FKLElBQUFBLGdCQUFnQixHQUFHLElBQUlWLDhCQUE4QixDQUFDc0IsNEJBQW5DLENBQWdFZCxnQkFBZ0IsQ0FBQ2EsTUFBakYsRUFBeUZWLFVBQVUsQ0FBQ1UsTUFBcEcsQ0FBbkI7O0FBQ0FYLElBQUFBLGdCQUFnQixDQUFDYSxnQ0FBakIsR0FBb0QsTUFBTSxRQUExRDtBQUNILEdBUEksQ0FBTDs7QUFRQSxXQUFTQyxpQkFBVCxDQUEyQkMsT0FBM0IsRUFBb0M7QUFDaEMsVUFBTUMsV0FBVyxHQUFHO0FBQUVDLE1BQUFBLHFCQUFxQixFQUFFRjtBQUF6QixLQUFwQjtBQUNBZCxJQUFBQSxVQUFVLENBQUNDLEtBQVgsQ0FBaUIxQixDQUFDLElBQUlBLENBQUMsQ0FBQ3dDLFdBQXhCLEVBQXFDTixPQUFyQyxDQUE2QyxNQUFNTSxXQUFuRDtBQUNIOztBQUNELEdBQUMsSUFBRCxFQUFPLEtBQVAsRUFBY0UsT0FBZCxDQUFzQkMsT0FBTyxJQUFJO0FBQzdCLFVBQU1DLE9BQU8sR0FBR0QsT0FBTyxHQUFHLE9BQUgsR0FBYSxPQUFwQztBQUNBLFVBQU1FLFlBQVksR0FBR0YsT0FBTyxHQUFHeEIsVUFBVSxDQUFDMkIsWUFBWCxDQUF3QkMsR0FBM0IsR0FBaUM1QixVQUFVLENBQUMyQixZQUFYLENBQXdCRSxHQUFyRjtBQUNBQyxJQUFBQSxJQUFJLENBQUUsaUNBQWdDTCxPQUFRLEdBQTFDLEVBQThDLE1BQU14RCxTQUFTLFNBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQ2pHbUMsTUFBQUEsUUFBUSxDQUNIRyxLQURMLENBQ1d3QixDQUFDLElBQUlBLENBQUMsQ0FBQ0MsSUFEbEIsRUFFS2pCLE9BRkwsQ0FFYSxNQUFNO0FBQUUsZUFBTztBQUFFa0IsVUFBQUEsSUFBSSxFQUFFakMsVUFBVSxDQUFDa0MsTUFBWCxDQUFrQkMsT0FBMUI7QUFBbUNULFVBQUFBO0FBQW5DLFNBQVA7QUFBMkQsT0FGaEYsRUFHS1UsVUFITCxDQUdnQjNDLE9BQU8sQ0FBQzRDLEtBQVIsQ0FBY0MsV0FBZCxFQUhoQjtBQUlBLFlBQU1DLFlBQVksR0FBR2YsT0FBTyxHQUFJLEdBQUV2QixvQkFBcUIsSUFBR0wsY0FBYyxDQUFDNEMsWUFBZixDQUE0QkMsWUFBYSxFQUF2RSxHQUE0RSxHQUFFeEMsb0JBQXFCLElBQUdMLGNBQWMsQ0FBQzRDLFlBQWYsQ0FBNEJFLFlBQWEsRUFBM0s7QUFDQSxZQUFNQyxJQUFJLEdBQUd0QyxnQkFBZ0IsQ0FBQ3VDLG1CQUFqQixFQUFiO0FBQ0F4QyxNQUFBQSxRQUFRLENBQUN5QyxTQUFUO0FBQ0F2RCxNQUFBQSxNQUFNLENBQUN3RCxNQUFQLENBQWNILElBQWQsRUFBb0JJLEVBQXBCLENBQXVCQyxFQUF2QixDQUEwQkMsS0FBMUIsQ0FBZ0NWLFlBQWhDO0FBQ0gsS0FUZ0UsQ0FBN0QsQ0FBSjtBQVVBVCxJQUFBQSxJQUFJLENBQUUsNkJBQTRCTCxPQUFRLEdBQXRDLEVBQTBDLE1BQU14RCxTQUFTLFNBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQzdGbUMsTUFBQUEsUUFBUSxDQUNIRyxLQURMLENBQ1d3QixDQUFDLElBQUlBLENBQUMsQ0FBQ0MsSUFEbEIsRUFFS2pCLE9BRkwsQ0FFYSxNQUFNO0FBQUUsZUFBTztBQUFFa0IsVUFBQUEsSUFBSSxFQUFFakMsVUFBVSxDQUFDa0MsTUFBWCxDQUFrQmdCLEdBQTFCO0FBQStCeEIsVUFBQUE7QUFBL0IsU0FBUDtBQUF1RCxPQUY1RSxFQUdLVSxVQUhMLENBR2dCM0MsT0FBTyxDQUFDNEMsS0FBUixDQUFjQyxXQUFkLEVBSGhCO0FBSUEsWUFBTUMsWUFBWSxHQUFJLEdBQUV0QyxvQkFBcUIsSUFBR0wsY0FBYyxDQUFDNEMsWUFBZixDQUE0QlcsUUFBUyxFQUFyRjtBQUNBLFlBQU1SLElBQUksR0FBR3RDLGdCQUFnQixDQUFDdUMsbUJBQWpCLEVBQWI7QUFDQXhDLE1BQUFBLFFBQVEsQ0FBQ3lDLFNBQVQ7QUFDQXZELE1BQUFBLE1BQU0sQ0FBQ3dELE1BQVAsQ0FBY0gsSUFBZCxFQUFvQkksRUFBcEIsQ0FBdUJDLEVBQXZCLENBQTBCQyxLQUExQixDQUFnQ1YsWUFBaEM7QUFDSCxLQVQ0RCxDQUF6RCxDQUFKO0FBVUFULElBQUFBLElBQUksQ0FBRSwrQkFBOEJMLE9BQVEsR0FBeEMsRUFBNEMsTUFBTXhELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDL0ZtQyxNQUFBQSxRQUFRLENBQ0hHLEtBREwsQ0FDV3dCLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxJQURsQixFQUVLakIsT0FGTCxDQUVhLE1BQU07QUFBRSxlQUFPO0FBQUVrQixVQUFBQSxJQUFJLEVBQUVqQyxVQUFVLENBQUNrQyxNQUFYLENBQWtCa0IsS0FBMUI7QUFBaUMxQixVQUFBQTtBQUFqQyxTQUFQO0FBQXlELE9BRjlFLEVBR0tVLFVBSEwsQ0FHZ0IzQyxPQUFPLENBQUM0QyxLQUFSLENBQWNDLFdBQWQsRUFIaEI7QUFJQSxZQUFNQyxZQUFZLEdBQUksR0FBRXRDLG9CQUFxQixJQUFHTCxjQUFjLENBQUM0QyxZQUFmLENBQTRCYSxVQUFXLEVBQXZGO0FBQ0EsWUFBTVYsSUFBSSxHQUFHdEMsZ0JBQWdCLENBQUN1QyxtQkFBakIsRUFBYjtBQUNBeEMsTUFBQUEsUUFBUSxDQUFDeUMsU0FBVDtBQUNBdkQsTUFBQUEsTUFBTSxDQUFDd0QsTUFBUCxDQUFjSCxJQUFkLEVBQW9CSSxFQUFwQixDQUF1QkMsRUFBdkIsQ0FBMEJDLEtBQTFCLENBQWdDVixZQUFoQztBQUNILEtBVDhELENBQTNELENBQUo7QUFVSCxHQWpDRDtBQWtDQVQsRUFBQUEsSUFBSSxDQUFDLGtDQUFELEVBQXFDLE1BQU03RCxTQUFTLFNBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQ3hGLFVBQU1xRixXQUFXLEdBQUcsYUFBcEI7O0FBQ0FqRCxJQUFBQSxnQkFBZ0IsQ0FBQ3VDLG1CQUFqQixHQUF1QyxNQUFNVSxXQUE3Qzs7QUFDQWpELElBQUFBLGdCQUFnQixDQUFDa0QsZUFBakIsR0FBbUMsQ0FBbkM7QUFDQXBDLElBQUFBLGlCQUFpQixDQUFDLE9BQUQsQ0FBakI7QUFDQSxVQUFNcUMsUUFBUSxHQUFHLENBQ2I7QUFBRUMsTUFBQUEsT0FBTyxFQUFFLEVBQVg7QUFBZUMsTUFBQUEsR0FBRyxFQUFFLEVBQXBCO0FBQXdCdEMsTUFBQUEsT0FBTyxFQUFFLElBQUk1QixRQUFRLENBQUNtRSxNQUFiLENBQW9CLE9BQXBCO0FBQWpDLEtBRGEsRUFFYjtBQUFFRixNQUFBQSxPQUFPLEVBQUUsRUFBWDtBQUFlQyxNQUFBQSxHQUFHLEVBQUUsRUFBcEI7QUFBd0J0QyxNQUFBQSxPQUFPLEVBQUUsSUFBSTVCLFFBQVEsQ0FBQ21FLE1BQWIsQ0FBb0IsT0FBcEI7QUFBakMsS0FGYSxFQUdiO0FBQUVGLE1BQUFBLE9BQU8sRUFBRSxFQUFYO0FBQWVDLE1BQUFBLEdBQUcsRUFBRSxFQUFwQjtBQUF3QnRDLE1BQUFBLE9BQU8sRUFBRSxJQUFJNUIsUUFBUSxDQUFDbUUsTUFBYixDQUFvQixPQUFwQjtBQUFqQyxLQUhhLEVBSWI7QUFBRUYsTUFBQUEsT0FBTyxFQUFFLEVBQVg7QUFBZUMsTUFBQUEsR0FBRyxFQUFFLEVBQXBCO0FBQXdCdEMsTUFBQUEsT0FBTyxFQUFFLElBQUk1QixRQUFRLENBQUNtRSxNQUFiLENBQW9CLE9BQXBCO0FBQWpDLEtBSmEsQ0FBakI7QUFNQSxVQUFNQyxlQUFlLEdBQUdKLFFBQVEsQ0FBQyxDQUFELENBQWhDO0FBQ0EsVUFBTUssSUFBSSxHQUFHcEUsT0FBTyxDQUFDZSxJQUFSLENBQWFDLE1BQWIsRUFBYjtBQUNBLFVBQU1xRCxLQUFLLEdBQUdyRSxPQUFPLENBQUNlLElBQVIsQ0FBYUMsTUFBYixFQUFkO0FBQ0FOLElBQUFBLGdCQUFnQixDQUFDSSxLQUFqQixDQUF1QkcsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLEdBQUYsQ0FBTWxCLE9BQU8sQ0FBQ21CLEVBQVIsQ0FBV0MsT0FBWCxDQUFtQmYsT0FBTyxDQUFDaUUsZ0JBQTNCLENBQU4sRUFBb0R0RSxPQUFPLENBQUNtQixFQUFSLENBQVdvRCxLQUFYLEVBQXBELENBQTVCLEVBQXFHakQsT0FBckcsQ0FBNkcsTUFBTThDLElBQUksQ0FBQzdDLE1BQXhIO0FBQ0FiLElBQUFBLGdCQUFnQixDQUFDSSxLQUFqQixDQUF1QkcsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLEdBQUYsQ0FBTWxCLE9BQU8sQ0FBQ21CLEVBQVIsQ0FBV0MsT0FBWCxDQUFtQmYsT0FBTyxDQUFDbUUsYUFBM0IsQ0FBTixDQUE1QixFQUE4RWxELE9BQTlFLENBQXNGLE1BQU0rQyxLQUFLLENBQUM5QyxNQUFsRztBQUNBNkMsSUFBQUEsSUFBSSxDQUNDdEQsS0FETCxDQUNXMkQsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLFdBQUYsQ0FBYzFFLE9BQU8sQ0FBQ21CLEVBQVIsQ0FBV0MsT0FBWCxDQUFtQnlDLFdBQW5CLENBQWQsQ0FEaEIsRUFFS3ZDLE9BRkwsQ0FFYSxNQUFNekMsT0FBTyxDQUFDQyxPQUFSLENBQWdCaUYsUUFBaEIsQ0FGbkIsRUFHS3BCLFVBSEwsQ0FHZ0IzQyxPQUFPLENBQUM0QyxLQUFSLENBQWMrQixJQUFkLEVBSGhCO0FBSUFOLElBQUFBLEtBQUssQ0FDQXZELEtBREwsQ0FDVzJELENBQUMsSUFBSUEsQ0FBQyxDQUFDRyxnQkFBRixDQUFtQjVFLE9BQU8sQ0FBQ21CLEVBQVIsQ0FBV29ELEtBQVgsRUFBbkIsQ0FEaEIsRUFFS2pELE9BRkwsQ0FFYSxNQUFNLElBRm5CLEVBR0txQixVQUhMLENBR2dCM0MsT0FBTyxDQUFDNEMsS0FBUixDQUFjQyxXQUFkLEVBSGhCO0FBSUEsVUFBTU4sSUFBSSxHQUFHLE1BQU0zQixnQkFBZ0IsQ0FBQ2lFLDRCQUFqQixFQUFuQjtBQUNBVCxJQUFBQSxJQUFJLENBQUNoQixTQUFMO0FBQ0FpQixJQUFBQSxLQUFLLENBQUNqQixTQUFOO0FBQ0F2RCxJQUFBQSxNQUFNLENBQUN3RCxNQUFQLENBQWNkLElBQWQsRUFBb0JlLEVBQXBCLENBQXVCd0IsSUFBdkIsQ0FBNEJ0QixLQUE1QixDQUFrQ1csZUFBbEM7QUFDSCxHQTVCdUQsQ0FBcEQsQ0FBSjtBQTZCQTlCLEVBQUFBLElBQUksQ0FBQywwREFBRCxFQUE2RCxNQUFNN0QsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUNoSGtELElBQUFBLGlCQUFpQixDQUFDLE9BQUQsQ0FBakI7QUFDQSxVQUFNbUMsV0FBVyxHQUFHLGFBQXBCOztBQUNBakQsSUFBQUEsZ0JBQWdCLENBQUN1QyxtQkFBakIsR0FBdUMsTUFBTVUsV0FBN0M7O0FBQ0FqRCxJQUFBQSxnQkFBZ0IsQ0FBQ2tELGVBQWpCLEdBQW1DLENBQW5DO0FBQ0EsVUFBTUMsUUFBUSxHQUFHLENBQ2I7QUFBRUMsTUFBQUEsT0FBTyxFQUFFLEVBQVg7QUFBZUMsTUFBQUEsR0FBRyxFQUFFLEVBQXBCO0FBQXdCdEMsTUFBQUEsT0FBTyxFQUFFLElBQUk1QixRQUFRLENBQUNtRSxNQUFiLENBQW9CLE9BQXBCO0FBQWpDLEtBRGEsRUFFYjtBQUFFRixNQUFBQSxPQUFPLEVBQUUsRUFBWDtBQUFlQyxNQUFBQSxHQUFHLEVBQUUsRUFBcEI7QUFBd0J0QyxNQUFBQSxPQUFPLEVBQUUsSUFBSTVCLFFBQVEsQ0FBQ21FLE1BQWIsQ0FBb0IsYUFBcEI7QUFBakMsS0FGYSxFQUdiO0FBQUVGLE1BQUFBLE9BQU8sRUFBRSxFQUFYO0FBQWVDLE1BQUFBLEdBQUcsRUFBRSxFQUFwQjtBQUF3QnRDLE1BQUFBLE9BQU8sRUFBRSxJQUFJNUIsUUFBUSxDQUFDbUUsTUFBYixDQUFvQixlQUFwQjtBQUFqQyxLQUhhLEVBSWI7QUFBRUYsTUFBQUEsT0FBTyxFQUFFLEVBQVg7QUFBZUMsTUFBQUEsR0FBRyxFQUFFLEVBQXBCO0FBQXdCdEMsTUFBQUEsT0FBTyxFQUFFLElBQUk1QixRQUFRLENBQUNtRSxNQUFiLENBQW9CLGdCQUFwQjtBQUFqQyxLQUphLENBQWpCO0FBTUEsVUFBTUMsZUFBZSxHQUFHSixRQUFRLENBQUMsQ0FBRCxDQUFoQztBQUNBLFVBQU1LLElBQUksR0FBR3BFLE9BQU8sQ0FBQ2UsSUFBUixDQUFhQyxNQUFiLEVBQWI7QUFDQSxVQUFNcUQsS0FBSyxHQUFHLElBQUlqRSxjQUFjLENBQUMyRSxZQUFuQixFQUFkO0FBQ0FyRSxJQUFBQSxnQkFBZ0IsQ0FBQ0ksS0FBakIsQ0FBdUJHLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxHQUFGLENBQU1sQixPQUFPLENBQUNtQixFQUFSLENBQVdDLE9BQVgsQ0FBbUJmLE9BQU8sQ0FBQ2lFLGdCQUEzQixDQUFOLEVBQW9EdEUsT0FBTyxDQUFDbUIsRUFBUixDQUFXb0QsS0FBWCxFQUFwRCxDQUE1QixFQUFxR2pELE9BQXJHLENBQTZHLE1BQU04QyxJQUFJLENBQUM3QyxNQUF4SDtBQUNBYixJQUFBQSxnQkFBZ0IsQ0FBQ0ksS0FBakIsQ0FBdUJHLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxHQUFGLENBQU1sQixPQUFPLENBQUNtQixFQUFSLENBQVdDLE9BQVgsQ0FBbUJmLE9BQU8sQ0FBQ21FLGFBQTNCLENBQU4sQ0FBNUIsRUFBOEVsRCxPQUE5RSxDQUFzRixNQUFNK0MsS0FBNUY7QUFDQUQsSUFBQUEsSUFBSSxDQUNDdEQsS0FETCxDQUNXMkQsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLFdBQUYsQ0FBYzFFLE9BQU8sQ0FBQ21CLEVBQVIsQ0FBV0MsT0FBWCxDQUFtQnlDLFdBQW5CLENBQWQsQ0FEaEIsRUFFS3ZDLE9BRkwsQ0FFYSxNQUFNekMsT0FBTyxDQUFDQyxPQUFSLENBQWdCaUYsUUFBaEIsQ0FGbkIsRUFHS3BCLFVBSEwsQ0FHZ0IzQyxPQUFPLENBQUM0QyxLQUFSLENBQWMrQixJQUFkLEVBSGhCO0FBSUEsVUFBTXBDLElBQUksR0FBRyxNQUFNM0IsZ0JBQWdCLENBQUNpRSw0QkFBakIsRUFBbkI7QUFDQVQsSUFBQUEsSUFBSSxDQUFDaEIsU0FBTDtBQUNBdkQsSUFBQUEsTUFBTSxDQUFDd0QsTUFBUCxDQUFjZCxJQUFkLEVBQW9CZSxFQUFwQixDQUF1QndCLElBQXZCLENBQTRCdEIsS0FBNUIsQ0FBa0NXLGVBQWxDO0FBQ0gsR0F2QitFLENBQTVFLENBQUo7QUF3QkE5QixFQUFBQSxJQUFJLENBQUMsMkNBQUQsRUFBOEMsTUFBTTdELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDakcsVUFBTXdHLGNBQWMsR0FBRyxRQUF2QjtBQUNBdEQsSUFBQUEsaUJBQWlCLENBQUNzRCxjQUFELENBQWpCO0FBQ0EsVUFBTW5CLFdBQVcsR0FBRyxhQUFwQjs7QUFDQWpELElBQUFBLGdCQUFnQixDQUFDdUMsbUJBQWpCLEdBQXVDLE1BQU1VLFdBQTdDOztBQUNBakQsSUFBQUEsZ0JBQWdCLENBQUNrRCxlQUFqQixHQUFtQyxDQUFuQztBQUNBLFVBQU1DLFFBQVEsR0FBRyxDQUNiO0FBQUVDLE1BQUFBLE9BQU8sRUFBRSxFQUFYO0FBQWVDLE1BQUFBLEdBQUcsRUFBRSxFQUFwQjtBQUF3QnRDLE1BQUFBLE9BQU8sRUFBRSxJQUFJNUIsUUFBUSxDQUFDbUUsTUFBYixDQUFvQixRQUFwQjtBQUFqQyxLQURhLEVBRWI7QUFBRUYsTUFBQUEsT0FBTyxFQUFFLEVBQVg7QUFBZUMsTUFBQUEsR0FBRyxFQUFFLEVBQXBCO0FBQXdCdEMsTUFBQUEsT0FBTyxFQUFFLElBQUk1QixRQUFRLENBQUNtRSxNQUFiLENBQW9CLFFBQXBCO0FBQWpDLEtBRmEsQ0FBakI7QUFJQSxVQUFNRSxJQUFJLEdBQUdwRSxPQUFPLENBQUNlLElBQVIsQ0FBYUMsTUFBYixFQUFiO0FBQ0EsVUFBTXFELEtBQUssR0FBRyxJQUFJakUsY0FBYyxDQUFDMkUsWUFBbkIsRUFBZDtBQUNBckUsSUFBQUEsZ0JBQWdCLENBQUNJLEtBQWpCLENBQXVCRyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsR0FBRixDQUFNbEIsT0FBTyxDQUFDbUIsRUFBUixDQUFXQyxPQUFYLENBQW1CZixPQUFPLENBQUNpRSxnQkFBM0IsQ0FBTixFQUFvRHRFLE9BQU8sQ0FBQ21CLEVBQVIsQ0FBV29ELEtBQVgsRUFBcEQsQ0FBNUIsRUFBcUdqRCxPQUFyRyxDQUE2RyxNQUFNOEMsSUFBSSxDQUFDN0MsTUFBeEg7QUFDQWIsSUFBQUEsZ0JBQWdCLENBQUNJLEtBQWpCLENBQXVCRyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsR0FBRixDQUFNbEIsT0FBTyxDQUFDbUIsRUFBUixDQUFXQyxPQUFYLENBQW1CZixPQUFPLENBQUNtRSxhQUEzQixDQUFOLENBQTVCLEVBQThFbEQsT0FBOUUsQ0FBc0YsTUFBTStDLEtBQTVGO0FBQ0FELElBQUFBLElBQUksQ0FDQ3RELEtBREwsQ0FDVzJELENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxXQUFGLENBQWMxRSxPQUFPLENBQUNtQixFQUFSLENBQVdDLE9BQVgsQ0FBbUJ5QyxXQUFuQixDQUFkLENBRGhCLEVBRUt2QyxPQUZMLENBRWEsTUFBTXpDLE9BQU8sQ0FBQ0MsT0FBUixDQUFnQmlGLFFBQWhCLENBRm5CLEVBR0twQixVQUhMLENBR2dCM0MsT0FBTyxDQUFDNEMsS0FBUixDQUFjK0IsSUFBZCxFQUhoQjtBQUlBLFVBQU1wQyxJQUFJLEdBQUcsTUFBTTNCLGdCQUFnQixDQUFDaUUsNEJBQWpCLEVBQW5CO0FBQ0FULElBQUFBLElBQUksQ0FBQ2hCLFNBQUw7QUFDQSxVQUFNZSxlQUFlLEdBQUc7QUFDcEJ4QyxNQUFBQSxPQUFPLEVBQUUsSUFBSTVCLFFBQVEsQ0FBQ21FLE1BQWIsQ0FBb0JjLGNBQXBCLENBRFc7QUFFcEJoQixNQUFBQSxPQUFPLEVBQUUvRCxpQ0FBaUMsQ0FBQ2dGLHNDQUFsQyxDQUF5RUMsTUFGOUQ7QUFHcEJqQixNQUFBQSxHQUFHLEVBQUcsR0FBRWhFLGlDQUFpQyxDQUFDa0YsMEJBQTJCLElBQUdsRixpQ0FBaUMsQ0FBQ2dGLHNDQUFsQyxDQUF5RUMsTUFBTyxJQUFHckIsV0FBWSxJQUFHbUIsY0FBZTtBQUhySyxLQUF4QjtBQUtBbkYsSUFBQUEsTUFBTSxDQUFDd0QsTUFBUCxDQUFjZCxJQUFkLEVBQW9CZSxFQUFwQixDQUF1QndCLElBQXZCLENBQTRCdEIsS0FBNUIsQ0FBa0NXLGVBQWxDO0FBQ0gsR0ExQmdFLENBQTdELENBQUo7QUEyQkgsQ0FuSUksQ0FBTCIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbid1c2Ugc3RyaWN0JztcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZTpuby1hbnkgbm8taW52YWxpZC10aGlzIG1heC1mdW5jLWJvZHktbGVuZ3RoXHJcbmNvbnN0IGNoYWlfMSA9IHJlcXVpcmUoXCJjaGFpXCIpO1xyXG5jb25zdCBzZW12ZXJfMSA9IHJlcXVpcmUoXCJzZW12ZXJcIik7XHJcbmNvbnN0IHR5cGVNb3EgPSByZXF1aXJlKFwidHlwZW1vcVwiKTtcclxuY29uc3QgbGFuZ3VhZ2VTZXJ2ZXJQYWNrYWdlUmVwb3NpdG9yeV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9hY3RpdmF0aW9uL2xhbmd1YWdlU2VydmVyL2xhbmd1YWdlU2VydmVyUGFja2FnZVJlcG9zaXRvcnlcIik7XHJcbmNvbnN0IGxhbmd1YWdlU2VydmVyUGFja2FnZVNlcnZpY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvYWN0aXZhdGlvbi9sYW5ndWFnZVNlcnZlci9sYW5ndWFnZVNlcnZlclBhY2thZ2VTZXJ2aWNlXCIpO1xyXG5jb25zdCBwbGF0Zm9ybURhdGFfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvYWN0aXZhdGlvbi9wbGF0Zm9ybURhdGFcIik7XHJcbmNvbnN0IG51Z2V0U2VydmljZV8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vbnVnZXQvbnVnZXRTZXJ2aWNlXCIpO1xyXG5jb25zdCB0eXBlc18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vbnVnZXQvdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzIgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2NvbW1vbi9wbGF0Zm9ybS90eXBlc1wiKTtcclxuY29uc3QgcGxhdGZvcm1fMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL3V0aWxzL3BsYXRmb3JtXCIpO1xyXG5jb25zdCBkb3dubG9hZEJhc2VGaWxlTmFtZSA9ICdQeXRob24tTGFuZ3VhZ2UtU2VydmVyJztcclxuc3VpdGUoJ0xhbmd1YWdlIFNlcnZlciBQYWNrYWdlIFNlcnZpY2UnLCAoKSA9PiB7XHJcbiAgICBsZXQgc2VydmljZUNvbnRhaW5lcjtcclxuICAgIGxldCBwbGF0Zm9ybTtcclxuICAgIGxldCBsc1BhY2thZ2VTZXJ2aWNlO1xyXG4gICAgbGV0IGFwcFZlcnNpb247XHJcbiAgICBzZXR1cCgoKSA9PiB7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lciA9IHR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBwbGF0Zm9ybSA9IHR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQodHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzIuSVBsYXRmb3JtU2VydmljZSkpKS5yZXR1cm5zKCgpID0+IHBsYXRmb3JtLm9iamVjdCk7XHJcbiAgICAgICAgYXBwVmVyc2lvbiA9IHR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBsc1BhY2thZ2VTZXJ2aWNlID0gbmV3IGxhbmd1YWdlU2VydmVyUGFja2FnZVNlcnZpY2VfMS5MYW5ndWFnZVNlcnZlclBhY2thZ2VTZXJ2aWNlKHNlcnZpY2VDb250YWluZXIub2JqZWN0LCBhcHBWZXJzaW9uLm9iamVjdCk7XHJcbiAgICAgICAgbHNQYWNrYWdlU2VydmljZS5nZXRMYW5ndWFnZVNlcnZlckRvd25sb2FkQ2hhbm5lbCA9ICgpID0+ICdzdGFibGUnO1xyXG4gICAgfSk7XHJcbiAgICBmdW5jdGlvbiBzZXRNaW5WZXJzaW9uT2ZMcyh2ZXJzaW9uKSB7XHJcbiAgICAgICAgY29uc3QgcGFja2FnZUpzb24gPSB7IGxhbmd1YWdlU2VydmVyVmVyc2lvbjogdmVyc2lvbiB9O1xyXG4gICAgICAgIGFwcFZlcnNpb24uc2V0dXAoZSA9PiBlLnBhY2thZ2VKc29uKS5yZXR1cm5zKCgpID0+IHBhY2thZ2VKc29uKTtcclxuICAgIH1cclxuICAgIFt0cnVlLCBmYWxzZV0uZm9yRWFjaChpczY0Qml0ID0+IHtcclxuICAgICAgICBjb25zdCBiaXRuZXNzID0gaXM2NEJpdCA/ICc2NGJpdCcgOiAnMzJiaXQnO1xyXG4gICAgICAgIGNvbnN0IGFyY2hpdGVjdHVyZSA9IGlzNjRCaXQgPyBwbGF0Zm9ybV8xLkFyY2hpdGVjdHVyZS54NjQgOiBwbGF0Zm9ybV8xLkFyY2hpdGVjdHVyZS54ODY7XHJcbiAgICAgICAgdGVzdChgR2V0IFBhY2thZ2UgbmFtZSBmb3IgV2luZG93cyAoJHtiaXRuZXNzfSlgLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIHBsYXRmb3JtXHJcbiAgICAgICAgICAgICAgICAuc2V0dXAocCA9PiBwLmluZm8pXHJcbiAgICAgICAgICAgICAgICAucmV0dXJucygoKSA9PiB7IHJldHVybiB7IHR5cGU6IHBsYXRmb3JtXzEuT1NUeXBlLldpbmRvd3MsIGFyY2hpdGVjdHVyZSB9OyB9KVxyXG4gICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZU1vcS5UaW1lcy5hdExlYXN0T25jZSgpKTtcclxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWROYW1lID0gaXM2NEJpdCA/IGAke2Rvd25sb2FkQmFzZUZpbGVOYW1lfS0ke3BsYXRmb3JtRGF0YV8xLlBsYXRmb3JtTmFtZS5XaW5kb3dzNjRCaXR9YCA6IGAke2Rvd25sb2FkQmFzZUZpbGVOYW1lfS0ke3BsYXRmb3JtRGF0YV8xLlBsYXRmb3JtTmFtZS5XaW5kb3dzMzJCaXR9YDtcclxuICAgICAgICAgICAgY29uc3QgbmFtZSA9IGxzUGFja2FnZVNlcnZpY2UuZ2V0TnVnZXRQYWNrYWdlTmFtZSgpO1xyXG4gICAgICAgICAgICBwbGF0Zm9ybS52ZXJpZnlBbGwoKTtcclxuICAgICAgICAgICAgY2hhaV8xLmV4cGVjdChuYW1lKS50by5iZS5lcXVhbChleHBlY3RlZE5hbWUpO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB0ZXN0KGBHZXQgUGFja2FnZSBuYW1lIGZvciBNYWMgKCR7Yml0bmVzc30pYCwgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBwbGF0Zm9ybVxyXG4gICAgICAgICAgICAgICAgLnNldHVwKHAgPT4gcC5pbmZvKVxyXG4gICAgICAgICAgICAgICAgLnJldHVybnMoKCkgPT4geyByZXR1cm4geyB0eXBlOiBwbGF0Zm9ybV8xLk9TVHlwZS5PU1gsIGFyY2hpdGVjdHVyZSB9OyB9KVxyXG4gICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZU1vcS5UaW1lcy5hdExlYXN0T25jZSgpKTtcclxuICAgICAgICAgICAgY29uc3QgZXhwZWN0ZWROYW1lID0gYCR7ZG93bmxvYWRCYXNlRmlsZU5hbWV9LSR7cGxhdGZvcm1EYXRhXzEuUGxhdGZvcm1OYW1lLk1hYzY0Qml0fWA7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWUgPSBsc1BhY2thZ2VTZXJ2aWNlLmdldE51Z2V0UGFja2FnZU5hbWUoKTtcclxuICAgICAgICAgICAgcGxhdGZvcm0udmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3QobmFtZSkudG8uYmUuZXF1YWwoZXhwZWN0ZWROYW1lKTtcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgdGVzdChgR2V0IFBhY2thZ2UgbmFtZSBmb3IgTGludXggKCR7Yml0bmVzc30pYCwgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBwbGF0Zm9ybVxyXG4gICAgICAgICAgICAgICAgLnNldHVwKHAgPT4gcC5pbmZvKVxyXG4gICAgICAgICAgICAgICAgLnJldHVybnMoKCkgPT4geyByZXR1cm4geyB0eXBlOiBwbGF0Zm9ybV8xLk9TVHlwZS5MaW51eCwgYXJjaGl0ZWN0dXJlIH07IH0pXHJcbiAgICAgICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlTW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZE5hbWUgPSBgJHtkb3dubG9hZEJhc2VGaWxlTmFtZX0tJHtwbGF0Zm9ybURhdGFfMS5QbGF0Zm9ybU5hbWUuTGludXg2NEJpdH1gO1xyXG4gICAgICAgICAgICBjb25zdCBuYW1lID0gbHNQYWNrYWdlU2VydmljZS5nZXROdWdldFBhY2thZ2VOYW1lKCk7XHJcbiAgICAgICAgICAgIHBsYXRmb3JtLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgICAgICBjaGFpXzEuZXhwZWN0KG5hbWUpLnRvLmJlLmVxdWFsKGV4cGVjdGVkTmFtZSk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdHZXQgbGF0ZXN0IG51Z2V0IHBhY2thZ2UgdmVyc2lvbicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBwYWNrYWdlTmFtZSA9ICdwYWNrYWdlTmFtZSc7XHJcbiAgICAgICAgbHNQYWNrYWdlU2VydmljZS5nZXROdWdldFBhY2thZ2VOYW1lID0gKCkgPT4gcGFja2FnZU5hbWU7XHJcbiAgICAgICAgbHNQYWNrYWdlU2VydmljZS5tYXhNYWpvclZlcnNpb24gPSAzO1xyXG4gICAgICAgIHNldE1pblZlcnNpb25PZkxzKCcwLjAuMScpO1xyXG4gICAgICAgIGNvbnN0IHBhY2thZ2VzID0gW1xyXG4gICAgICAgICAgICB7IHBhY2thZ2U6ICcnLCB1cmk6ICcnLCB2ZXJzaW9uOiBuZXcgc2VtdmVyXzEuU2VtVmVyKCcxLjEuMScpIH0sXHJcbiAgICAgICAgICAgIHsgcGFja2FnZTogJycsIHVyaTogJycsIHZlcnNpb246IG5ldyBzZW12ZXJfMS5TZW1WZXIoJzMuNC4xJykgfSxcclxuICAgICAgICAgICAgeyBwYWNrYWdlOiAnJywgdXJpOiAnJywgdmVyc2lvbjogbmV3IHNlbXZlcl8xLlNlbVZlcignMy4xLjEnKSB9LFxyXG4gICAgICAgICAgICB7IHBhY2thZ2U6ICcnLCB1cmk6ICcnLCB2ZXJzaW9uOiBuZXcgc2VtdmVyXzEuU2VtVmVyKCcyLjEuMScpIH1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkUGFja2FnZSA9IHBhY2thZ2VzWzFdO1xyXG4gICAgICAgIGNvbnN0IHJlcG8gPSB0eXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgY29uc3QgbnVnZXQgPSB0eXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KHR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18xLklOdWdldFJlcG9zaXRvcnkpLCB0eXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHJlcG8ub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQodHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzEuSU51Z2V0U2VydmljZSkpKS5yZXR1cm5zKCgpID0+IG51Z2V0Lm9iamVjdCk7XHJcbiAgICAgICAgcmVwb1xyXG4gICAgICAgICAgICAuc2V0dXAobiA9PiBuLmdldFBhY2thZ2VzKHR5cGVNb3EuSXQuaXNWYWx1ZShwYWNrYWdlTmFtZSkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUocGFja2FnZXMpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgbnVnZXRcclxuICAgICAgICAgICAgLnNldHVwKG4gPT4gbi5pc1JlbGVhc2VWZXJzaW9uKHR5cGVNb3EuSXQuaXNBbnkoKSkpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IHRydWUpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKHR5cGVNb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgaW5mbyA9IHlpZWxkIGxzUGFja2FnZVNlcnZpY2UuZ2V0TGF0ZXN0TnVnZXRQYWNrYWdlVmVyc2lvbigpO1xyXG4gICAgICAgIHJlcG8udmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgbnVnZXQudmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpbmZvKS50by5kZWVwLmVxdWFsKGV4cGVjdGVkUGFja2FnZSk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdHZXQgbGF0ZXN0IG51Z2V0IHBhY2thZ2UgdmVyc2lvbiAoZXhjbHVkaW5nIG5vbi1yZWxlYXNlKScsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBzZXRNaW5WZXJzaW9uT2ZMcygnMC4wLjEnKTtcclxuICAgICAgICBjb25zdCBwYWNrYWdlTmFtZSA9ICdwYWNrYWdlTmFtZSc7XHJcbiAgICAgICAgbHNQYWNrYWdlU2VydmljZS5nZXROdWdldFBhY2thZ2VOYW1lID0gKCkgPT4gcGFja2FnZU5hbWU7XHJcbiAgICAgICAgbHNQYWNrYWdlU2VydmljZS5tYXhNYWpvclZlcnNpb24gPSAxO1xyXG4gICAgICAgIGNvbnN0IHBhY2thZ2VzID0gW1xyXG4gICAgICAgICAgICB7IHBhY2thZ2U6ICcnLCB1cmk6ICcnLCB2ZXJzaW9uOiBuZXcgc2VtdmVyXzEuU2VtVmVyKCcxLjEuMScpIH0sXHJcbiAgICAgICAgICAgIHsgcGFja2FnZTogJycsIHVyaTogJycsIHZlcnNpb246IG5ldyBzZW12ZXJfMS5TZW1WZXIoJzEuMy4xLWFscGhhJykgfSxcclxuICAgICAgICAgICAgeyBwYWNrYWdlOiAnJywgdXJpOiAnJywgdmVyc2lvbjogbmV3IHNlbXZlcl8xLlNlbVZlcignMS40LjEtcHJldmlldycpIH0sXHJcbiAgICAgICAgICAgIHsgcGFja2FnZTogJycsIHVyaTogJycsIHZlcnNpb246IG5ldyBzZW12ZXJfMS5TZW1WZXIoJzEuMi4xLWludGVybmFsJykgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgY29uc3QgZXhwZWN0ZWRQYWNrYWdlID0gcGFja2FnZXNbMF07XHJcbiAgICAgICAgY29uc3QgcmVwbyA9IHR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBjb25zdCBudWdldCA9IG5ldyBudWdldFNlcnZpY2VfMS5OdWdldFNlcnZpY2UoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQodHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzEuSU51Z2V0UmVwb3NpdG9yeSksIHR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gcmVwby5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldCh0eXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMS5JTnVnZXRTZXJ2aWNlKSkpLnJldHVybnMoKCkgPT4gbnVnZXQpO1xyXG4gICAgICAgIHJlcG9cclxuICAgICAgICAgICAgLnNldHVwKG4gPT4gbi5nZXRQYWNrYWdlcyh0eXBlTW9xLkl0LmlzVmFsdWUocGFja2FnZU5hbWUpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHBhY2thZ2VzKSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IGluZm8gPSB5aWVsZCBsc1BhY2thZ2VTZXJ2aWNlLmdldExhdGVzdE51Z2V0UGFja2FnZVZlcnNpb24oKTtcclxuICAgICAgICByZXBvLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoaW5mbykudG8uZGVlcC5lcXVhbChleHBlY3RlZFBhY2thZ2UpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5zdXJlIG1pbmltdW0gdmVyc2lvbiBvZiBwYWNrYWdlIGlzIHVzZWQnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgbWluaW11bVZlcnNpb24gPSAnMC4xLjUwJztcclxuICAgICAgICBzZXRNaW5WZXJzaW9uT2ZMcyhtaW5pbXVtVmVyc2lvbik7XHJcbiAgICAgICAgY29uc3QgcGFja2FnZU5hbWUgPSAncGFja2FnZU5hbWUnO1xyXG4gICAgICAgIGxzUGFja2FnZVNlcnZpY2UuZ2V0TnVnZXRQYWNrYWdlTmFtZSA9ICgpID0+IHBhY2thZ2VOYW1lO1xyXG4gICAgICAgIGxzUGFja2FnZVNlcnZpY2UubWF4TWFqb3JWZXJzaW9uID0gMDtcclxuICAgICAgICBjb25zdCBwYWNrYWdlcyA9IFtcclxuICAgICAgICAgICAgeyBwYWNrYWdlOiAnJywgdXJpOiAnJywgdmVyc2lvbjogbmV3IHNlbXZlcl8xLlNlbVZlcignMC4xLjQ4JykgfSxcclxuICAgICAgICAgICAgeyBwYWNrYWdlOiAnJywgdXJpOiAnJywgdmVyc2lvbjogbmV3IHNlbXZlcl8xLlNlbVZlcignMC4xLjQ5JykgfVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgY29uc3QgcmVwbyA9IHR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBjb25zdCBudWdldCA9IG5ldyBudWdldFNlcnZpY2VfMS5OdWdldFNlcnZpY2UoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKGMgPT4gYy5nZXQodHlwZU1vcS5JdC5pc1ZhbHVlKHR5cGVzXzEuSU51Z2V0UmVwb3NpdG9yeSksIHR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gcmVwby5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldCh0eXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMS5JTnVnZXRTZXJ2aWNlKSkpLnJldHVybnMoKCkgPT4gbnVnZXQpO1xyXG4gICAgICAgIHJlcG9cclxuICAgICAgICAgICAgLnNldHVwKG4gPT4gbi5nZXRQYWNrYWdlcyh0eXBlTW9xLkl0LmlzVmFsdWUocGFja2FnZU5hbWUpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHBhY2thZ2VzKSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IGluZm8gPSB5aWVsZCBsc1BhY2thZ2VTZXJ2aWNlLmdldExhdGVzdE51Z2V0UGFja2FnZVZlcnNpb24oKTtcclxuICAgICAgICByZXBvLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIGNvbnN0IGV4cGVjdGVkUGFja2FnZSA9IHtcclxuICAgICAgICAgICAgdmVyc2lvbjogbmV3IHNlbXZlcl8xLlNlbVZlcihtaW5pbXVtVmVyc2lvbiksXHJcbiAgICAgICAgICAgIHBhY2thZ2U6IGxhbmd1YWdlU2VydmVyUGFja2FnZVJlcG9zaXRvcnlfMS5MYW5ndWFnZVNlcnZlclBhY2thZ2VTdG9yYWdlQ29udGFpbmVycy5zdGFibGUsXHJcbiAgICAgICAgICAgIHVyaTogYCR7bGFuZ3VhZ2VTZXJ2ZXJQYWNrYWdlUmVwb3NpdG9yeV8xLmF6dXJlQ0ROQmxvYlN0b3JhZ2VBY2NvdW50fS8ke2xhbmd1YWdlU2VydmVyUGFja2FnZVJlcG9zaXRvcnlfMS5MYW5ndWFnZVNlcnZlclBhY2thZ2VTdG9yYWdlQ29udGFpbmVycy5zdGFibGV9LyR7cGFja2FnZU5hbWV9LiR7bWluaW11bVZlcnNpb259Lm51cGtnYFxyXG4gICAgICAgIH07XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpbmZvKS50by5kZWVwLmVxdWFsKGV4cGVjdGVkUGFja2FnZSk7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1sYW5ndWFnZVNlcnZlclBhY2thZ2VTZXJ2aWNlLnVuaXQudGVzdC5qcy5tYXAiXX0=