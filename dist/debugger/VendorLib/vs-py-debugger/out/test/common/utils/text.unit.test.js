// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:max-func-body-length no-any no-require-imports no-var-requires

const chai_1 = require("chai");

const vscode_1 = require("vscode");

const text_1 = require("../../../client/common/utils/text");

suite('parseRange()', () => {
  test('valid strings', () => __awaiter(void 0, void 0, void 0, function* () {
    const tests = [['1:5-3:5', new vscode_1.Range(new vscode_1.Position(1, 5), new vscode_1.Position(3, 5))], ['1:5-3:3', new vscode_1.Range(new vscode_1.Position(1, 5), new vscode_1.Position(3, 3))], ['1:3-3:5', new vscode_1.Range(new vscode_1.Position(1, 3), new vscode_1.Position(3, 5))], ['1-3:5', new vscode_1.Range(new vscode_1.Position(1, 0), new vscode_1.Position(3, 5))], ['1-3', new vscode_1.Range(new vscode_1.Position(1, 0), new vscode_1.Position(3, 0))], ['1-1', new vscode_1.Range(new vscode_1.Position(1, 0), new vscode_1.Position(1, 0))], ['1', new vscode_1.Range(new vscode_1.Position(1, 0), new vscode_1.Position(1, 0))], ['1:3-', new vscode_1.Range(new vscode_1.Position(1, 3), new vscode_1.Position(0, 0) // ???
    )], ['1:3', new vscode_1.Range(new vscode_1.Position(1, 3), new vscode_1.Position(1, 3))], ['', new vscode_1.Range(new vscode_1.Position(0, 0), new vscode_1.Position(0, 0))], ['3-1', new vscode_1.Range(new vscode_1.Position(3, 0), new vscode_1.Position(1, 0))]];

    for (const [raw, expected] of tests) {
      const result = text_1.parseRange(raw);
      chai_1.expect(result).to.deep.equal(expected);
    }
  }));
  test('valid numbers', () => __awaiter(void 0, void 0, void 0, function* () {
    const tests = [[1, new vscode_1.Range(new vscode_1.Position(1, 0), new vscode_1.Position(1, 0))]];

    for (const [raw, expected] of tests) {
      const result = text_1.parseRange(raw);
      chai_1.expect(result).to.deep.equal(expected);
    }
  }));
  test('bad strings', () => __awaiter(void 0, void 0, void 0, function* () {
    const tests = ['1-2-3', '1:4-2-3', '1-2:4-3', '1-2-3:4', '1:2:3', '1:2:3-4', '1-2:3:4', '1:2:3-4:5:6', '1-a', '1:2-a', '1-a:2', '1:2-a:2', 'a-1', 'a-b', 'a', 'a:1', 'a:b'];

    for (const raw of tests) {
      chai_1.expect(() => text_1.parseRange(raw)).to.throw();
    }
  }));
});
suite('parsePosition()', () => {
  test('valid strings', () => __awaiter(void 0, void 0, void 0, function* () {
    const tests = [['1:5', new vscode_1.Position(1, 5)], ['1', new vscode_1.Position(1, 0)], ['', new vscode_1.Position(0, 0)]];

    for (const [raw, expected] of tests) {
      const result = text_1.parsePosition(raw);
      chai_1.expect(result).to.deep.equal(expected);
    }
  }));
  test('valid numbers', () => __awaiter(void 0, void 0, void 0, function* () {
    const tests = [[1, new vscode_1.Position(1, 0)]];

    for (const [raw, expected] of tests) {
      const result = text_1.parsePosition(raw);
      chai_1.expect(result).to.deep.equal(expected);
    }
  }));
  test('bad strings', () => __awaiter(void 0, void 0, void 0, function* () {
    const tests = ['1:2:3', '1:a', 'a'];

    for (const raw of tests) {
      chai_1.expect(() => text_1.parsePosition(raw)).to.throw();
    }
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRleHQudW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJjaGFpXzEiLCJyZXF1aXJlIiwidnNjb2RlXzEiLCJ0ZXh0XzEiLCJzdWl0ZSIsInRlc3QiLCJ0ZXN0cyIsIlJhbmdlIiwiUG9zaXRpb24iLCJyYXciLCJleHBlY3RlZCIsInBhcnNlUmFuZ2UiLCJleHBlY3QiLCJ0byIsImRlZXAiLCJlcXVhbCIsInRocm93IiwicGFyc2VQb3NpdGlvbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFKO0FBQThCLE9BQXBDLENBQXFDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzNGLGFBQVNDLFFBQVQsQ0FBa0JKLEtBQWxCLEVBQXlCO0FBQUUsVUFBSTtBQUFFQyxRQUFBQSxJQUFJLENBQUNOLFNBQVMsQ0FBQyxPQUFELENBQVQsQ0FBbUJLLEtBQW5CLENBQUQsQ0FBSjtBQUFrQyxPQUF4QyxDQUF5QyxPQUFPRyxDQUFQLEVBQVU7QUFBRUwsUUFBQUEsTUFBTSxDQUFDSyxDQUFELENBQU47QUFBWTtBQUFFOztBQUM5RixhQUFTRixJQUFULENBQWNJLE1BQWQsRUFBc0I7QUFBRUEsTUFBQUEsTUFBTSxDQUFDQyxJQUFQLEdBQWNULE9BQU8sQ0FBQ1EsTUFBTSxDQUFDTCxLQUFSLENBQXJCLEdBQXNDLElBQUlOLENBQUosQ0FBTSxVQUFVRyxPQUFWLEVBQW1CO0FBQUVBLFFBQUFBLE9BQU8sQ0FBQ1EsTUFBTSxDQUFDTCxLQUFSLENBQVA7QUFBd0IsT0FBbkQsRUFBcURPLElBQXJELENBQTBEUixTQUExRCxFQUFxRUssUUFBckUsQ0FBdEM7QUFBdUg7O0FBQy9JSCxJQUFBQSxJQUFJLENBQUMsQ0FBQ04sU0FBUyxHQUFHQSxTQUFTLENBQUNhLEtBQVYsQ0FBZ0JoQixPQUFoQixFQUF5QkMsVUFBVSxJQUFJLEVBQXZDLENBQWIsRUFBeURTLElBQXpELEVBQUQsQ0FBSjtBQUNILEdBTE0sQ0FBUDtBQU1ILENBUEQ7O0FBUUFPLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFBRVgsRUFBQUEsS0FBSyxFQUFFO0FBQVQsQ0FBN0MsRSxDQUNBOztBQUNBLE1BQU1ZLE1BQU0sR0FBR0MsT0FBTyxDQUFDLE1BQUQsQ0FBdEI7O0FBQ0EsTUFBTUMsUUFBUSxHQUFHRCxPQUFPLENBQUMsUUFBRCxDQUF4Qjs7QUFDQSxNQUFNRSxNQUFNLEdBQUdGLE9BQU8sQ0FBQyxtQ0FBRCxDQUF0Qjs7QUFDQUcsS0FBSyxDQUFDLGNBQUQsRUFBaUIsTUFBTTtBQUN4QkMsRUFBQUEsSUFBSSxDQUFDLGVBQUQsRUFBa0IsTUFBTTFCLFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDckUsVUFBTTJCLEtBQUssR0FBRyxDQUNWLENBQUMsU0FBRCxFQUFZLElBQUlKLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVosQ0FEVSxFQUVWLENBQUMsU0FBRCxFQUFZLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVosQ0FGVSxFQUdWLENBQUMsU0FBRCxFQUFZLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVosQ0FIVSxFQUlWLENBQUMsT0FBRCxFQUFVLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVYsQ0FKVSxFQUtWLENBQUMsS0FBRCxFQUFRLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVIsQ0FMVSxFQU1WLENBQUMsS0FBRCxFQUFRLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVIsQ0FOVSxFQU9WLENBQUMsR0FBRCxFQUFNLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQU4sQ0FQVSxFQVFWLENBQUMsTUFBRCxFQUFTLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQTRFO0FBQTVFLEtBQVQsQ0FSVSxFQVVWLENBQUMsS0FBRCxFQUFRLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQVIsQ0FWVSxFQVdWLENBQUMsRUFBRCxFQUFLLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVBQXlCLENBQXpCLENBQWhELENBQUwsQ0FYVSxFQVlWLENBQUMsS0FBRCxFQUFRLElBQUlOLFFBQVEsQ0FBQ0ssS0FBYixDQUFtQixJQUFJTCxRQUFRLENBQUNNLFFBQWIsQ0FBc0IsQ0FBdEIsRUFBeUIsQ0FBekIsQ0FBbkIsRUFBZ0QsSUFBSU4sUUFBUSxDQUFDTSxRQUFiLENBQXNCLENBQXRCLEVB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cmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbid1c2Ugc3RyaWN0JztcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZTptYXgtZnVuYy1ib2R5LWxlbmd0aCBuby1hbnkgbm8tcmVxdWlyZS1pbXBvcnRzIG5vLXZhci1yZXF1aXJlc1xyXG5jb25zdCBjaGFpXzEgPSByZXF1aXJlKFwiY2hhaVwiKTtcclxuY29uc3QgdnNjb2RlXzEgPSByZXF1aXJlKFwidnNjb2RlXCIpO1xyXG5jb25zdCB0ZXh0XzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2NvbW1vbi91dGlscy90ZXh0XCIpO1xyXG5zdWl0ZSgncGFyc2VSYW5nZSgpJywgKCkgPT4ge1xyXG4gICAgdGVzdCgndmFsaWQgc3RyaW5ncycsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB0ZXN0cyA9IFtcclxuICAgICAgICAgICAgWycxOjUtMzo1JywgbmV3IHZzY29kZV8xLlJhbmdlKG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigxLCA1KSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDMsIDUpKV0sXHJcbiAgICAgICAgICAgIFsnMTo1LTM6MycsIG5ldyB2c2NvZGVfMS5SYW5nZShuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgNSksIG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigzLCAzKSldLFxyXG4gICAgICAgICAgICBbJzE6My0zOjUnLCBuZXcgdnNjb2RlXzEuUmFuZ2UobmV3IHZzY29kZV8xLlBvc2l0aW9uKDEsIDMpLCBuZXcgdnNjb2RlXzEuUG9zaXRpb24oMywgNSkpXSxcclxuICAgICAgICAgICAgWycxLTM6NScsIG5ldyB2c2NvZGVfMS5SYW5nZShuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgMCksIG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigzLCA1KSldLFxyXG4gICAgICAgICAgICBbJzEtMycsIG5ldyB2c2NvZGVfMS5SYW5nZShuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgMCksIG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigzLCAwKSldLFxyXG4gICAgICAgICAgICBbJzEtMScsIG5ldyB2c2NvZGVfMS5SYW5nZShuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgMCksIG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigxLCAwKSldLFxyXG4gICAgICAgICAgICBbJzEnLCBuZXcgdnNjb2RlXzEuUmFuZ2UobmV3IHZzY29kZV8xLlBvc2l0aW9uKDEsIDApLCBuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgMCkpXSxcclxuICAgICAgICAgICAgWycxOjMtJywgbmV3IHZzY29kZV8xLlJhbmdlKG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigxLCAzKSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDAsIDApIC8vID8/P1xyXG4gICAgICAgICAgICAgICAgKV0sXHJcbiAgICAgICAgICAgIFsnMTozJywgbmV3IHZzY29kZV8xLlJhbmdlKG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigxLCAzKSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDEsIDMpKV0sXHJcbiAgICAgICAgICAgIFsnJywgbmV3IHZzY29kZV8xLlJhbmdlKG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigwLCAwKSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDAsIDApKV0sXHJcbiAgICAgICAgICAgIFsnMy0xJywgbmV3IHZzY29kZV8xLlJhbmdlKG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigzLCAwKSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDEsIDApKV1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGZvciAoY29uc3QgW3JhdywgZXhwZWN0ZWRdIG9mIHRlc3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRleHRfMS5wYXJzZVJhbmdlKHJhdyk7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3QocmVzdWx0KS50by5kZWVwLmVxdWFsKGV4cGVjdGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCd2YWxpZCBudW1iZXJzJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHRlc3RzID0gW1xyXG4gICAgICAgICAgICBbMSwgbmV3IHZzY29kZV8xLlJhbmdlKG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigxLCAwKSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDEsIDApKV1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGZvciAoY29uc3QgW3JhdywgZXhwZWN0ZWRdIG9mIHRlc3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRleHRfMS5wYXJzZVJhbmdlKHJhdyk7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3QocmVzdWx0KS50by5kZWVwLmVxdWFsKGV4cGVjdGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdiYWQgc3RyaW5ncycsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB0ZXN0cyA9IFtcclxuICAgICAgICAgICAgJzEtMi0zJyxcclxuICAgICAgICAgICAgJzE6NC0yLTMnLFxyXG4gICAgICAgICAgICAnMS0yOjQtMycsXHJcbiAgICAgICAgICAgICcxLTItMzo0JyxcclxuICAgICAgICAgICAgJzE6MjozJyxcclxuICAgICAgICAgICAgJzE6MjozLTQnLFxyXG4gICAgICAgICAgICAnMS0yOjM6NCcsXHJcbiAgICAgICAgICAgICcxOjI6My00OjU6NicsXHJcbiAgICAgICAgICAgICcxLWEnLFxyXG4gICAgICAgICAgICAnMToyLWEnLFxyXG4gICAgICAgICAgICAnMS1hOjInLFxyXG4gICAgICAgICAgICAnMToyLWE6MicsXHJcbiAgICAgICAgICAgICdhLTEnLFxyXG4gICAgICAgICAgICAnYS1iJyxcclxuICAgICAgICAgICAgJ2EnLFxyXG4gICAgICAgICAgICAnYToxJyxcclxuICAgICAgICAgICAgJ2E6YidcclxuICAgICAgICBdO1xyXG4gICAgICAgIGZvciAoY29uc3QgcmF3IG9mIHRlc3RzKSB7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3QoKCkgPT4gdGV4dF8xLnBhcnNlUmFuZ2UocmF3KSkudG8udGhyb3coKTtcclxuICAgICAgICB9XHJcbiAgICB9KSk7XHJcbn0pO1xyXG5zdWl0ZSgncGFyc2VQb3NpdGlvbigpJywgKCkgPT4ge1xyXG4gICAgdGVzdCgndmFsaWQgc3RyaW5ncycsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB0ZXN0cyA9IFtcclxuICAgICAgICAgICAgWycxOjUnLCBuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgNSldLFxyXG4gICAgICAgICAgICBbJzEnLCBuZXcgdnNjb2RlXzEuUG9zaXRpb24oMSwgMCldLFxyXG4gICAgICAgICAgICBbJycsIG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigwLCAwKV1cclxuICAgICAgICBdO1xyXG4gICAgICAgIGZvciAoY29uc3QgW3JhdywgZXhwZWN0ZWRdIG9mIHRlc3RzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IHRleHRfMS5wYXJzZVBvc2l0aW9uKHJhdyk7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3QocmVzdWx0KS50by5kZWVwLmVxdWFsKGV4cGVjdGVkKTtcclxuICAgICAgICB9XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCd2YWxpZCBudW1iZXJzJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHRlc3RzID0gW1xyXG4gICAgICAgICAgICBbMSwgbmV3IHZzY29kZV8xLlBvc2l0aW9uKDEsIDApXVxyXG4gICAgICAgIF07XHJcbiAgICAgICAgZm9yIChjb25zdCBbcmF3LCBleHBlY3RlZF0gb2YgdGVzdHMpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gdGV4dF8xLnBhcnNlUG9zaXRpb24ocmF3KTtcclxuICAgICAgICAgICAgY2hhaV8xLmV4cGVjdChyZXN1bHQpLnRvLmRlZXAuZXF1YWwoZXhwZWN0ZWQpO1xyXG4gICAgICAgIH1cclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ2JhZCBzdHJpbmdzJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHRlc3RzID0gW1xyXG4gICAgICAgICAgICAnMToyOjMnLFxyXG4gICAgICAgICAgICAnMTphJyxcclxuICAgICAgICAgICAgJ2EnXHJcbiAgICAgICAgXTtcclxuICAgICAgICBmb3IgKGNvbnN0IHJhdyBvZiB0ZXN0cykge1xyXG4gICAgICAgICAgICBjaGFpXzEuZXhwZWN0KCgpID0+IHRleHRfMS5wYXJzZVBvc2l0aW9uKHJhdykpLnRvLnRocm93KCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSkpO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9dGV4dC51bml0LnRlc3QuanMubWFwIl19