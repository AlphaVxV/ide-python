// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const chai_1 = require("chai");

const TypeMoq = require("typemoq");

const types_1 = require("../../../client/common/application/types");

const types_2 = require("../../../client/common/terminal/types");

const types_3 = require("../../../client/common/types");

const misc_1 = require("../../../client/common/utils/misc");

const activation_1 = require("../../../client/terminals/activation");

suite('Terminal Auto Activation', () => {
  let activator;
  let terminalManager;
  let terminalAutoActivation;
  setup(() => {
    terminalManager = TypeMoq.Mock.ofType();
    activator = TypeMoq.Mock.ofType();
    const disposables = [];
    const serviceContainer = TypeMoq.Mock.ofType();
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_1.ITerminalManager), TypeMoq.It.isAny())).returns(() => terminalManager.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_2.ITerminalHelper), TypeMoq.It.isAny())).returns(() => activator.object);
    serviceContainer.setup(c => c.get(TypeMoq.It.isValue(types_3.IDisposableRegistry), TypeMoq.It.isAny())).returns(() => disposables);
    terminalAutoActivation = new activation_1.TerminalAutoActivation(serviceContainer.object, activator.object);
  });
  test('New Terminals should be activated', () => __awaiter(void 0, void 0, void 0, function* () {
    let eventHandler;
    const terminal = TypeMoq.Mock.ofType();
    terminalManager.setup(m => m.onDidOpenTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(handler => {
      eventHandler = handler;
      return {
        dispose: misc_1.noop
      };
    });
    activator.setup(h => h.activateEnvironmentInTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).verifiable(TypeMoq.Times.once());
    terminalAutoActivation.register();
    chai_1.expect(eventHandler).not.to.be.an('undefined', 'event handler not initialized');
    eventHandler.bind(terminalAutoActivation)(terminal.object);
    activator.verifyAll();
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFjdGl2YXRpb24udW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJjaGFpXzEiLCJyZXF1aXJlIiwiVHlwZU1vcSIsInR5cGVzXzEiLCJ0eXBlc18yIiwidHlwZXNfMyIsIm1pc2NfMSIsImFjdGl2YXRpb25fMSIsInN1aXRlIiwiYWN0aXZhdG9yIiwidGVybWluYWxNYW5hZ2VyIiwidGVybWluYWxBdXRvQWN0aXZhdGlvbiIsInNldHVwIiwiTW9jayIsIm9mVHlwZSIsImRpc3Bvc2FibGVzIiwic2VydmljZUNvbnRhaW5lciIsImMiLCJnZXQiLCJJdCIsImlzVmFsdWUiLCJJVGVybWluYWxNYW5hZ2VyIiwiaXNBbnkiLCJyZXR1cm5zIiwib2JqZWN0IiwiSVRlcm1pbmFsSGVscGVyIiwiSURpc3Bvc2FibGVSZWdpc3RyeSIsIlRlcm1pbmFsQXV0b0FjdGl2YXRpb24iLCJ0ZXN0IiwiZXZlbnRIYW5kbGVyIiwidGVybWluYWwiLCJtIiwib25EaWRPcGVuVGVybWluYWwiLCJoYW5kbGVyIiwiZGlzcG9zZSIsIm5vb3AiLCJoIiwiYWN0aXZhdGVFbnZpcm9ubWVudEluVGVybWluYWwiLCJ2ZXJpZmlhYmxlIiwiVGltZXMiLCJvbmNlIiwicmVnaXN0ZXIiLCJleHBlY3QiLCJub3QiLCJ0byIsImJlIiwiYW4iLCJiaW5kIiwidmVyaWZ5QWxsIl0sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBQ0EsSUFBSUEsU0FBUyxHQUFJLFVBQVEsU0FBS0EsU0FBZCxJQUE0QixVQUFVQyxPQUFWLEVBQW1CQyxVQUFuQixF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Q0FEaEIsRUFFS0MsT0FGTCxDQUVhVSxPQUFPLElBQUk7QUFDcEJKLE1BQUFBLFlBQVksR0FBR0ksT0FBZjtBQUNBLGFBQU87QUFBRUMsUUFBQUEsT0FBTyxFQUFFNUIsTUFBTSxDQUFDNkI7QUFBbEIsT0FBUDtBQUNILEtBTEQ7QUFNQTFCLElBQUFBLFNBQVMsQ0FDSkcsS0FETCxDQUNXd0IsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLDZCQUFGLENBQWdDbkMsT0FBTyxDQUFDaUIsRUFBUixDQUFXRyxLQUFYLEVBQWhDLEVBQW9EcEIsT0FBTyxDQUFDaUIsRUFBUixDQUFXRyxLQUFYLEVBQXBELEVBQXdFcEIsT0FBTyxDQUFDaUIsRUFBUixDQUFXRyxLQUFYLEVBQXhFLENBRGhCLEVBRUtnQixVQUZMLENBRWdCcEMsT0FBTyxDQUFDcUMsS0FBUixDQUFjQyxJQUFkLEVBRmhCO0FBR0E3QixJQUFBQSxzQkFBc0IsQ0FBQzhCLFFBQXZCO0FBQ0F6QyxJQUFBQSxNQUFNLENBQUMwQyxNQUFQLENBQWNiLFlBQWQsRUFBNEJjLEdBQTVCLENBQWdDQyxFQUFoQyxDQUFtQ0MsRUFBbkMsQ0FBc0NDLEVBQXRDLENBQXlDLFdBQXpDLEVBQXNELCtCQUF0RDtBQUNBakIsSUFBQUEsWUFBWSxDQUFDa0IsSUFBYixDQUFrQnBDLHNCQUFsQixFQUEwQ21CLFFBQVEsQ0FBQ04sTUFBbkQ7QUFDQWYsSUFBQUEsU0FBUyxDQUFDdUMsU0FBVjtBQUNILEdBaEJ3RCxDQUFyRCxDQUFKO0FBaUJILENBckNJLENBQUwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgY2hhaV8xID0gcmVxdWlyZShcImNoYWlcIik7XHJcbmNvbnN0IFR5cGVNb3EgPSByZXF1aXJlKFwidHlwZW1vcVwiKTtcclxuY29uc3QgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL2FwcGxpY2F0aW9uL3R5cGVzXCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vdGVybWluYWwvdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzMgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2NvbW1vbi90eXBlc1wiKTtcclxuY29uc3QgbWlzY18xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vdXRpbHMvbWlzY1wiKTtcclxuY29uc3QgYWN0aXZhdGlvbl8xID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC90ZXJtaW5hbHMvYWN0aXZhdGlvblwiKTtcclxuc3VpdGUoJ1Rlcm1pbmFsIEF1dG8gQWN0aXZhdGlvbicsICgpID0+IHtcclxuICAgIGxldCBhY3RpdmF0b3I7XHJcbiAgICBsZXQgdGVybWluYWxNYW5hZ2VyO1xyXG4gICAgbGV0IHRlcm1pbmFsQXV0b0FjdGl2YXRpb247XHJcbiAgICBzZXR1cCgoKSA9PiB7XHJcbiAgICAgICAgdGVybWluYWxNYW5hZ2VyID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGFjdGl2YXRvciA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBjb25zdCBkaXNwb3NhYmxlcyA9IFtdO1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2VDb250YWluZXIgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lclxyXG4gICAgICAgICAgICAuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMS5JVGVybWluYWxNYW5hZ2VyKSwgVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gdGVybWluYWxNYW5hZ2VyLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lclxyXG4gICAgICAgICAgICAuc2V0dXAoYyA9PiBjLmdldChUeXBlTW9xLkl0LmlzVmFsdWUodHlwZXNfMi5JVGVybWluYWxIZWxwZXIpLCBUeXBlTW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBhY3RpdmF0b3Iub2JqZWN0KTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyXHJcbiAgICAgICAgICAgIC5zZXR1cChjID0+IGMuZ2V0KFR5cGVNb3EuSXQuaXNWYWx1ZSh0eXBlc18zLklEaXNwb3NhYmxlUmVnaXN0cnkpLCBUeXBlTW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBkaXNwb3NhYmxlcyk7XHJcbiAgICAgICAgdGVybWluYWxBdXRvQWN0aXZhdGlvbiA9IG5ldyBhY3RpdmF0aW9uXzEuVGVybWluYWxBdXRvQWN0aXZhdGlvbihzZXJ2aWNlQ29udGFpbmVyLm9iamVjdCwgYWN0aXZhdG9yLm9iamVjdCk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ05ldyBUZXJtaW5hbHMgc2hvdWxkIGJlIGFjdGl2YXRlZCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBsZXQgZXZlbnRIYW5kbGVyO1xyXG4gICAgICAgIGNvbnN0IHRlcm1pbmFsID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHRlcm1pbmFsTWFuYWdlclxyXG4gICAgICAgICAgICAuc2V0dXAobSA9PiBtLm9uRGlkT3BlblRlcm1pbmFsKFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAucmV0dXJucyhoYW5kbGVyID0+IHtcclxuICAgICAgICAgICAgZXZlbnRIYW5kbGVyID0gaGFuZGxlcjtcclxuICAgICAgICAgICAgcmV0dXJuIHsgZGlzcG9zZTogbWlzY18xLm5vb3AgfTtcclxuICAgICAgICB9KTtcclxuICAgICAgICBhY3RpdmF0b3JcclxuICAgICAgICAgICAgLnNldHVwKGggPT4gaC5hY3RpdmF0ZUVudmlyb25tZW50SW5UZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgLnZlcmlmaWFibGUoVHlwZU1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgIHRlcm1pbmFsQXV0b0FjdGl2YXRpb24ucmVnaXN0ZXIoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGV2ZW50SGFuZGxlcikubm90LnRvLmJlLmFuKCd1bmRlZmluZWQnLCAnZXZlbnQgaGFuZGxlciBub3QgaW5pdGlhbGl6ZWQnKTtcclxuICAgICAgICBldmVudEhhbmRsZXIuYmluZCh0ZXJtaW5hbEF1dG9BY3RpdmF0aW9uKSh0ZXJtaW5hbC5vYmplY3QpO1xyXG4gICAgICAgIGFjdGl2YXRvci52ZXJpZnlBbGwoKTtcclxuICAgIH0pKTtcclxufSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFjdGl2YXRpb24udW5pdC50ZXN0LmpzLm1hcCJdfQ==