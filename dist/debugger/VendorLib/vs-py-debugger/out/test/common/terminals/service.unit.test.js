"use strict"; // Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const chai_1 = require("chai");

const TypeMoq = require("typemoq");

const types_1 = require("../../../client/common/application/types");

const types_2 = require("../../../client/common/platform/types");

const service_1 = require("../../../client/common/terminal/service");

const types_3 = require("../../../client/common/terminal/types");

const types_4 = require("../../../client/common/types"); // tslint:disable-next-line:max-func-body-length


suite('Terminal Service', () => {
  let service;
  let terminal;
  let terminalManager;
  let terminalHelper;
  let terminalActivator;
  let platformService;
  let workspaceService;
  let disposables = [];
  let mockServiceContainer;
  setup(() => {
    terminal = TypeMoq.Mock.ofType();
    terminalManager = TypeMoq.Mock.ofType();
    platformService = TypeMoq.Mock.ofType();
    workspaceService = TypeMoq.Mock.ofType();
    terminalHelper = TypeMoq.Mock.ofType();
    terminalActivator = TypeMoq.Mock.ofType();
    disposables = [];
    mockServiceContainer = TypeMoq.Mock.ofType();
    mockServiceContainer.setup(c => c.get(types_1.ITerminalManager)).returns(() => terminalManager.object);
    mockServiceContainer.setup(c => c.get(types_3.ITerminalHelper)).returns(() => terminalHelper.object);
    mockServiceContainer.setup(c => c.get(types_2.IPlatformService)).returns(() => platformService.object);
    mockServiceContainer.setup(c => c.get(types_4.IDisposableRegistry)).returns(() => disposables);
    mockServiceContainer.setup(c => c.get(types_1.IWorkspaceService)).returns(() => workspaceService.object);
    mockServiceContainer.setup(c => c.get(types_3.ITerminalActivator)).returns(() => terminalActivator.object);
  });
  teardown(() => {
    if (service) {
      // tslint:disable-next-line:no-any
      service.dispose();
    }

    disposables.filter(item => !!item).forEach(item => item.dispose());
  });
  test('Ensure terminal is disposed', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    const os = 'windows';
    service = new service_1.TerminalService(mockServiceContainer.object);
    const shellPath = 'powershell.exe';
    workspaceService.setup(w => w.getConfiguration(TypeMoq.It.isValue('terminal.integrated.shell'))).returns(() => {
      const workspaceConfig = TypeMoq.Mock.ofType();
      workspaceConfig.setup(c => c.get(os)).returns(() => shellPath);
      return workspaceConfig.object;
    });
    platformService.setup(p => p.isWindows).returns(() => os === 'windows');
    platformService.setup(p => p.isLinux).returns(() => os === 'linux');
    platformService.setup(p => p.isMac).returns(() => os === 'osx');
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object);
    terminalHelper.setup(h => h.buildCommandForTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => 'dummy text'); // Sending a command will cause the terminal to be created

    yield service.sendCommand('', []);
    terminal.verify(t => t.show(TypeMoq.It.isValue(true)), TypeMoq.Times.exactly(2));
    service.dispose();
    terminal.verify(t => t.dispose(), TypeMoq.Times.exactly(1));
  }));
  test('Ensure command is sent to terminal and it is shown', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    service = new service_1.TerminalService(mockServiceContainer.object);
    const commandToSend = 'SomeCommand';
    const args = ['1', '2'];
    const commandToExpect = [commandToSend].concat(args).join(' ');
    terminalHelper.setup(h => h.buildCommandForTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => commandToExpect);
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '');
    terminalHelper.setup(h => h.identifyTerminalShell(TypeMoq.It.isAny())).returns(() => types_3.TerminalShellType.bash);
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object);
    yield service.sendCommand(commandToSend, args);
    terminal.verify(t => t.show(TypeMoq.It.isValue(true)), TypeMoq.Times.exactly(2));
    terminal.verify(t => t.sendText(TypeMoq.It.isValue(commandToExpect), TypeMoq.It.isValue(true)), TypeMoq.Times.exactly(1));
  }));
  test('Ensure text is sent to terminal and it is shown', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    service = new service_1.TerminalService(mockServiceContainer.object);
    const textToSend = 'Some Text';
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '');
    terminalHelper.setup(h => h.identifyTerminalShell(TypeMoq.It.isAny())).returns(() => types_3.TerminalShellType.bash);
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object);
    yield service.sendText(textToSend);
    terminal.verify(t => t.show(TypeMoq.It.isValue(true)), TypeMoq.Times.exactly(2));
    terminal.verify(t => t.sendText(TypeMoq.It.isValue(textToSend)), TypeMoq.Times.exactly(1));
  }));
  test('Ensure terminal shown', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    service = new service_1.TerminalService(mockServiceContainer.object);
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '');
    terminalHelper.setup(h => h.identifyTerminalShell(TypeMoq.It.isAny())).returns(() => types_3.TerminalShellType.bash);
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object);
    yield service.show();
    terminal.verify(t => t.show(TypeMoq.It.isValue(true)), TypeMoq.Times.exactly(2));
  }));
  test('Ensure terminal shown and focus is set to the Terminal', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    service = new service_1.TerminalService(mockServiceContainer.object);
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '');
    terminalHelper.setup(h => h.identifyTerminalShell(TypeMoq.It.isAny())).returns(() => types_3.TerminalShellType.bash);
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object);
    yield service.show(false);
    terminal.verify(t => t.show(TypeMoq.It.isValue(false)), TypeMoq.Times.exactly(2));
  }));
  test('Ensure terminal is activated once after creation', () => __awaiter(void 0, void 0, void 0, function* () {
    service = new service_1.TerminalService(mockServiceContainer.object);
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '').verifiable(TypeMoq.Times.once());
    terminalActivator.setup(h => h.activateEnvironmentInTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(true)).verifiable(TypeMoq.Times.once());
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object).verifiable(TypeMoq.Times.atLeastOnce());
    yield service.show();
    yield service.show();
    yield service.show();
    yield service.show();
    terminalHelper.verifyAll();
    terminalActivator.verifyAll();
    terminal.verify(t => t.show(TypeMoq.It.isValue(true)), TypeMoq.Times.atLeastOnce());
  }));
  test('Ensure terminal is activated once before sending text', () => __awaiter(void 0, void 0, void 0, function* () {
    service = new service_1.TerminalService(mockServiceContainer.object);
    const textToSend = 'Some Text';
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '').verifiable(TypeMoq.Times.once());
    terminalActivator.setup(h => h.activateEnvironmentInTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(true)).verifiable(TypeMoq.Times.once());
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object).verifiable(TypeMoq.Times.atLeastOnce());
    yield service.sendText(textToSend);
    yield service.sendText(textToSend);
    yield service.sendText(textToSend);
    yield service.sendText(textToSend);
    terminalHelper.verifyAll();
    terminalActivator.verifyAll();
    terminal.verify(t => t.show(TypeMoq.It.isValue(true)), TypeMoq.Times.atLeastOnce());
  }));
  test('Ensure close event is not fired when another terminal is closed', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    let eventFired = false;
    let eventHandler;
    terminalManager.setup(m => m.onDidCloseTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(handler => {
      eventHandler = handler; // tslint:disable-next-line:no-empty

      return {
        dispose: () => {}
      };
    });
    service = new service_1.TerminalService(mockServiceContainer.object);
    service.onDidCloseTerminal(() => eventFired = true, service);
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '');
    terminalHelper.setup(h => h.identifyTerminalShell(TypeMoq.It.isAny())).returns(() => types_3.TerminalShellType.bash);
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object); // This will create the terminal.

    yield service.sendText('blah');
    chai_1.expect(eventHandler).not.to.be.an('undefined', 'event handler not initialized');
    eventHandler.bind(service)();
    chai_1.expect(eventFired).to.be.equal(false, 'Event fired');
  }));
  test('Ensure close event is not fired when terminal is closed', () => __awaiter(void 0, void 0, void 0, function* () {
    terminalHelper.setup(helper => helper.getEnvironmentActivationCommands(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => Promise.resolve(undefined));
    let eventFired = false;
    let eventHandler;
    terminalManager.setup(m => m.onDidCloseTerminal(TypeMoq.It.isAny(), TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(handler => {
      eventHandler = handler; // tslint:disable-next-line:no-empty

      return {
        dispose: () => {}
      };
    });
    service = new service_1.TerminalService(mockServiceContainer.object);
    service.onDidCloseTerminal(() => eventFired = true);
    terminalHelper.setup(h => h.getTerminalShellPath()).returns(() => '');
    terminalHelper.setup(h => h.identifyTerminalShell(TypeMoq.It.isAny())).returns(() => types_3.TerminalShellType.bash);
    terminalManager.setup(t => t.createTerminal(TypeMoq.It.isAny())).returns(() => terminal.object); // This will create the terminal.

    yield service.sendText('blah');
    chai_1.expect(eventHandler).not.to.be.an('undefined', 'event handler not initialized');
    eventHandler.bind(service)(terminal.object);
    chai_1.expect(eventFired).to.be.equal(true, 'Event not fired');
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNlcnZpY2UudW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJjaGFpXzEiLCJyZXF1aXJlIiwiVHlwZU1vcSIsInR5cGVzXzEiLCJ0eXBlc18yIiwic2VydmljZV8xIiwidHlwZXNfMyIsInR5cGVzXzQiLCJzdWl0ZSIsInNlcnZpY2UiLCJ0ZXJtaW5hbCIsInRlcm1pbmFsTWFuYWdlciIsInRlcm1pbmFsSGVscGVyIiwidGVybWluYWxBY3RpdmF0b3IiLCJwbGF0Zm9ybVNlcnZpY2UiLCJ3b3Jrc3BhY2VTZXJ2aWNlIiwiZGlzcG9zYWJsZXMiLCJtb2NrU2VydmljZUNvbnRhaW5lciIsInNldHVwIiwiTW9jayIsIm9mVHlwZSIsImMiLCJnZXQiLCJJVGVybWluYWxNYW5hZ2VyIiwicmV0dXJucyIsIm9iamVjdCIsIklUZXJtaW5hbEhlbHBlciIsIklQbGF0Zm9ybVNlcnZpY2UiLCJJRGlzcG9zYWJsZVJlZ2lzdHJ5IiwiSVdvcmtzcGFjZVNlcnZpY2UiLCJJVGVybWluYWxBY3RpdmF0b3IiLCJ0ZWFyZG93biIsImRpc3Bvc2UiLCJmaWx0ZXIiLCJpdGVtIiwiZm9yRWFjaCIsInRlc3QiLCJoZWxwZXIiLCJnZXRFbnZpcm9ubWVudEFjdGl2YXRpb25Db21tYW5kcyIsIkl0IiwiaXNBbnkiLCJ1bmRlZmluZWQiLCJvcyIsIlRlcm1pbmFsU2VydmljZSIsInNoZWxsUGF0aCIsInciLCJnZXRDb25maWd1cmF0aW9uIiwiaXNWYWx1ZSIsIndvcmtzcGFjZUNvbmZpZyIsInAiLCJpc1dpbmRvd3MiLCJpc0xpbnV4IiwiaXNNYWMiLCJ0IiwiY3JlYXRlVGVybWluYWwiLCJoIiwiYnVpbGRDb21tYW5kRm9yVGVybWluYWwiLCJzZW5kQ29tbWFuZCIsInZlcmlmeSIsInNob3ciLCJUaW1lcyIsImV4YWN0bHkiLCJjb21tYW5kVG9TZW5kIiwiYXJncyIsImNvbW1hbmRUb0V4cGVjdCIsImNvbmNhdCIsImpvaW4iLCJnZXRUZXJtaW5hbFNoZWxsUGF0aCIsImlkZW50aWZ5VGVybWluYWxTaGVsbCIsIlRlcm1pbmFsU2hlbGxUeXBlIiwiYmFzaCIsInNlbmRUZXh0IiwidGV4dFRvU2VuZCIsInZlcmlmaWFibGUiLCJvbmNlIiwiYWN0aXZhdGVFbnZpcm9ubWVudEluVGVybWluYWwiLCJhdExlYXN0T25jZSIsInZlcmlmeUFsbCIsImV2ZW50RmlyZWQiLCJldmVudEhhbmRsZXIiLCJtIiwib25EaWRDbG9zZVRlcm1pbmFsIiwiaGFuZGxlciIsImV4cGVjdCIsIm5vdCIsInRvIiwiYmUiLCJhbiIsImJpbmQiLCJlcXVhbCJdLCJtYXBwaW5ncyI6IkFBQUEsYSxDQUNBO0FBQ0E7O0FBQ0EsSUFBSUEsU0FBUyxHQUFJLFVBQVEsU0FBS0EsU0FBZCxJQUE0QixVQUFVQyxPQUFWLEVBQW1CQyxVQUFuQixFQUErQkMsQ0FBL0IsRUFBa0NDLFNBQWxDLEVBQTZDO0FBQ3JGLFNBQU8sS0FBS0QsQ0FBQyxLQUFLQSxDQUFDLEdBQUdFLE9BQVQsQ0FBTixFQUF5QixVQUFVQyxPQUFWLEVBQW1CQyxNQUFuQixFQUEyQjtBQUN2RCxhQUFTQyxTQUFULENBQW1CQyxLQUFuQixFQUEwQjtBQUFFLFVBQUk7QUFBRUMsUUFBQUEsSUFBSSxDQUFDTixTQUFTLENBQUNPLElBQVYsQ0FBZUYsS0FBZixDQUFELENBQUo7QUFBOEIsT0FBcEMsQ0FBcUMsT0FBT0csQ0FBUCxFQUFVO0FBQUVMLFFBQUFBLE1BQU0sQ0FBQ0ssQ0FBRCxDQUFOO0FBQVk7QUFBRTs7QUFDM0YsYUFBU0MsUUFBVCxDQUFrQkosS0FBbEIsRUFBeUI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDLE9BQUQsQ0FBVCxDQUFtQkssS0FBbkIsQ0FBRCxDQUFKO0FBQWtDLE9BQXhDLENBQXlDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzlGLGFBQVNGLElBQVQsQ0FBY0ksTUFBZCxFQUFzQjtBQUFFQSxNQUFBQSxNQUFNLENBQUNDLElBQVAsR0FBY1QsT0FBTyxDQUFDUSxNQUFNLENBQUNMLEtBQVIsQ0FBckIsR0FBc0MsSUFBSU4sQ0FBSixDQUFNLFVBQVVHLE9BQVYsRUFBbUI7QUFBRUEsUUFBQUEsT0FBTyxDQUFDUSxNQUFNLENBQUNMLEtBQVIsQ0FBUDtBQUF3QixPQUFuRCxFQUFxRE8sSUFBckQsQ0FBMERSLFNBQTFELEVBQXFFSyxRQUFyRSxDQUF0QztBQUF1SDs7QUFDL0lILElBQUFBLElBQUksQ0FBQyxDQUFDTixTQUFTLEdBQUdBLFNBQVMsQ0FBQ2EsS0FBVixDQUFnQmhCLE9BQWhCLEVBQXlCQyxVQUFVLElBQUksRUFBdkMsQ0FBYixFQUF5RFMsSUFBekQsRUFBRCxDQUFKO0FBQ0gsR0FMTSxDQUFQO0FBTUgsQ0FQRDs7QUFRQU8sTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUFFWCxFQUFBQSxLQUFLLEVBQUU7QUFBVCxDQUE3Qzs7QUFDQSxNQUFNWSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxNQUFELENBQXRCOztBQUNBLE1BQU1DLE9BQU8sR0FBR0QsT0FBTyxDQUFDLFNBQUQsQ0FBdkI7O0FBQ0EsTUFBTUUsT0FBTyxHQUFHRixPQUFPLENBQUMsMENBQUQsQ0FBdkI7O0FBQ0EsTUFBTUcsT0FBTyxHQUFHSCxPQUFPLENBQUMsdUNBQUQsQ0FBdkI7O0FBQ0EsTUFBTUksU0FBUyxHQUFHSixPQUFPLENBQUMseUNBQUQsQ0FBekI7O0FBQ0EsTUFBTUssT0FBTyxHQUFHTCxPQUFPLENBQUMsdUNBQUQsQ0FBdkI7O0FBQ0EsTUFBTU0sT0FBTyxHQUFHTixPQUFPLENBQUMsOEJBQUQsQ0FBdkIsQyxDQUNBOzs7QUFDQU8sS0FBSyxDQUFDLGtCQUFELEVBQXFCLE1BQU07QUFDNUIsTUFBSUMsT0FBSjtBQUNBLE1BQUlDLFFBQUo7QUFDQSxNQUFJQyxlQUFKO0FBQ0EsTUFBSUMsY0FBSjtBQUNBLE1BQUlDLGlCQUFKO0FBQ0EsTUFBSUMsZUFBSjtBQUNBLE1BQUlDLGdCQUFKO0FBQ0EsTUFBSUMsV0FBVyxHQUFHLEVBQWxCO0FBQ0EsTUFBSUMsb0JBQUo7QUFDQUMsRUFBQUEsS0FBSyxDQUFDLE1BQU07QUFDUlIsSUFBQUEsUUFBUSxHQUFHUixPQUFPLENBQUNpQixJQUFSLENBQWFDLE1BQWIsRUFBWDtBQUNBVCxJQUFBQSxlQUFlLEdBQUdULE9BQU8sQ0FBQ2lCLElBQVIsQ0FBYUMsTUFBYixFQUFsQjtBQUNBTixJQUFBQSxlQUFlLEdBQUdaLE9BQU8sQ0FBQ2lCLElBQVIsQ0FBYUMsTUFBYixFQUFsQjtBQUNBTCxJQUFBQSxnQkFBZ0IsR0FBR2IsT0FBTyxDQUFDaUIsSUFBUixDQUFhQyxNQUFiLEVBQW5CO0FBQ0FSLElBQUFBLGNBQWMsR0FBR1YsT0FBTyxDQUFDaUIsSUFBUixDQUFhQyxNQUFiLEVBQWpCO0FBQ0FQLElBQUFBLGlCQUFpQixHQUFHWCxPQUFPLENBQUNpQixJQUFSLENBQWFDLE1BQWIsRUFBcEI7QUFDQUosSUFBQUEsV0FBVyxHQUFHLEVBQWQ7QUFDQUMsSUFBQUEsb0JBQW9CLEdBQUdmLE9BQU8sQ0FBQ2lCLElBQVIsQ0FBYUMsTUFBYixFQUF2QjtBQUNBSCxJQUFBQSxvQkFBb0IsQ0FBQ0MsS0FBckIsQ0FBMkJHLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxHQUFGLENBQU1uQixPQUFPLENBQUNvQixnQkFBZCxDQUFoQyxFQUFpRUMsT0FBakUsQ0FBeUUsTUFBTWIsZUFBZSxDQUFDYyxNQUEvRjtBQUNBUixJQUFBQSxvQkFBb0IsQ0FBQ0MsS0FBckIsQ0FBMkJHLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxHQUFGLENBQU1oQixPQUFPLENBQUNvQixlQUFkLENBQWhDLEVBQWdFRixPQUFoRSxDQUF3RSxNQUFNWixjQUFjLENBQUNhLE1BQTdGO0FBQ0FSLElBQUFBLG9CQUFvQixDQUFDQyxLQUFyQixDQUEyQkcsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLEdBQUYsQ0FBTWxCLE9BQU8sQ0FBQ3VCLGdCQUFkLENBQWhDLEVBQWlFSCxPQUFqRSxDQUF5RSxNQUFNVixlQUFlLENBQUNXLE1BQS9GO0FBQ0FSLElBQUFBLG9CQUFvQixDQUFDQyxLQUFyQixDQUEyQkcsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLEdBQUYsQ0FBTWYsT0FBTyxDQUFDcUIsbUJBQWQsQ0FBaEMsRUFBb0VKLE9BQXBFLENBQTRFLE1BQU1SLFdBQWxGO0FBQ0FDLElBQUFBLG9CQUFvQixDQUFDQyxLQUFyQixDQUEyQkcsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLEdBQUYsQ0FBTW5CLE9BQU8sQ0FBQzBCLGlCQUFkLENBQWhDLEVBQWtFTCxPQUFsRSxDQUEwRSxNQUFNVCxnQkFBZ0IsQ0FBQ1UsTUFBakc7QUFDQVIsSUFBQUEsb0JBQW9CLENBQUNDLEtBQXJCLENBQTJCRyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsR0FBRixDQUFNaEIsT0FBTyxDQUFDd0Isa0JBQWQsQ0FBaEMsRUFBbUVOLE9BQW5FLENBQTJFLE1BQU1YLGlCQUFpQixDQUFDWSxNQUFuRztBQUNILEdBZkksQ0FBTDtBQWdCQU0sRUFBQUEsUUFBUSxDQUFDLE1BQU07QUFDWCxRQUFJdEIsT0FBSixFQUFhO0FBQ1Q7QUFDQUEsTUFBQUEsT0FBTyxDQUFDdUIsT0FBUjtBQUNIOztBQUNEaEIsSUFBQUEsV0FBVyxDQUFDaUIsTUFBWixDQUFtQkMsSUFBSSxJQUFJLENBQUMsQ0FBQ0EsSUFBN0IsRUFBbUNDLE9BQW5DLENBQTJDRCxJQUFJLElBQUlBLElBQUksQ0FBQ0YsT0FBTCxFQUFuRDtBQUNILEdBTk8sQ0FBUjtBQU9BSSxFQUFBQSxJQUFJLENBQUMsNkJBQUQsRUFBZ0MsTUFBTXpELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDbkZpQyxJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJtQixNQUFNLElBQUlBLE1BQU0sQ0FBQ0MsZ0NBQVAsQ0FBd0NwQyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBeEMsRUFBNER0QyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBNUQsQ0FBL0IsRUFBZ0hoQixPQUFoSCxDQUF3SCxNQUFNeEMsT0FBTyxDQUFDQyxPQUFSLENBQWdCd0QsU0FBaEIsQ0FBOUg7QUFDQSxVQUFNQyxFQUFFLEdBQUcsU0FBWDtBQUNBakMsSUFBQUEsT0FBTyxHQUFHLElBQUlKLFNBQVMsQ0FBQ3NDLGVBQWQsQ0FBOEIxQixvQkFBb0IsQ0FBQ1EsTUFBbkQsQ0FBVjtBQUNBLFVBQU1tQixTQUFTLEdBQUcsZ0JBQWxCO0FBQ0E3QixJQUFBQSxnQkFBZ0IsQ0FBQ0csS0FBakIsQ0FBdUIyQixDQUFDLElBQUlBLENBQUMsQ0FBQ0MsZ0JBQUYsQ0FBbUI1QyxPQUFPLENBQUNxQyxFQUFSLENBQVdRLE9BQVgsQ0FBbUIsMkJBQW5CLENBQW5CLENBQTVCLEVBQWlHdkIsT0FBakcsQ0FBeUcsTUFBTTtBQUMzRyxZQUFNd0IsZUFBZSxHQUFHOUMsT0FBTyxDQUFDaUIsSUFBUixDQUFhQyxNQUFiLEVBQXhCO0FBQ0E0QixNQUFBQSxlQUFlLENBQUM5QixLQUFoQixDQUFzQkcsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLEdBQUYsQ0FBTW9CLEVBQU4sQ0FBM0IsRUFBc0NsQixPQUF0QyxDQUE4QyxNQUFNb0IsU0FBcEQ7QUFDQSxhQUFPSSxlQUFlLENBQUN2QixNQUF2QjtBQUNILEtBSkQ7QUFLQVgsSUFBQUEsZUFBZSxDQUFDSSxLQUFoQixDQUFzQitCLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxTQUE3QixFQUF3QzFCLE9BQXhDLENBQWdELE1BQU1rQixFQUFFLEtBQUssU0FBN0Q7QUFDQTVCLElBQUFBLGVBQWUsQ0FBQ0ksS0FBaEIsQ0FBc0IrQixDQUFDLElBQUlBLENBQUMsQ0FBQ0UsT0FBN0IsRUFBc0MzQixPQUF0QyxDQUE4QyxNQUFNa0IsRUFBRSxLQUFLLE9BQTNEO0FBQ0E1QixJQUFBQSxlQUFlLENBQUNJLEtBQWhCLENBQXNCK0IsQ0FBQyxJQUFJQSxDQUFDLENBQUNHLEtBQTdCLEVBQW9DNUIsT0FBcEMsQ0FBNEMsTUFBTWtCLEVBQUUsS0FBSyxLQUF6RDtBQUNBL0IsSUFBQUEsZUFBZSxDQUFDTyxLQUFoQixDQUFzQm1DLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxjQUFGLENBQWlCcEQsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQWpCLENBQTNCLEVBQWlFaEIsT0FBakUsQ0FBeUUsTUFBTWQsUUFBUSxDQUFDZSxNQUF4RjtBQUNBYixJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsdUJBQUYsQ0FBMEJ0RCxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBMUIsRUFBOEN0QyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBOUMsRUFBa0V0QyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBbEUsQ0FBMUIsRUFBaUhoQixPQUFqSCxDQUF5SCxNQUFNLFlBQS9ILEVBZG1GLENBZW5GOztBQUNBLFVBQU1mLE9BQU8sQ0FBQ2dELFdBQVIsQ0FBb0IsRUFBcEIsRUFBd0IsRUFBeEIsQ0FBTjtBQUNBL0MsSUFBQUEsUUFBUSxDQUFDZ0QsTUFBVCxDQUFnQkwsQ0FBQyxJQUFJQSxDQUFDLENBQUNNLElBQUYsQ0FBT3pELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV1EsT0FBWCxDQUFtQixJQUFuQixDQUFQLENBQXJCLEVBQXVEN0MsT0FBTyxDQUFDMEQsS0FBUixDQUFjQyxPQUFkLENBQXNCLENBQXRCLENBQXZEO0FBQ0FwRCxJQUFBQSxPQUFPLENBQUN1QixPQUFSO0FBQ0F0QixJQUFBQSxRQUFRLENBQUNnRCxNQUFULENBQWdCTCxDQUFDLElBQUlBLENBQUMsQ0FBQ3JCLE9BQUYsRUFBckIsRUFBa0M5QixPQUFPLENBQUMwRCxLQUFSLENBQWNDLE9BQWQsQ0FBc0IsQ0FBdEIsQ0FBbEM7QUFDSCxHQXBCa0QsQ0FBL0MsQ0FBSjtBQXFCQXpCLEVBQUFBLElBQUksQ0FBQyxvREFBRCxFQUF1RCxNQUFNekQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUMxR2lDLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQm1CLE1BQU0sSUFBSUEsTUFBTSxDQUFDQyxnQ0FBUCxDQUF3Q3BDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QyxFQUE0RHRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUE1RCxDQUEvQixFQUFnSGhCLE9BQWhILENBQXdILE1BQU14QyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0J3RCxTQUFoQixDQUE5SDtBQUNBaEMsSUFBQUEsT0FBTyxHQUFHLElBQUlKLFNBQVMsQ0FBQ3NDLGVBQWQsQ0FBOEIxQixvQkFBb0IsQ0FBQ1EsTUFBbkQsQ0FBVjtBQUNBLFVBQU1xQyxhQUFhLEdBQUcsYUFBdEI7QUFDQSxVQUFNQyxJQUFJLEdBQUcsQ0FBQyxHQUFELEVBQU0sR0FBTixDQUFiO0FBQ0EsVUFBTUMsZUFBZSxHQUFHLENBQUNGLGFBQUQsRUFBZ0JHLE1BQWhCLENBQXVCRixJQUF2QixFQUE2QkcsSUFBN0IsQ0FBa0MsR0FBbEMsQ0FBeEI7QUFDQXRELElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQnFDLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyx1QkFBRixDQUEwQnRELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUExQixFQUE4Q3RDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUE5QyxFQUFrRXRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFsRSxDQUExQixFQUFpSGhCLE9BQWpILENBQXlILE1BQU13QyxlQUEvSDtBQUNBcEQsSUFBQUEsY0FBYyxDQUFDTSxLQUFmLENBQXFCcUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNZLG9CQUFGLEVBQTFCLEVBQW9EM0MsT0FBcEQsQ0FBNEQsTUFBTSxFQUFsRTtBQUNBWixJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ2EscUJBQUYsQ0FBd0JsRSxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBeEIsQ0FBMUIsRUFBdUVoQixPQUF2RSxDQUErRSxNQUFNbEIsT0FBTyxDQUFDK0QsaUJBQVIsQ0FBMEJDLElBQS9HO0FBQ0EzRCxJQUFBQSxlQUFlLENBQUNPLEtBQWhCLENBQXNCbUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLGNBQUYsQ0FBaUJwRCxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBakIsQ0FBM0IsRUFBaUVoQixPQUFqRSxDQUF5RSxNQUFNZCxRQUFRLENBQUNlLE1BQXhGO0FBQ0EsVUFBTWhCLE9BQU8sQ0FBQ2dELFdBQVIsQ0FBb0JLLGFBQXBCLEVBQW1DQyxJQUFuQyxDQUFOO0FBQ0FyRCxJQUFBQSxRQUFRLENBQUNnRCxNQUFULENBQWdCTCxDQUFDLElBQUlBLENBQUMsQ0FBQ00sSUFBRixDQUFPekQsT0FBTyxDQUFDcUMsRUFBUixDQUFXUSxPQUFYLENBQW1CLElBQW5CLENBQVAsQ0FBckIsRUFBdUQ3QyxPQUFPLENBQUMwRCxLQUFSLENBQWNDLE9BQWQsQ0FBc0IsQ0FBdEIsQ0FBdkQ7QUFDQW5ELElBQUFBLFFBQVEsQ0FBQ2dELE1BQVQsQ0FBZ0JMLENBQUMsSUFBSUEsQ0FBQyxDQUFDa0IsUUFBRixDQUFXckUsT0FBTyxDQUFDcUMsRUFBUixDQUFXUSxPQUFYLENBQW1CaUIsZUFBbkIsQ0FBWCxFQUFnRDlELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV1EsT0FBWCxDQUFtQixJQUFuQixDQUFoRCxDQUFyQixFQUFnRzdDLE9BQU8sQ0FBQzBELEtBQVIsQ0FBY0MsT0FBZCxDQUFzQixDQUF0QixDQUFoRztBQUNILEdBYnlFLENBQXRFLENBQUo7QUFjQXpCLEVBQUFBLElBQUksQ0FBQyxpREFBRCxFQUFvRCxNQUFNekQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUN2R2lDLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQm1CLE1BQU0sSUFBSUEsTUFBTSxDQUFDQyxnQ0FBUCxDQUF3Q3BDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QyxFQUE0RHRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUE1RCxDQUEvQixFQUFnSGhCLE9BQWhILENBQXdILE1BQU14QyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0J3RCxTQUFoQixDQUE5SDtBQUNBaEMsSUFBQUEsT0FBTyxHQUFHLElBQUlKLFNBQVMsQ0FBQ3NDLGVBQWQsQ0FBOEIxQixvQkFBb0IsQ0FBQ1EsTUFBbkQsQ0FBVjtBQUNBLFVBQU0rQyxVQUFVLEdBQUcsV0FBbkI7QUFDQTVELElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQnFDLENBQUMsSUFBSUEsQ0FBQyxDQUFDWSxvQkFBRixFQUExQixFQUFvRDNDLE9BQXBELENBQTRELE1BQU0sRUFBbEU7QUFDQVosSUFBQUEsY0FBYyxDQUFDTSxLQUFmLENBQXFCcUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNhLHFCQUFGLENBQXdCbEUsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQXhCLENBQTFCLEVBQXVFaEIsT0FBdkUsQ0FBK0UsTUFBTWxCLE9BQU8sQ0FBQytELGlCQUFSLENBQTBCQyxJQUEvRztBQUNBM0QsSUFBQUEsZUFBZSxDQUFDTyxLQUFoQixDQUFzQm1DLENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxjQUFGLENBQWlCcEQsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQWpCLENBQTNCLEVBQWlFaEIsT0FBakUsQ0FBeUUsTUFBTWQsUUFBUSxDQUFDZSxNQUF4RjtBQUNBLFVBQU1oQixPQUFPLENBQUM4RCxRQUFSLENBQWlCQyxVQUFqQixDQUFOO0FBQ0E5RCxJQUFBQSxRQUFRLENBQUNnRCxNQUFULENBQWdCTCxDQUFDLElBQUlBLENBQUMsQ0FBQ00sSUFBRixDQUFPekQsT0FBTyxDQUFDcUMsRUFBUixDQUFXUSxPQUFYLENBQW1CLElBQW5CLENBQVAsQ0FBckIsRUFBdUQ3QyxPQUFPLENBQUMwRCxLQUFSLENBQWNDLE9BQWQsQ0FBc0IsQ0FBdEIsQ0FBdkQ7QUFDQW5ELElBQUFBLFFBQVEsQ0FBQ2dELE1BQVQsQ0FBZ0JMLENBQUMsSUFBSUEsQ0FBQyxDQUFDa0IsUUFBRixDQUFXckUsT0FBTyxDQUFDcUMsRUFBUixDQUFXUSxPQUFYLENBQW1CeUIsVUFBbkIsQ0FBWCxDQUFyQixFQUFpRXRFLE9BQU8sQ0FBQzBELEtBQVIsQ0FBY0MsT0FBZCxDQUFzQixDQUF0QixDQUFqRTtBQUNILEdBVnNFLENBQW5FLENBQUo7QUFXQXpCLEVBQUFBLElBQUksQ0FBQyx1QkFBRCxFQUEwQixNQUFNekQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUM3RWlDLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQm1CLE1BQU0sSUFBSUEsTUFBTSxDQUFDQyxnQ0FBUCxDQUF3Q3BDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QyxFQUE0RHRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUE1RCxDQUEvQixFQUFnSGhCLE9BQWhILENBQXdILE1BQU14QyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0J3RCxTQUFoQixDQUE5SDtBQUNBaEMsSUFBQUEsT0FBTyxHQUFHLElBQUlKLFNBQVMsQ0FBQ3NDLGVBQWQsQ0FBOEIxQixvQkFBb0IsQ0FBQ1EsTUFBbkQsQ0FBVjtBQUNBYixJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ1ksb0JBQUYsRUFBMUIsRUFBb0QzQyxPQUFwRCxDQUE0RCxNQUFNLEVBQWxFO0FBQ0FaLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQnFDLENBQUMsSUFBSUEsQ0FBQyxDQUFDYSxxQkFBRixDQUF3QmxFLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QixDQUExQixFQUF1RWhCLE9BQXZFLENBQStFLE1BQU1sQixPQUFPLENBQUMrRCxpQkFBUixDQUEwQkMsSUFBL0c7QUFDQTNELElBQUFBLGVBQWUsQ0FBQ08sS0FBaEIsQ0FBc0JtQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsY0FBRixDQUFpQnBELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFqQixDQUEzQixFQUFpRWhCLE9BQWpFLENBQXlFLE1BQU1kLFFBQVEsQ0FBQ2UsTUFBeEY7QUFDQSxVQUFNaEIsT0FBTyxDQUFDa0QsSUFBUixFQUFOO0FBQ0FqRCxJQUFBQSxRQUFRLENBQUNnRCxNQUFULENBQWdCTCxDQUFDLElBQUlBLENBQUMsQ0FBQ00sSUFBRixDQUFPekQsT0FBTyxDQUFDcUMsRUFBUixDQUFXUSxPQUFYLENBQW1CLElBQW5CLENBQVAsQ0FBckIsRUFBdUQ3QyxPQUFPLENBQUMwRCxLQUFSLENBQWNDLE9BQWQsQ0FBc0IsQ0FBdEIsQ0FBdkQ7QUFDSCxHQVI0QyxDQUF6QyxDQUFKO0FBU0F6QixFQUFBQSxJQUFJLENBQUMsd0RBQUQsRUFBMkQsTUFBTXpELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDOUdpQyxJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJtQixNQUFNLElBQUlBLE1BQU0sQ0FBQ0MsZ0NBQVAsQ0FBd0NwQyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBeEMsRUFBNER0QyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBNUQsQ0FBL0IsRUFBZ0hoQixPQUFoSCxDQUF3SCxNQUFNeEMsT0FBTyxDQUFDQyxPQUFSLENBQWdCd0QsU0FBaEIsQ0FBOUg7QUFDQWhDLElBQUFBLE9BQU8sR0FBRyxJQUFJSixTQUFTLENBQUNzQyxlQUFkLENBQThCMUIsb0JBQW9CLENBQUNRLE1BQW5ELENBQVY7QUFDQWIsSUFBQUEsY0FBYyxDQUFDTSxLQUFmLENBQXFCcUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNZLG9CQUFGLEVBQTFCLEVBQW9EM0MsT0FBcEQsQ0FBNEQsTUFBTSxFQUFsRTtBQUNBWixJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ2EscUJBQUYsQ0FBd0JsRSxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBeEIsQ0FBMUIsRUFBdUVoQixPQUF2RSxDQUErRSxNQUFNbEIsT0FBTyxDQUFDK0QsaUJBQVIsQ0FBMEJDLElBQS9HO0FBQ0EzRCxJQUFBQSxlQUFlLENBQUNPLEtBQWhCLENBQXNCbUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLGNBQUYsQ0FBaUJwRCxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBakIsQ0FBM0IsRUFBaUVoQixPQUFqRSxDQUF5RSxNQUFNZCxRQUFRLENBQUNlLE1BQXhGO0FBQ0EsVUFBTWhCLE9BQU8sQ0FBQ2tELElBQVIsQ0FBYSxLQUFiLENBQU47QUFDQWpELElBQUFBLFFBQVEsQ0FBQ2dELE1BQVQsQ0FBZ0JMLENBQUMsSUFBSUEsQ0FBQyxDQUFDTSxJQUFGLENBQU96RCxPQUFPLENBQUNxQyxFQUFSLENBQVdRLE9BQVgsQ0FBbUIsS0FBbkIsQ0FBUCxDQUFyQixFQUF3RDdDLE9BQU8sQ0FBQzBELEtBQVIsQ0FBY0MsT0FBZCxDQUFzQixDQUF0QixDQUF4RDtBQUNILEdBUjZFLENBQTFFLENBQUo7QUFTQXpCLEVBQUFBLElBQUksQ0FBQyxrREFBRCxFQUFxRCxNQUFNekQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUN4RzhCLElBQUFBLE9BQU8sR0FBRyxJQUFJSixTQUFTLENBQUNzQyxlQUFkLENBQThCMUIsb0JBQW9CLENBQUNRLE1BQW5ELENBQVY7QUFDQWIsSUFBQUEsY0FBYyxDQUNUTSxLQURMLENBQ1dxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ1ksb0JBQUYsRUFEaEIsRUFDMEMzQyxPQUQxQyxDQUNrRCxNQUFNLEVBRHhELEVBRUtpRCxVQUZMLENBRWdCdkUsT0FBTyxDQUFDMEQsS0FBUixDQUFjYyxJQUFkLEVBRmhCO0FBR0E3RCxJQUFBQSxpQkFBaUIsQ0FDWkssS0FETCxDQUNXcUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNvQiw2QkFBRixDQUFnQ3pFLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFoQyxFQUFvRHRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFwRCxFQUF3RXRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4RSxDQURoQixFQUVLaEIsT0FGTCxDQUVhLE1BQU14QyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0IsSUFBaEIsQ0FGbkIsRUFHS3dGLFVBSEwsQ0FHZ0J2RSxPQUFPLENBQUMwRCxLQUFSLENBQWNjLElBQWQsRUFIaEI7QUFJQS9ELElBQUFBLGVBQWUsQ0FDVk8sS0FETCxDQUNXbUMsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLGNBQUYsQ0FBaUJwRCxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBakIsQ0FEaEIsRUFDc0RoQixPQUR0RCxDQUM4RCxNQUFNZCxRQUFRLENBQUNlLE1BRDdFLEVBRUtnRCxVQUZMLENBRWdCdkUsT0FBTyxDQUFDMEQsS0FBUixDQUFjZ0IsV0FBZCxFQUZoQjtBQUdBLFVBQU1uRSxPQUFPLENBQUNrRCxJQUFSLEVBQU47QUFDQSxVQUFNbEQsT0FBTyxDQUFDa0QsSUFBUixFQUFOO0FBQ0EsVUFBTWxELE9BQU8sQ0FBQ2tELElBQVIsRUFBTjtBQUNBLFVBQU1sRCxPQUFPLENBQUNrRCxJQUFSLEVBQU47QUFDQS9DLElBQUFBLGNBQWMsQ0FBQ2lFLFNBQWY7QUFDQWhFLElBQUFBLGlCQUFpQixDQUFDZ0UsU0FBbEI7QUFDQW5FLElBQUFBLFFBQVEsQ0FBQ2dELE1BQVQsQ0FBZ0JMLENBQUMsSUFBSUEsQ0FBQyxDQUFDTSxJQUFGLENBQU96RCxPQUFPLENBQUNxQyxFQUFSLENBQVdRLE9BQVgsQ0FBbUIsSUFBbkIsQ0FBUCxDQUFyQixFQUF1RDdDLE9BQU8sQ0FBQzBELEtBQVIsQ0FBY2dCLFdBQWQsRUFBdkQ7QUFDSCxHQW5CdUUsQ0FBcEUsQ0FBSjtBQW9CQXhDLEVBQUFBLElBQUksQ0FBQyx1REFBRCxFQUEwRCxNQUFNekQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUM3RzhCLElBQUFBLE9BQU8sR0FBRyxJQUFJSixTQUFTLENBQUNzQyxlQUFkLENBQThCMUIsb0JBQW9CLENBQUNRLE1BQW5ELENBQVY7QUFDQSxVQUFNK0MsVUFBVSxHQUFHLFdBQW5CO0FBQ0E1RCxJQUFBQSxjQUFjLENBQ1RNLEtBREwsQ0FDV3FDLENBQUMsSUFBSUEsQ0FBQyxDQUFDWSxvQkFBRixFQURoQixFQUMwQzNDLE9BRDFDLENBQ2tELE1BQU0sRUFEeEQsRUFFS2lELFVBRkwsQ0FFZ0J2RSxPQUFPLENBQUMwRCxLQUFSLENBQWNjLElBQWQsRUFGaEI7QUFHQTdELElBQUFBLGlCQUFpQixDQUNaSyxLQURMLENBQ1dxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ29CLDZCQUFGLENBQWdDekUsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQWhDLEVBQW9EdEMsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQXBELEVBQXdFdEMsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQXhFLENBRGhCLEVBRUtoQixPQUZMLENBRWEsTUFBTXhDLE9BQU8sQ0FBQ0MsT0FBUixDQUFnQixJQUFoQixDQUZuQixFQUdLd0YsVUFITCxDQUdnQnZFLE9BQU8sQ0FBQzBELEtBQVIsQ0FBY2MsSUFBZCxFQUhoQjtBQUlBL0QsSUFBQUEsZUFBZSxDQUNWTyxLQURMLENBQ1dtQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsY0FBRixDQUFpQnBELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFqQixDQURoQixFQUNzRGhCLE9BRHRELENBQzhELE1BQU1kLFFBQVEsQ0FBQ2UsTUFEN0UsRUFFS2dELFVBRkwsQ0FFZ0J2RSxPQUFPLENBQUMwRCxLQUFSLENBQWNnQixXQUFkLEVBRmhCO0FBR0EsVUFBTW5FLE9BQU8sQ0FBQzhELFFBQVIsQ0FBaUJDLFVBQWpCLENBQU47QUFDQSxVQUFNL0QsT0FBTyxDQUFDOEQsUUFBUixDQUFpQkMsVUFBakIsQ0FBTjtBQUNBLFVBQU0vRCxPQUFPLENBQUM4RCxRQUFSLENBQWlCQyxVQUFqQixDQUFOO0FBQ0EsVUFBTS9ELE9BQU8sQ0FBQzhELFFBQVIsQ0FBaUJDLFVBQWpCLENBQU47QUFDQTVELElBQUFBLGNBQWMsQ0FBQ2lFLFNBQWY7QUFDQWhFLElBQUFBLGlCQUFpQixDQUFDZ0UsU0FBbEI7QUFDQW5FLElBQUFBLFFBQVEsQ0FBQ2dELE1BQVQsQ0FBZ0JMLENBQUMsSUFBSUEsQ0FBQyxDQUFDTSxJQUFGLENBQU96RCxPQUFPLENBQUNxQyxFQUFSLENBQVdRLE9BQVgsQ0FBbUIsSUFBbkIsQ0FBUCxDQUFyQixFQUF1RDdDLE9BQU8sQ0FBQzBELEtBQVIsQ0FBY2dCLFdBQWQsRUFBdkQ7QUFDSCxHQXBCNEUsQ0FBekUsQ0FBSjtBQXFCQXhDLEVBQUFBLElBQUksQ0FBQyxpRUFBRCxFQUFvRSxNQUFNekQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUN2SGlDLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQm1CLE1BQU0sSUFBSUEsTUFBTSxDQUFDQyxnQ0FBUCxDQUF3Q3BDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QyxFQUE0RHRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUE1RCxDQUEvQixFQUFnSGhCLE9BQWhILENBQXdILE1BQU14QyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0J3RCxTQUFoQixDQUE5SDtBQUNBLFFBQUlxQyxVQUFVLEdBQUcsS0FBakI7QUFDQSxRQUFJQyxZQUFKO0FBQ0FwRSxJQUFBQSxlQUFlLENBQUNPLEtBQWhCLENBQXNCOEQsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLGtCQUFGLENBQXFCL0UsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQXJCLEVBQXlDdEMsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQXpDLEVBQTZEdEMsT0FBTyxDQUFDcUMsRUFBUixDQUFXQyxLQUFYLEVBQTdELENBQTNCLEVBQTZHaEIsT0FBN0csQ0FBcUgwRCxPQUFPLElBQUk7QUFDNUhILE1BQUFBLFlBQVksR0FBR0csT0FBZixDQUQ0SCxDQUU1SDs7QUFDQSxhQUFPO0FBQUVsRCxRQUFBQSxPQUFPLEVBQUUsTUFBTSxDQUFHO0FBQXBCLE9BQVA7QUFDSCxLQUpEO0FBS0F2QixJQUFBQSxPQUFPLEdBQUcsSUFBSUosU0FBUyxDQUFDc0MsZUFBZCxDQUE4QjFCLG9CQUFvQixDQUFDUSxNQUFuRCxDQUFWO0FBQ0FoQixJQUFBQSxPQUFPLENBQUN3RSxrQkFBUixDQUEyQixNQUFNSCxVQUFVLEdBQUcsSUFBOUMsRUFBb0RyRSxPQUFwRDtBQUNBRyxJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ1ksb0JBQUYsRUFBMUIsRUFBb0QzQyxPQUFwRCxDQUE0RCxNQUFNLEVBQWxFO0FBQ0FaLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQnFDLENBQUMsSUFBSUEsQ0FBQyxDQUFDYSxxQkFBRixDQUF3QmxFLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QixDQUExQixFQUF1RWhCLE9BQXZFLENBQStFLE1BQU1sQixPQUFPLENBQUMrRCxpQkFBUixDQUEwQkMsSUFBL0c7QUFDQTNELElBQUFBLGVBQWUsQ0FBQ08sS0FBaEIsQ0FBc0JtQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsY0FBRixDQUFpQnBELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFqQixDQUEzQixFQUFpRWhCLE9BQWpFLENBQXlFLE1BQU1kLFFBQVEsQ0FBQ2UsTUFBeEYsRUFidUgsQ0Fjdkg7O0FBQ0EsVUFBTWhCLE9BQU8sQ0FBQzhELFFBQVIsQ0FBaUIsTUFBakIsQ0FBTjtBQUNBdkUsSUFBQUEsTUFBTSxDQUFDbUYsTUFBUCxDQUFjSixZQUFkLEVBQTRCSyxHQUE1QixDQUFnQ0MsRUFBaEMsQ0FBbUNDLEVBQW5DLENBQXNDQyxFQUF0QyxDQUF5QyxXQUF6QyxFQUFzRCwrQkFBdEQ7QUFDQVIsSUFBQUEsWUFBWSxDQUFDUyxJQUFiLENBQWtCL0UsT0FBbEI7QUFDQVQsSUFBQUEsTUFBTSxDQUFDbUYsTUFBUCxDQUFjTCxVQUFkLEVBQTBCTyxFQUExQixDQUE2QkMsRUFBN0IsQ0FBZ0NHLEtBQWhDLENBQXNDLEtBQXRDLEVBQTZDLGFBQTdDO0FBQ0gsR0FuQnNGLENBQW5GLENBQUo7QUFvQkFyRCxFQUFBQSxJQUFJLENBQUMseURBQUQsRUFBNEQsTUFBTXpELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDL0dpQyxJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJtQixNQUFNLElBQUlBLE1BQU0sQ0FBQ0MsZ0NBQVAsQ0FBd0NwQyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBeEMsRUFBNER0QyxPQUFPLENBQUNxQyxFQUFSLENBQVdDLEtBQVgsRUFBNUQsQ0FBL0IsRUFBZ0hoQixPQUFoSCxDQUF3SCxNQUFNeEMsT0FBTyxDQUFDQyxPQUFSLENBQWdCd0QsU0FBaEIsQ0FBOUg7QUFDQSxRQUFJcUMsVUFBVSxHQUFHLEtBQWpCO0FBQ0EsUUFBSUMsWUFBSjtBQUNBcEUsSUFBQUEsZUFBZSxDQUFDTyxLQUFoQixDQUFzQjhELENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxrQkFBRixDQUFxQi9FLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFyQixFQUF5Q3RDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF6QyxFQUE2RHRDLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUE3RCxDQUEzQixFQUE2R2hCLE9BQTdHLENBQXFIMEQsT0FBTyxJQUFJO0FBQzVISCxNQUFBQSxZQUFZLEdBQUdHLE9BQWYsQ0FENEgsQ0FFNUg7O0FBQ0EsYUFBTztBQUFFbEQsUUFBQUEsT0FBTyxFQUFFLE1BQU0sQ0FBRztBQUFwQixPQUFQO0FBQ0gsS0FKRDtBQUtBdkIsSUFBQUEsT0FBTyxHQUFHLElBQUlKLFNBQVMsQ0FBQ3NDLGVBQWQsQ0FBOEIxQixvQkFBb0IsQ0FBQ1EsTUFBbkQsQ0FBVjtBQUNBaEIsSUFBQUEsT0FBTyxDQUFDd0Usa0JBQVIsQ0FBMkIsTUFBTUgsVUFBVSxHQUFHLElBQTlDO0FBQ0FsRSxJQUFBQSxjQUFjLENBQUNNLEtBQWYsQ0FBcUJxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ1ksb0JBQUYsRUFBMUIsRUFBb0QzQyxPQUFwRCxDQUE0RCxNQUFNLEVBQWxFO0FBQ0FaLElBQUFBLGNBQWMsQ0FBQ00sS0FBZixDQUFxQnFDLENBQUMsSUFBSUEsQ0FBQyxDQUFDYSxxQkFBRixDQUF3QmxFLE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUF4QixDQUExQixFQUF1RWhCLE9BQXZFLENBQStFLE1BQU1sQixPQUFPLENBQUMrRCxpQkFBUixDQUEwQkMsSUFBL0c7QUFDQTNELElBQUFBLGVBQWUsQ0FBQ08sS0FBaEIsQ0FBc0JtQyxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsY0FBRixDQUFpQnBELE9BQU8sQ0FBQ3FDLEVBQVIsQ0FBV0MsS0FBWCxFQUFqQixDQUEzQixFQUFpRWhCLE9BQWpFLENBQXlFLE1BQU1kLFFBQVEsQ0FBQ2UsTUFBeEYsRUFiK0csQ0FjL0c7O0FBQ0EsVUFBTWhCLE9BQU8sQ0FBQzhELFFBQVIsQ0FBaUIsTUFBakIsQ0FBTjtBQUNBdkUsSUFBQUEsTUFBTSxDQUFDbUYsTUFBUCxDQUFjSixZQUFkLEVBQTRCSyxHQUE1QixDQUFnQ0MsRUFBaEMsQ0FBbUNDLEVBQW5DLENBQXNDQyxFQUF0QyxDQUF5QyxXQUF6QyxFQUFzRCwrQkFBdEQ7QUFDQVIsSUFBQUEsWUFBWSxDQUFDUyxJQUFiLENBQWtCL0UsT0FBbEIsRUFBMkJDLFFBQVEsQ0FBQ2UsTUFBcEM7QUFDQXpCLElBQUFBLE1BQU0sQ0FBQ21GLE1BQVAsQ0FBY0wsVUFBZCxFQUEwQk8sRUFBMUIsQ0FBNkJDLEVBQTdCLENBQWdDRyxLQUFoQyxDQUFzQyxJQUF0QyxFQUE0QyxpQkFBNUM7QUFDSCxHQW5COEUsQ0FBM0UsQ0FBSjtBQW9CSCxDQWxMSSxDQUFMIiwic291cmNlc0NvbnRlbnQiOlsiXCJ1c2Ugc3RyaWN0XCI7XHJcbi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgY2hhaV8xID0gcmVxdWlyZShcImNoYWlcIik7XHJcbmNvbnN0IFR5cGVNb3EgPSByZXF1aXJlKFwidHlwZW1vcVwiKTtcclxuY29uc3QgdHlwZXNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL2FwcGxpY2F0aW9uL3R5cGVzXCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vcGxhdGZvcm0vdHlwZXNcIik7XHJcbmNvbnN0IHNlcnZpY2VfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL3Rlcm1pbmFsL3NlcnZpY2VcIik7XHJcbmNvbnN0IHR5cGVzXzMgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2NvbW1vbi90ZXJtaW5hbC90eXBlc1wiKTtcclxuY29uc3QgdHlwZXNfNCA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL3R5cGVzXCIpO1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWZ1bmMtYm9keS1sZW5ndGhcclxuc3VpdGUoJ1Rlcm1pbmFsIFNlcnZpY2UnLCAoKSA9PiB7XHJcbiAgICBsZXQgc2VydmljZTtcclxuICAgIGxldCB0ZXJtaW5hbDtcclxuICAgIGxldCB0ZXJtaW5hbE1hbmFnZXI7XHJcbiAgICBsZXQgdGVybWluYWxIZWxwZXI7XHJcbiAgICBsZXQgdGVybWluYWxBY3RpdmF0b3I7XHJcbiAgICBsZXQgcGxhdGZvcm1TZXJ2aWNlO1xyXG4gICAgbGV0IHdvcmtzcGFjZVNlcnZpY2U7XHJcbiAgICBsZXQgZGlzcG9zYWJsZXMgPSBbXTtcclxuICAgIGxldCBtb2NrU2VydmljZUNvbnRhaW5lcjtcclxuICAgIHNldHVwKCgpID0+IHtcclxuICAgICAgICB0ZXJtaW5hbCA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICB0ZXJtaW5hbE1hbmFnZXIgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgcGxhdGZvcm1TZXJ2aWNlID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHdvcmtzcGFjZVNlcnZpY2UgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgdGVybWluYWxBY3RpdmF0b3IgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgZGlzcG9zYWJsZXMgPSBbXTtcclxuICAgICAgICBtb2NrU2VydmljZUNvbnRhaW5lciA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBtb2NrU2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KHR5cGVzXzEuSVRlcm1pbmFsTWFuYWdlcikpLnJldHVybnMoKCkgPT4gdGVybWluYWxNYW5hZ2VyLm9iamVjdCk7XHJcbiAgICAgICAgbW9ja1NlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldCh0eXBlc18zLklUZXJtaW5hbEhlbHBlcikpLnJldHVybnMoKCkgPT4gdGVybWluYWxIZWxwZXIub2JqZWN0KTtcclxuICAgICAgICBtb2NrU2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KHR5cGVzXzIuSVBsYXRmb3JtU2VydmljZSkpLnJldHVybnMoKCkgPT4gcGxhdGZvcm1TZXJ2aWNlLm9iamVjdCk7XHJcbiAgICAgICAgbW9ja1NlcnZpY2VDb250YWluZXIuc2V0dXAoYyA9PiBjLmdldCh0eXBlc180LklEaXNwb3NhYmxlUmVnaXN0cnkpKS5yZXR1cm5zKCgpID0+IGRpc3Bvc2FibGVzKTtcclxuICAgICAgICBtb2NrU2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KHR5cGVzXzEuSVdvcmtzcGFjZVNlcnZpY2UpKS5yZXR1cm5zKCgpID0+IHdvcmtzcGFjZVNlcnZpY2Uub2JqZWN0KTtcclxuICAgICAgICBtb2NrU2VydmljZUNvbnRhaW5lci5zZXR1cChjID0+IGMuZ2V0KHR5cGVzXzMuSVRlcm1pbmFsQWN0aXZhdG9yKSkucmV0dXJucygoKSA9PiB0ZXJtaW5hbEFjdGl2YXRvci5vYmplY3QpO1xyXG4gICAgfSk7XHJcbiAgICB0ZWFyZG93bigoKSA9PiB7XHJcbiAgICAgICAgaWYgKHNlcnZpY2UpIHtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWFueVxyXG4gICAgICAgICAgICBzZXJ2aWNlLmRpc3Bvc2UoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZGlzcG9zYWJsZXMuZmlsdGVyKGl0ZW0gPT4gISFpdGVtKS5mb3JFYWNoKGl0ZW0gPT4gaXRlbS5kaXNwb3NlKCkpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgdGVybWluYWwgaXMgZGlzcG9zZWQnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIuc2V0dXAoaGVscGVyID0+IGhlbHBlci5nZXRFbnZpcm9ubWVudEFjdGl2YXRpb25Db21tYW5kcyhUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCkpO1xyXG4gICAgICAgIGNvbnN0IG9zID0gJ3dpbmRvd3MnO1xyXG4gICAgICAgIHNlcnZpY2UgPSBuZXcgc2VydmljZV8xLlRlcm1pbmFsU2VydmljZShtb2NrU2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgICAgIGNvbnN0IHNoZWxsUGF0aCA9ICdwb3dlcnNoZWxsLmV4ZSc7XHJcbiAgICAgICAgd29ya3NwYWNlU2VydmljZS5zZXR1cCh3ID0+IHcuZ2V0Q29uZmlndXJhdGlvbihUeXBlTW9xLkl0LmlzVmFsdWUoJ3Rlcm1pbmFsLmludGVncmF0ZWQuc2hlbGwnKSkpLnJldHVybnMoKCkgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCB3b3Jrc3BhY2VDb25maWcgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgICAgIHdvcmtzcGFjZUNvbmZpZy5zZXR1cChjID0+IGMuZ2V0KG9zKSkucmV0dXJucygoKSA9PiBzaGVsbFBhdGgpO1xyXG4gICAgICAgICAgICByZXR1cm4gd29ya3NwYWNlQ29uZmlnLm9iamVjdDtcclxuICAgICAgICB9KTtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzV2luZG93cykucmV0dXJucygoKSA9PiBvcyA9PT0gJ3dpbmRvd3MnKTtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzTGludXgpLnJldHVybnMoKCkgPT4gb3MgPT09ICdsaW51eCcpO1xyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZS5zZXR1cChwID0+IHAuaXNNYWMpLnJldHVybnMoKCkgPT4gb3MgPT09ICdvc3gnKTtcclxuICAgICAgICB0ZXJtaW5hbE1hbmFnZXIuc2V0dXAodCA9PiB0LmNyZWF0ZVRlcm1pbmFsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdGVybWluYWwub2JqZWN0KTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoID0+IGguYnVpbGRDb21tYW5kRm9yVGVybWluYWwoVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gJ2R1bW15IHRleHQnKTtcclxuICAgICAgICAvLyBTZW5kaW5nIGEgY29tbWFuZCB3aWxsIGNhdXNlIHRoZSB0ZXJtaW5hbCB0byBiZSBjcmVhdGVkXHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zZW5kQ29tbWFuZCgnJywgW10pO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuc2hvdyhUeXBlTW9xLkl0LmlzVmFsdWUodHJ1ZSkpLCBUeXBlTW9xLlRpbWVzLmV4YWN0bHkoMikpO1xyXG4gICAgICAgIHNlcnZpY2UuZGlzcG9zZSgpO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuZGlzcG9zZSgpLCBUeXBlTW9xLlRpbWVzLmV4YWN0bHkoMSkpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5zdXJlIGNvbW1hbmQgaXMgc2VudCB0byB0ZXJtaW5hbCBhbmQgaXQgaXMgc2hvd24nLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIuc2V0dXAoaGVscGVyID0+IGhlbHBlci5nZXRFbnZpcm9ubWVudEFjdGl2YXRpb25Db21tYW5kcyhUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCkpO1xyXG4gICAgICAgIHNlcnZpY2UgPSBuZXcgc2VydmljZV8xLlRlcm1pbmFsU2VydmljZShtb2NrU2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgICAgIGNvbnN0IGNvbW1hbmRUb1NlbmQgPSAnU29tZUNvbW1hbmQnO1xyXG4gICAgICAgIGNvbnN0IGFyZ3MgPSBbJzEnLCAnMiddO1xyXG4gICAgICAgIGNvbnN0IGNvbW1hbmRUb0V4cGVjdCA9IFtjb21tYW5kVG9TZW5kXS5jb25jYXQoYXJncykuam9pbignICcpO1xyXG4gICAgICAgIHRlcm1pbmFsSGVscGVyLnNldHVwKGggPT4gaC5idWlsZENvbW1hbmRGb3JUZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiBjb21tYW5kVG9FeHBlY3QpO1xyXG4gICAgICAgIHRlcm1pbmFsSGVscGVyLnNldHVwKGggPT4gaC5nZXRUZXJtaW5hbFNoZWxsUGF0aCgpKS5yZXR1cm5zKCgpID0+ICcnKTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoID0+IGguaWRlbnRpZnlUZXJtaW5hbFNoZWxsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdHlwZXNfMy5UZXJtaW5hbFNoZWxsVHlwZS5iYXNoKTtcclxuICAgICAgICB0ZXJtaW5hbE1hbmFnZXIuc2V0dXAodCA9PiB0LmNyZWF0ZVRlcm1pbmFsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdGVybWluYWwub2JqZWN0KTtcclxuICAgICAgICB5aWVsZCBzZXJ2aWNlLnNlbmRDb21tYW5kKGNvbW1hbmRUb1NlbmQsIGFyZ3MpO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuc2hvdyhUeXBlTW9xLkl0LmlzVmFsdWUodHJ1ZSkpLCBUeXBlTW9xLlRpbWVzLmV4YWN0bHkoMikpO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuc2VuZFRleHQoVHlwZU1vcS5JdC5pc1ZhbHVlKGNvbW1hbmRUb0V4cGVjdCksIFR5cGVNb3EuSXQuaXNWYWx1ZSh0cnVlKSksIFR5cGVNb3EuVGltZXMuZXhhY3RseSgxKSk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgdGV4dCBpcyBzZW50IHRvIHRlcm1pbmFsIGFuZCBpdCBpcyBzaG93bicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoZWxwZXIgPT4gaGVscGVyLmdldEVudmlyb25tZW50QWN0aXZhdGlvbkNvbW1hbmRzKFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKSk7XHJcbiAgICAgICAgc2VydmljZSA9IG5ldyBzZXJ2aWNlXzEuVGVybWluYWxTZXJ2aWNlKG1vY2tTZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICAgICAgY29uc3QgdGV4dFRvU2VuZCA9ICdTb21lIFRleHQnO1xyXG4gICAgICAgIHRlcm1pbmFsSGVscGVyLnNldHVwKGggPT4gaC5nZXRUZXJtaW5hbFNoZWxsUGF0aCgpKS5yZXR1cm5zKCgpID0+ICcnKTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoID0+IGguaWRlbnRpZnlUZXJtaW5hbFNoZWxsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdHlwZXNfMy5UZXJtaW5hbFNoZWxsVHlwZS5iYXNoKTtcclxuICAgICAgICB0ZXJtaW5hbE1hbmFnZXIuc2V0dXAodCA9PiB0LmNyZWF0ZVRlcm1pbmFsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdGVybWluYWwub2JqZWN0KTtcclxuICAgICAgICB5aWVsZCBzZXJ2aWNlLnNlbmRUZXh0KHRleHRUb1NlbmQpO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuc2hvdyhUeXBlTW9xLkl0LmlzVmFsdWUodHJ1ZSkpLCBUeXBlTW9xLlRpbWVzLmV4YWN0bHkoMikpO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuc2VuZFRleHQoVHlwZU1vcS5JdC5pc1ZhbHVlKHRleHRUb1NlbmQpKSwgVHlwZU1vcS5UaW1lcy5leGFjdGx5KDEpKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0Vuc3VyZSB0ZXJtaW5hbCBzaG93bicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoZWxwZXIgPT4gaGVscGVyLmdldEVudmlyb25tZW50QWN0aXZhdGlvbkNvbW1hbmRzKFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKSk7XHJcbiAgICAgICAgc2VydmljZSA9IG5ldyBzZXJ2aWNlXzEuVGVybWluYWxTZXJ2aWNlKG1vY2tTZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIuc2V0dXAoaCA9PiBoLmdldFRlcm1pbmFsU2hlbGxQYXRoKCkpLnJldHVybnMoKCkgPT4gJycpO1xyXG4gICAgICAgIHRlcm1pbmFsSGVscGVyLnNldHVwKGggPT4gaC5pZGVudGlmeVRlcm1pbmFsU2hlbGwoVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiB0eXBlc18zLlRlcm1pbmFsU2hlbGxUeXBlLmJhc2gpO1xyXG4gICAgICAgIHRlcm1pbmFsTWFuYWdlci5zZXR1cCh0ID0+IHQuY3JlYXRlVGVybWluYWwoVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiB0ZXJtaW5hbC5vYmplY3QpO1xyXG4gICAgICAgIHlpZWxkIHNlcnZpY2Uuc2hvdygpO1xyXG4gICAgICAgIHRlcm1pbmFsLnZlcmlmeSh0ID0+IHQuc2hvdyhUeXBlTW9xLkl0LmlzVmFsdWUodHJ1ZSkpLCBUeXBlTW9xLlRpbWVzLmV4YWN0bHkoMikpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5zdXJlIHRlcm1pbmFsIHNob3duIGFuZCBmb2N1cyBpcyBzZXQgdG8gdGhlIFRlcm1pbmFsJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIHRlcm1pbmFsSGVscGVyLnNldHVwKGhlbHBlciA9PiBoZWxwZXIuZ2V0RW52aXJvbm1lbnRBY3RpdmF0aW9uQ29tbWFuZHMoVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IFByb21pc2UucmVzb2x2ZSh1bmRlZmluZWQpKTtcclxuICAgICAgICBzZXJ2aWNlID0gbmV3IHNlcnZpY2VfMS5UZXJtaW5hbFNlcnZpY2UobW9ja1NlcnZpY2VDb250YWluZXIub2JqZWN0KTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoID0+IGguZ2V0VGVybWluYWxTaGVsbFBhdGgoKSkucmV0dXJucygoKSA9PiAnJyk7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIuc2V0dXAoaCA9PiBoLmlkZW50aWZ5VGVybWluYWxTaGVsbChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHR5cGVzXzMuVGVybWluYWxTaGVsbFR5cGUuYmFzaCk7XHJcbiAgICAgICAgdGVybWluYWxNYW5hZ2VyLnNldHVwKHQgPT4gdC5jcmVhdGVUZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHRlcm1pbmFsLm9iamVjdCk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zaG93KGZhbHNlKTtcclxuICAgICAgICB0ZXJtaW5hbC52ZXJpZnkodCA9PiB0LnNob3coVHlwZU1vcS5JdC5pc1ZhbHVlKGZhbHNlKSksIFR5cGVNb3EuVGltZXMuZXhhY3RseSgyKSk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgdGVybWluYWwgaXMgYWN0aXZhdGVkIG9uY2UgYWZ0ZXIgY3JlYXRpb24nLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgc2VydmljZSA9IG5ldyBzZXJ2aWNlXzEuVGVybWluYWxTZXJ2aWNlKG1vY2tTZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXJcclxuICAgICAgICAgICAgLnNldHVwKGggPT4gaC5nZXRUZXJtaW5hbFNoZWxsUGF0aCgpKS5yZXR1cm5zKCgpID0+ICcnKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgdGVybWluYWxBY3RpdmF0b3JcclxuICAgICAgICAgICAgLnNldHVwKGggPT4gaC5hY3RpdmF0ZUVudmlyb25tZW50SW5UZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHRydWUpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgdGVybWluYWxNYW5hZ2VyXHJcbiAgICAgICAgICAgIC5zZXR1cCh0ID0+IHQuY3JlYXRlVGVybWluYWwoVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiB0ZXJtaW5hbC5vYmplY3QpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zaG93KCk7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIudmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgdGVybWluYWxBY3RpdmF0b3IudmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgdGVybWluYWwudmVyaWZ5KHQgPT4gdC5zaG93KFR5cGVNb3EuSXQuaXNWYWx1ZSh0cnVlKSksIFR5cGVNb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgdGVybWluYWwgaXMgYWN0aXZhdGVkIG9uY2UgYmVmb3JlIHNlbmRpbmcgdGV4dCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBzZXJ2aWNlID0gbmV3IHNlcnZpY2VfMS5UZXJtaW5hbFNlcnZpY2UobW9ja1NlcnZpY2VDb250YWluZXIub2JqZWN0KTtcclxuICAgICAgICBjb25zdCB0ZXh0VG9TZW5kID0gJ1NvbWUgVGV4dCc7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXJcclxuICAgICAgICAgICAgLnNldHVwKGggPT4gaC5nZXRUZXJtaW5hbFNoZWxsUGF0aCgpKS5yZXR1cm5zKCgpID0+ICcnKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgdGVybWluYWxBY3RpdmF0b3JcclxuICAgICAgICAgICAgLnNldHVwKGggPT4gaC5hY3RpdmF0ZUVudmlyb25tZW50SW5UZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHRydWUpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZShUeXBlTW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgdGVybWluYWxNYW5hZ2VyXHJcbiAgICAgICAgICAgIC5zZXR1cCh0ID0+IHQuY3JlYXRlVGVybWluYWwoVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiB0ZXJtaW5hbC5vYmplY3QpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKFR5cGVNb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zZW5kVGV4dCh0ZXh0VG9TZW5kKTtcclxuICAgICAgICB5aWVsZCBzZXJ2aWNlLnNlbmRUZXh0KHRleHRUb1NlbmQpO1xyXG4gICAgICAgIHlpZWxkIHNlcnZpY2Uuc2VuZFRleHQodGV4dFRvU2VuZCk7XHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zZW5kVGV4dCh0ZXh0VG9TZW5kKTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci52ZXJpZnlBbGwoKTtcclxuICAgICAgICB0ZXJtaW5hbEFjdGl2YXRvci52ZXJpZnlBbGwoKTtcclxuICAgICAgICB0ZXJtaW5hbC52ZXJpZnkodCA9PiB0LnNob3coVHlwZU1vcS5JdC5pc1ZhbHVlKHRydWUpKSwgVHlwZU1vcS5UaW1lcy5hdExlYXN0T25jZSgpKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBjbG9zZSBldmVudCBpcyBub3QgZmlyZWQgd2hlbiBhbm90aGVyIHRlcm1pbmFsIGlzIGNsb3NlZCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoZWxwZXIgPT4gaGVscGVyLmdldEVudmlyb25tZW50QWN0aXZhdGlvbkNvbW1hbmRzKFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUodW5kZWZpbmVkKSk7XHJcbiAgICAgICAgbGV0IGV2ZW50RmlyZWQgPSBmYWxzZTtcclxuICAgICAgICBsZXQgZXZlbnRIYW5kbGVyO1xyXG4gICAgICAgIHRlcm1pbmFsTWFuYWdlci5zZXR1cChtID0+IG0ub25EaWRDbG9zZVRlcm1pbmFsKFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKGhhbmRsZXIgPT4ge1xyXG4gICAgICAgICAgICBldmVudEhhbmRsZXIgPSBoYW5kbGVyO1xyXG4gICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8tZW1wdHlcclxuICAgICAgICAgICAgcmV0dXJuIHsgZGlzcG9zZTogKCkgPT4geyB9IH07XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgc2VydmljZSA9IG5ldyBzZXJ2aWNlXzEuVGVybWluYWxTZXJ2aWNlKG1vY2tTZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICAgICAgc2VydmljZS5vbkRpZENsb3NlVGVybWluYWwoKCkgPT4gZXZlbnRGaXJlZCA9IHRydWUsIHNlcnZpY2UpO1xyXG4gICAgICAgIHRlcm1pbmFsSGVscGVyLnNldHVwKGggPT4gaC5nZXRUZXJtaW5hbFNoZWxsUGF0aCgpKS5yZXR1cm5zKCgpID0+ICcnKTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoID0+IGguaWRlbnRpZnlUZXJtaW5hbFNoZWxsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdHlwZXNfMy5UZXJtaW5hbFNoZWxsVHlwZS5iYXNoKTtcclxuICAgICAgICB0ZXJtaW5hbE1hbmFnZXIuc2V0dXAodCA9PiB0LmNyZWF0ZVRlcm1pbmFsKFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdGVybWluYWwub2JqZWN0KTtcclxuICAgICAgICAvLyBUaGlzIHdpbGwgY3JlYXRlIHRoZSB0ZXJtaW5hbC5cclxuICAgICAgICB5aWVsZCBzZXJ2aWNlLnNlbmRUZXh0KCdibGFoJyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChldmVudEhhbmRsZXIpLm5vdC50by5iZS5hbigndW5kZWZpbmVkJywgJ2V2ZW50IGhhbmRsZXIgbm90IGluaXRpYWxpemVkJyk7XHJcbiAgICAgICAgZXZlbnRIYW5kbGVyLmJpbmQoc2VydmljZSkoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGV2ZW50RmlyZWQpLnRvLmJlLmVxdWFsKGZhbHNlLCAnRXZlbnQgZmlyZWQnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBjbG9zZSBldmVudCBpcyBub3QgZmlyZWQgd2hlbiB0ZXJtaW5hbCBpcyBjbG9zZWQnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIuc2V0dXAoaGVscGVyID0+IGhlbHBlci5nZXRFbnZpcm9ubWVudEFjdGl2YXRpb25Db21tYW5kcyhUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHVuZGVmaW5lZCkpO1xyXG4gICAgICAgIGxldCBldmVudEZpcmVkID0gZmFsc2U7XHJcbiAgICAgICAgbGV0IGV2ZW50SGFuZGxlcjtcclxuICAgICAgICB0ZXJtaW5hbE1hbmFnZXIuc2V0dXAobSA9PiBtLm9uRGlkQ2xvc2VUZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCksIFR5cGVNb3EuSXQuaXNBbnkoKSwgVHlwZU1vcS5JdC5pc0FueSgpKSkucmV0dXJucyhoYW5kbGVyID0+IHtcclxuICAgICAgICAgICAgZXZlbnRIYW5kbGVyID0gaGFuZGxlcjtcclxuICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm5vLWVtcHR5XHJcbiAgICAgICAgICAgIHJldHVybiB7IGRpc3Bvc2U6ICgpID0+IHsgfSB9O1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHNlcnZpY2UgPSBuZXcgc2VydmljZV8xLlRlcm1pbmFsU2VydmljZShtb2NrU2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2Uub25EaWRDbG9zZVRlcm1pbmFsKCgpID0+IGV2ZW50RmlyZWQgPSB0cnVlKTtcclxuICAgICAgICB0ZXJtaW5hbEhlbHBlci5zZXR1cChoID0+IGguZ2V0VGVybWluYWxTaGVsbFBhdGgoKSkucmV0dXJucygoKSA9PiAnJyk7XHJcbiAgICAgICAgdGVybWluYWxIZWxwZXIuc2V0dXAoaCA9PiBoLmlkZW50aWZ5VGVybWluYWxTaGVsbChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHR5cGVzXzMuVGVybWluYWxTaGVsbFR5cGUuYmFzaCk7XHJcbiAgICAgICAgdGVybWluYWxNYW5hZ2VyLnNldHVwKHQgPT4gdC5jcmVhdGVUZXJtaW5hbChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHRlcm1pbmFsLm9iamVjdCk7XHJcbiAgICAgICAgLy8gVGhpcyB3aWxsIGNyZWF0ZSB0aGUgdGVybWluYWwuXHJcbiAgICAgICAgeWllbGQgc2VydmljZS5zZW5kVGV4dCgnYmxhaCcpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoZXZlbnRIYW5kbGVyKS5ub3QudG8uYmUuYW4oJ3VuZGVmaW5lZCcsICdldmVudCBoYW5kbGVyIG5vdCBpbml0aWFsaXplZCcpO1xyXG4gICAgICAgIGV2ZW50SGFuZGxlci5iaW5kKHNlcnZpY2UpKHRlcm1pbmFsLm9iamVjdCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChldmVudEZpcmVkKS50by5iZS5lcXVhbCh0cnVlLCAnRXZlbnQgbm90IGZpcmVkJyk7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1zZXJ2aWNlLnVuaXQudGVzdC5qcy5tYXAiXX0=