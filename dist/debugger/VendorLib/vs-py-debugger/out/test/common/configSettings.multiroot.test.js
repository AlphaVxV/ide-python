"use strict";

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const assert = require("assert");

const path = require("path");

const vscode_1 = require("vscode");

const configSettings_1 = require("../../client/common/configSettings");

const common_1 = require("../common");

const initialize_1 = require("../initialize");

const multirootPath = path.join(__dirname, '..', '..', '..', 'src', 'testMultiRootWkspc'); // tslint:disable-next-line:max-func-body-length

suite('Multiroot Config Settings', () => {
  suiteSetup(function () {
    return __awaiter(this, void 0, void 0, function* () {
      if (!initialize_1.IS_MULTI_ROOT_TEST) {
        // tslint:disable-next-line:no-invalid-this
        this.skip();
      }

      yield common_1.clearPythonPathInWorkspaceFolder(vscode_1.Uri.file(path.join(multirootPath, 'workspace1')));
      yield initialize_1.initialize();
    });
  });
  setup(initialize_1.initializeTest);
  suiteTeardown(initialize_1.closeActiveWindows);
  teardown(() => __awaiter(void 0, void 0, void 0, function* () {
    yield initialize_1.closeActiveWindows();
    yield common_1.clearPythonPathInWorkspaceFolder(vscode_1.Uri.file(path.join(multirootPath, 'workspace1')));
    yield initialize_1.initializeTest();
  }));

  function enableDisableLinterSetting(resource, configTarget, setting, enabled) {
    return __awaiter(this, void 0, void 0, function* () {
      const settings = vscode_1.workspace.getConfiguration('python.linting', resource);
      const cfgValue = settings.inspect(setting);

      if (configTarget === vscode_1.ConfigurationTarget.Workspace && cfgValue && cfgValue.workspaceValue === enabled) {
        return;
      }

      if (configTarget === vscode_1.ConfigurationTarget.WorkspaceFolder && cfgValue && cfgValue.workspaceFolderValue === enabled) {
        return;
      }

      yield settings.update(setting, enabled, configTarget);
      configSettings_1.PythonSettings.dispose();
    });
  }

  test('Workspace folder should inherit Python Path from workspace root', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    let settings = vscode_1.workspace.getConfiguration('python', workspaceUri);
    const pythonPath = `x${new Date().getTime()}`;
    yield settings.update('pythonPath', pythonPath, vscode_1.ConfigurationTarget.Workspace);
    const value = settings.inspect('pythonPath');

    if (value && typeof value.workspaceFolderValue === 'string') {
      yield settings.update('pythonPath', undefined, vscode_1.ConfigurationTarget.WorkspaceFolder);
    }

    settings = vscode_1.workspace.getConfiguration('python', workspaceUri);
    configSettings_1.PythonSettings.dispose();
    const cfgSetting = configSettings_1.PythonSettings.getInstance(workspaceUri);
    assert.equal(cfgSetting.pythonPath, pythonPath, 'Python Path not inherited from workspace');
  }));
  test('Workspace folder should not inherit Python Path from workspace root', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    const settings = vscode_1.workspace.getConfiguration('python', workspaceUri);
    const pythonPath = `x${new Date().getTime()}`;
    yield settings.update('pythonPath', pythonPath, vscode_1.ConfigurationTarget.Workspace);
    const privatePythonPath = `x${new Date().getTime()}`;
    yield settings.update('pythonPath', privatePythonPath, vscode_1.ConfigurationTarget.WorkspaceFolder);
    const cfgSetting = configSettings_1.PythonSettings.getInstance(workspaceUri);
    assert.equal(cfgSetting.pythonPath, privatePythonPath, 'Python Path for workspace folder is incorrect');
  }));
  test('Workspace folder should inherit Python Path from workspace root when opening a document', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    const fileToOpen = path.join(multirootPath, 'workspace1', 'file.py');
    const settings = vscode_1.workspace.getConfiguration('python', workspaceUri);
    const pythonPath = `x${new Date().getTime()}`;
    yield settings.update('pythonPath', pythonPath, vscode_1.ConfigurationTarget.Workspace); // Update workspace folder to something else so it gets refreshed.

    yield settings.update('pythonPath', `x${new Date().getTime()}`, vscode_1.ConfigurationTarget.WorkspaceFolder);
    yield settings.update('pythonPath', undefined, vscode_1.ConfigurationTarget.WorkspaceFolder);
    const document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    const cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(cfg.pythonPath, pythonPath, 'Python Path not inherited from workspace');
  }));
  test('Workspace folder should not inherit Python Path from workspace root when opening a document', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    const fileToOpen = path.join(multirootPath, 'workspace1', 'file.py');
    const settings = vscode_1.workspace.getConfiguration('python', workspaceUri);
    const pythonPath = `x${new Date().getTime()}`;
    yield settings.update('pythonPath', pythonPath, vscode_1.ConfigurationTarget.Workspace);
    const privatePythonPath = `x${new Date().getTime()}`;
    yield settings.update('pythonPath', privatePythonPath, vscode_1.ConfigurationTarget.WorkspaceFolder);
    const document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    const cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(cfg.pythonPath, privatePythonPath, 'Python Path for workspace folder is incorrect');
  }));
  test('Enabling/Disabling Pylint in root should be reflected in config settings', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', undefined);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', true);
    let settings = configSettings_1.PythonSettings.getInstance(workspaceUri);
    assert.equal(settings.linting.pylintEnabled, true, 'Pylint not enabled when it should be');
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', false);
    settings = configSettings_1.PythonSettings.getInstance(workspaceUri);
    assert.equal(settings.linting.pylintEnabled, false, 'Pylint enabled when it should not be');
  }));
  test('Enabling/Disabling Pylint in root and workspace should be reflected in config settings', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', false);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', true);
    let cfgSetting = configSettings_1.PythonSettings.getInstance(workspaceUri);
    assert.equal(cfgSetting.linting.pylintEnabled, false, 'Workspace folder pylint setting is true when it should not be');
    configSettings_1.PythonSettings.dispose();
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', true);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', false);
    cfgSetting = configSettings_1.PythonSettings.getInstance(workspaceUri);
    assert.equal(cfgSetting.linting.pylintEnabled, true, 'Workspace folder pylint setting is false when it should not be');
  }));
  test('Enabling/Disabling Pylint in root should be reflected in config settings when opening a document', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    const fileToOpen = path.join(multirootPath, 'workspace1', 'file.py');
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', false);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', true);
    let document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    let cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(cfg.linting.pylintEnabled, true, 'Pylint should be enabled in workspace');
    configSettings_1.PythonSettings.dispose();
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', true);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', false);
    document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(cfg.linting.pylintEnabled, false, 'Pylint should not be enabled in workspace');
  }));
  test('Enabling/Disabling Pylint in root should be reflected in config settings when opening a document', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspaceUri = vscode_1.Uri.file(path.join(multirootPath, 'workspace1'));
    const fileToOpen = path.join(multirootPath, 'workspace1', 'file.py');
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', false);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', true);
    let document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    let cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(cfg.linting.pylintEnabled, true, 'Pylint should be enabled in workspace');
    configSettings_1.PythonSettings.dispose();
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.Workspace, 'pylintEnabled', true);
    yield enableDisableLinterSetting(workspaceUri, vscode_1.ConfigurationTarget.WorkspaceFolder, 'pylintEnabled', false);
    document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(cfg.linting.pylintEnabled, false, 'Pylint should not be enabled in workspace');
  })); // tslint:disable-next-line:no-invalid-template-strings

  test('${workspaceFolder} variable in settings should be replaced with the right value', () => __awaiter(void 0, void 0, void 0, function* () {
    const workspace2Uri = vscode_1.Uri.file(path.join(multirootPath, 'workspace2'));
    let fileToOpen = path.join(workspace2Uri.fsPath, 'file.py');
    let document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    let cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(path.dirname(cfg.workspaceSymbols.tagFilePath), workspace2Uri.fsPath, 'ctags file path for workspace2 is incorrect');
    assert.equal(path.basename(cfg.workspaceSymbols.tagFilePath), 'workspace2.tags.file', 'ctags file name for workspace2 is incorrect');
    configSettings_1.PythonSettings.dispose();
    const workspace3Uri = vscode_1.Uri.file(path.join(multirootPath, 'workspace3'));
    fileToOpen = path.join(workspace3Uri.fsPath, 'file.py');
    document = yield vscode_1.workspace.openTextDocument(fileToOpen);
    cfg = configSettings_1.PythonSettings.getInstance(document.uri);
    assert.equal(path.dirname(cfg.workspaceSymbols.tagFilePath), workspace3Uri.fsPath, 'ctags file path for workspace3 is incorrect');
    assert.equal(path.basename(cfg.workspaceSymbols.tagFilePath), 'workspace3.tags.file', 'ctags file name for workspace3 is incorrect');
    configSettings_1.PythonSettings.dispose();
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImNvbmZpZ1NldHRpbmdzLm11bHRpcm9vdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJhc3NlcnQiLCJyZXF1aXJlIiwicGF0aCIsInZzY29kZV8xIiwiY29uZmlnU2V0dGluZ3NfMSIsImNvbW1vbl8xIiwiaW5pdGlhbGl6ZV8xIiwibXVsdGlyb290UGF0aCIsImpvaW4iLCJfX2Rpcm5hbWUiLCJzdWl0ZSIsInN1aXRlU2V0dXAiLCJJU19NVUxUSV9ST09UX1RFU1QiLCJza2lwIiwiY2xlYXJQeXRob25QYXRoSW5Xb3Jrc3BhY2VGb2xkZXIiLCJVcmkiLCJmaWxlIiwiaW5pdGlhbGl6ZSIsInNldHVwIiwiaW5pdGlhbGl6ZVRlc3QiLCJzdWl0ZVRlYXJkb3duIiwiY2xvc2VBY3RpdmVXaW5kb3dzIiwidGVhcmRvd24iLCJlbmFibGVEaXNhYmxlTGludGVyU2V0dGluZyIsInJlc291cmNlIiwiY29uZmlnVGFyZ2V0Iiwic2V0dGluZyIsImVuYWJsZWQiLCJzZXR0aW5ncyIsIndvcmtzcGFjZSIsImdldENvbmZpZ3VyYXRpb24iLCJjZmdWYWx1ZSIsImluc3BlY3QiLCJDb25maWd1cmF0aW9uVGFyZ2V0IiwiV29ya3NwYWNlIiwid29ya3NwYWNlVmFsdWUiLCJXb3Jrc3BhY2VGb2xkZXIiLCJ3b3Jrc3BhY2VGb2xkZXJWYWx1ZSIsInVwZGF0ZSIsIlB5dGhvblNldHRpbmdzIiwiZGlzcG9zZSIsInRlc3QiLCJ3b3Jrc3BhY2VVcmkiLCJweXRob25QYXRoIiwiRGF0ZSIsImdldFRpbWUiLCJ1bmRlZmluZWQiLCJjZmdTZXR0aW5nIiwiZ2V0SW5zdGFuY2UiLCJlcXVhbCIsInByaXZhdGVQeXRob25QYXRoIiwiZmlsZVRvT3BlbiIsImRvY3VtZW50Iiwib3BlblRleHREb2N1bWVudCIsImNmZyIsInVyaSIsImxpbnRpbmciLCJweWxpbnRFbmFibGVkIiwid29ya3NwYWNlMlVyaSIsImZzUGF0aCIsImRpcm5hbWUiLCJ3b3Jrc3BhY2VTeW1ib2xzIiwidGFnRmlsZVBhdGgiLCJiYXNlbmFtZSIsIndvcmtzcGFjZTNVcmkiXSwibWFwcGluZ3MiOiJBQUFBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFKO0FBQThCLE9BQXBDLENBQXFDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzNGLGFBQVNDLFFBQVQsQ0FBa0JKLEtBQWxCLEVBQXlCO0FBQUUsVUFBSTtBQUFFQyxRQUFBQSxJQUFJLENBQUNOLFNBQVMsQ0FBQyxPQUFELENBQVQsQ0FBbUJLLEtBQW5CLENBQUQsQ0FBSjtBQUFrQyxPQUF4QyxDQUF5QyxPQUFPRyxDQUFQLEVBQVU7QUFBRUwsUUFBQUEsTUFBTSxDQUFDSyxDQUFELENBQU47QUFBWTtBQUFFOztBQUM5RixhQUFTRixJQUFULENBQWNJLE1BQWQsRUFBc0I7QUFBRUEsTUFBQUEsTUFBTSxDQUFDQyxJQUFQLEdBQWNULE9BQU8sQ0FBQ1EsTUFBTSxDQUFDTCxLQUFSLENBQXJCLEdBQXNDLElBQUlOLENBQUosQ0FBTSxVQUFVRyxPQUFWLEVBQW1CO0FBQUVBLFFBQUFBLE9BQU8sQ0FBQ1EsTUFBTSxDQUFDTCxLQUFSLENBQVA7QUFBd0IsT0FBbkQsRUFBcURPLElBQXJELENBQTBEUixTQUExRCxFQUFxRUssUUFBckUsQ0FBdEM7QUFBdUg7O0FBQy9JSCxJQUFBQSxJQUFJLENBQUMsQ0FBQ04sU0FBUyxHQUFHQSxTQUFTLENBQUNhLEtBQVYsQ0FBZ0JoQixPQUFoQixFQUF5QkMsVUFBVSxJQUFJLEVBQXZDLENBQWIsRUFBeURTLElBQXpELEVBQUQsQ0FBSjtBQUNILEdBTE0sQ0FBUDtBQU1ILENBUEQ7O0FBUUFPLE1BQU0sQ0FBQ0MsY0FBUCxDQUFzQkMsT0FBdEIsRUFBK0IsWUFBL0IsRUFBNkM7QUFBRVgsRUFBQUEsS0FBSyxFQUFFO0FBQVQsQ0FBN0M7O0FBQ0EsTUFBTVksTUFBTSxHQUFHQyxPQUFPLENBQUMsUUFBRCxDQUF0Qjs7QUFDQSxNQUFNQyxJQUFJLEdBQUdELE9BQU8sQ0FBQyxNQUFELENBQXBCOztBQUNBLE1BQU1FLFFBQVEsR0FBR0YsT0FBTyxDQUFDLFFBQUQsQ0FBeEI7O0FBQ0EsTUFBTUcsZ0JBQWdCLEdBQUdILE9BQU8sQ0FBQyxvQ0FBRCxDQUFoQzs7QUFDQSxNQUFNSSxRQUFRLEdBQUdKLE9BQU8sQ0FBQyxXQUFELENBQXhCOztBQUNBLE1BQU1LLFlBQVksR0FBR0wsT0FBTyxDQUFDLGVBQUQsQ0FBNUI7O0FBQ0EsTUFBTU0sYUFBYSxHQUFHTCxJQUFJLENBQUNNLElBQUwsQ0FBVUMsU0FBVixFQUFxQixJQUFyQixFQUEyQixJQUEzQixFQUFpQyxJQUFqQyxFQUF1QyxLQUF2QyxFQUE4QyxvQkFBOUMsQ0FBdEIsQyxDQUNBOztBQUNBQyxLQUFLLENBQUMsMkJBQUQsRUFBOEIsTUFBTTtBQUNyQ0MsRUFBQUEsVUFBVSxDQUFDLFlBQVk7QUFDbkIsV0FBT2hDLFNBQVMsQ0FBQyxJQUFELEVBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQ2hELFVBQUksQ0FBQzJCLFlBQVksQ0FBQ00sa0JBQWxCLEVBQXNDO0FBQ2xDO0FBQ0EsYUFBS0MsSUFBTDtBQUNIOztBQUNELFlBQU1SLFFBQVEsQ0FBQ1MsZ0NBQVQsQ0FBMENYLFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUExQyxDQUFOO0FBQ0EsWUFBTUQsWUFBWSxDQUFDVyxVQUFiLEVBQU47QUFDSCxLQVBlLENBQWhCO0FBUUgsR0FUUyxDQUFWO0FBVUFDLEVBQUFBLEtBQUssQ0FBQ1osWUFBWSxDQUFDYSxjQUFkLENBQUw7QUFDQUMsRUFBQUEsYUFBYSxDQUFDZCxZQUFZLENBQUNlLGtCQUFkLENBQWI7QUFDQUMsRUFBQUEsUUFBUSxDQUFDLE1BQU0zQyxTQUFTLFNBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQ3hELFVBQU0yQixZQUFZLENBQUNlLGtCQUFiLEVBQU47QUFDQSxVQUFNaEIsUUFBUSxDQUFDUyxnQ0FBVCxDQUEwQ1gsUUFBUSxDQUFDWSxHQUFULENBQWFDLElBQWIsQ0FBa0JkLElBQUksQ0FBQ00sSUFBTCxDQUFVRCxhQUFWLEVBQXlCLFlBQXpCLENBQWxCLENBQTFDLENBQU47QUFDQSxVQUFNRCxZQUFZLENBQUNhLGNBQWIsRUFBTjtBQUNILEdBSnVCLENBQWhCLENBQVI7O0FBS0EsV0FBU0ksMEJBQVQsQ0FBb0NDLFFBQXBDLEVBQThDQyxZQUE5QyxFQUE0REMsT0FBNUQsRUFBcUVDLE9BQXJFLEVBQThFO0FBQzFFLFdBQU9oRCxTQUFTLENBQUMsSUFBRCxFQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUNoRCxZQUFNaUQsUUFBUSxHQUFHekIsUUFBUSxDQUFDMEIsU0FBVCxDQUFtQkMsZ0JBQW5CLENBQW9DLGdCQUFwQyxFQUFzRE4sUUFBdEQsQ0FBakI7QUFDQSxZQUFNTyxRQUFRLEdBQUdILFFBQVEsQ0FBQ0ksT0FBVCxDQUFpQk4sT0FBakIsQ0FBakI7O0FBQ0EsVUFBSUQsWUFBWSxLQUFLdEIsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJDLFNBQTlDLElBQTJESCxRQUEzRCxJQUF1RUEsUUFBUSxDQUFDSSxjQUFULEtBQTRCUixPQUF2RyxFQUFnSDtBQUM1RztBQUNIOztBQUNELFVBQUlGLFlBQVksS0FBS3RCLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE5QyxJQUFpRUwsUUFBakUsSUFBNkVBLFFBQVEsQ0FBQ00sb0JBQVQsS0FBa0NWLE9BQW5ILEVBQTRIO0FBQ3hIO0FBQ0g7O0FBQ0QsWUFBTUMsUUFBUSxDQUFDVSxNQUFULENBQWdCWixPQUFoQixFQUF5QkMsT0FBekIsRUFBa0NGLFlBQWxDLENBQU47QUFDQXJCLE1BQUFBLGdCQUFnQixDQUFDbUMsY0FBakIsQ0FBZ0NDLE9BQWhDO0FBQ0gsS0FYZSxDQUFoQjtBQVlIOztBQUNEQyxFQUFBQSxJQUFJLENBQUMsaUVBQUQsRUFBb0UsTUFBTTlELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDdkgsVUFBTStELFlBQVksR0FBR3ZDLFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUFyQjtBQUNBLFFBQUlxQixRQUFRLEdBQUd6QixRQUFRLENBQUMwQixTQUFULENBQW1CQyxnQkFBbkIsQ0FBb0MsUUFBcEMsRUFBOENZLFlBQTlDLENBQWY7QUFDQSxVQUFNQyxVQUFVLEdBQUksSUFBRyxJQUFJQyxJQUFKLEdBQVdDLE9BQVgsRUFBcUIsRUFBNUM7QUFDQSxVQUFNakIsUUFBUSxDQUFDVSxNQUFULENBQWdCLFlBQWhCLEVBQThCSyxVQUE5QixFQUEwQ3hDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCQyxTQUF2RSxDQUFOO0FBQ0EsVUFBTTlDLEtBQUssR0FBR3dDLFFBQVEsQ0FBQ0ksT0FBVCxDQUFpQixZQUFqQixDQUFkOztBQUNBLFFBQUk1QyxLQUFLLElBQUksT0FBT0EsS0FBSyxDQUFDaUQsb0JBQWIsS0FBc0MsUUFBbkQsRUFBNkQ7QUFDekQsWUFBTVQsUUFBUSxDQUFDVSxNQUFULENBQWdCLFlBQWhCLEVBQThCUSxTQUE5QixFQUF5QzNDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUF0RSxDQUFOO0FBQ0g7O0FBQ0RSLElBQUFBLFFBQVEsR0FBR3pCLFFBQVEsQ0FBQzBCLFNBQVQsQ0FBbUJDLGdCQUFuQixDQUFvQyxRQUFwQyxFQUE4Q1ksWUFBOUMsQ0FBWDtBQUNBdEMsSUFBQUEsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ0MsT0FBaEM7QUFDQSxVQUFNTyxVQUFVLEdBQUczQyxnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDUyxXQUFoQyxDQUE0Q04sWUFBNUMsQ0FBbkI7QUFDQTFDLElBQUFBLE1BQU0sQ0FBQ2lELEtBQVAsQ0FBYUYsVUFBVSxDQUFDSixVQUF4QixFQUFvQ0EsVUFBcEMsRUFBZ0QsMENBQWhEO0FBQ0gsR0Fic0YsQ0FBbkYsQ0FBSjtBQWNBRixFQUFBQSxJQUFJLENBQUMscUVBQUQsRUFBd0UsTUFBTTlELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDM0gsVUFBTStELFlBQVksR0FBR3ZDLFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUFyQjtBQUNBLFVBQU1xQixRQUFRLEdBQUd6QixRQUFRLENBQUMwQixTQUFULENBQW1CQyxnQkFBbkIsQ0FBb0MsUUFBcEMsRUFBOENZLFlBQTlDLENBQWpCO0FBQ0EsVUFBTUMsVUFBVSxHQUFJLElBQUcsSUFBSUMsSUFBSixHQUFXQyxPQUFYLEVBQXFCLEVBQTVDO0FBQ0EsVUFBTWpCLFFBQVEsQ0FBQ1UsTUFBVCxDQUFnQixZQUFoQixFQUE4QkssVUFBOUIsRUFBMEN4QyxRQUFRLENBQUM4QixtQkFBVCxDQUE2QkMsU0FBdkUsQ0FBTjtBQUNBLFVBQU1nQixpQkFBaUIsR0FBSSxJQUFHLElBQUlOLElBQUosR0FBV0MsT0FBWCxFQUFxQixFQUFuRDtBQUNBLFVBQU1qQixRQUFRLENBQUNVLE1BQVQsQ0FBZ0IsWUFBaEIsRUFBOEJZLGlCQUE5QixFQUFpRC9DLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE5RSxDQUFOO0FBQ0EsVUFBTVcsVUFBVSxHQUFHM0MsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ1MsV0FBaEMsQ0FBNENOLFlBQTVDLENBQW5CO0FBQ0ExQyxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWFGLFVBQVUsQ0FBQ0osVUFBeEIsRUFBb0NPLGlCQUFwQyxFQUF1RCwrQ0FBdkQ7QUFDSCxHQVQwRixDQUF2RixDQUFKO0FBVUFULEVBQUFBLElBQUksQ0FBQyx5RkFBRCxFQUE0RixNQUFNOUQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUMvSSxVQUFNK0QsWUFBWSxHQUFHdkMsUUFBUSxDQUFDWSxHQUFULENBQWFDLElBQWIsQ0FBa0JkLElBQUksQ0FBQ00sSUFBTCxDQUFVRCxhQUFWLEVBQXlCLFlBQXpCLENBQWxCLENBQXJCO0FBQ0EsVUFBTTRDLFVBQVUsR0FBR2pELElBQUksQ0FBQ00sSUFBTCxDQUFVRCxhQUFWLEVBQXlCLFlBQXpCLEVBQXVDLFNBQXZDLENBQW5CO0FBQ0EsVUFBTXFCLFFBQVEsR0FBR3pCLFFBQVEsQ0FBQzBCLFNBQVQsQ0FBbUJDLGdCQUFuQixDQUFvQyxRQUFwQyxFQUE4Q1ksWUFBOUMsQ0FBakI7QUFDQSxVQUFNQyxVQUFVLEdBQUksSUFBRyxJQUFJQyxJQUFKLEdBQVdDLE9BQVgsRUFBcUIsRUFBNUM7QUFDQSxVQUFNakIsUUFBUSxDQUFDVSxNQUFULENBQWdCLFlBQWhCLEVBQThCSyxVQUE5QixFQUEwQ3hDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCQyxTQUF2RSxDQUFOLENBTCtJLENBTS9JOztBQUNBLFVBQU1OLFFBQVEsQ0FBQ1UsTUFBVCxDQUFnQixZQUFoQixFQUErQixJQUFHLElBQUlNLElBQUosR0FBV0MsT0FBWCxFQUFxQixFQUF2RCxFQUEwRDFDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUF2RixDQUFOO0FBQ0EsVUFBTVIsUUFBUSxDQUFDVSxNQUFULENBQWdCLFlBQWhCLEVBQThCUSxTQUE5QixFQUF5QzNDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUF0RSxDQUFOO0FBQ0EsVUFBTWdCLFFBQVEsR0FBRyxNQUFNakQsUUFBUSxDQUFDMEIsU0FBVCxDQUFtQndCLGdCQUFuQixDQUFvQ0YsVUFBcEMsQ0FBdkI7QUFDQSxVQUFNRyxHQUFHLEdBQUdsRCxnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDUyxXQUFoQyxDQUE0Q0ksUUFBUSxDQUFDRyxHQUFyRCxDQUFaO0FBQ0F2RCxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWFLLEdBQUcsQ0FBQ1gsVUFBakIsRUFBNkJBLFVBQTdCLEVBQXlDLDBDQUF6QztBQUNILEdBWjhHLENBQTNHLENBQUo7QUFhQUYsRUFBQUEsSUFBSSxDQUFDLDZGQUFELEVBQWdHLE1BQU05RCxTQUFTLFNBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQ25KLFVBQU0rRCxZQUFZLEdBQUd2QyxRQUFRLENBQUNZLEdBQVQsQ0FBYUMsSUFBYixDQUFrQmQsSUFBSSxDQUFDTSxJQUFMLENBQVVELGFBQVYsRUFBeUIsWUFBekIsQ0FBbEIsQ0FBckI7QUFDQSxVQUFNNEMsVUFBVSxHQUFHakQsSUFBSSxDQUFDTSxJQUFMLENBQVVELGFBQVYsRUFBeUIsWUFBekIsRUFBdUMsU0FBdkMsQ0FBbkI7QUFDQSxVQUFNcUIsUUFBUSxHQUFHekIsUUFBUSxDQUFDMEIsU0FBVCxDQUFtQkMsZ0JBQW5CLENBQW9DLFFBQXBDLEVBQThDWSxZQUE5QyxDQUFqQjtBQUNBLFVBQU1DLFVBQVUsR0FBSSxJQUFHLElBQUlDLElBQUosR0FBV0MsT0FBWCxFQUFxQixFQUE1QztBQUNBLFVBQU1qQixRQUFRLENBQUNVLE1BQVQsQ0FBZ0IsWUFBaEIsRUFBOEJLLFVBQTlCLEVBQTBDeEMsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJDLFNBQXZFLENBQU47QUFDQSxVQUFNZ0IsaUJBQWlCLEdBQUksSUFBRyxJQUFJTixJQUFKLEdBQVdDLE9BQVgsRUFBcUIsRUFBbkQ7QUFDQSxVQUFNakIsUUFBUSxDQUFDVSxNQUFULENBQWdCLFlBQWhCLEVBQThCWSxpQkFBOUIsRUFBaUQvQyxRQUFRLENBQUM4QixtQkFBVCxDQUE2QkcsZUFBOUUsQ0FBTjtBQUNBLFVBQU1nQixRQUFRLEdBQUcsTUFBTWpELFFBQVEsQ0FBQzBCLFNBQVQsQ0FBbUJ3QixnQkFBbkIsQ0FBb0NGLFVBQXBDLENBQXZCO0FBQ0EsVUFBTUcsR0FBRyxHQUFHbEQsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ1MsV0FBaEMsQ0FBNENJLFFBQVEsQ0FBQ0csR0FBckQsQ0FBWjtBQUNBdkQsSUFBQUEsTUFBTSxDQUFDaUQsS0FBUCxDQUFhSyxHQUFHLENBQUNYLFVBQWpCLEVBQTZCTyxpQkFBN0IsRUFBZ0QsK0NBQWhEO0FBQ0gsR0FYa0gsQ0FBL0csQ0FBSjtBQVlBVCxFQUFBQSxJQUFJLENBQUMsMEVBQUQsRUFBNkUsTUFBTTlELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDaEksVUFBTStELFlBQVksR0FBR3ZDLFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUFyQjtBQUNBLFVBQU1nQiwwQkFBMEIsQ0FBQ21CLFlBQUQsRUFBZXZDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE1QyxFQUE2RCxlQUE3RCxFQUE4RVUsU0FBOUUsQ0FBaEM7QUFDQSxVQUFNdkIsMEJBQTBCLENBQUNtQixZQUFELEVBQWV2QyxRQUFRLENBQUM4QixtQkFBVCxDQUE2QkMsU0FBNUMsRUFBdUQsZUFBdkQsRUFBd0UsSUFBeEUsQ0FBaEM7QUFDQSxRQUFJTixRQUFRLEdBQUd4QixnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDUyxXQUFoQyxDQUE0Q04sWUFBNUMsQ0FBZjtBQUNBMUMsSUFBQUEsTUFBTSxDQUFDaUQsS0FBUCxDQUFhckIsUUFBUSxDQUFDNEIsT0FBVCxDQUFpQkMsYUFBOUIsRUFBNkMsSUFBN0MsRUFBbUQsc0NBQW5EO0FBQ0EsVUFBTWxDLDBCQUEwQixDQUFDbUIsWUFBRCxFQUFldkMsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJDLFNBQTVDLEVBQXVELGVBQXZELEVBQXdFLEtBQXhFLENBQWhDO0FBQ0FOLElBQUFBLFFBQVEsR0FBR3hCLGdCQUFnQixDQUFDbUMsY0FBakIsQ0FBZ0NTLFdBQWhDLENBQTRDTixZQUE1QyxDQUFYO0FBQ0ExQyxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWFyQixRQUFRLENBQUM0QixPQUFULENBQWlCQyxhQUE5QixFQUE2QyxLQUE3QyxFQUFvRCxzQ0FBcEQ7QUFDSCxHQVQrRixDQUE1RixDQUFKO0FBVUFoQixFQUFBQSxJQUFJLENBQUMsd0ZBQUQsRUFBMkYsTUFBTTlELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDOUksVUFBTStELFlBQVksR0FBR3ZDLFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUFyQjtBQUNBLFVBQU1nQiwwQkFBMEIsQ0FBQ21CLFlBQUQsRUFBZXZDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE1QyxFQUE2RCxlQUE3RCxFQUE4RSxLQUE5RSxDQUFoQztBQUNBLFVBQU1iLDBCQUEwQixDQUFDbUIsWUFBRCxFQUFldkMsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJDLFNBQTVDLEVBQXVELGVBQXZELEVBQXdFLElBQXhFLENBQWhDO0FBQ0EsUUFBSWEsVUFBVSxHQUFHM0MsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ1MsV0FBaEMsQ0FBNENOLFlBQTVDLENBQWpCO0FBQ0ExQyxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWFGLFVBQVUsQ0FBQ1MsT0FBWCxDQUFtQkMsYUFBaEMsRUFBK0MsS0FBL0MsRUFBc0QsK0RBQXREO0FBQ0FyRCxJQUFBQSxnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDQyxPQUFoQztBQUNBLFVBQU1qQiwwQkFBMEIsQ0FBQ21CLFlBQUQsRUFBZXZDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE1QyxFQUE2RCxlQUE3RCxFQUE4RSxJQUE5RSxDQUFoQztBQUNBLFVBQU1iLDBCQUEwQixDQUFDbUIsWUFBRCxFQUFldkMsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJDLFNBQTVDLEVBQXVELGVBQXZELEVBQXdFLEtBQXhFLENBQWhDO0FBQ0FhLElBQUFBLFVBQVUsR0FBRzNDLGdCQUFnQixDQUFDbUMsY0FBakIsQ0FBZ0NTLFdBQWhDLENBQTRDTixZQUE1QyxDQUFiO0FBQ0ExQyxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWFGLFVBQVUsQ0FBQ1MsT0FBWCxDQUFtQkMsYUFBaEMsRUFBK0MsSUFBL0MsRUFBcUQsZ0VBQXJEO0FBQ0gsR0FYNkcsQ0FBMUcsQ0FBSjtBQVlBaEIsRUFBQUEsSUFBSSxDQUFDLGtHQUFELEVBQXFHLE1BQU05RCxTQUFTLFNBQU8sS0FBSyxDQUFaLEVBQWUsS0FBSyxDQUFwQixFQUF1QixhQUFhO0FBQ3hKLFVBQU0rRCxZQUFZLEdBQUd2QyxRQUFRLENBQUNZLEdBQVQsQ0FBYUMsSUFBYixDQUFrQmQsSUFBSSxDQUFDTSxJQUFMLENBQVVELGFBQVYsRUFBeUIsWUFBekIsQ0FBbEIsQ0FBckI7QUFDQSxVQUFNNEMsVUFBVSxHQUFHakQsSUFBSSxDQUFDTSxJQUFMLENBQVVELGFBQVYsRUFBeUIsWUFBekIsRUFBdUMsU0FBdkMsQ0FBbkI7QUFDQSxVQUFNZ0IsMEJBQTBCLENBQUNtQixZQUFELEVBQWV2QyxRQUFRLENBQUM4QixtQkFBVCxDQUE2QkMsU0FBNUMsRUFBdUQsZUFBdkQsRUFBd0UsS0FBeEUsQ0FBaEM7QUFDQSxVQUFNWCwwQkFBMEIsQ0FBQ21CLFlBQUQsRUFBZXZDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE1QyxFQUE2RCxlQUE3RCxFQUE4RSxJQUE5RSxDQUFoQztBQUNBLFFBQUlnQixRQUFRLEdBQUcsTUFBTWpELFFBQVEsQ0FBQzBCLFNBQVQsQ0FBbUJ3QixnQkFBbkIsQ0FBb0NGLFVBQXBDLENBQXJCO0FBQ0EsUUFBSUcsR0FBRyxHQUFHbEQsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ1MsV0FBaEMsQ0FBNENJLFFBQVEsQ0FBQ0csR0FBckQsQ0FBVjtBQUNBdkQsSUFBQUEsTUFBTSxDQUFDaUQsS0FBUCxDQUFhSyxHQUFHLENBQUNFLE9BQUosQ0FBWUMsYUFBekIsRUFBd0MsSUFBeEMsRUFBOEMsdUNBQTlDO0FBQ0FyRCxJQUFBQSxnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDQyxPQUFoQztBQUNBLFVBQU1qQiwwQkFBMEIsQ0FBQ21CLFlBQUQsRUFBZXZDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCQyxTQUE1QyxFQUF1RCxlQUF2RCxFQUF3RSxJQUF4RSxDQUFoQztBQUNBLFVBQU1YLDBCQUEwQixDQUFDbUIsWUFBRCxFQUFldkMsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJHLGVBQTVDLEVBQTZELGVBQTdELEVBQThFLEtBQTlFLENBQWhDO0FBQ0FnQixJQUFBQSxRQUFRLEdBQUcsTUFBTWpELFFBQVEsQ0FBQzBCLFNBQVQsQ0FBbUJ3QixnQkFBbkIsQ0FBb0NGLFVBQXBDLENBQWpCO0FBQ0FHLElBQUFBLEdBQUcsR0FBR2xELGdCQUFnQixDQUFDbUMsY0FBakIsQ0FBZ0NTLFdBQWhDLENBQTRDSSxRQUFRLENBQUNHLEdBQXJELENBQU47QUFDQXZELElBQUFBLE1BQU0sQ0FBQ2lELEtBQVAsQ0FBYUssR0FBRyxDQUFDRSxPQUFKLENBQVlDLGFBQXpCLEVBQXdDLEtBQXhDLEVBQStDLDJDQUEvQztBQUNILEdBZHVILENBQXBILENBQUo7QUFlQWhCLEVBQUFBLElBQUksQ0FBQyxrR0FBRCxFQUFxRyxNQUFNOUQsU0FBUyxTQUFPLEtBQUssQ0FBWixFQUFlLEtBQUssQ0FBcEIsRUFBdUIsYUFBYTtBQUN4SixVQUFNK0QsWUFBWSxHQUFHdkMsUUFBUSxDQUFDWSxHQUFULENBQWFDLElBQWIsQ0FBa0JkLElBQUksQ0FBQ00sSUFBTCxDQUFVRCxhQUFWLEVBQXlCLFlBQXpCLENBQWxCLENBQXJCO0FBQ0EsVUFBTTRDLFVBQVUsR0FBR2pELElBQUksQ0FBQ00sSUFBTCxDQUFVRCxhQUFWLEVBQXlCLFlBQXpCLEVBQXVDLFNBQXZDLENBQW5CO0FBQ0EsVUFBTWdCLDBCQUEwQixDQUFDbUIsWUFBRCxFQUFldkMsUUFBUSxDQUFDOEIsbUJBQVQsQ0FBNkJDLFNBQTVDLEVBQXVELGVBQXZELEVBQXdFLEtBQXhFLENBQWhDO0FBQ0EsVUFBTVgsMEJBQTBCLENBQUNtQixZQUFELEVBQWV2QyxRQUFRLENBQUM4QixtQkFBVCxDQUE2QkcsZUFBNUMsRUFBNkQsZUFBN0QsRUFBOEUsSUFBOUUsQ0FBaEM7QUFDQSxRQUFJZ0IsUUFBUSxHQUFHLE1BQU1qRCxRQUFRLENBQUMwQixTQUFULENBQW1Cd0IsZ0JBQW5CLENBQW9DRixVQUFwQyxDQUFyQjtBQUNBLFFBQUlHLEdBQUcsR0FBR2xELGdCQUFnQixDQUFDbUMsY0FBakIsQ0FBZ0NTLFdBQWhDLENBQTRDSSxRQUFRLENBQUNHLEdBQXJELENBQVY7QUFDQXZELElBQUFBLE1BQU0sQ0FBQ2lELEtBQVAsQ0FBYUssR0FBRyxDQUFDRSxPQUFKLENBQVlDLGFBQXpCLEVBQXdDLElBQXhDLEVBQThDLHVDQUE5QztBQUNBckQsSUFBQUEsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ0MsT0FBaEM7QUFDQSxVQUFNakIsMEJBQTBCLENBQUNtQixZQUFELEVBQWV2QyxRQUFRLENBQUM4QixtQkFBVCxDQUE2QkMsU0FBNUMsRUFBdUQsZUFBdkQsRUFBd0UsSUFBeEUsQ0FBaEM7QUFDQSxVQUFNWCwwQkFBMEIsQ0FBQ21CLFlBQUQsRUFBZXZDLFFBQVEsQ0FBQzhCLG1CQUFULENBQTZCRyxlQUE1QyxFQUE2RCxlQUE3RCxFQUE4RSxLQUE5RSxDQUFoQztBQUNBZ0IsSUFBQUEsUUFBUSxHQUFHLE1BQU1qRCxRQUFRLENBQUMwQixTQUFULENBQW1Cd0IsZ0JBQW5CLENBQW9DRixVQUFwQyxDQUFqQjtBQUNBRyxJQUFBQSxHQUFHLEdBQUdsRCxnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDUyxXQUFoQyxDQUE0Q0ksUUFBUSxDQUFDRyxHQUFyRCxDQUFOO0FBQ0F2RCxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWFLLEdBQUcsQ0FBQ0UsT0FBSixDQUFZQyxhQUF6QixFQUF3QyxLQUF4QyxFQUErQywyQ0FBL0M7QUFDSCxHQWR1SCxDQUFwSCxDQUFKLENBdEhxQyxDQXFJckM7O0FBQ0FoQixFQUFBQSxJQUFJLENBQUMsaUZBQUQsRUFBb0YsTUFBTTlELFNBQVMsU0FBTyxLQUFLLENBQVosRUFBZSxLQUFLLENBQXBCLEVBQXVCLGFBQWE7QUFDdkksVUFBTStFLGFBQWEsR0FBR3ZELFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUF0QjtBQUNBLFFBQUk0QyxVQUFVLEdBQUdqRCxJQUFJLENBQUNNLElBQUwsQ0FBVWtELGFBQWEsQ0FBQ0MsTUFBeEIsRUFBZ0MsU0FBaEMsQ0FBakI7QUFDQSxRQUFJUCxRQUFRLEdBQUcsTUFBTWpELFFBQVEsQ0FBQzBCLFNBQVQsQ0FBbUJ3QixnQkFBbkIsQ0FBb0NGLFVBQXBDLENBQXJCO0FBQ0EsUUFBSUcsR0FBRyxHQUFHbEQsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ1MsV0FBaEMsQ0FBNENJLFFBQVEsQ0FBQ0csR0FBckQsQ0FBVjtBQUNBdkQsSUFBQUEsTUFBTSxDQUFDaUQsS0FBUCxDQUFhL0MsSUFBSSxDQUFDMEQsT0FBTCxDQUFhTixHQUFHLENBQUNPLGdCQUFKLENBQXFCQyxXQUFsQyxDQUFiLEVBQTZESixhQUFhLENBQUNDLE1BQTNFLEVBQW1GLDZDQUFuRjtBQUNBM0QsSUFBQUEsTUFBTSxDQUFDaUQsS0FBUCxDQUFhL0MsSUFBSSxDQUFDNkQsUUFBTCxDQUFjVCxHQUFHLENBQUNPLGdCQUFKLENBQXFCQyxXQUFuQyxDQUFiLEVBQThELHNCQUE5RCxFQUFzRiw2Q0FBdEY7QUFDQTFELElBQUFBLGdCQUFnQixDQUFDbUMsY0FBakIsQ0FBZ0NDLE9BQWhDO0FBQ0EsVUFBTXdCLGFBQWEsR0FBRzdELFFBQVEsQ0FBQ1ksR0FBVCxDQUFhQyxJQUFiLENBQWtCZCxJQUFJLENBQUNNLElBQUwsQ0FBVUQsYUFBVixFQUF5QixZQUF6QixDQUFsQixDQUF0QjtBQUNBNEMsSUFBQUEsVUFBVSxHQUFHakQsSUFBSSxDQUFDTSxJQUFMLENBQVV3RCxhQUFhLENBQUNMLE1BQXhCLEVBQWdDLFNBQWhDLENBQWI7QUFDQVAsSUFBQUEsUUFBUSxHQUFHLE1BQU1qRCxRQUFRLENBQUMwQixTQUFULENBQW1Cd0IsZ0JBQW5CLENBQW9DRixVQUFwQyxDQUFqQjtBQUNBRyxJQUFBQSxHQUFHLEdBQUdsRCxnQkFBZ0IsQ0FBQ21DLGNBQWpCLENBQWdDUyxXQUFoQyxDQUE0Q0ksUUFBUSxDQUFDRyxHQUFyRCxDQUFOO0FBQ0F2RCxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWEvQyxJQUFJLENBQUMwRCxPQUFMLENBQWFOLEdBQUcsQ0FBQ08sZ0JBQUosQ0FBcUJDLFdBQWxDLENBQWIsRUFBNkRFLGFBQWEsQ0FBQ0wsTUFBM0UsRUFBbUYsNkNBQW5GO0FBQ0EzRCxJQUFBQSxNQUFNLENBQUNpRCxLQUFQLENBQWEvQyxJQUFJLENBQUM2RCxRQUFMLENBQWNULEdBQUcsQ0FBQ08sZ0JBQUosQ0FBcUJDLFdBQW5DLENBQWIsRUFBOEQsc0JBQTlELEVBQXNGLDZDQUF0RjtBQUNBMUQsSUFBQUEsZ0JBQWdCLENBQUNtQyxjQUFqQixDQUFnQ0MsT0FBaEM7QUFDSCxHQWZzRyxDQUFuRyxDQUFKO0FBZ0JILENBdEpJLENBQUwiLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBhc3NlcnQgPSByZXF1aXJlKFwiYXNzZXJ0XCIpO1xyXG5jb25zdCBwYXRoID0gcmVxdWlyZShcInBhdGhcIik7XHJcbmNvbnN0IHZzY29kZV8xID0gcmVxdWlyZShcInZzY29kZVwiKTtcclxuY29uc3QgY29uZmlnU2V0dGluZ3NfMSA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvY29tbW9uL2NvbmZpZ1NldHRpbmdzXCIpO1xyXG5jb25zdCBjb21tb25fMSA9IHJlcXVpcmUoXCIuLi9jb21tb25cIik7XHJcbmNvbnN0IGluaXRpYWxpemVfMSA9IHJlcXVpcmUoXCIuLi9pbml0aWFsaXplXCIpO1xyXG5jb25zdCBtdWx0aXJvb3RQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJy4uJywgJy4uJywgJ3NyYycsICd0ZXN0TXVsdGlSb290V2tzcGMnKTtcclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1mdW5jLWJvZHktbGVuZ3RoXHJcbnN1aXRlKCdNdWx0aXJvb3QgQ29uZmlnIFNldHRpbmdzJywgKCkgPT4ge1xyXG4gICAgc3VpdGVTZXR1cChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgaWYgKCFpbml0aWFsaXplXzEuSVNfTVVMVElfUk9PVF9URVNUKSB7XHJcbiAgICAgICAgICAgICAgICAvLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bm8taW52YWxpZC10aGlzXHJcbiAgICAgICAgICAgICAgICB0aGlzLnNraXAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB5aWVsZCBjb21tb25fMS5jbGVhclB5dGhvblBhdGhJbldvcmtzcGFjZUZvbGRlcih2c2NvZGVfMS5VcmkuZmlsZShwYXRoLmpvaW4obXVsdGlyb290UGF0aCwgJ3dvcmtzcGFjZTEnKSkpO1xyXG4gICAgICAgICAgICB5aWVsZCBpbml0aWFsaXplXzEuaW5pdGlhbGl6ZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgICBzZXR1cChpbml0aWFsaXplXzEuaW5pdGlhbGl6ZVRlc3QpO1xyXG4gICAgc3VpdGVUZWFyZG93bihpbml0aWFsaXplXzEuY2xvc2VBY3RpdmVXaW5kb3dzKTtcclxuICAgIHRlYXJkb3duKCgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICB5aWVsZCBpbml0aWFsaXplXzEuY2xvc2VBY3RpdmVXaW5kb3dzKCk7XHJcbiAgICAgICAgeWllbGQgY29tbW9uXzEuY2xlYXJQeXRob25QYXRoSW5Xb3Jrc3BhY2VGb2xkZXIodnNjb2RlXzEuVXJpLmZpbGUocGF0aC5qb2luKG11bHRpcm9vdFBhdGgsICd3b3Jrc3BhY2UxJykpKTtcclxuICAgICAgICB5aWVsZCBpbml0aWFsaXplXzEuaW5pdGlhbGl6ZVRlc3QoKTtcclxuICAgIH0pKTtcclxuICAgIGZ1bmN0aW9uIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHJlc291cmNlLCBjb25maWdUYXJnZXQsIHNldHRpbmcsIGVuYWJsZWQpIHtcclxuICAgICAgICByZXR1cm4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHZzY29kZV8xLndvcmtzcGFjZS5nZXRDb25maWd1cmF0aW9uKCdweXRob24ubGludGluZycsIHJlc291cmNlKTtcclxuICAgICAgICAgICAgY29uc3QgY2ZnVmFsdWUgPSBzZXR0aW5ncy5pbnNwZWN0KHNldHRpbmcpO1xyXG4gICAgICAgICAgICBpZiAoY29uZmlnVGFyZ2V0ID09PSB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZSAmJiBjZmdWYWx1ZSAmJiBjZmdWYWx1ZS53b3Jrc3BhY2VWYWx1ZSA9PT0gZW5hYmxlZCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmIChjb25maWdUYXJnZXQgPT09IHZzY29kZV8xLkNvbmZpZ3VyYXRpb25UYXJnZXQuV29ya3NwYWNlRm9sZGVyICYmIGNmZ1ZhbHVlICYmIGNmZ1ZhbHVlLndvcmtzcGFjZUZvbGRlclZhbHVlID09PSBlbmFibGVkKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgeWllbGQgc2V0dGluZ3MudXBkYXRlKHNldHRpbmcsIGVuYWJsZWQsIGNvbmZpZ1RhcmdldCk7XHJcbiAgICAgICAgICAgIGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZGlzcG9zZSgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgdGVzdCgnV29ya3NwYWNlIGZvbGRlciBzaG91bGQgaW5oZXJpdCBQeXRob24gUGF0aCBmcm9tIHdvcmtzcGFjZSByb290JywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHdvcmtzcGFjZVVyaSA9IHZzY29kZV8xLlVyaS5maWxlKHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMScpKTtcclxuICAgICAgICBsZXQgc2V0dGluZ3MgPSB2c2NvZGVfMS53b3Jrc3BhY2UuZ2V0Q29uZmlndXJhdGlvbigncHl0aG9uJywgd29ya3NwYWNlVXJpKTtcclxuICAgICAgICBjb25zdCBweXRob25QYXRoID0gYHgke25ldyBEYXRlKCkuZ2V0VGltZSgpfWA7XHJcbiAgICAgICAgeWllbGQgc2V0dGluZ3MudXBkYXRlKCdweXRob25QYXRoJywgcHl0aG9uUGF0aCwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2UpO1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gc2V0dGluZ3MuaW5zcGVjdCgncHl0aG9uUGF0aCcpO1xyXG4gICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUud29ya3NwYWNlRm9sZGVyVmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgICAgICAgIHlpZWxkIHNldHRpbmdzLnVwZGF0ZSgncHl0aG9uUGF0aCcsIHVuZGVmaW5lZCwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2VGb2xkZXIpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBzZXR0aW5ncyA9IHZzY29kZV8xLndvcmtzcGFjZS5nZXRDb25maWd1cmF0aW9uKCdweXRob24nLCB3b3Jrc3BhY2VVcmkpO1xyXG4gICAgICAgIGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZGlzcG9zZSgpO1xyXG4gICAgICAgIGNvbnN0IGNmZ1NldHRpbmcgPSBjb25maWdTZXR0aW5nc18xLlB5dGhvblNldHRpbmdzLmdldEluc3RhbmNlKHdvcmtzcGFjZVVyaSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNmZ1NldHRpbmcucHl0aG9uUGF0aCwgcHl0aG9uUGF0aCwgJ1B5dGhvbiBQYXRoIG5vdCBpbmhlcml0ZWQgZnJvbSB3b3Jrc3BhY2UnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ1dvcmtzcGFjZSBmb2xkZXIgc2hvdWxkIG5vdCBpbmhlcml0IFB5dGhvbiBQYXRoIGZyb20gd29ya3NwYWNlIHJvb3QnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlVXJpID0gdnNjb2RlXzEuVXJpLmZpbGUocGF0aC5qb2luKG11bHRpcm9vdFBhdGgsICd3b3Jrc3BhY2UxJykpO1xyXG4gICAgICAgIGNvbnN0IHNldHRpbmdzID0gdnNjb2RlXzEud29ya3NwYWNlLmdldENvbmZpZ3VyYXRpb24oJ3B5dGhvbicsIHdvcmtzcGFjZVVyaSk7XHJcbiAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IGB4JHtuZXcgRGF0ZSgpLmdldFRpbWUoKX1gO1xyXG4gICAgICAgIHlpZWxkIHNldHRpbmdzLnVwZGF0ZSgncHl0aG9uUGF0aCcsIHB5dGhvblBhdGgsIHZzY29kZV8xLkNvbmZpZ3VyYXRpb25UYXJnZXQuV29ya3NwYWNlKTtcclxuICAgICAgICBjb25zdCBwcml2YXRlUHl0aG9uUGF0aCA9IGB4JHtuZXcgRGF0ZSgpLmdldFRpbWUoKX1gO1xyXG4gICAgICAgIHlpZWxkIHNldHRpbmdzLnVwZGF0ZSgncHl0aG9uUGF0aCcsIHByaXZhdGVQeXRob25QYXRoLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZUZvbGRlcik7XHJcbiAgICAgICAgY29uc3QgY2ZnU2V0dGluZyA9IGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZ2V0SW5zdGFuY2Uod29ya3NwYWNlVXJpKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoY2ZnU2V0dGluZy5weXRob25QYXRoLCBwcml2YXRlUHl0aG9uUGF0aCwgJ1B5dGhvbiBQYXRoIGZvciB3b3Jrc3BhY2UgZm9sZGVyIGlzIGluY29ycmVjdCcpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnV29ya3NwYWNlIGZvbGRlciBzaG91bGQgaW5oZXJpdCBQeXRob24gUGF0aCBmcm9tIHdvcmtzcGFjZSByb290IHdoZW4gb3BlbmluZyBhIGRvY3VtZW50JywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHdvcmtzcGFjZVVyaSA9IHZzY29kZV8xLlVyaS5maWxlKHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMScpKTtcclxuICAgICAgICBjb25zdCBmaWxlVG9PcGVuID0gcGF0aC5qb2luKG11bHRpcm9vdFBhdGgsICd3b3Jrc3BhY2UxJywgJ2ZpbGUucHknKTtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHZzY29kZV8xLndvcmtzcGFjZS5nZXRDb25maWd1cmF0aW9uKCdweXRob24nLCB3b3Jrc3BhY2VVcmkpO1xyXG4gICAgICAgIGNvbnN0IHB5dGhvblBhdGggPSBgeCR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YDtcclxuICAgICAgICB5aWVsZCBzZXR0aW5ncy51cGRhdGUoJ3B5dGhvblBhdGgnLCBweXRob25QYXRoLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZSk7XHJcbiAgICAgICAgLy8gVXBkYXRlIHdvcmtzcGFjZSBmb2xkZXIgdG8gc29tZXRoaW5nIGVsc2Ugc28gaXQgZ2V0cyByZWZyZXNoZWQuXHJcbiAgICAgICAgeWllbGQgc2V0dGluZ3MudXBkYXRlKCdweXRob25QYXRoJywgYHgke25ldyBEYXRlKCkuZ2V0VGltZSgpfWAsIHZzY29kZV8xLkNvbmZpZ3VyYXRpb25UYXJnZXQuV29ya3NwYWNlRm9sZGVyKTtcclxuICAgICAgICB5aWVsZCBzZXR0aW5ncy51cGRhdGUoJ3B5dGhvblBhdGgnLCB1bmRlZmluZWQsIHZzY29kZV8xLkNvbmZpZ3VyYXRpb25UYXJnZXQuV29ya3NwYWNlRm9sZGVyKTtcclxuICAgICAgICBjb25zdCBkb2N1bWVudCA9IHlpZWxkIHZzY29kZV8xLndvcmtzcGFjZS5vcGVuVGV4dERvY3VtZW50KGZpbGVUb09wZW4pO1xyXG4gICAgICAgIGNvbnN0IGNmZyA9IGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZ2V0SW5zdGFuY2UoZG9jdW1lbnQudXJpKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoY2ZnLnB5dGhvblBhdGgsIHB5dGhvblBhdGgsICdQeXRob24gUGF0aCBub3QgaW5oZXJpdGVkIGZyb20gd29ya3NwYWNlJyk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdXb3Jrc3BhY2UgZm9sZGVyIHNob3VsZCBub3QgaW5oZXJpdCBQeXRob24gUGF0aCBmcm9tIHdvcmtzcGFjZSByb290IHdoZW4gb3BlbmluZyBhIGRvY3VtZW50JywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHdvcmtzcGFjZVVyaSA9IHZzY29kZV8xLlVyaS5maWxlKHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMScpKTtcclxuICAgICAgICBjb25zdCBmaWxlVG9PcGVuID0gcGF0aC5qb2luKG11bHRpcm9vdFBhdGgsICd3b3Jrc3BhY2UxJywgJ2ZpbGUucHknKTtcclxuICAgICAgICBjb25zdCBzZXR0aW5ncyA9IHZzY29kZV8xLndvcmtzcGFjZS5nZXRDb25maWd1cmF0aW9uKCdweXRob24nLCB3b3Jrc3BhY2VVcmkpO1xyXG4gICAgICAgIGNvbnN0IHB5dGhvblBhdGggPSBgeCR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YDtcclxuICAgICAgICB5aWVsZCBzZXR0aW5ncy51cGRhdGUoJ3B5dGhvblBhdGgnLCBweXRob25QYXRoLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZSk7XHJcbiAgICAgICAgY29uc3QgcHJpdmF0ZVB5dGhvblBhdGggPSBgeCR7bmV3IERhdGUoKS5nZXRUaW1lKCl9YDtcclxuICAgICAgICB5aWVsZCBzZXR0aW5ncy51cGRhdGUoJ3B5dGhvblBhdGgnLCBwcml2YXRlUHl0aG9uUGF0aCwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2VGb2xkZXIpO1xyXG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0geWllbGQgdnNjb2RlXzEud29ya3NwYWNlLm9wZW5UZXh0RG9jdW1lbnQoZmlsZVRvT3Blbik7XHJcbiAgICAgICAgY29uc3QgY2ZnID0gY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChjZmcucHl0aG9uUGF0aCwgcHJpdmF0ZVB5dGhvblBhdGgsICdQeXRob24gUGF0aCBmb3Igd29ya3NwYWNlIGZvbGRlciBpcyBpbmNvcnJlY3QnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0VuYWJsaW5nL0Rpc2FibGluZyBQeWxpbnQgaW4gcm9vdCBzaG91bGQgYmUgcmVmbGVjdGVkIGluIGNvbmZpZyBzZXR0aW5ncycsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB3b3Jrc3BhY2VVcmkgPSB2c2NvZGVfMS5VcmkuZmlsZShwYXRoLmpvaW4obXVsdGlyb290UGF0aCwgJ3dvcmtzcGFjZTEnKSk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZUZvbGRlciwgJ3B5bGludEVuYWJsZWQnLCB1bmRlZmluZWQpO1xyXG4gICAgICAgIHlpZWxkIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHdvcmtzcGFjZVVyaSwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2UsICdweWxpbnRFbmFibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgbGV0IHNldHRpbmdzID0gY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZSh3b3Jrc3BhY2VVcmkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChzZXR0aW5ncy5saW50aW5nLnB5bGludEVuYWJsZWQsIHRydWUsICdQeWxpbnQgbm90IGVuYWJsZWQgd2hlbiBpdCBzaG91bGQgYmUnKTtcclxuICAgICAgICB5aWVsZCBlbmFibGVEaXNhYmxlTGludGVyU2V0dGluZyh3b3Jrc3BhY2VVcmksIHZzY29kZV8xLkNvbmZpZ3VyYXRpb25UYXJnZXQuV29ya3NwYWNlLCAncHlsaW50RW5hYmxlZCcsIGZhbHNlKTtcclxuICAgICAgICBzZXR0aW5ncyA9IGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZ2V0SW5zdGFuY2Uod29ya3NwYWNlVXJpKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoc2V0dGluZ3MubGludGluZy5weWxpbnRFbmFibGVkLCBmYWxzZSwgJ1B5bGludCBlbmFibGVkIHdoZW4gaXQgc2hvdWxkIG5vdCBiZScpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5hYmxpbmcvRGlzYWJsaW5nIFB5bGludCBpbiByb290IGFuZCB3b3Jrc3BhY2Ugc2hvdWxkIGJlIHJlZmxlY3RlZCBpbiBjb25maWcgc2V0dGluZ3MnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlVXJpID0gdnNjb2RlXzEuVXJpLmZpbGUocGF0aC5qb2luKG11bHRpcm9vdFBhdGgsICd3b3Jrc3BhY2UxJykpO1xyXG4gICAgICAgIHlpZWxkIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHdvcmtzcGFjZVVyaSwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2VGb2xkZXIsICdweWxpbnRFbmFibGVkJywgZmFsc2UpO1xyXG4gICAgICAgIHlpZWxkIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHdvcmtzcGFjZVVyaSwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2UsICdweWxpbnRFbmFibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgbGV0IGNmZ1NldHRpbmcgPSBjb25maWdTZXR0aW5nc18xLlB5dGhvblNldHRpbmdzLmdldEluc3RhbmNlKHdvcmtzcGFjZVVyaSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNmZ1NldHRpbmcubGludGluZy5weWxpbnRFbmFibGVkLCBmYWxzZSwgJ1dvcmtzcGFjZSBmb2xkZXIgcHlsaW50IHNldHRpbmcgaXMgdHJ1ZSB3aGVuIGl0IHNob3VsZCBub3QgYmUnKTtcclxuICAgICAgICBjb25maWdTZXR0aW5nc18xLlB5dGhvblNldHRpbmdzLmRpc3Bvc2UoKTtcclxuICAgICAgICB5aWVsZCBlbmFibGVEaXNhYmxlTGludGVyU2V0dGluZyh3b3Jrc3BhY2VVcmksIHZzY29kZV8xLkNvbmZpZ3VyYXRpb25UYXJnZXQuV29ya3NwYWNlRm9sZGVyLCAncHlsaW50RW5hYmxlZCcsIHRydWUpO1xyXG4gICAgICAgIHlpZWxkIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHdvcmtzcGFjZVVyaSwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2UsICdweWxpbnRFbmFibGVkJywgZmFsc2UpO1xyXG4gICAgICAgIGNmZ1NldHRpbmcgPSBjb25maWdTZXR0aW5nc18xLlB5dGhvblNldHRpbmdzLmdldEluc3RhbmNlKHdvcmtzcGFjZVVyaSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNmZ1NldHRpbmcubGludGluZy5weWxpbnRFbmFibGVkLCB0cnVlLCAnV29ya3NwYWNlIGZvbGRlciBweWxpbnQgc2V0dGluZyBpcyBmYWxzZSB3aGVuIGl0IHNob3VsZCBub3QgYmUnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0VuYWJsaW5nL0Rpc2FibGluZyBQeWxpbnQgaW4gcm9vdCBzaG91bGQgYmUgcmVmbGVjdGVkIGluIGNvbmZpZyBzZXR0aW5ncyB3aGVuIG9wZW5pbmcgYSBkb2N1bWVudCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB3b3Jrc3BhY2VVcmkgPSB2c2NvZGVfMS5VcmkuZmlsZShwYXRoLmpvaW4obXVsdGlyb290UGF0aCwgJ3dvcmtzcGFjZTEnKSk7XHJcbiAgICAgICAgY29uc3QgZmlsZVRvT3BlbiA9IHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMScsICdmaWxlLnB5Jyk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZSwgJ3B5bGludEVuYWJsZWQnLCBmYWxzZSk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZUZvbGRlciwgJ3B5bGludEVuYWJsZWQnLCB0cnVlKTtcclxuICAgICAgICBsZXQgZG9jdW1lbnQgPSB5aWVsZCB2c2NvZGVfMS53b3Jrc3BhY2Uub3BlblRleHREb2N1bWVudChmaWxlVG9PcGVuKTtcclxuICAgICAgICBsZXQgY2ZnID0gY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChjZmcubGludGluZy5weWxpbnRFbmFibGVkLCB0cnVlLCAnUHlsaW50IHNob3VsZCBiZSBlbmFibGVkIGluIHdvcmtzcGFjZScpO1xyXG4gICAgICAgIGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZGlzcG9zZSgpO1xyXG4gICAgICAgIHlpZWxkIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHdvcmtzcGFjZVVyaSwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2UsICdweWxpbnRFbmFibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZUZvbGRlciwgJ3B5bGludEVuYWJsZWQnLCBmYWxzZSk7XHJcbiAgICAgICAgZG9jdW1lbnQgPSB5aWVsZCB2c2NvZGVfMS53b3Jrc3BhY2Uub3BlblRleHREb2N1bWVudChmaWxlVG9PcGVuKTtcclxuICAgICAgICBjZmcgPSBjb25maWdTZXR0aW5nc18xLlB5dGhvblNldHRpbmdzLmdldEluc3RhbmNlKGRvY3VtZW50LnVyaSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNmZy5saW50aW5nLnB5bGludEVuYWJsZWQsIGZhbHNlLCAnUHlsaW50IHNob3VsZCBub3QgYmUgZW5hYmxlZCBpbiB3b3Jrc3BhY2UnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0VuYWJsaW5nL0Rpc2FibGluZyBQeWxpbnQgaW4gcm9vdCBzaG91bGQgYmUgcmVmbGVjdGVkIGluIGNvbmZpZyBzZXR0aW5ncyB3aGVuIG9wZW5pbmcgYSBkb2N1bWVudCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCB3b3Jrc3BhY2VVcmkgPSB2c2NvZGVfMS5VcmkuZmlsZShwYXRoLmpvaW4obXVsdGlyb290UGF0aCwgJ3dvcmtzcGFjZTEnKSk7XHJcbiAgICAgICAgY29uc3QgZmlsZVRvT3BlbiA9IHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMScsICdmaWxlLnB5Jyk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZSwgJ3B5bGludEVuYWJsZWQnLCBmYWxzZSk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZUZvbGRlciwgJ3B5bGludEVuYWJsZWQnLCB0cnVlKTtcclxuICAgICAgICBsZXQgZG9jdW1lbnQgPSB5aWVsZCB2c2NvZGVfMS53b3Jrc3BhY2Uub3BlblRleHREb2N1bWVudChmaWxlVG9PcGVuKTtcclxuICAgICAgICBsZXQgY2ZnID0gY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChjZmcubGludGluZy5weWxpbnRFbmFibGVkLCB0cnVlLCAnUHlsaW50IHNob3VsZCBiZSBlbmFibGVkIGluIHdvcmtzcGFjZScpO1xyXG4gICAgICAgIGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZGlzcG9zZSgpO1xyXG4gICAgICAgIHlpZWxkIGVuYWJsZURpc2FibGVMaW50ZXJTZXR0aW5nKHdvcmtzcGFjZVVyaSwgdnNjb2RlXzEuQ29uZmlndXJhdGlvblRhcmdldC5Xb3Jrc3BhY2UsICdweWxpbnRFbmFibGVkJywgdHJ1ZSk7XHJcbiAgICAgICAgeWllbGQgZW5hYmxlRGlzYWJsZUxpbnRlclNldHRpbmcod29ya3NwYWNlVXJpLCB2c2NvZGVfMS5Db25maWd1cmF0aW9uVGFyZ2V0LldvcmtzcGFjZUZvbGRlciwgJ3B5bGludEVuYWJsZWQnLCBmYWxzZSk7XHJcbiAgICAgICAgZG9jdW1lbnQgPSB5aWVsZCB2c2NvZGVfMS53b3Jrc3BhY2Uub3BlblRleHREb2N1bWVudChmaWxlVG9PcGVuKTtcclxuICAgICAgICBjZmcgPSBjb25maWdTZXR0aW5nc18xLlB5dGhvblNldHRpbmdzLmdldEluc3RhbmNlKGRvY3VtZW50LnVyaSk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNmZy5saW50aW5nLnB5bGludEVuYWJsZWQsIGZhbHNlLCAnUHlsaW50IHNob3VsZCBub3QgYmUgZW5hYmxlZCBpbiB3b3Jrc3BhY2UnKTtcclxuICAgIH0pKTtcclxuICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby1pbnZhbGlkLXRlbXBsYXRlLXN0cmluZ3NcclxuICAgIHRlc3QoJyR7d29ya3NwYWNlRm9sZGVyfSB2YXJpYWJsZSBpbiBzZXR0aW5ncyBzaG91bGQgYmUgcmVwbGFjZWQgd2l0aCB0aGUgcmlnaHQgdmFsdWUnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlMlVyaSA9IHZzY29kZV8xLlVyaS5maWxlKHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMicpKTtcclxuICAgICAgICBsZXQgZmlsZVRvT3BlbiA9IHBhdGguam9pbih3b3Jrc3BhY2UyVXJpLmZzUGF0aCwgJ2ZpbGUucHknKTtcclxuICAgICAgICBsZXQgZG9jdW1lbnQgPSB5aWVsZCB2c2NvZGVfMS53b3Jrc3BhY2Uub3BlblRleHREb2N1bWVudChmaWxlVG9PcGVuKTtcclxuICAgICAgICBsZXQgY2ZnID0gY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChwYXRoLmRpcm5hbWUoY2ZnLndvcmtzcGFjZVN5bWJvbHMudGFnRmlsZVBhdGgpLCB3b3Jrc3BhY2UyVXJpLmZzUGF0aCwgJ2N0YWdzIGZpbGUgcGF0aCBmb3Igd29ya3NwYWNlMiBpcyBpbmNvcnJlY3QnKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwocGF0aC5iYXNlbmFtZShjZmcud29ya3NwYWNlU3ltYm9scy50YWdGaWxlUGF0aCksICd3b3Jrc3BhY2UyLnRhZ3MuZmlsZScsICdjdGFncyBmaWxlIG5hbWUgZm9yIHdvcmtzcGFjZTIgaXMgaW5jb3JyZWN0Jyk7XHJcbiAgICAgICAgY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5kaXNwb3NlKCk7XHJcbiAgICAgICAgY29uc3Qgd29ya3NwYWNlM1VyaSA9IHZzY29kZV8xLlVyaS5maWxlKHBhdGguam9pbihtdWx0aXJvb3RQYXRoLCAnd29ya3NwYWNlMycpKTtcclxuICAgICAgICBmaWxlVG9PcGVuID0gcGF0aC5qb2luKHdvcmtzcGFjZTNVcmkuZnNQYXRoLCAnZmlsZS5weScpO1xyXG4gICAgICAgIGRvY3VtZW50ID0geWllbGQgdnNjb2RlXzEud29ya3NwYWNlLm9wZW5UZXh0RG9jdW1lbnQoZmlsZVRvT3Blbik7XHJcbiAgICAgICAgY2ZnID0gY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpO1xyXG4gICAgICAgIGFzc2VydC5lcXVhbChwYXRoLmRpcm5hbWUoY2ZnLndvcmtzcGFjZVN5bWJvbHMudGFnRmlsZVBhdGgpLCB3b3Jrc3BhY2UzVXJpLmZzUGF0aCwgJ2N0YWdzIGZpbGUgcGF0aCBmb3Igd29ya3NwYWNlMyBpcyBpbmNvcnJlY3QnKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwocGF0aC5iYXNlbmFtZShjZmcud29ya3NwYWNlU3ltYm9scy50YWdGaWxlUGF0aCksICd3b3Jrc3BhY2UzLnRhZ3MuZmlsZScsICdjdGFncyBmaWxlIG5hbWUgZm9yIHdvcmtzcGFjZTMgaXMgaW5jb3JyZWN0Jyk7XHJcbiAgICAgICAgY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5kaXNwb3NlKCk7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1jb25maWdTZXR0aW5ncy5tdWx0aXJvb3QudGVzdC5qcy5tYXAiXX0=