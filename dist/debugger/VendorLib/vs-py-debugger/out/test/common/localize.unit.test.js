// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

const assert = require("assert");

const fs = require("fs");

const path = require("path");

const constants_1 = require("../../client/common/constants");

const localize = require("../../client/common/utils/localize"); // Defines a Mocha test suite to group tests of similar kind together


suite('localize tests', () => {
  test('keys', done => {
    const val = localize.LanguageServiceSurveyBanner.bannerMessage();
    assert.equal(val, 'Can you please take 2 minutes to tell us how the Python Language Server is working for you?', 'LanguageServiceSurveyBanner string doesnt match');
    done();
  });
  test('keys italian', done => {
    // Force a config change
    process.env.VSCODE_NLS_CONFIG = '{ "locale": "it" }';
    const val = localize.LanguageServiceSurveyBanner.bannerLabelYes();
    assert.equal(val, 'Sì, prenderò il sondaggio ora', 'bannerLabelYes is not being translated');
    done();
  });
  test('keys exist', done => {
    // Read all of the namespaces from the localize import
    const entries = Object.keys(localize); // Read in the JSON object for the package.nls.json

    let nlsCollection = {};
    const defaultNlsFile = path.join(constants_1.EXTENSION_ROOT_DIR, 'package.nls.json');

    if (fs.existsSync(defaultNlsFile)) {
      const contents = fs.readFileSync(defaultNlsFile, 'utf8');
      nlsCollection = JSON.parse(contents);
    } else {
      nlsCollection = {};
    } // Now match all of our namespace entries to our nls entries


    entries.forEach(e => {
      if (typeof localize[e] !== 'function') {
        // This must be a namespace. It should have functions inside of it
        const namespace = localize[e];
        const funcs = Object.keys(namespace); // Run every function, this should fill up our asked for keys collection

        funcs.forEach(f => {
          const func = namespace[f];
          func();
        });
      }
    }); // Now verify all of the asked for keys exist

    const askedFor = localize.getAskedForCollection();
    const missing = {};
    Object.keys(askedFor).forEach(key => {
      // Now check that this key exists somewhere in the nls collection
      if (!nlsCollection[key]) {
        missing[key] = askedFor[key];
      }
    }); // If any missing keys, output an error

    const missingKeys = Object.keys(missing);

    if (missingKeys && missingKeys.length > 0) {
      let message = 'Missing keys. Add the following to package.nls.json:\n';
      missingKeys.forEach(k => {
        message = message.concat(`\t"${k}" : "${missing[k]}",\n`);
      });
      assert.fail(message);
    }

    done();
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImxvY2FsaXplLnVuaXQudGVzdC5qcyJdLCJuYW1lcyI6WyJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ2YWx1ZSIsImFzc2VydCIsInJlcXVpcmUiLCJmcyIsInBhdGgiLCJjb25zdGFudHNfMSIsImxvY2FsaXplIiwic3VpdGUiLCJ0ZXN0IiwiZG9uZSIsInZhbCIsIkxhbmd1YWdlU2VydmljZVN1cnZleUJhbm5lciIsImJhbm5lck1lc3NhZ2UiLCJlcXVhbCIsInByb2Nlc3MiLCJlbnYiLCJWU0NPREVfTkxTX0NPTkZJRyIsImJhbm5lckxhYmVsWWVzIiwiZW50cmllcyIsImtleXMiLCJubHNDb2xsZWN0aW9uIiwiZGVmYXVsdE5sc0ZpbGUiLCJqb2luIiwiRVhURU5TSU9OX1JPT1RfRElSIiwiZXhpc3RzU3luYyIsImNvbnRlbnRzIiwicmVhZEZpbGVTeW5jIiwiSlNPTiIsInBhcnNlIiwiZm9yRWFjaCIsImUiLCJuYW1lc3BhY2UiLCJmdW5jcyIsImYiLCJmdW5jIiwiYXNrZWRGb3IiLCJnZXRBc2tlZEZvckNvbGxlY3Rpb24iLCJtaXNzaW5nIiwia2V5IiwibWlzc2luZ0tleXMiLCJsZW5ndGgiLCJtZXNzYWdlIiwiayIsImNvbmNhdCIsImZhaWwiXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTs7QUFDQUEsTUFBTSxDQUFDQyxjQUFQLENBQXNCQyxPQUF0QixFQUErQixZQUEvQixFQUE2QztBQUFFQyxFQUFBQSxLQUFLLEVBQUU7QUFBVCxDQUE3Qzs7QUFDQSxNQUFNQyxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxRQUFELENBQXRCOztBQUNBLE1BQU1DLEVBQUUsR0FBR0QsT0FBTyxDQUFDLElBQUQsQ0FBbEI7O0FBQ0EsTUFBTUUsSUFBSSxHQUFHRixPQUFPLENBQUMsTUFBRCxDQUFwQjs7QUFDQSxNQUFNRyxXQUFXLEdBQUdILE9BQU8sQ0FBQywrQkFBRCxDQUEzQjs7QUFDQSxNQUFNSSxRQUFRLEdBQUdKLE9BQU8sQ0FBQyxvQ0FBRCxDQUF4QixDLENBQ0E7OztBQUNBSyxLQUFLLENBQUMsZ0JBQUQsRUFBbUIsTUFBTTtBQUMxQkMsRUFBQUEsSUFBSSxDQUFDLE1BQUQsRUFBU0MsSUFBSSxJQUFJO0FBQ2pCLFVBQU1DLEdBQUcsR0FBR0osUUFBUSxDQUFDSywyQkFBVCxDQUFxQ0MsYUFBckMsRUFBWjtBQUNBWCxJQUFBQSxNQUFNLENBQUNZLEtBQVAsQ0FBYUgsR0FBYixFQUFrQiw2RkFBbEIsRUFBaUgsaURBQWpIO0FBQ0FELElBQUFBLElBQUk7QUFDUCxHQUpHLENBQUo7QUFLQUQsRUFBQUEsSUFBSSxDQUFDLGNBQUQsRUFBaUJDLElBQUksSUFBSTtBQUN6QjtBQUNBSyxJQUFBQSxPQUFPLENBQUNDLEdBQVIsQ0FBWUMsaUJBQVosR0FBZ0Msb0JBQWhDO0FBQ0EsVUFBTU4sR0FBRyxHQUFHSixRQUFRLENBQUNLLDJCQUFULENBQXFDTSxjQUFyQyxFQUFaO0FBQ0FoQixJQUFBQSxNQUFNLENBQUNZLEtBQVAsQ0FBYUgsR0FBYixFQUFrQiwrQkFBbEIsRUFBbUQsd0NBQW5EO0FBQ0FELElBQUFBLElBQUk7QUFDUCxHQU5HLENBQUo7QUFPQUQsRUFBQUEsSUFBSSxDQUFDLFlBQUQsRUFBZUMsSUFBSSxJQUFJO0FBQ3ZCO0FBQ0EsVUFBTVMsT0FBTyxHQUFHckIsTUFBTSxDQUFDc0IsSUFBUCxDQUFZYixRQUFaLENBQWhCLENBRnVCLENBR3ZCOztBQUNBLFFBQUljLGFBQWEsR0FBRyxFQUFwQjtBQUNBLFVBQU1DLGNBQWMsR0FBR2pCLElBQUksQ0FBQ2tCLElBQUwsQ0FBVWpCLFdBQVcsQ0FBQ2tCLGtCQUF0QixFQUEwQyxrQkFBMUMsQ0FBdkI7O0FBQ0EsUUFBSXBCLEVBQUUsQ0FBQ3FCLFVBQUgsQ0FBY0gsY0FBZCxDQUFKLEVBQW1DO0FBQy9CLFlBQU1JLFFBQVEsR0FBR3RCLEVBQUUsQ0FBQ3VCLFlBQUgsQ0FBZ0JMLGNBQWhCLEVBQWdDLE1BQWhDLENBQWpCO0FBQ0FELE1BQUFBLGFBQWEsR0FBR08sSUFBSSxDQUFDQyxLQUFMLENBQVdILFFBQVgsQ0FBaEI7QUFDSCxLQUhELE1BSUs7QUFDREwsTUFBQUEsYUFBYSxHQUFHLEVBQWhCO0FBQ0gsS0Fac0IsQ0FhdkI7OztBQUNBRixJQUFBQSxPQUFPLENBQUNXLE9BQVIsQ0FBaUJDLENBQUQsSUFBTztBQUNuQixVQUFJLE9BQU94QixRQUFRLENBQUN3QixDQUFELENBQWYsS0FBdUIsVUFBM0IsRUFBdUM7QUFDbkM7QUFDQSxjQUFNQyxTQUFTLEdBQUd6QixRQUFRLENBQUN3QixDQUFELENBQTFCO0FBQ0EsY0FBTUUsS0FBSyxHQUFHbkMsTUFBTSxDQUFDc0IsSUFBUCxDQUFZWSxTQUFaLENBQWQsQ0FIbUMsQ0FJbkM7O0FBQ0FDLFFBQUFBLEtBQUssQ0FBQ0gsT0FBTixDQUFlSSxDQUFELElBQU87QUFDakIsZ0JBQU1DLElBQUksR0FBR0gsU0FBUyxDQUFDRSxDQUFELENBQXRCO0FBQ0FDLFVBQUFBLElBQUk7QUFDUCxTQUhEO0FBSUg7QUFDSixLQVhELEVBZHVCLENBMEJ2Qjs7QUFDQSxVQUFNQyxRQUFRLEdBQUc3QixRQUFRLENBQUM4QixxQkFBVCxFQUFqQjtBQUNBLFVBQU1DLE9BQU8sR0FBRyxFQUFoQjtBQUNBeEMsSUFBQUEsTUFBTSxDQUFDc0IsSUFBUCxDQUFZZ0IsUUFBWixFQUFzQk4sT0FBdEIsQ0FBK0JTLEdBQUQsSUFBUztBQUNuQztBQUNBLFVBQUksQ0FBQ2xCLGFBQWEsQ0FBQ2tCLEdBQUQsQ0FBbEIsRUFBeUI7QUFDckJELFFBQUFBLE9BQU8sQ0FBQ0MsR0FBRCxDQUFQLEdBQWVILFFBQVEsQ0FBQ0csR0FBRCxDQUF2QjtBQUNIO0FBQ0osS0FMRCxFQTdCdUIsQ0FtQ3ZCOztBQUNBLFVBQU1DLFdBQVcsR0FBRzFDLE1BQU0sQ0FBQ3NCLElBQVAsQ0FBWWtCLE9BQVosQ0FBcEI7O0FBQ0EsUUFBSUUsV0FBVyxJQUFJQSxXQUFXLENBQUNDLE1BQVosR0FBcUIsQ0FBeEMsRUFBMkM7QUFDdkMsVUFBSUMsT0FBTyxHQUFHLHdEQUFkO0FBQ0FGLE1BQUFBLFdBQVcsQ0FBQ1YsT0FBWixDQUFxQmEsQ0FBRCxJQUFPO0FBQ3ZCRCxRQUFBQSxPQUFPLEdBQUdBLE9BQU8sQ0FBQ0UsTUFBUixDQUFnQixNQUFLRCxDQUFFLFFBQU9MLE9BQU8sQ0FBQ0ssQ0FBRCxDQUFJLE1BQXpDLENBQVY7QUFDSCxPQUZEO0FBR0F6QyxNQUFBQSxNQUFNLENBQUMyQyxJQUFQLENBQVlILE9BQVo7QUFDSDs7QUFDRGhDLElBQUFBLElBQUk7QUFDUCxHQTdDRyxDQUFKO0FBOENILENBM0RJLENBQUwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4ndXNlIHN0cmljdCc7XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuY29uc3QgYXNzZXJ0ID0gcmVxdWlyZShcImFzc2VydFwiKTtcclxuY29uc3QgZnMgPSByZXF1aXJlKFwiZnNcIik7XHJcbmNvbnN0IHBhdGggPSByZXF1aXJlKFwicGF0aFwiKTtcclxuY29uc3QgY29uc3RhbnRzXzEgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L2NvbW1vbi9jb25zdGFudHNcIik7XHJcbmNvbnN0IGxvY2FsaXplID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC9jb21tb24vdXRpbHMvbG9jYWxpemVcIik7XHJcbi8vIERlZmluZXMgYSBNb2NoYSB0ZXN0IHN1aXRlIHRvIGdyb3VwIHRlc3RzIG9mIHNpbWlsYXIga2luZCB0b2dldGhlclxyXG5zdWl0ZSgnbG9jYWxpemUgdGVzdHMnLCAoKSA9PiB7XHJcbiAgICB0ZXN0KCdrZXlzJywgZG9uZSA9PiB7XHJcbiAgICAgICAgY29uc3QgdmFsID0gbG9jYWxpemUuTGFuZ3VhZ2VTZXJ2aWNlU3VydmV5QmFubmVyLmJhbm5lck1lc3NhZ2UoKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwodmFsLCAnQ2FuIHlvdSBwbGVhc2UgdGFrZSAyIG1pbnV0ZXMgdG8gdGVsbCB1cyBob3cgdGhlIFB5dGhvbiBMYW5ndWFnZSBTZXJ2ZXIgaXMgd29ya2luZyBmb3IgeW91PycsICdMYW5ndWFnZVNlcnZpY2VTdXJ2ZXlCYW5uZXIgc3RyaW5nIGRvZXNudCBtYXRjaCcpO1xyXG4gICAgICAgIGRvbmUoKTtcclxuICAgIH0pO1xyXG4gICAgdGVzdCgna2V5cyBpdGFsaWFuJywgZG9uZSA9PiB7XHJcbiAgICAgICAgLy8gRm9yY2UgYSBjb25maWcgY2hhbmdlXHJcbiAgICAgICAgcHJvY2Vzcy5lbnYuVlNDT0RFX05MU19DT05GSUcgPSAneyBcImxvY2FsZVwiOiBcIml0XCIgfSc7XHJcbiAgICAgICAgY29uc3QgdmFsID0gbG9jYWxpemUuTGFuZ3VhZ2VTZXJ2aWNlU3VydmV5QmFubmVyLmJhbm5lckxhYmVsWWVzKCk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKHZhbCwgJ1PDrCwgcHJlbmRlcsOyIGlsIHNvbmRhZ2dpbyBvcmEnLCAnYmFubmVyTGFiZWxZZXMgaXMgbm90IGJlaW5nIHRyYW5zbGF0ZWQnKTtcclxuICAgICAgICBkb25lKCk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ2tleXMgZXhpc3QnLCBkb25lID0+IHtcclxuICAgICAgICAvLyBSZWFkIGFsbCBvZiB0aGUgbmFtZXNwYWNlcyBmcm9tIHRoZSBsb2NhbGl6ZSBpbXBvcnRcclxuICAgICAgICBjb25zdCBlbnRyaWVzID0gT2JqZWN0LmtleXMobG9jYWxpemUpO1xyXG4gICAgICAgIC8vIFJlYWQgaW4gdGhlIEpTT04gb2JqZWN0IGZvciB0aGUgcGFja2FnZS5ubHMuanNvblxyXG4gICAgICAgIGxldCBubHNDb2xsZWN0aW9uID0ge307XHJcbiAgICAgICAgY29uc3QgZGVmYXVsdE5sc0ZpbGUgPSBwYXRoLmpvaW4oY29uc3RhbnRzXzEuRVhURU5TSU9OX1JPT1RfRElSLCAncGFja2FnZS5ubHMuanNvbicpO1xyXG4gICAgICAgIGlmIChmcy5leGlzdHNTeW5jKGRlZmF1bHRObHNGaWxlKSkge1xyXG4gICAgICAgICAgICBjb25zdCBjb250ZW50cyA9IGZzLnJlYWRGaWxlU3luYyhkZWZhdWx0TmxzRmlsZSwgJ3V0ZjgnKTtcclxuICAgICAgICAgICAgbmxzQ29sbGVjdGlvbiA9IEpTT04ucGFyc2UoY29udGVudHMpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbmxzQ29sbGVjdGlvbiA9IHt9O1xyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBOb3cgbWF0Y2ggYWxsIG9mIG91ciBuYW1lc3BhY2UgZW50cmllcyB0byBvdXIgbmxzIGVudHJpZXNcclxuICAgICAgICBlbnRyaWVzLmZvckVhY2goKGUpID0+IHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBsb2NhbGl6ZVtlXSAhPT0gJ2Z1bmN0aW9uJykge1xyXG4gICAgICAgICAgICAgICAgLy8gVGhpcyBtdXN0IGJlIGEgbmFtZXNwYWNlLiBJdCBzaG91bGQgaGF2ZSBmdW5jdGlvbnMgaW5zaWRlIG9mIGl0XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuYW1lc3BhY2UgPSBsb2NhbGl6ZVtlXTtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGZ1bmNzID0gT2JqZWN0LmtleXMobmFtZXNwYWNlKTtcclxuICAgICAgICAgICAgICAgIC8vIFJ1biBldmVyeSBmdW5jdGlvbiwgdGhpcyBzaG91bGQgZmlsbCB1cCBvdXIgYXNrZWQgZm9yIGtleXMgY29sbGVjdGlvblxyXG4gICAgICAgICAgICAgICAgZnVuY3MuZm9yRWFjaCgoZikgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZ1bmMgPSBuYW1lc3BhY2VbZl07XHJcbiAgICAgICAgICAgICAgICAgICAgZnVuYygpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgICAvLyBOb3cgdmVyaWZ5IGFsbCBvZiB0aGUgYXNrZWQgZm9yIGtleXMgZXhpc3RcclxuICAgICAgICBjb25zdCBhc2tlZEZvciA9IGxvY2FsaXplLmdldEFza2VkRm9yQ29sbGVjdGlvbigpO1xyXG4gICAgICAgIGNvbnN0IG1pc3NpbmcgPSB7fTtcclxuICAgICAgICBPYmplY3Qua2V5cyhhc2tlZEZvcikuZm9yRWFjaCgoa2V5KSA9PiB7XHJcbiAgICAgICAgICAgIC8vIE5vdyBjaGVjayB0aGF0IHRoaXMga2V5IGV4aXN0cyBzb21ld2hlcmUgaW4gdGhlIG5scyBjb2xsZWN0aW9uXHJcbiAgICAgICAgICAgIGlmICghbmxzQ29sbGVjdGlvbltrZXldKSB7XHJcbiAgICAgICAgICAgICAgICBtaXNzaW5nW2tleV0gPSBhc2tlZEZvcltrZXldO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgLy8gSWYgYW55IG1pc3Npbmcga2V5cywgb3V0cHV0IGFuIGVycm9yXHJcbiAgICAgICAgY29uc3QgbWlzc2luZ0tleXMgPSBPYmplY3Qua2V5cyhtaXNzaW5nKTtcclxuICAgICAgICBpZiAobWlzc2luZ0tleXMgJiYgbWlzc2luZ0tleXMubGVuZ3RoID4gMCkge1xyXG4gICAgICAgICAgICBsZXQgbWVzc2FnZSA9ICdNaXNzaW5nIGtleXMuIEFkZCB0aGUgZm9sbG93aW5nIHRvIHBhY2thZ2UubmxzLmpzb246XFxuJztcclxuICAgICAgICAgICAgbWlzc2luZ0tleXMuZm9yRWFjaCgoaykgPT4ge1xyXG4gICAgICAgICAgICAgICAgbWVzc2FnZSA9IG1lc3NhZ2UuY29uY2F0KGBcXHRcIiR7a31cIiA6IFwiJHttaXNzaW5nW2tdfVwiLFxcbmApO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgYXNzZXJ0LmZhaWwobWVzc2FnZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRvbmUoKTtcclxuICAgIH0pO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bG9jYWxpemUudW5pdC50ZXN0LmpzLm1hcCJdfQ==