// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:insecure-random max-func-body-length

const typemoq = require("typemoq");

const vscode_1 = require("vscode");

const promptHandler_1 = require("../../../client/application/diagnostics/promptHandler");

const types_1 = require("../../../client/application/diagnostics/types");

const types_2 = require("../../../client/common/application/types");

const enum_1 = require("../../../client/common/utils/enum");

suite('Application Diagnostics - PromptHandler', () => {
  let serviceContainer;
  let appShell;
  let promptHandler;
  setup(() => {
    serviceContainer = typemoq.Mock.ofType();
    appShell = typemoq.Mock.ofType();
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_2.IApplicationShell))).returns(() => appShell.object);
    promptHandler = new promptHandler_1.DiagnosticCommandPromptHandlerService(serviceContainer.object);
  });
  enum_1.getNamesAndValues(vscode_1.DiagnosticSeverity).forEach(severity => {
    test(`Handling a diagnositic of severity '${severity.name}' should display a message without any buttons`, () => __awaiter(void 0, void 0, void 0, function* () {
      const diagnostic = {
        code: '1',
        message: 'one',
        scope: types_1.DiagnosticScope.Global,
        severity: severity.value
      };

      switch (severity.value) {
        case vscode_1.DiagnosticSeverity.Error:
          {
            appShell.setup(a => a.showErrorMessage(typemoq.It.isValue(diagnostic.message))).verifiable(typemoq.Times.once());
            break;
          }

        case vscode_1.DiagnosticSeverity.Warning:
          {
            appShell.setup(a => a.showWarningMessage(typemoq.It.isValue(diagnostic.message))).verifiable(typemoq.Times.once());
            break;
          }

        default:
          {
            appShell.setup(a => a.showInformationMessage(typemoq.It.isValue(diagnostic.message))).verifiable(typemoq.Times.once());
            break;
          }
      }

      yield promptHandler.handle(diagnostic);
      appShell.verifyAll();
    }));
    test(`Handling a diagnositic of severity '${severity.name}' should display a custom message with buttons`, () => __awaiter(void 0, void 0, void 0, function* () {
      const diagnostic = {
        code: '1',
        message: 'one',
        scope: types_1.DiagnosticScope.Global,
        severity: severity.value
      };
      const options = {
        commandPrompts: [{
          prompt: 'Yes'
        }, {
          prompt: 'No'
        }],
        message: 'Custom Message'
      };

      switch (severity.value) {
        case vscode_1.DiagnosticSeverity.Error:
          {
            appShell.setup(a => a.showErrorMessage(typemoq.It.isValue(options.message), typemoq.It.isValue('Yes'), typemoq.It.isValue('No'))).verifiable(typemoq.Times.once());
            break;
          }

        case vscode_1.DiagnosticSeverity.Warning:
          {
            appShell.setup(a => a.showWarningMessage(typemoq.It.isValue(options.message), typemoq.It.isValue('Yes'), typemoq.It.isValue('No'))).verifiable(typemoq.Times.once());
            break;
          }

        default:
          {
            appShell.setup(a => a.showInformationMessage(typemoq.It.isValue(options.message), typemoq.It.isValue('Yes'), typemoq.It.isValue('No'))).verifiable(typemoq.Times.once());
            break;
          }
      }

      yield promptHandler.handle(diagnostic, options);
      appShell.verifyAll();
    }));
    test(`Handling a diagnositic of severity '${severity.name}' should display a custom message with buttons and invoke selected command`, () => __awaiter(void 0, void 0, void 0, function* () {
      const diagnostic = {
        code: '1',
        message: 'one',
        scope: types_1.DiagnosticScope.Global,
        severity: severity.value
      };
      const command = typemoq.Mock.ofType();
      const options = {
        commandPrompts: [{
          prompt: 'Yes',
          command: command.object
        }, {
          prompt: 'No',
          command: command.object
        }],
        message: 'Custom Message'
      };
      command.setup(c => c.invoke()).verifiable(typemoq.Times.once());

      switch (severity.value) {
        case vscode_1.DiagnosticSeverity.Error:
          {
            appShell.setup(a => a.showErrorMessage(typemoq.It.isValue(options.message), typemoq.It.isValue('Yes'), typemoq.It.isValue('No'))).returns(() => Promise.resolve('Yes')).verifiable(typemoq.Times.once());
            break;
          }

        case vscode_1.DiagnosticSeverity.Warning:
          {
            appShell.setup(a => a.showWarningMessage(typemoq.It.isValue(options.message), typemoq.It.isValue('Yes'), typemoq.It.isValue('No'))).returns(() => Promise.resolve('Yes')).verifiable(typemoq.Times.once());
            break;
          }

        default:
          {
            appShell.setup(a => a.showInformationMessage(typemoq.It.isValue(options.message), typemoq.It.isValue('Yes'), typemoq.It.isValue('No'))).returns(() => Promise.resolve('Yes')).verifiable(typemoq.Times.once());
            break;
          }
      }

      yield promptHandler.handle(diagnostic, options);
      appShell.verifyAll();
      command.verifyAll();
    }));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInByb21wdEhhbmRsZXIudW5pdC50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJ0eXBlbW9xIiwicmVxdWlyZSIsInZzY29kZV8xIiwicHJvbXB0SGFuZGxlcl8xIiwidHlwZXNfMSIsInR5cGVzXzIiLCJlbnVtXzEiLCJzdWl0ZSIsInNlcnZpY2VDb250YWluZXIiLCJhcHBTaGVsbCIsInByb21wdEhhbmRsZXIiLCJzZXR1cCIsIk1vY2siLCJvZlR5cGUiLCJzIiwiZ2V0IiwiSXQiLCJpc1ZhbHVlIiwiSUFwcGxpY2F0aW9uU2hlbGwiLCJyZXR1cm5zIiwib2JqZWN0IiwiRGlhZ25vc3RpY0NvbW1hbmRQcm9tcHRIYW5kbGVyU2VydmljZSIsImdldE5hbWVzQW5kVmFsdWVzIiwiRGlhZ25vc3RpY1NldmVyaXR5IiwiZm9yRWFjaCIsInNldmVyaXR5IiwidGVzdCIsIm5hbWUiLCJkaWFnbm9zdGljIiwiY29kZSIsIm1lc3NhZ2UiLCJzY29wZSIsIkRpYWdub3N0aWNTY29wZSIsIkdsb2JhbCIsIkVycm9yIiwiYSIsInNob3dFcnJvck1lc3NhZ2UiLCJ2ZXJpZmlhYmxlIiwiVGltZXMiLCJvbmNlIiwiV2FybmluZyIsInNob3dXYXJuaW5nTWVzc2FnZSIsInNob3dJbmZvcm1hdGlvbk1lc3NhZ2UiLCJoYW5kbGUiLCJ2ZXJpZnlBbGwiLCJvcHRpb25zIiwiY29tbWFuZFByb21wdHMiLCJwcm9tcHQiLCJjb21tYW5kIiwiYyIsImludm9rZSJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMs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Q0FBQyxDQUFDTyxzQkFBRixDQUF5QjFDLE9BQU8sQ0FBQ2dCLEVBQVIsQ0FBV0MsT0FBWCxDQUFtQjRCLE9BQU8sQ0FBQ2YsT0FBM0IsQ0FBekIsRUFBOEQ5QixPQUFPLENBQUNnQixFQUFSLENBQVdDLE9BQVgsQ0FBbUIsS0FBbkIsQ0FBOUQsRUFBeUZqQixPQUFPLENBQUNnQixFQUFSLENBQVdDLE9BQVgsQ0FBbUIsSUFBbkIsQ0FBekYsQ0FBcEIsRUFDS0UsT0FETCxDQUNhLE1BQU1uQyxPQUFPLENBQUNDLE9BQVIsQ0FBZ0IsS0FBaEIsQ0FEbkIsRUFFS29ELFVBRkwsQ0FFZ0JyQyxPQUFPLENBQUNzQyxLQUFSLENBQWNDLElBQWQsRUFGaEI7QUFHQTtBQUNIO0FBbEJMOztBQW9CQSxZQUFNN0IsYUFBYSxDQUFDaUMsTUFBZCxDQUFxQmYsVUFBckIsRUFBaUNpQixPQUFqQyxDQUFOO0FBQ0FwQyxNQUFBQSxRQUFRLENBQUNtQyxTQUFUO0FBQ0FJLE1BQUFBLE9BQU8sQ0FBQ0osU0FBUjtBQUNILEtBbkNxSixDQUFsSixDQUFKO0FBb0NILEdBeEZEO0FBeUZILENBcEdJLENBQUwiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgKGMpIE1pY3Jvc29mdCBDb3Jwb3JhdGlvbi4gQWxsIHJpZ2h0cyByZXNlcnZlZC5cclxuLy8gTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBMaWNlbnNlLlxyXG4ndXNlIHN0cmljdCc7XHJcbnZhciBfX2F3YWl0ZXIgPSAodGhpcyAmJiB0aGlzLl9fYXdhaXRlcikgfHwgZnVuY3Rpb24gKHRoaXNBcmcsIF9hcmd1bWVudHMsIFAsIGdlbmVyYXRvcikge1xyXG4gICAgcmV0dXJuIG5ldyAoUCB8fCAoUCA9IFByb21pc2UpKShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XHJcbiAgICAgICAgZnVuY3Rpb24gZnVsZmlsbGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yLm5leHQodmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHJlamVjdGVkKHZhbHVlKSB7IHRyeSB7IHN0ZXAoZ2VuZXJhdG9yW1widGhyb3dcIl0odmFsdWUpKTsgfSBjYXRjaCAoZSkgeyByZWplY3QoZSk7IH0gfVxyXG4gICAgICAgIGZ1bmN0aW9uIHN0ZXAocmVzdWx0KSB7IHJlc3VsdC5kb25lID8gcmVzb2x2ZShyZXN1bHQudmFsdWUpIDogbmV3IFAoZnVuY3Rpb24gKHJlc29sdmUpIHsgcmVzb2x2ZShyZXN1bHQudmFsdWUpOyB9KS50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpOyB9XHJcbiAgICAgICAgc3RlcCgoZ2VuZXJhdG9yID0gZ2VuZXJhdG9yLmFwcGx5KHRoaXNBcmcsIF9hcmd1bWVudHMgfHwgW10pKS5uZXh0KCkpO1xyXG4gICAgfSk7XHJcbn07XHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwgeyB2YWx1ZTogdHJ1ZSB9KTtcclxuLy8gdHNsaW50OmRpc2FibGU6aW5zZWN1cmUtcmFuZG9tIG1heC1mdW5jLWJvZHktbGVuZ3RoXHJcbmNvbnN0IHR5cGVtb3EgPSByZXF1aXJlKFwidHlwZW1vcVwiKTtcclxuY29uc3QgdnNjb2RlXzEgPSByZXF1aXJlKFwidnNjb2RlXCIpO1xyXG5jb25zdCBwcm9tcHRIYW5kbGVyXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2FwcGxpY2F0aW9uL2RpYWdub3N0aWNzL3Byb21wdEhhbmRsZXJcIik7XHJcbmNvbnN0IHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vY2xpZW50L2FwcGxpY2F0aW9uL2RpYWdub3N0aWNzL3R5cGVzXCIpO1xyXG5jb25zdCB0eXBlc18yID0gcmVxdWlyZShcIi4uLy4uLy4uL2NsaWVudC9jb21tb24vYXBwbGljYXRpb24vdHlwZXNcIik7XHJcbmNvbnN0IGVudW1fMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi9jbGllbnQvY29tbW9uL3V0aWxzL2VudW1cIik7XHJcbnN1aXRlKCdBcHBsaWNhdGlvbiBEaWFnbm9zdGljcyAtIFByb21wdEhhbmRsZXInLCAoKSA9PiB7XHJcbiAgICBsZXQgc2VydmljZUNvbnRhaW5lcjtcclxuICAgIGxldCBhcHBTaGVsbDtcclxuICAgIGxldCBwcm9tcHRIYW5kbGVyO1xyXG4gICAgc2V0dXAoKCkgPT4ge1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgYXBwU2hlbGwgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChzID0+IHMuZ2V0KHR5cGVtb3EuSXQuaXNWYWx1ZSh0eXBlc18yLklBcHBsaWNhdGlvblNoZWxsKSkpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IGFwcFNoZWxsLm9iamVjdCk7XHJcbiAgICAgICAgcHJvbXB0SGFuZGxlciA9IG5ldyBwcm9tcHRIYW5kbGVyXzEuRGlhZ25vc3RpY0NvbW1hbmRQcm9tcHRIYW5kbGVyU2VydmljZShzZXJ2aWNlQ29udGFpbmVyLm9iamVjdCk7XHJcbiAgICB9KTtcclxuICAgIGVudW1fMS5nZXROYW1lc0FuZFZhbHVlcyh2c2NvZGVfMS5EaWFnbm9zdGljU2V2ZXJpdHkpLmZvckVhY2goc2V2ZXJpdHkgPT4ge1xyXG4gICAgICAgIHRlc3QoYEhhbmRsaW5nIGEgZGlhZ25vc2l0aWMgb2Ygc2V2ZXJpdHkgJyR7c2V2ZXJpdHkubmFtZX0nIHNob3VsZCBkaXNwbGF5IGEgbWVzc2FnZSB3aXRob3V0IGFueSBidXR0b25zYCwgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgICAgICBjb25zdCBkaWFnbm9zdGljID0geyBjb2RlOiAnMScsIG1lc3NhZ2U6ICdvbmUnLCBzY29wZTogdHlwZXNfMS5EaWFnbm9zdGljU2NvcGUuR2xvYmFsLCBzZXZlcml0eTogc2V2ZXJpdHkudmFsdWUgfTtcclxuICAgICAgICAgICAgc3dpdGNoIChzZXZlcml0eS52YWx1ZSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSB2c2NvZGVfMS5EaWFnbm9zdGljU2V2ZXJpdHkuRXJyb3I6IHtcclxuICAgICAgICAgICAgICAgICAgICBhcHBTaGVsbC5zZXR1cChhID0+IGEuc2hvd0Vycm9yTWVzc2FnZSh0eXBlbW9xLkl0LmlzVmFsdWUoZGlhZ25vc3RpYy5tZXNzYWdlKSkpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIC52ZXJpZmlhYmxlKHR5cGVtb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGNhc2UgdnNjb2RlXzEuRGlhZ25vc3RpY1NldmVyaXR5Lldhcm5pbmc6IHtcclxuICAgICAgICAgICAgICAgICAgICBhcHBTaGVsbC5zZXR1cChhID0+IGEuc2hvd1dhcm5pbmdNZXNzYWdlKHR5cGVtb3EuSXQuaXNWYWx1ZShkaWFnbm9zdGljLm1lc3NhZ2UpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZW1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcFNoZWxsLnNldHVwKGEgPT4gYS5zaG93SW5mb3JtYXRpb25NZXNzYWdlKHR5cGVtb3EuSXQuaXNWYWx1ZShkaWFnbm9zdGljLm1lc3NhZ2UpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZW1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHlpZWxkIHByb21wdEhhbmRsZXIuaGFuZGxlKGRpYWdub3N0aWMpO1xyXG4gICAgICAgICAgICBhcHBTaGVsbC52ZXJpZnlBbGwoKTtcclxuICAgICAgICB9KSk7XHJcbiAgICAgICAgdGVzdChgSGFuZGxpbmcgYSBkaWFnbm9zaXRpYyBvZiBzZXZlcml0eSAnJHtzZXZlcml0eS5uYW1lfScgc2hvdWxkIGRpc3BsYXkgYSBjdXN0b20gbWVzc2FnZSB3aXRoIGJ1dHRvbnNgLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpYWdub3N0aWMgPSB7IGNvZGU6ICcxJywgbWVzc2FnZTogJ29uZScsIHNjb3BlOiB0eXBlc18xLkRpYWdub3N0aWNTY29wZS5HbG9iYWwsIHNldmVyaXR5OiBzZXZlcml0eS52YWx1ZSB9O1xyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgY29tbWFuZFByb21wdHM6IFtcclxuICAgICAgICAgICAgICAgICAgICB7IHByb21wdDogJ1llcycgfSxcclxuICAgICAgICAgICAgICAgICAgICB7IHByb21wdDogJ05vJyB9XHJcbiAgICAgICAgICAgICAgICBdLFxyXG4gICAgICAgICAgICAgICAgbWVzc2FnZTogJ0N1c3RvbSBNZXNzYWdlJ1xyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHNldmVyaXR5LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHZzY29kZV8xLkRpYWdub3N0aWNTZXZlcml0eS5FcnJvcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcFNoZWxsLnNldHVwKGEgPT4gYS5zaG93RXJyb3JNZXNzYWdlKHR5cGVtb3EuSXQuaXNWYWx1ZShvcHRpb25zLm1lc3NhZ2UpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ1llcycpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ05vJykpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXNlIHZzY29kZV8xLkRpYWdub3N0aWNTZXZlcml0eS5XYXJuaW5nOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwU2hlbGwuc2V0dXAoYSA9PiBhLnNob3dXYXJuaW5nTWVzc2FnZSh0eXBlbW9xLkl0LmlzVmFsdWUob3B0aW9ucy5tZXNzYWdlKSwgdHlwZW1vcS5JdC5pc1ZhbHVlKCdZZXMnKSwgdHlwZW1vcS5JdC5pc1ZhbHVlKCdObycpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZW1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcFNoZWxsLnNldHVwKGEgPT4gYS5zaG93SW5mb3JtYXRpb25NZXNzYWdlKHR5cGVtb3EuSXQuaXNWYWx1ZShvcHRpb25zLm1lc3NhZ2UpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ1llcycpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ05vJykpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgeWllbGQgcHJvbXB0SGFuZGxlci5oYW5kbGUoZGlhZ25vc3RpYywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIGFwcFNoZWxsLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB0ZXN0KGBIYW5kbGluZyBhIGRpYWdub3NpdGljIG9mIHNldmVyaXR5ICcke3NldmVyaXR5Lm5hbWV9JyBzaG91bGQgZGlzcGxheSBhIGN1c3RvbSBtZXNzYWdlIHdpdGggYnV0dG9ucyBhbmQgaW52b2tlIHNlbGVjdGVkIGNvbW1hbmRgLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGRpYWdub3N0aWMgPSB7IGNvZGU6ICcxJywgbWVzc2FnZTogJ29uZScsIHNjb3BlOiB0eXBlc18xLkRpYWdub3N0aWNTY29wZS5HbG9iYWwsIHNldmVyaXR5OiBzZXZlcml0eS52YWx1ZSB9O1xyXG4gICAgICAgICAgICBjb25zdCBjb21tYW5kID0gdHlwZW1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgICAgICBjb25zdCBvcHRpb25zID0ge1xyXG4gICAgICAgICAgICAgICAgY29tbWFuZFByb21wdHM6IFtcclxuICAgICAgICAgICAgICAgICAgICB7IHByb21wdDogJ1llcycsIGNvbW1hbmQ6IGNvbW1hbmQub2JqZWN0IH0sXHJcbiAgICAgICAgICAgICAgICAgICAgeyBwcm9tcHQ6ICdObycsIGNvbW1hbmQ6IGNvbW1hbmQub2JqZWN0IH1cclxuICAgICAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgICAgICBtZXNzYWdlOiAnQ3VzdG9tIE1lc3NhZ2UnXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIGNvbW1hbmQuc2V0dXAoYyA9PiBjLmludm9rZSgpKVxyXG4gICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZW1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgICAgICBzd2l0Y2ggKHNldmVyaXR5LnZhbHVlKSB7XHJcbiAgICAgICAgICAgICAgICBjYXNlIHZzY29kZV8xLkRpYWdub3N0aWNTZXZlcml0eS5FcnJvcjoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcFNoZWxsLnNldHVwKGEgPT4gYS5zaG93RXJyb3JNZXNzYWdlKHR5cGVtb3EuSXQuaXNWYWx1ZShvcHRpb25zLm1lc3NhZ2UpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ1llcycpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ05vJykpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUoJ1llcycpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjYXNlIHZzY29kZV8xLkRpYWdub3N0aWNTZXZlcml0eS5XYXJuaW5nOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXBwU2hlbGwuc2V0dXAoYSA9PiBhLnNob3dXYXJuaW5nTWVzc2FnZSh0eXBlbW9xLkl0LmlzVmFsdWUob3B0aW9ucy5tZXNzYWdlKSwgdHlwZW1vcS5JdC5pc1ZhbHVlKCdZZXMnKSwgdHlwZW1vcS5JdC5pc1ZhbHVlKCdObycpKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKCdZZXMnKSlcclxuICAgICAgICAgICAgICAgICAgICAgICAgLnZlcmlmaWFibGUodHlwZW1vcS5UaW1lcy5vbmNlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDoge1xyXG4gICAgICAgICAgICAgICAgICAgIGFwcFNoZWxsLnNldHVwKGEgPT4gYS5zaG93SW5mb3JtYXRpb25NZXNzYWdlKHR5cGVtb3EuSXQuaXNWYWx1ZShvcHRpb25zLm1lc3NhZ2UpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ1llcycpLCB0eXBlbW9xLkl0LmlzVmFsdWUoJ05vJykpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAucmV0dXJucygoKSA9PiBQcm9taXNlLnJlc29sdmUoJ1llcycpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgeWllbGQgcHJvbXB0SGFuZGxlci5oYW5kbGUoZGlhZ25vc3RpYywgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIGFwcFNoZWxsLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgICAgICBjb21tYW5kLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIH0pKTtcclxuICAgIH0pO1xyXG59KTtcclxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cHJvbXB0SGFuZGxlci51bml0LnRlc3QuanMubWFwIl19