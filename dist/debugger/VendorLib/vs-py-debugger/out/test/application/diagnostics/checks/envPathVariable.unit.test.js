// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const chai_1 = require("chai");

const path = require("path");

const typemoq = require("typemoq");

const vscode_1 = require("vscode");

const envPathVariable_1 = require("../../../../client/application/diagnostics/checks/envPathVariable");

const types_1 = require("../../../../client/application/diagnostics/commands/types");

const constants_1 = require("../../../../client/application/diagnostics/constants");

const promptHandler_1 = require("../../../../client/application/diagnostics/promptHandler");

const types_2 = require("../../../../client/application/diagnostics/types");

const types_3 = require("../../../../client/common/application/types");

const types_4 = require("../../../../client/common/platform/types");

const types_5 = require("../../../../client/common/types"); // tslint:disable-next-line:max-func-body-length


suite('Application Diagnostics - Checks Env Path Variable', () => {
  let diagnosticService;
  let platformService;
  let messageHandler;
  let filterService;
  let procEnv;
  let appEnv;
  let commandFactory;
  const pathVariableName = 'Path';
  const pathDelimiter = ';';
  const extensionName = 'Some Extension Name';
  setup(() => {
    const serviceContainer = typemoq.Mock.ofType();
    platformService = typemoq.Mock.ofType();
    platformService.setup(p => p.pathVariableName).returns(() => pathVariableName);
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_4.IPlatformService))).returns(() => platformService.object);
    messageHandler = typemoq.Mock.ofType();
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_2.IDiagnosticHandlerService), typemoq.It.isValue(promptHandler_1.DiagnosticCommandPromptHandlerServiceId))).returns(() => messageHandler.object);
    appEnv = typemoq.Mock.ofType();
    appEnv.setup(a => a.extensionName).returns(() => extensionName);
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_3.IApplicationEnvironment))).returns(() => appEnv.object);
    filterService = typemoq.Mock.ofType();
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_2.IDiagnosticFilterService))).returns(() => filterService.object);
    commandFactory = typemoq.Mock.ofType();
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_1.IDiagnosticsCommandFactory))).returns(() => commandFactory.object);
    const currentProc = typemoq.Mock.ofType();
    procEnv = typemoq.Mock.ofType();
    currentProc.setup(p => p.env).returns(() => procEnv.object);
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_5.ICurrentProcess))).returns(() => currentProc.object);
    const pathUtils = typemoq.Mock.ofType();
    pathUtils.setup(p => p.delimiter).returns(() => pathDelimiter);
    serviceContainer.setup(s => s.get(typemoq.It.isValue(types_5.IPathUtils))).returns(() => pathUtils.object);
    diagnosticService = new envPathVariable_1.EnvironmentPathVariableDiagnosticsService(serviceContainer.object);
  });
  test('Can handle EnvPathVariable diagnostics', () => __awaiter(void 0, void 0, void 0, function* () {
    const diagnostic = typemoq.Mock.ofType();
    diagnostic.setup(d => d.code).returns(() => constants_1.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic).verifiable(typemoq.Times.atLeastOnce());
    const canHandle = yield diagnosticService.canHandle(diagnostic.object);
    chai_1.expect(canHandle).to.be.equal(true, 'Invalid value');
    diagnostic.verifyAll();
  }));
  test('Can not handle non-EnvPathVariable diagnostics', () => __awaiter(void 0, void 0, void 0, function* () {
    const diagnostic = typemoq.Mock.ofType();
    diagnostic.setup(d => d.code).returns(() => 'Something Else').verifiable(typemoq.Times.atLeastOnce());
    const canHandle = yield diagnosticService.canHandle(diagnostic.object);
    chai_1.expect(canHandle).to.be.equal(false, 'Invalid value');
    diagnostic.verifyAll();
  }));
  test('Should return empty diagnostics for Mac', () => __awaiter(void 0, void 0, void 0, function* () {
    platformService.setup(p => p.isMac).returns(() => true);
    platformService.setup(p => p.isLinux).returns(() => false);
    platformService.setup(p => p.isWindows).returns(() => false);
    const diagnostics = yield diagnosticService.diagnose();
    chai_1.expect(diagnostics).to.be.deep.equal([]);
  }));
  test('Should return empty diagnostics for Linux', () => __awaiter(void 0, void 0, void 0, function* () {
    platformService.setup(p => p.isMac).returns(() => false);
    platformService.setup(p => p.isLinux).returns(() => true);
    platformService.setup(p => p.isWindows).returns(() => false);
    const diagnostics = yield diagnosticService.diagnose();
    chai_1.expect(diagnostics).to.be.deep.equal([]);
  }));
  test('Should return empty diagnostics for Windows if path variable is valid', () => __awaiter(void 0, void 0, void 0, function* () {
    platformService.setup(p => p.isWindows).returns(() => true);
    const paths = [path.join('one', 'two', 'three'), path.join('one', 'two', 'four')].join(pathDelimiter);
    procEnv.setup(env => env[pathVariableName]).returns(() => paths);
    const diagnostics = yield diagnosticService.diagnose();
    chai_1.expect(diagnostics).to.be.deep.equal([]);
  })); // Note: On windows, when a path contains a `;` then Windows encloses the path within `"`.

  test('Should return single diagnostics for Windows if path contains \'"\'', () => __awaiter(void 0, void 0, void 0, function* () {
    platformService.setup(p => p.isWindows).returns(() => true);
    const paths = [path.join('one', 'two', 'three"'), path.join('one', 'two', 'four')].join(pathDelimiter);
    procEnv.setup(env => env[pathVariableName]).returns(() => paths);
    const diagnostics = yield diagnosticService.diagnose();
    chai_1.expect(diagnostics).to.be.lengthOf(1);
    chai_1.expect(diagnostics[0].code).to.be.equal(constants_1.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic);
    chai_1.expect(diagnostics[0].message).to.contain(extensionName);
    chai_1.expect(diagnostics[0].message).to.contain(pathVariableName);
    chai_1.expect(diagnostics[0].severity).to.be.equal(vscode_1.DiagnosticSeverity.Warning);
    chai_1.expect(diagnostics[0].scope).to.be.equal(types_2.DiagnosticScope.Global);
  }));
  test('Should not return diagnostics for Windows if path ends with delimiter', () => __awaiter(void 0, void 0, void 0, function* () {
    const paths = [path.join('one', 'two', 'three'), path.join('one', 'two', 'four')].join(pathDelimiter) + pathDelimiter;
    platformService.setup(p => p.isWindows).returns(() => true);
    procEnv.setup(env => env[pathVariableName]).returns(() => paths);
    const diagnostics = yield diagnosticService.diagnose();
    chai_1.expect(diagnostics).to.be.lengthOf(0);
  }));
  test('Should display three options in message displayed with 2 commands', () => __awaiter(void 0, void 0, void 0, function* () {
    platformService.setup(p => p.isWindows).returns(() => true);
    const diagnostic = typemoq.Mock.ofType();
    diagnostic.setup(d => d.code).returns(() => constants_1.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic).verifiable(typemoq.Times.atLeastOnce());
    const alwaysIgnoreCommand = typemoq.Mock.ofType();
    commandFactory.setup(f => f.createCommand(typemoq.It.isAny(), typemoq.It.isObjectWith({
      type: 'ignore',
      options: types_2.DiagnosticScope.Global
    }))).returns(() => alwaysIgnoreCommand.object).verifiable(typemoq.Times.once());
    const launchBrowserCommand = typemoq.Mock.ofType();
    commandFactory.setup(f => f.createCommand(typemoq.It.isAny(), typemoq.It.isObjectWith({
      type: 'launch'
    }))).returns(() => launchBrowserCommand.object).verifiable(typemoq.Times.once());
    messageHandler.setup(m => m.handle(typemoq.It.isAny(), typemoq.It.isAny())).verifiable(typemoq.Times.once());
    yield diagnosticService.handle([diagnostic.object]);
    diagnostic.verifyAll();
    commandFactory.verifyAll();
    messageHandler.verifyAll();
  }));
  test('Should not display a message if the diagnostic code has been ignored', () => __awaiter(void 0, void 0, void 0, function* () {
    platformService.setup(p => p.isWindows).returns(() => true);
    const diagnostic = typemoq.Mock.ofType();
    filterService.setup(f => f.shouldIgnoreDiagnostic(typemoq.It.isValue(constants_1.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic))).returns(() => Promise.resolve(true)).verifiable(typemoq.Times.once());
    diagnostic.setup(d => d.code).returns(() => constants_1.DiagnosticCodes.InvalidEnvironmentPathVariableDiagnostic).verifiable(typemoq.Times.atLeastOnce());
    commandFactory.setup(f => f.createCommand(typemoq.It.isAny(), typemoq.It.isAny())).verifiable(typemoq.Times.never());
    messageHandler.setup(m => m.handle(typemoq.It.isAny(), typemoq.It.isAny())).verifiable(typemoq.Times.never());
    yield diagnosticService.handle([diagnostic.object]);
    filterService.verifyAll();
    diagnostic.verifyAll();
    commandFactory.verifyAll();
    messageHandler.verifyAll();
  }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImVudlBhdGhWYXJpYWJsZS51bml0LnRlc3QuanMiXSwibmFtZXMiOlsiX19hd2FpdGVyIiwidGhpc0FyZyIsIl9hcmd1bWVudHMiLCJQIiwiZ2VuZXJhdG9yIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJmdWxmaWxsZWQiLCJ2YWx1ZSIsInN0ZXAiLCJuZXh0IiwiZSIsInJlamVjdGVkIiwicmVzdWx0IiwiZG9uZSIsInRoZW4iLCJhcHBseSIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZXhwb3J0cyIsImNoYWlfMSIsInJlcXVpcmUiLCJwYXRoIiwidHlwZW1vcSIsInZzY29kZV8xIiwiZW52UGF0aFZhcmlhYmxlXzEiLCJ0eXBlc18xIiwiY29uc3RhbnRzXzEiLCJwcm9tcHRIYW5kbGVyXzEiLCJ0eXBlc18yIiwidHlwZXNfMyIsInR5cGVzXzQiLCJ0eXBlc181Iiwic3VpdGUiLCJkaWFnbm9zdGljU2VydmljZSIsInBsYXRmb3JtU2VydmljZSIsIm1lc3NhZ2VIYW5kbGVyIiwiZmlsdGVyU2VydmljZSIsInByb2NFbnYiLCJhcHBFbnYiLCJjb21tYW5kRmFjdG9yeSIsInBhdGhWYXJpYWJsZU5hbWUiLCJwYXRoRGVsaW1pdGVyIiwiZXh0ZW5zaW9uTmFtZSIsInNldHVwIiwic2VydmljZUNvbnRhaW5lciIsIk1vY2siLCJvZlR5cGUiLCJwIiwicmV0dXJucyIsInMiLCJnZXQiLCJJdCIsImlzVmFsdWUiLCJJUGxhdGZvcm1TZXJ2aWNlIiwib2JqZWN0IiwiSURpYWdub3N0aWNIYW5kbGVyU2VydmljZSIsIkRpYWdub3N0aWNDb21tYW5kUHJvbXB0SGFuZGxlclNlcnZpY2VJZCIsImEiLCJJQXBwbGljYXRpb25FbnZpcm9ubWVudCIsIklEaWFnbm9zdGljRmlsdGVyU2VydmljZSIsIklEaWFnbm9zdGljc0NvbW1hbmRGYWN0b3J5IiwiY3VycmVudFByb2MiLCJlbnYiLCJJQ3VycmVudFByb2Nlc3MiLCJwYXRoVXRpbHMiLCJkZWxpbWl0ZXIiLCJJUGF0aFV0aWxzIiwiRW52aXJvbm1lbnRQYXRoVmFyaWFibGVEaWFnbm9zdGljc1NlcnZpY2UiLCJ0ZXN0IiwiZGlhZ25vc3RpYyIsImQiLCJjb2RlIiwiRGlhZ25vc3RpY0NvZGVzIiwiSW52YWxpZEVudmlyb25tZW50UGF0aFZhcmlhYmxlRGlhZ25vc3RpYyIsInZlcmlmaWFibGUiLCJUaW1lcyIsImF0TGVhc3RPbmNlIiwiY2FuSGFuZGxlIiwiZXhwZWN0IiwidG8iLCJiZSIsImVxdWFsIiwidmVyaWZ5QWxsIiwiaXNNYWMiLCJpc0xpbnV4IiwiaXNXaW5kb3dzIiwiZGlhZ25vc3RpY3MiLCJkaWFnbm9zZSIsImRlZXAiLCJwYXRocyIsImpvaW4iLCJsZW5ndGhPZiIsIm1lc3NhZ2UiLCJjb250YWluIiwic2V2ZXJpdHkiLCJEaWFnbm9zdGljU2V2ZXJpdHkiLCJXYXJuaW5nIiwic2NvcGUiLCJEaWFnbm9zdGljU2NvcGUiLCJHbG9iYWwiLCJhbHdheXNJZ25vcmVDb21tYW5kIiwiZiIsImNyZWF0ZUNvbW1hbmQiLCJpc0FueSIsImlzT2JqZWN0V2l0aCIsInR5cGUiLCJvcHRpb25zIiwib25jZSIsImxhdW5jaEJyb3dzZXJDb21tYW5kIiwibSIsImhhbmRsZSIsInNob3VsZElnbm9yZURpYWdub3N0aWMiLCJuZXZlciJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFK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QUMsQ0FBQ0MsSUFBeEIsRUFDS3ZCLE9BREwsQ0FDYSxNQUFNdEIsV0FBVyxDQUFDOEMsZUFBWixDQUE0QkMsd0NBRC9DLEVBRUtDLFVBRkwsQ0FFZ0JwRCxPQUFPLENBQUNxRCxLQUFSLENBQWNDLFdBQWQsRUFGaEI7QUFHQXJDLElBQUFBLGNBQWMsQ0FBQ0ksS0FBZixDQUFxQjBELENBQUMsSUFBSUEsQ0FBQyxDQUFDQyxhQUFGLENBQWdCaEYsT0FBTyxDQUFDNkIsRUFBUixDQUFXb0QsS0FBWCxFQUFoQixFQUFvQ2pGLE9BQU8sQ0FBQzZCLEVBQVIsQ0FBV29ELEtBQVgsRUFBcEMsQ0FBMUIsRUFDSzdCLFVBREwsQ0FDZ0JwRCxPQUFPLENBQUNxRCxLQUFSLENBQWNxQyxLQUFkLEVBRGhCO0FBRUE3RSxJQUFBQSxjQUFjLENBQUNRLEtBQWYsQ0FBcUJrRSxDQUFDLElBQUlBLENBQUMsQ0FBQ0MsTUFBRixDQUFTeEYsT0FBTyxDQUFDNkIsRUFBUixDQUFXb0QsS0FBWCxFQUFULEVBQTZCakYsT0FBTyxDQUFDNkIsRUFBUixDQUFXb0QsS0FBWCxFQUE3QixDQUExQixFQUNLN0IsVUFETCxDQUNnQnBELE9BQU8sQ0FBQ3FELEtBQVIsQ0FBY3FDLEtBQWQsRUFEaEI7QUFFQSxVQUFNL0UsaUJBQWlCLENBQUM2RSxNQUFsQixDQUF5QixDQUFDekMsVUFBVSxDQUFDZixNQUFaLENBQXpCLENBQU47QUFDQWxCLElBQUFBLGFBQWEsQ0FBQzhDLFNBQWQ7QUFDQWIsSUFBQUEsVUFBVSxDQUFDYSxTQUFYO0FBQ0EzQyxJQUFBQSxjQUFjLENBQUMyQyxTQUFmO0FBQ0EvQyxJQUFBQSxjQUFjLENBQUMrQyxTQUFmO0FBQ0gsR0FsQjJGLENBQXhGLENBQUo7QUFtQkgsQ0FySkksQ0FBTCIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvcHlyaWdodCAoYykgTWljcm9zb2Z0IENvcnBvcmF0aW9uLiBBbGwgcmlnaHRzIHJlc2VydmVkLlxyXG4vLyBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuXHJcbid1c2Ugc3RyaWN0JztcclxudmFyIF9fYXdhaXRlciA9ICh0aGlzICYmIHRoaXMuX19hd2FpdGVyKSB8fCBmdW5jdGlvbiAodGhpc0FyZywgX2FyZ3VtZW50cywgUCwgZ2VuZXJhdG9yKSB7XHJcbiAgICByZXR1cm4gbmV3IChQIHx8IChQID0gUHJvbWlzZSkpKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICBmdW5jdGlvbiBmdWxmaWxsZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3IubmV4dCh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gcmVqZWN0ZWQodmFsdWUpIHsgdHJ5IHsgc3RlcChnZW5lcmF0b3JbXCJ0aHJvd1wiXSh2YWx1ZSkpOyB9IGNhdGNoIChlKSB7IHJlamVjdChlKTsgfSB9XHJcbiAgICAgICAgZnVuY3Rpb24gc3RlcChyZXN1bHQpIHsgcmVzdWx0LmRvbmUgPyByZXNvbHZlKHJlc3VsdC52YWx1ZSkgOiBuZXcgUChmdW5jdGlvbiAocmVzb2x2ZSkgeyByZXNvbHZlKHJlc3VsdC52YWx1ZSk7IH0pLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCk7IH1cclxuICAgICAgICBzdGVwKChnZW5lcmF0b3IgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSkpLm5leHQoKSk7XHJcbiAgICB9KTtcclxufTtcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7IHZhbHVlOiB0cnVlIH0pO1xyXG5jb25zdCBjaGFpXzEgPSByZXF1aXJlKFwiY2hhaVwiKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xyXG5jb25zdCB0eXBlbW9xID0gcmVxdWlyZShcInR5cGVtb3FcIik7XHJcbmNvbnN0IHZzY29kZV8xID0gcmVxdWlyZShcInZzY29kZVwiKTtcclxuY29uc3QgZW52UGF0aFZhcmlhYmxlXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2FwcGxpY2F0aW9uL2RpYWdub3N0aWNzL2NoZWNrcy9lbnZQYXRoVmFyaWFibGVcIik7XHJcbmNvbnN0IHR5cGVzXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2FwcGxpY2F0aW9uL2RpYWdub3N0aWNzL2NvbW1hbmRzL3R5cGVzXCIpO1xyXG5jb25zdCBjb25zdGFudHNfMSA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9jbGllbnQvYXBwbGljYXRpb24vZGlhZ25vc3RpY3MvY29uc3RhbnRzXCIpO1xyXG5jb25zdCBwcm9tcHRIYW5kbGVyXzEgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2FwcGxpY2F0aW9uL2RpYWdub3N0aWNzL3Byb21wdEhhbmRsZXJcIik7XHJcbmNvbnN0IHR5cGVzXzIgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2FwcGxpY2F0aW9uL2RpYWdub3N0aWNzL3R5cGVzXCIpO1xyXG5jb25zdCB0eXBlc18zID0gcmVxdWlyZShcIi4uLy4uLy4uLy4uL2NsaWVudC9jb21tb24vYXBwbGljYXRpb24vdHlwZXNcIik7XHJcbmNvbnN0IHR5cGVzXzQgPSByZXF1aXJlKFwiLi4vLi4vLi4vLi4vY2xpZW50L2NvbW1vbi9wbGF0Zm9ybS90eXBlc1wiKTtcclxuY29uc3QgdHlwZXNfNSA9IHJlcXVpcmUoXCIuLi8uLi8uLi8uLi9jbGllbnQvY29tbW9uL3R5cGVzXCIpO1xyXG4vLyB0c2xpbnQ6ZGlzYWJsZS1uZXh0LWxpbmU6bWF4LWZ1bmMtYm9keS1sZW5ndGhcclxuc3VpdGUoJ0FwcGxpY2F0aW9uIERpYWdub3N0aWNzIC0gQ2hlY2tzIEVudiBQYXRoIFZhcmlhYmxlJywgKCkgPT4ge1xyXG4gICAgbGV0IGRpYWdub3N0aWNTZXJ2aWNlO1xyXG4gICAgbGV0IHBsYXRmb3JtU2VydmljZTtcclxuICAgIGxldCBtZXNzYWdlSGFuZGxlcjtcclxuICAgIGxldCBmaWx0ZXJTZXJ2aWNlO1xyXG4gICAgbGV0IHByb2NFbnY7XHJcbiAgICBsZXQgYXBwRW52O1xyXG4gICAgbGV0IGNvbW1hbmRGYWN0b3J5O1xyXG4gICAgY29uc3QgcGF0aFZhcmlhYmxlTmFtZSA9ICdQYXRoJztcclxuICAgIGNvbnN0IHBhdGhEZWxpbWl0ZXIgPSAnOyc7XHJcbiAgICBjb25zdCBleHRlbnNpb25OYW1lID0gJ1NvbWUgRXh0ZW5zaW9uIE5hbWUnO1xyXG4gICAgc2V0dXAoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHNlcnZpY2VDb250YWluZXIgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgcGxhdGZvcm1TZXJ2aWNlID0gdHlwZW1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZS5zZXR1cChwID0+IHAucGF0aFZhcmlhYmxlTmFtZSkucmV0dXJucygoKSA9PiBwYXRoVmFyaWFibGVOYW1lKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKHMgPT4gcy5nZXQodHlwZW1vcS5JdC5pc1ZhbHVlKHR5cGVzXzQuSVBsYXRmb3JtU2VydmljZSkpKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiBwbGF0Zm9ybVNlcnZpY2Uub2JqZWN0KTtcclxuICAgICAgICBtZXNzYWdlSGFuZGxlciA9IHR5cGVtb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKHMgPT4gcy5nZXQodHlwZW1vcS5JdC5pc1ZhbHVlKHR5cGVzXzIuSURpYWdub3N0aWNIYW5kbGVyU2VydmljZSksIHR5cGVtb3EuSXQuaXNWYWx1ZShwcm9tcHRIYW5kbGVyXzEuRGlhZ25vc3RpY0NvbW1hbmRQcm9tcHRIYW5kbGVyU2VydmljZUlkKSkpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IG1lc3NhZ2VIYW5kbGVyLm9iamVjdCk7XHJcbiAgICAgICAgYXBwRW52ID0gdHlwZW1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGFwcEVudi5zZXR1cChhID0+IGEuZXh0ZW5zaW9uTmFtZSkucmV0dXJucygoKSA9PiBleHRlbnNpb25OYW1lKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKHMgPT4gcy5nZXQodHlwZW1vcS5JdC5pc1ZhbHVlKHR5cGVzXzMuSUFwcGxpY2F0aW9uRW52aXJvbm1lbnQpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gYXBwRW52Lm9iamVjdCk7XHJcbiAgICAgICAgZmlsdGVyU2VydmljZSA9IHR5cGVtb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKHMgPT4gcy5nZXQodHlwZW1vcS5JdC5pc1ZhbHVlKHR5cGVzXzIuSURpYWdub3N0aWNGaWx0ZXJTZXJ2aWNlKSkpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IGZpbHRlclNlcnZpY2Uub2JqZWN0KTtcclxuICAgICAgICBjb21tYW5kRmFjdG9yeSA9IHR5cGVtb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBzZXJ2aWNlQ29udGFpbmVyLnNldHVwKHMgPT4gcy5nZXQodHlwZW1vcS5JdC5pc1ZhbHVlKHR5cGVzXzEuSURpYWdub3N0aWNzQ29tbWFuZEZhY3RvcnkpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gY29tbWFuZEZhY3Rvcnkub2JqZWN0KTtcclxuICAgICAgICBjb25zdCBjdXJyZW50UHJvYyA9IHR5cGVtb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBwcm9jRW52ID0gdHlwZW1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGN1cnJlbnRQcm9jLnNldHVwKHAgPT4gcC5lbnYpLnJldHVybnMoKCkgPT4gcHJvY0Vudi5vYmplY3QpO1xyXG4gICAgICAgIHNlcnZpY2VDb250YWluZXIuc2V0dXAocyA9PiBzLmdldCh0eXBlbW9xLkl0LmlzVmFsdWUodHlwZXNfNS5JQ3VycmVudFByb2Nlc3MpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gY3VycmVudFByb2Mub2JqZWN0KTtcclxuICAgICAgICBjb25zdCBwYXRoVXRpbHMgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgcGF0aFV0aWxzLnNldHVwKHAgPT4gcC5kZWxpbWl0ZXIpLnJldHVybnMoKCkgPT4gcGF0aERlbGltaXRlcik7XHJcbiAgICAgICAgc2VydmljZUNvbnRhaW5lci5zZXR1cChzID0+IHMuZ2V0KHR5cGVtb3EuSXQuaXNWYWx1ZSh0eXBlc181LklQYXRoVXRpbHMpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gcGF0aFV0aWxzLm9iamVjdCk7XHJcbiAgICAgICAgZGlhZ25vc3RpY1NlcnZpY2UgPSBuZXcgZW52UGF0aFZhcmlhYmxlXzEuRW52aXJvbm1lbnRQYXRoVmFyaWFibGVEaWFnbm9zdGljc1NlcnZpY2Uoc2VydmljZUNvbnRhaW5lci5vYmplY3QpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdDYW4gaGFuZGxlIEVudlBhdGhWYXJpYWJsZSBkaWFnbm9zdGljcycsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBkaWFnbm9zdGljID0gdHlwZW1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGRpYWdub3N0aWMuc2V0dXAoZCA9PiBkLmNvZGUpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IGNvbnN0YW50c18xLkRpYWdub3N0aWNDb2Rlcy5JbnZhbGlkRW52aXJvbm1lbnRQYXRoVmFyaWFibGVEaWFnbm9zdGljKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IGNhbkhhbmRsZSA9IHlpZWxkIGRpYWdub3N0aWNTZXJ2aWNlLmNhbkhhbmRsZShkaWFnbm9zdGljLm9iamVjdCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChjYW5IYW5kbGUpLnRvLmJlLmVxdWFsKHRydWUsICdJbnZhbGlkIHZhbHVlJyk7XHJcbiAgICAgICAgZGlhZ25vc3RpYy52ZXJpZnlBbGwoKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0NhbiBub3QgaGFuZGxlIG5vbi1FbnZQYXRoVmFyaWFibGUgZGlhZ25vc3RpY3MnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgZGlhZ25vc3RpYyA9IHR5cGVtb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBkaWFnbm9zdGljLnNldHVwKGQgPT4gZC5jb2RlKVxyXG4gICAgICAgICAgICAucmV0dXJucygoKSA9PiAnU29tZXRoaW5nIEVsc2UnKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLmF0TGVhc3RPbmNlKCkpO1xyXG4gICAgICAgIGNvbnN0IGNhbkhhbmRsZSA9IHlpZWxkIGRpYWdub3N0aWNTZXJ2aWNlLmNhbkhhbmRsZShkaWFnbm9zdGljLm9iamVjdCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChjYW5IYW5kbGUpLnRvLmJlLmVxdWFsKGZhbHNlLCAnSW52YWxpZCB2YWx1ZScpO1xyXG4gICAgICAgIGRpYWdub3N0aWMudmVyaWZ5QWxsKCk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdTaG91bGQgcmV0dXJuIGVtcHR5IGRpYWdub3N0aWNzIGZvciBNYWMnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgcGxhdGZvcm1TZXJ2aWNlLnNldHVwKHAgPT4gcC5pc01hYykucmV0dXJucygoKSA9PiB0cnVlKTtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzTGludXgpLnJldHVybnMoKCkgPT4gZmFsc2UpO1xyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZS5zZXR1cChwID0+IHAuaXNXaW5kb3dzKS5yZXR1cm5zKCgpID0+IGZhbHNlKTtcclxuICAgICAgICBjb25zdCBkaWFnbm9zdGljcyA9IHlpZWxkIGRpYWdub3N0aWNTZXJ2aWNlLmRpYWdub3NlKCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChkaWFnbm9zdGljcykudG8uYmUuZGVlcC5lcXVhbChbXSk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdTaG91bGQgcmV0dXJuIGVtcHR5IGRpYWdub3N0aWNzIGZvciBMaW51eCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzTWFjKS5yZXR1cm5zKCgpID0+IGZhbHNlKTtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzTGludXgpLnJldHVybnMoKCkgPT4gdHJ1ZSk7XHJcbiAgICAgICAgcGxhdGZvcm1TZXJ2aWNlLnNldHVwKHAgPT4gcC5pc1dpbmRvd3MpLnJldHVybnMoKCkgPT4gZmFsc2UpO1xyXG4gICAgICAgIGNvbnN0IGRpYWdub3N0aWNzID0geWllbGQgZGlhZ25vc3RpY1NlcnZpY2UuZGlhZ25vc2UoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGRpYWdub3N0aWNzKS50by5iZS5kZWVwLmVxdWFsKFtdKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ1Nob3VsZCByZXR1cm4gZW1wdHkgZGlhZ25vc3RpY3MgZm9yIFdpbmRvd3MgaWYgcGF0aCB2YXJpYWJsZSBpcyB2YWxpZCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzV2luZG93cykucmV0dXJucygoKSA9PiB0cnVlKTtcclxuICAgICAgICBjb25zdCBwYXRocyA9IFtcclxuICAgICAgICAgICAgcGF0aC5qb2luKCdvbmUnLCAndHdvJywgJ3RocmVlJyksXHJcbiAgICAgICAgICAgIHBhdGguam9pbignb25lJywgJ3R3bycsICdmb3VyJylcclxuICAgICAgICBdLmpvaW4ocGF0aERlbGltaXRlcik7XHJcbiAgICAgICAgcHJvY0Vudi5zZXR1cChlbnYgPT4gZW52W3BhdGhWYXJpYWJsZU5hbWVdKS5yZXR1cm5zKCgpID0+IHBhdGhzKTtcclxuICAgICAgICBjb25zdCBkaWFnbm9zdGljcyA9IHlpZWxkIGRpYWdub3N0aWNTZXJ2aWNlLmRpYWdub3NlKCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChkaWFnbm9zdGljcykudG8uYmUuZGVlcC5lcXVhbChbXSk7XHJcbiAgICB9KSk7XHJcbiAgICAvLyBOb3RlOiBPbiB3aW5kb3dzLCB3aGVuIGEgcGF0aCBjb250YWlucyBhIGA7YCB0aGVuIFdpbmRvd3MgZW5jbG9zZXMgdGhlIHBhdGggd2l0aGluIGBcImAuXHJcbiAgICB0ZXN0KCdTaG91bGQgcmV0dXJuIHNpbmdsZSBkaWFnbm9zdGljcyBmb3IgV2luZG93cyBpZiBwYXRoIGNvbnRhaW5zIFxcJ1wiXFwnJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZS5zZXR1cChwID0+IHAuaXNXaW5kb3dzKS5yZXR1cm5zKCgpID0+IHRydWUpO1xyXG4gICAgICAgIGNvbnN0IHBhdGhzID0gW1xyXG4gICAgICAgICAgICBwYXRoLmpvaW4oJ29uZScsICd0d28nLCAndGhyZWVcIicpLFxyXG4gICAgICAgICAgICBwYXRoLmpvaW4oJ29uZScsICd0d28nLCAnZm91cicpXHJcbiAgICAgICAgXS5qb2luKHBhdGhEZWxpbWl0ZXIpO1xyXG4gICAgICAgIHByb2NFbnYuc2V0dXAoZW52ID0+IGVudltwYXRoVmFyaWFibGVOYW1lXSkucmV0dXJucygoKSA9PiBwYXRocyk7XHJcbiAgICAgICAgY29uc3QgZGlhZ25vc3RpY3MgPSB5aWVsZCBkaWFnbm9zdGljU2VydmljZS5kaWFnbm9zZSgpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoZGlhZ25vc3RpY3MpLnRvLmJlLmxlbmd0aE9mKDEpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoZGlhZ25vc3RpY3NbMF0uY29kZSkudG8uYmUuZXF1YWwoY29uc3RhbnRzXzEuRGlhZ25vc3RpY0NvZGVzLkludmFsaWRFbnZpcm9ubWVudFBhdGhWYXJpYWJsZURpYWdub3N0aWMpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoZGlhZ25vc3RpY3NbMF0ubWVzc2FnZSkudG8uY29udGFpbihleHRlbnNpb25OYW1lKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGRpYWdub3N0aWNzWzBdLm1lc3NhZ2UpLnRvLmNvbnRhaW4ocGF0aFZhcmlhYmxlTmFtZSk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChkaWFnbm9zdGljc1swXS5zZXZlcml0eSkudG8uYmUuZXF1YWwodnNjb2RlXzEuRGlhZ25vc3RpY1NldmVyaXR5Lldhcm5pbmcpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoZGlhZ25vc3RpY3NbMF0uc2NvcGUpLnRvLmJlLmVxdWFsKHR5cGVzXzIuRGlhZ25vc3RpY1Njb3BlLkdsb2JhbCk7XHJcbiAgICB9KSk7XHJcbiAgICB0ZXN0KCdTaG91bGQgbm90IHJldHVybiBkaWFnbm9zdGljcyBmb3IgV2luZG93cyBpZiBwYXRoIGVuZHMgd2l0aCBkZWxpbWl0ZXInLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgcGF0aHMgPSBbXHJcbiAgICAgICAgICAgIHBhdGguam9pbignb25lJywgJ3R3bycsICd0aHJlZScpLFxyXG4gICAgICAgICAgICBwYXRoLmpvaW4oJ29uZScsICd0d28nLCAnZm91cicpXHJcbiAgICAgICAgXS5qb2luKHBhdGhEZWxpbWl0ZXIpICsgcGF0aERlbGltaXRlcjtcclxuICAgICAgICBwbGF0Zm9ybVNlcnZpY2Uuc2V0dXAocCA9PiBwLmlzV2luZG93cykucmV0dXJucygoKSA9PiB0cnVlKTtcclxuICAgICAgICBwcm9jRW52LnNldHVwKGVudiA9PiBlbnZbcGF0aFZhcmlhYmxlTmFtZV0pLnJldHVybnMoKCkgPT4gcGF0aHMpO1xyXG4gICAgICAgIGNvbnN0IGRpYWdub3N0aWNzID0geWllbGQgZGlhZ25vc3RpY1NlcnZpY2UuZGlhZ25vc2UoKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGRpYWdub3N0aWNzKS50by5iZS5sZW5ndGhPZigwKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ1Nob3VsZCBkaXNwbGF5IHRocmVlIG9wdGlvbnMgaW4gbWVzc2FnZSBkaXNwbGF5ZWQgd2l0aCAyIGNvbW1hbmRzJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZS5zZXR1cChwID0+IHAuaXNXaW5kb3dzKS5yZXR1cm5zKCgpID0+IHRydWUpO1xyXG4gICAgICAgIGNvbnN0IGRpYWdub3N0aWMgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgZGlhZ25vc3RpYy5zZXR1cChkID0+IGQuY29kZSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gY29uc3RhbnRzXzEuRGlhZ25vc3RpY0NvZGVzLkludmFsaWRFbnZpcm9ubWVudFBhdGhWYXJpYWJsZURpYWdub3N0aWMpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKHR5cGVtb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgYWx3YXlzSWdub3JlQ29tbWFuZCA9IHR5cGVtb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBjb21tYW5kRmFjdG9yeS5zZXR1cChmID0+IGYuY3JlYXRlQ29tbWFuZCh0eXBlbW9xLkl0LmlzQW55KCksIHR5cGVtb3EuSXQuaXNPYmplY3RXaXRoKHsgdHlwZTogJ2lnbm9yZScsIG9wdGlvbnM6IHR5cGVzXzIuRGlhZ25vc3RpY1Njb3BlLkdsb2JhbCB9KSkpXHJcbiAgICAgICAgICAgIC5yZXR1cm5zKCgpID0+IGFsd2F5c0lnbm9yZUNvbW1hbmQub2JqZWN0KVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgY29uc3QgbGF1bmNoQnJvd3NlckNvbW1hbmQgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgY29tbWFuZEZhY3Rvcnkuc2V0dXAoZiA9PiBmLmNyZWF0ZUNvbW1hbmQodHlwZW1vcS5JdC5pc0FueSgpLCB0eXBlbW9xLkl0LmlzT2JqZWN0V2l0aCh7IHR5cGU6ICdsYXVuY2gnIH0pKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gbGF1bmNoQnJvd3NlckNvbW1hbmQub2JqZWN0KVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgbWVzc2FnZUhhbmRsZXIuc2V0dXAobSA9PiBtLmhhbmRsZSh0eXBlbW9xLkl0LmlzQW55KCksIHR5cGVtb3EuSXQuaXNBbnkoKSkpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKHR5cGVtb3EuVGltZXMub25jZSgpKTtcclxuICAgICAgICB5aWVsZCBkaWFnbm9zdGljU2VydmljZS5oYW5kbGUoW2RpYWdub3N0aWMub2JqZWN0XSk7XHJcbiAgICAgICAgZGlhZ25vc3RpYy52ZXJpZnlBbGwoKTtcclxuICAgICAgICBjb21tYW5kRmFjdG9yeS52ZXJpZnlBbGwoKTtcclxuICAgICAgICBtZXNzYWdlSGFuZGxlci52ZXJpZnlBbGwoKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ1Nob3VsZCBub3QgZGlzcGxheSBhIG1lc3NhZ2UgaWYgdGhlIGRpYWdub3N0aWMgY29kZSBoYXMgYmVlbiBpZ25vcmVkJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIHBsYXRmb3JtU2VydmljZS5zZXR1cChwID0+IHAuaXNXaW5kb3dzKS5yZXR1cm5zKCgpID0+IHRydWUpO1xyXG4gICAgICAgIGNvbnN0IGRpYWdub3N0aWMgPSB0eXBlbW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgZmlsdGVyU2VydmljZS5zZXR1cChmID0+IGYuc2hvdWxkSWdub3JlRGlhZ25vc3RpYyh0eXBlbW9xLkl0LmlzVmFsdWUoY29uc3RhbnRzXzEuRGlhZ25vc3RpY0NvZGVzLkludmFsaWRFbnZpcm9ubWVudFBhdGhWYXJpYWJsZURpYWdub3N0aWMpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHRydWUpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm9uY2UoKSk7XHJcbiAgICAgICAgZGlhZ25vc3RpYy5zZXR1cChkID0+IGQuY29kZSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gY29uc3RhbnRzXzEuRGlhZ25vc3RpY0NvZGVzLkludmFsaWRFbnZpcm9ubWVudFBhdGhWYXJpYWJsZURpYWdub3N0aWMpXHJcbiAgICAgICAgICAgIC52ZXJpZmlhYmxlKHR5cGVtb3EuVGltZXMuYXRMZWFzdE9uY2UoKSk7XHJcbiAgICAgICAgY29tbWFuZEZhY3Rvcnkuc2V0dXAoZiA9PiBmLmNyZWF0ZUNvbW1hbmQodHlwZW1vcS5JdC5pc0FueSgpLCB0eXBlbW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm5ldmVyKCkpO1xyXG4gICAgICAgIG1lc3NhZ2VIYW5kbGVyLnNldHVwKG0gPT4gbS5oYW5kbGUodHlwZW1vcS5JdC5pc0FueSgpLCB0eXBlbW9xLkl0LmlzQW55KCkpKVxyXG4gICAgICAgICAgICAudmVyaWZpYWJsZSh0eXBlbW9xLlRpbWVzLm5ldmVyKCkpO1xyXG4gICAgICAgIHlpZWxkIGRpYWdub3N0aWNTZXJ2aWNlLmhhbmRsZShbZGlhZ25vc3RpYy5vYmplY3RdKTtcclxuICAgICAgICBmaWx0ZXJTZXJ2aWNlLnZlcmlmeUFsbCgpO1xyXG4gICAgICAgIGRpYWdub3N0aWMudmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgY29tbWFuZEZhY3RvcnkudmVyaWZ5QWxsKCk7XHJcbiAgICAgICAgbWVzc2FnZUhhbmRsZXIudmVyaWZ5QWxsKCk7XHJcbiAgICB9KSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1lbnZQYXRoVmFyaWFibGUudW5pdC50ZXN0LmpzLm1hcCJdfQ==