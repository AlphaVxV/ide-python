// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
'use strict';

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
}); // tslint:disable:max-func-body-length

const chai_1 = require("chai");

const chaipromise = require("chai-as-promised");

const TypeMoq = require("typemoq");

const vscode_1 = require("vscode");

const jediProxyFactory_1 = require("../../client/languageServices/jediProxyFactory");

const providerUtilities_1 = require("../../client/providers/providerUtilities");

const signatureProvider_1 = require("../../client/providers/signatureProvider");

chai_1.use(chaipromise);
suite('Signature Provider unit tests', () => {
  let pySignatureProvider;
  let jediHandler;
  let argResultItems;
  setup(() => {
    const jediFactory = TypeMoq.Mock.ofType(jediProxyFactory_1.JediFactory);
    jediHandler = TypeMoq.Mock.ofType();
    jediFactory.setup(j => j.getJediProxyHandler(TypeMoq.It.isAny())).returns(() => jediHandler.object);
    pySignatureProvider = new signatureProvider_1.PythonSignatureProvider(jediFactory.object);
    argResultItems = {
      definitions: [{
        description: 'The result',
        docstring: 'Some docstring goes here.',
        name: 'print',
        paramindex: 0,
        params: [{
          description: 'Some parameter',
          docstring: 'gimme docs',
          name: 'param',
          value: 'blah'
        }]
      }],
      requestId: 1
    };
  });

  function testSignatureReturns(source, pos) {
    const doc = TypeMoq.Mock.ofType();
    const position = new vscode_1.Position(0, pos);
    const lineText = TypeMoq.Mock.ofType();
    const argsResult = TypeMoq.Mock.ofType();
    const cancelToken = TypeMoq.Mock.ofType();
    cancelToken.setup(ct => ct.isCancellationRequested).returns(() => false);
    doc.setup(d => d.fileName).returns(() => '');
    doc.setup(d => d.getText(TypeMoq.It.isAny())).returns(() => source);
    doc.setup(d => d.lineAt(TypeMoq.It.isAny())).returns(() => lineText.object);
    doc.setup(d => d.offsetAt(TypeMoq.It.isAny())).returns(() => pos - 1); // pos is 1-based

    const docUri = TypeMoq.Mock.ofType();
    docUri.setup(u => u.scheme).returns(() => 'http');
    doc.setup(d => d.uri).returns(() => docUri.object);
    lineText.setup(l => l.text).returns(() => source);
    argsResult.setup(c => c.requestId).returns(() => 1);
    argsResult.setup(c => c.definitions).returns(() => argResultItems[0].definitions);
    jediHandler.setup(j => j.sendCommand(TypeMoq.It.isAny(), TypeMoq.It.isAny())).returns(() => {
      return Promise.resolve(argResultItems);
    });
    return pySignatureProvider.provideSignatureHelp(doc.object, position, cancelToken.object);
  }

  function testIsInsideStringOrComment(sourceLine, sourcePos) {
    const textLine = TypeMoq.Mock.ofType();
    textLine.setup(t => t.text).returns(() => sourceLine);
    const doc = TypeMoq.Mock.ofType();
    const pos = new vscode_1.Position(1, sourcePos);
    doc.setup(d => d.fileName).returns(() => '');
    doc.setup(d => d.getText(TypeMoq.It.isAny())).returns(() => sourceLine);
    doc.setup(d => d.lineAt(TypeMoq.It.isAny())).returns(() => textLine.object);
    doc.setup(d => d.offsetAt(TypeMoq.It.isAny())).returns(() => sourcePos);
    return providerUtilities_1.isPositionInsideStringOrComment(doc.object, pos);
  }

  test('Ensure no signature is given within a string.', () => __awaiter(void 0, void 0, void 0, function* () {
    const source = '  print(\'Python is awesome,\')\n';
    const sigHelp = yield testSignatureReturns(source, 27);
    chai_1.expect(sigHelp).to.not.be.equal(undefined, 'Expected to get a blank signature item back - did the pattern change here?');
    chai_1.expect(sigHelp.signatures.length).to.equal(0, 'Signature provided for symbols within a string?');
  }));
  test('Ensure no signature is given within a line comment.', () => __awaiter(void 0, void 0, void 0, function* () {
    const source = '#  print(\'Python is awesome,\')\n';
    const sigHelp = yield testSignatureReturns(source, 28);
    chai_1.expect(sigHelp).to.not.be.equal(undefined, 'Expected to get a blank signature item back - did the pattern change here?');
    chai_1.expect(sigHelp.signatures.length).to.equal(0, 'Signature provided for symbols within a full-line comment?');
  }));
  test('Ensure no signature is given within a comment tailing a command.', () => __awaiter(void 0, void 0, void 0, function* () {
    const source = '  print(\'Python\') # print(\'is awesome,\')\n';
    const sigHelp = yield testSignatureReturns(source, 38);
    chai_1.expect(sigHelp).to.not.be.equal(undefined, 'Expected to get a blank signature item back - did the pattern change here?');
    chai_1.expect(sigHelp.signatures.length).to.equal(0, 'Signature provided for symbols within a trailing comment?');
  }));
  test('Ensure signature is given for built-in print command.', () => __awaiter(void 0, void 0, void 0, function* () {
    const source = '  print(\'Python\',)\n';
    let sigHelp;

    try {
      sigHelp = yield testSignatureReturns(source, 18);
      chai_1.expect(sigHelp).to.not.equal(undefined, 'Expected to get a blank signature item back - did the pattern change here?');
      chai_1.expect(sigHelp.signatures.length).to.not.equal(0, 'Expected dummy argresult back from testing our print signature.');
      chai_1.expect(sigHelp.activeParameter).to.be.equal(0, 'Parameter for print should be the first member of the test argresult\'s params object.');
      chai_1.expect(sigHelp.activeSignature).to.be.equal(0, 'The signature for print should be the first member of the test argresult.');
      chai_1.expect(sigHelp.signatures[sigHelp.activeSignature].label).to.be.equal('print(param)', `Expected arg result calls for specific returned signature of \'print(param)\' but we got ${sigHelp.signatures[sigHelp.activeSignature].label}`);
    } catch (error) {
      chai_1.assert(false, `Caught exception ${error}`);
    }
  }));
  test('Ensure isPositionInsideStringOrComment is behaving as expected.', () => {
    const sourceLine = '  print(\'Hello world!\')\n';
    const sourcePos = sourceLine.length - 1;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.not.be.equal(true, [`Position set to the end of ${sourceLine} but `, 'is reported as being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected at end of source.', () => {
    const sourceLine = '  print(\'Hello world!\')\n';
    const sourcePos = 0;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.not.be.equal(true, [`Position set to the end of ${sourceLine} but `, 'is reported as being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected at beginning of source.', () => {
    const sourceLine = '  print(\'Hello world!\')\n';
    const sourcePos = 0;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.not.be.equal(true, [`Position set to the beginning of ${sourceLine} but `, 'is reported as being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected within a string.', () => {
    const sourceLine = '  print(\'Hello world!\')\n';
    const sourcePos = 16;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within the string in ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected immediately before a string.', () => {
    const sourceLine = '  print(\'Hello world!\')\n';
    const sourcePos = 8;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(false, [`Position set to just before the string in ${sourceLine} (position ${sourcePos}) but `, 'is reported as being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected immediately in a string.', () => {
    const sourceLine = '  print(\'Hello world!\')\n';
    const sourcePos = 9;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set to the start of the string in ${sourceLine} (position ${sourcePos}) but `, 'is reported as being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected within a comment.', () => {
    const sourceLine = '#  print(\'Hello world!\')\n';
    const sourcePos = 16;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a full line comment ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected within a trailing comment.', () => {
    const sourceLine = '  print(\'Hello world!\') # some comment...\n';
    const sourcePos = 34;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a trailing line comment ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected at the very end of a trailing comment.', () => {
    const sourceLine = '  print(\'Hello world!\') # some comment...\n';
    const sourcePos = sourceLine.length - 1;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a trailing line comment ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected within a multiline string.', () => {
    const sourceLine = '  stringVal = \'\'\'This is a multiline\nstring that you can use\nto test this stuff out with\neveryday!\'\'\'\n';
    const sourcePos = 48;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a multi-line string ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected at the very last quote on a multiline string.', () => {
    const sourceLine = '  stringVal = \'\'\'This is a multiline\nstring that you can use\nto test this stuff out with\neveryday!\'\'\'\n';
    const sourcePos = sourceLine.length - 2; // just at the last '

    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a multi-line string ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected within a multiline string (double-quoted).', () => {
    const sourceLine = '  stringVal = """This is a multiline\nstring that you can use\nto test this stuff out with\neveryday!"""\n';
    const sourcePos = 48;
    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a multi-line string ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected at the very last quote on a multiline string (double-quoted).', () => {
    const sourceLine = '  stringVal = """This is a multiline\nstring that you can use\nto test this stuff out with\neveryday!"""\n';
    const sourcePos = sourceLine.length - 2; // just at the last '

    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a multi-line string ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
  test('Ensure isPositionInsideStringOrComment is behaving as expected during construction of a multiline string (double-quoted).', () => {
    const sourceLine = '  stringVal = """This is a multiline\nstring that you can use\nto test this stuff';
    const sourcePos = sourceLine.length - 1; // just at the last position in the string before it's termination

    const isInsideStrComment = testIsInsideStringOrComment(sourceLine, sourcePos);
    chai_1.expect(isInsideStrComment).to.be.equal(true, [`Position set within a multi-line string ${sourceLine} (position ${sourcePos}) but `, 'is reported as NOT being within a string or comment.'].join(''));
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInB5dGhvblNpZ25hdHVyZVByb3ZpZGVyLnVuaXQudGVzdC5qcyJdLCJuYW1lcyI6WyJfX2F3YWl0ZXIiLCJ0aGlzQXJnIiwiX2FyZ3VtZW50cyIsIlAiLCJnZW5lcmF0b3IiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsImZ1bGZpbGxlZCIsInZhbHVlIiwic3RlcCIsIm5leHQiLCJlIiwicmVqZWN0ZWQiLCJyZXN1bHQiLCJkb25lIiwidGhlbiIsImFwcGx5IiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJleHBvcnRzIiwiY2hhaV8xIiwicmVxdWlyZSIsImNoYWlwcm9taXNlIiwiVHlwZU1vcSIsInZzY29kZV8xIiwiamVkaVByb3h5RmFjdG9yeV8xIiwicHJvdmlkZXJVdGlsaXRpZXNfMSIsInNpZ25hdHVyZVByb3ZpZGVyXzEiLCJ1c2UiLCJzdWl0ZSIsInB5U2lnbmF0dXJlUHJvdmlkZXIiLCJqZWRpSGFuZGxlciIsImFyZ1Jlc3VsdEl0ZW1zIiwic2V0dXAiLCJqZWRpRmFjdG9yeSIsIk1vY2siLCJvZlR5cGUiLCJKZWRpRmFjdG9yeSIsImoiLCJnZXRKZWRpUHJveHlIYW5kbGVyIiwiSXQiLCJpc0FueSIsInJldHVybnMiLCJvYmplY3QiLCJQeXRob25TaWduYXR1cmVQcm92aWRlciIsImRlZmluaXRpb25zIiwiZGVzY3JpcHRpb24iLCJkb2NzdHJpbmciLCJuYW1lIiwicGFyYW1pbmRleCIsInBhcmFtcyIsInJlcXVlc3RJZCIsInRlc3RTaWduYXR1cmVSZXR1cm5zIiwic291cmNlIiwicG9zIiwiZG9jIiwicG9zaXRpb24iLCJQb3NpdGlvbiIsImxpbmVUZXh0IiwiYXJnc1Jlc3VsdCIsImNhbmNlbFRva2VuIiwiY3QiLCJpc0NhbmNlbGxhdGlvblJlcXVlc3RlZCIsImQiLCJmaWxlTmFtZSIsImdldFRleHQiLCJsaW5lQXQiLCJvZmZzZXRBdCIsImRvY1VyaSIsInUiLCJzY2hlbWUiLCJ1cmkiLCJsIiwidGV4dCIsImMiLCJzZW5kQ29tbWFuZCIsInByb3ZpZGVTaWduYXR1cmVIZWxwIiwidGVzdElzSW5zaWRlU3RyaW5nT3JDb21tZW50Iiwic291cmNlTGluZSIsInNvdXJjZVBvcyIsInRleHRMaW5lIiwidCIsImlzUG9zaXRpb25JbnNpZGVTdHJpbmdPckNvbW1lbnQiLCJ0ZXN0Iiwic2lnSGVscCIsImV4cGVjdCIsInRvIiwibm90IiwiYmUiLCJlcXVhbCIsInVuZGVmaW5lZCIsInNpZ25hdHVyZXMiLCJsZW5ndGgiLCJhY3RpdmVQYXJhbWV0ZXIiLCJhY3RpdmVTaWduYXR1cmUiLCJsYWJlbCIsImVycm9yIiwiYXNzZXJ0IiwiaXNJbnNpZGVTdHJDb21tZW50Iiwiam9pbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFDQTtBQUNBOztBQUNBLElBQUlBLFNBQVMsR0FBSSxVQUFRLFNBQUtBLFNBQWQsSUFBNEIsVUFBVUMsT0FBVixFQUFtQkMsVUFBbkIsRUFBK0JDLENBQS9CLEVBQWtDQyxTQUFsQyxFQUE2QztBQUNyRixTQUFPLEtBQUtELENBQUMsS0FBS0EsQ0FBQyxHQUFHRSxPQUFULENBQU4sRUFBeUIsVUFBVUMsT0FBVixFQUFtQkMsTUFBbkIsRUFBMkI7QUFDdkQsYUFBU0MsU0FBVCxDQUFtQkMsS0FBbkIsRUFBMEI7QUFBRSxVQUFJO0FBQUVDLFFBQUFBLElBQUksQ0FBQ04sU0FBUyxDQUFDTyxJQUFWLENBQWVGLEtBQWYsQ0FBRCxDQUFKO0FBQThCLE9BQXBDLENBQXFDLE9BQU9HLENBQVAsRUFBVTtBQUFFTCxRQUFBQSxNQUFNLENBQUNLLENBQUQsQ0FBTjtBQUFZO0FBQUU7O0FBQzNGLGFBQVNDLFFBQVQsQ0FBa0JKLEtBQWxCLEVBQXlCO0FBQUUsVUFBSTtBQUFFQyxRQUFBQSxJQUFJLENBQUNOLFNBQVMsQ0FBQyxPQUFELENBQVQsQ0FBbUJLLEtBQW5CLENBQUQsQ0FBSjtBQUFrQyxPQUF4QyxDQUF5QyxPQUFPRyxDQUFQLEVBQVU7QUFBRUwsUUFBQUEsTUFBTSxDQUFDSyxDQUFELENBQU47QUFBWTtBQUFFOztBQUM5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QUN6QyxVQUFNTSxrQkFBa0IsR0FBR3JCLDJCQUEyQixDQUFDQyxVQUFELEVBQWFDLFNBQWIsQ0FBdEQ7QUFDQTNELElBQUFBLE1BQU0sQ0FBQ2lFLE1BQVAsQ0FBY2Esa0JBQWQsRUFBa0NaLEVBQWxDLENBQXFDRSxFQUFyQyxDQUF3Q0MsS0FBeEMsQ0FBOEMsSUFBOUMsRUFBb0QsQ0FDL0MsMkNBQTBDWCxVQUFXLGNBQWFDLFNBQVUsUUFEN0IsRUFFaEQsc0RBRmdELEVBR2xEb0IsSUFIa0QsQ0FHN0MsRUFINkMsQ0FBcEQ7QUFJSCxHQVJHLENBQUo7QUFTSCxDQTlOSSxDQUFMIiwic291cmNlc0NvbnRlbnQiOlsiLy8gQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbi8vIExpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgTGljZW5zZS5cclxuJ3VzZSBzdHJpY3QnO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbi8vIHRzbGludDpkaXNhYmxlOm1heC1mdW5jLWJvZHktbGVuZ3RoXHJcbmNvbnN0IGNoYWlfMSA9IHJlcXVpcmUoXCJjaGFpXCIpO1xyXG5jb25zdCBjaGFpcHJvbWlzZSA9IHJlcXVpcmUoXCJjaGFpLWFzLXByb21pc2VkXCIpO1xyXG5jb25zdCBUeXBlTW9xID0gcmVxdWlyZShcInR5cGVtb3FcIik7XHJcbmNvbnN0IHZzY29kZV8xID0gcmVxdWlyZShcInZzY29kZVwiKTtcclxuY29uc3QgamVkaVByb3h5RmFjdG9yeV8xID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC9sYW5ndWFnZVNlcnZpY2VzL2plZGlQcm94eUZhY3RvcnlcIik7XHJcbmNvbnN0IHByb3ZpZGVyVXRpbGl0aWVzXzEgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L3Byb3ZpZGVycy9wcm92aWRlclV0aWxpdGllc1wiKTtcclxuY29uc3Qgc2lnbmF0dXJlUHJvdmlkZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvcHJvdmlkZXJzL3NpZ25hdHVyZVByb3ZpZGVyXCIpO1xyXG5jaGFpXzEudXNlKGNoYWlwcm9taXNlKTtcclxuc3VpdGUoJ1NpZ25hdHVyZSBQcm92aWRlciB1bml0IHRlc3RzJywgKCkgPT4ge1xyXG4gICAgbGV0IHB5U2lnbmF0dXJlUHJvdmlkZXI7XHJcbiAgICBsZXQgamVkaUhhbmRsZXI7XHJcbiAgICBsZXQgYXJnUmVzdWx0SXRlbXM7XHJcbiAgICBzZXR1cCgoKSA9PiB7XHJcbiAgICAgICAgY29uc3QgamVkaUZhY3RvcnkgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKGplZGlQcm94eUZhY3RvcnlfMS5KZWRpRmFjdG9yeSk7XHJcbiAgICAgICAgamVkaUhhbmRsZXIgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgamVkaUZhY3Rvcnkuc2V0dXAoaiA9PiBqLmdldEplZGlQcm94eUhhbmRsZXIoVHlwZU1vcS5JdC5pc0FueSgpKSlcclxuICAgICAgICAgICAgLnJldHVybnMoKCkgPT4gamVkaUhhbmRsZXIub2JqZWN0KTtcclxuICAgICAgICBweVNpZ25hdHVyZVByb3ZpZGVyID0gbmV3IHNpZ25hdHVyZVByb3ZpZGVyXzEuUHl0aG9uU2lnbmF0dXJlUHJvdmlkZXIoamVkaUZhY3Rvcnkub2JqZWN0KTtcclxuICAgICAgICBhcmdSZXN1bHRJdGVtcyA9IHtcclxuICAgICAgICAgICAgZGVmaW5pdGlvbnM6IFtcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogJ1RoZSByZXN1bHQnLFxyXG4gICAgICAgICAgICAgICAgICAgIGRvY3N0cmluZzogJ1NvbWUgZG9jc3RyaW5nIGdvZXMgaGVyZS4nLFxyXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwcmludCcsXHJcbiAgICAgICAgICAgICAgICAgICAgcGFyYW1pbmRleDogMCxcclxuICAgICAgICAgICAgICAgICAgICBwYXJhbXM6IFtcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246ICdTb21lIHBhcmFtZXRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkb2NzdHJpbmc6ICdnaW1tZSBkb2NzJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6ICdwYXJhbScsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZTogJ2JsYWgnXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIF0sXHJcbiAgICAgICAgICAgIHJlcXVlc3RJZDogMVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuICAgIGZ1bmN0aW9uIHRlc3RTaWduYXR1cmVSZXR1cm5zKHNvdXJjZSwgcG9zKSB7XHJcbiAgICAgICAgY29uc3QgZG9jID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGNvbnN0IHBvc2l0aW9uID0gbmV3IHZzY29kZV8xLlBvc2l0aW9uKDAsIHBvcyk7XHJcbiAgICAgICAgY29uc3QgbGluZVRleHQgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgY29uc3QgYXJnc1Jlc3VsdCA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBjb25zdCBjYW5jZWxUb2tlbiA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBjYW5jZWxUb2tlbi5zZXR1cChjdCA9PiBjdC5pc0NhbmNlbGxhdGlvblJlcXVlc3RlZCkucmV0dXJucygoKSA9PiBmYWxzZSk7XHJcbiAgICAgICAgZG9jLnNldHVwKGQgPT4gZC5maWxlTmFtZSkucmV0dXJucygoKSA9PiAnJyk7XHJcbiAgICAgICAgZG9jLnNldHVwKGQgPT4gZC5nZXRUZXh0KFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gc291cmNlKTtcclxuICAgICAgICBkb2Muc2V0dXAoZCA9PiBkLmxpbmVBdChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IGxpbmVUZXh0Lm9iamVjdCk7XHJcbiAgICAgICAgZG9jLnNldHVwKGQgPT4gZC5vZmZzZXRBdChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHBvcyAtIDEpOyAvLyBwb3MgaXMgMS1iYXNlZFxyXG4gICAgICAgIGNvbnN0IGRvY1VyaSA9IFR5cGVNb3EuTW9jay5vZlR5cGUoKTtcclxuICAgICAgICBkb2NVcmkuc2V0dXAodSA9PiB1LnNjaGVtZSkucmV0dXJucygoKSA9PiAnaHR0cCcpO1xyXG4gICAgICAgIGRvYy5zZXR1cChkID0+IGQudXJpKS5yZXR1cm5zKCgpID0+IGRvY1VyaS5vYmplY3QpO1xyXG4gICAgICAgIGxpbmVUZXh0LnNldHVwKGwgPT4gbC50ZXh0KS5yZXR1cm5zKCgpID0+IHNvdXJjZSk7XHJcbiAgICAgICAgYXJnc1Jlc3VsdC5zZXR1cChjID0+IGMucmVxdWVzdElkKS5yZXR1cm5zKCgpID0+IDEpO1xyXG4gICAgICAgIGFyZ3NSZXN1bHQuc2V0dXAoYyA9PiBjLmRlZmluaXRpb25zKS5yZXR1cm5zKCgpID0+IGFyZ1Jlc3VsdEl0ZW1zWzBdLmRlZmluaXRpb25zKTtcclxuICAgICAgICBqZWRpSGFuZGxlci5zZXR1cChqID0+IGouc2VuZENvbW1hbmQoVHlwZU1vcS5JdC5pc0FueSgpLCBUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHtcclxuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShhcmdSZXN1bHRJdGVtcyk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgICAgcmV0dXJuIHB5U2lnbmF0dXJlUHJvdmlkZXIucHJvdmlkZVNpZ25hdHVyZUhlbHAoZG9jLm9iamVjdCwgcG9zaXRpb24sIGNhbmNlbFRva2VuLm9iamVjdCk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKSB7XHJcbiAgICAgICAgY29uc3QgdGV4dExpbmUgPSBUeXBlTW9xLk1vY2sub2ZUeXBlKCk7XHJcbiAgICAgICAgdGV4dExpbmUuc2V0dXAodCA9PiB0LnRleHQpLnJldHVybnMoKCkgPT4gc291cmNlTGluZSk7XHJcbiAgICAgICAgY29uc3QgZG9jID0gVHlwZU1vcS5Nb2NrLm9mVHlwZSgpO1xyXG4gICAgICAgIGNvbnN0IHBvcyA9IG5ldyB2c2NvZGVfMS5Qb3NpdGlvbigxLCBzb3VyY2VQb3MpO1xyXG4gICAgICAgIGRvYy5zZXR1cChkID0+IGQuZmlsZU5hbWUpLnJldHVybnMoKCkgPT4gJycpO1xyXG4gICAgICAgIGRvYy5zZXR1cChkID0+IGQuZ2V0VGV4dChUeXBlTW9xLkl0LmlzQW55KCkpKS5yZXR1cm5zKCgpID0+IHNvdXJjZUxpbmUpO1xyXG4gICAgICAgIGRvYy5zZXR1cChkID0+IGQubGluZUF0KFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gdGV4dExpbmUub2JqZWN0KTtcclxuICAgICAgICBkb2Muc2V0dXAoZCA9PiBkLm9mZnNldEF0KFR5cGVNb3EuSXQuaXNBbnkoKSkpLnJldHVybnMoKCkgPT4gc291cmNlUG9zKTtcclxuICAgICAgICByZXR1cm4gcHJvdmlkZXJVdGlsaXRpZXNfMS5pc1Bvc2l0aW9uSW5zaWRlU3RyaW5nT3JDb21tZW50KGRvYy5vYmplY3QsIHBvcyk7XHJcbiAgICB9XHJcbiAgICB0ZXN0KCdFbnN1cmUgbm8gc2lnbmF0dXJlIGlzIGdpdmVuIHdpdGhpbiBhIHN0cmluZy4nLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3Qgc291cmNlID0gJyAgcHJpbnQoXFwnUHl0aG9uIGlzIGF3ZXNvbWUsXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc2lnSGVscCA9IHlpZWxkIHRlc3RTaWduYXR1cmVSZXR1cm5zKHNvdXJjZSwgMjcpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3Qoc2lnSGVscCkudG8ubm90LmJlLmVxdWFsKHVuZGVmaW5lZCwgJ0V4cGVjdGVkIHRvIGdldCBhIGJsYW5rIHNpZ25hdHVyZSBpdGVtIGJhY2sgLSBkaWQgdGhlIHBhdHRlcm4gY2hhbmdlIGhlcmU/Jyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChzaWdIZWxwLnNpZ25hdHVyZXMubGVuZ3RoKS50by5lcXVhbCgwLCAnU2lnbmF0dXJlIHByb3ZpZGVkIGZvciBzeW1ib2xzIHdpdGhpbiBhIHN0cmluZz8nKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBubyBzaWduYXR1cmUgaXMgZ2l2ZW4gd2l0aGluIGEgbGluZSBjb21tZW50LicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBzb3VyY2UgPSAnIyAgcHJpbnQoXFwnUHl0aG9uIGlzIGF3ZXNvbWUsXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc2lnSGVscCA9IHlpZWxkIHRlc3RTaWduYXR1cmVSZXR1cm5zKHNvdXJjZSwgMjgpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3Qoc2lnSGVscCkudG8ubm90LmJlLmVxdWFsKHVuZGVmaW5lZCwgJ0V4cGVjdGVkIHRvIGdldCBhIGJsYW5rIHNpZ25hdHVyZSBpdGVtIGJhY2sgLSBkaWQgdGhlIHBhdHRlcm4gY2hhbmdlIGhlcmU/Jyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChzaWdIZWxwLnNpZ25hdHVyZXMubGVuZ3RoKS50by5lcXVhbCgwLCAnU2lnbmF0dXJlIHByb3ZpZGVkIGZvciBzeW1ib2xzIHdpdGhpbiBhIGZ1bGwtbGluZSBjb21tZW50PycpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5zdXJlIG5vIHNpZ25hdHVyZSBpcyBnaXZlbiB3aXRoaW4gYSBjb21tZW50IHRhaWxpbmcgYSBjb21tYW5kLicsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICBjb25zdCBzb3VyY2UgPSAnICBwcmludChcXCdQeXRob25cXCcpICMgcHJpbnQoXFwnaXMgYXdlc29tZSxcXCcpXFxuJztcclxuICAgICAgICBjb25zdCBzaWdIZWxwID0geWllbGQgdGVzdFNpZ25hdHVyZVJldHVybnMoc291cmNlLCAzOCk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChzaWdIZWxwKS50by5ub3QuYmUuZXF1YWwodW5kZWZpbmVkLCAnRXhwZWN0ZWQgdG8gZ2V0IGEgYmxhbmsgc2lnbmF0dXJlIGl0ZW0gYmFjayAtIGRpZCB0aGUgcGF0dGVybiBjaGFuZ2UgaGVyZT8nKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KHNpZ0hlbHAuc2lnbmF0dXJlcy5sZW5ndGgpLnRvLmVxdWFsKDAsICdTaWduYXR1cmUgcHJvdmlkZWQgZm9yIHN5bWJvbHMgd2l0aGluIGEgdHJhaWxpbmcgY29tbWVudD8nKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBzaWduYXR1cmUgaXMgZ2l2ZW4gZm9yIGJ1aWx0LWluIHByaW50IGNvbW1hbmQuJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZSA9ICcgIHByaW50KFxcJ1B5dGhvblxcJywpXFxuJztcclxuICAgICAgICBsZXQgc2lnSGVscDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICBzaWdIZWxwID0geWllbGQgdGVzdFNpZ25hdHVyZVJldHVybnMoc291cmNlLCAxOCk7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3Qoc2lnSGVscCkudG8ubm90LmVxdWFsKHVuZGVmaW5lZCwgJ0V4cGVjdGVkIHRvIGdldCBhIGJsYW5rIHNpZ25hdHVyZSBpdGVtIGJhY2sgLSBkaWQgdGhlIHBhdHRlcm4gY2hhbmdlIGhlcmU/Jyk7XHJcbiAgICAgICAgICAgIGNoYWlfMS5leHBlY3Qoc2lnSGVscC5zaWduYXR1cmVzLmxlbmd0aCkudG8ubm90LmVxdWFsKDAsICdFeHBlY3RlZCBkdW1teSBhcmdyZXN1bHQgYmFjayBmcm9tIHRlc3Rpbmcgb3VyIHByaW50IHNpZ25hdHVyZS4nKTtcclxuICAgICAgICAgICAgY2hhaV8xLmV4cGVjdChzaWdIZWxwLmFjdGl2ZVBhcmFtZXRlcikudG8uYmUuZXF1YWwoMCwgJ1BhcmFtZXRlciBmb3IgcHJpbnQgc2hvdWxkIGJlIHRoZSBmaXJzdCBtZW1iZXIgb2YgdGhlIHRlc3QgYXJncmVzdWx0XFwncyBwYXJhbXMgb2JqZWN0LicpO1xyXG4gICAgICAgICAgICBjaGFpXzEuZXhwZWN0KHNpZ0hlbHAuYWN0aXZlU2lnbmF0dXJlKS50by5iZS5lcXVhbCgwLCAnVGhlIHNpZ25hdHVyZSBmb3IgcHJpbnQgc2hvdWxkIGJlIHRoZSBmaXJzdCBtZW1iZXIgb2YgdGhlIHRlc3QgYXJncmVzdWx0LicpO1xyXG4gICAgICAgICAgICBjaGFpXzEuZXhwZWN0KHNpZ0hlbHAuc2lnbmF0dXJlc1tzaWdIZWxwLmFjdGl2ZVNpZ25hdHVyZV0ubGFiZWwpLnRvLmJlLmVxdWFsKCdwcmludChwYXJhbSknLCBgRXhwZWN0ZWQgYXJnIHJlc3VsdCBjYWxscyBmb3Igc3BlY2lmaWMgcmV0dXJuZWQgc2lnbmF0dXJlIG9mIFxcJ3ByaW50KHBhcmFtKVxcJyBidXQgd2UgZ290ICR7c2lnSGVscC5zaWduYXR1cmVzW3NpZ0hlbHAuYWN0aXZlU2lnbmF0dXJlXS5sYWJlbH1gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICAgICAgIGNoYWlfMS5hc3NlcnQoZmFsc2UsIGBDYXVnaHQgZXhjZXB0aW9uICR7ZXJyb3J9YCk7XHJcbiAgICAgICAgfVxyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnRW5zdXJlIGlzUG9zaXRpb25JbnNpZGVTdHJpbmdPckNvbW1lbnQgaXMgYmVoYXZpbmcgYXMgZXhwZWN0ZWQuJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZUxpbmUgPSAnICBwcmludChcXCdIZWxsbyB3b3JsZCFcXCcpXFxuJztcclxuICAgICAgICBjb25zdCBzb3VyY2VQb3MgPSBzb3VyY2VMaW5lLmxlbmd0aCAtIDE7XHJcbiAgICAgICAgY29uc3QgaXNJbnNpZGVTdHJDb21tZW50ID0gdGVzdElzSW5zaWRlU3RyaW5nT3JDb21tZW50KHNvdXJjZUxpbmUsIHNvdXJjZVBvcyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc0luc2lkZVN0ckNvbW1lbnQpLnRvLm5vdC5iZS5lcXVhbCh0cnVlLCBbXHJcbiAgICAgICAgICAgIGBQb3NpdGlvbiBzZXQgdG8gdGhlIGVuZCBvZiAke3NvdXJjZUxpbmV9IGJ1dCBgLFxyXG4gICAgICAgICAgICAnaXMgcmVwb3J0ZWQgYXMgYmVpbmcgd2l0aGluIGEgc3RyaW5nIG9yIGNvbW1lbnQuJ1xyXG4gICAgICAgIF0uam9pbignJykpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgaXNQb3NpdGlvbkluc2lkZVN0cmluZ09yQ29tbWVudCBpcyBiZWhhdmluZyBhcyBleHBlY3RlZCBhdCBlbmQgb2Ygc291cmNlLicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgcHJpbnQoXFwnSGVsbG8gd29ybGQhXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gMDtcclxuICAgICAgICBjb25zdCBpc0luc2lkZVN0ckNvbW1lbnQgPSB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzSW5zaWRlU3RyQ29tbWVudCkudG8ubm90LmJlLmVxdWFsKHRydWUsIFtcclxuICAgICAgICAgICAgYFBvc2l0aW9uIHNldCB0byB0aGUgZW5kIG9mICR7c291cmNlTGluZX0gYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBiZWluZyB3aXRoaW4gYSBzdHJpbmcgb3IgY29tbWVudC4nXHJcbiAgICAgICAgXS5qb2luKCcnKSk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBpc1Bvc2l0aW9uSW5zaWRlU3RyaW5nT3JDb21tZW50IGlzIGJlaGF2aW5nIGFzIGV4cGVjdGVkIGF0IGJlZ2lubmluZyBvZiBzb3VyY2UuJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZUxpbmUgPSAnICBwcmludChcXCdIZWxsbyB3b3JsZCFcXCcpXFxuJztcclxuICAgICAgICBjb25zdCBzb3VyY2VQb3MgPSAwO1xyXG4gICAgICAgIGNvbnN0IGlzSW5zaWRlU3RyQ29tbWVudCA9IHRlc3RJc0luc2lkZVN0cmluZ09yQ29tbWVudChzb3VyY2VMaW5lLCBzb3VyY2VQb3MpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoaXNJbnNpZGVTdHJDb21tZW50KS50by5ub3QuYmUuZXF1YWwodHJ1ZSwgW1xyXG4gICAgICAgICAgICBgUG9zaXRpb24gc2V0IHRvIHRoZSBiZWdpbm5pbmcgb2YgJHtzb3VyY2VMaW5lfSBidXQgYCxcclxuICAgICAgICAgICAgJ2lzIHJlcG9ydGVkIGFzIGJlaW5nIHdpdGhpbiBhIHN0cmluZyBvciBjb21tZW50LidcclxuICAgICAgICBdLmpvaW4oJycpKTtcclxuICAgIH0pO1xyXG4gICAgdGVzdCgnRW5zdXJlIGlzUG9zaXRpb25JbnNpZGVTdHJpbmdPckNvbW1lbnQgaXMgYmVoYXZpbmcgYXMgZXhwZWN0ZWQgd2l0aGluIGEgc3RyaW5nLicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgcHJpbnQoXFwnSGVsbG8gd29ybGQhXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gMTY7XHJcbiAgICAgICAgY29uc3QgaXNJbnNpZGVTdHJDb21tZW50ID0gdGVzdElzSW5zaWRlU3RyaW5nT3JDb21tZW50KHNvdXJjZUxpbmUsIHNvdXJjZVBvcyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc0luc2lkZVN0ckNvbW1lbnQpLnRvLmJlLmVxdWFsKHRydWUsIFtcclxuICAgICAgICAgICAgYFBvc2l0aW9uIHNldCB3aXRoaW4gdGhlIHN0cmluZyBpbiAke3NvdXJjZUxpbmV9IChwb3NpdGlvbiAke3NvdXJjZVBvc30pIGJ1dCBgLFxyXG4gICAgICAgICAgICAnaXMgcmVwb3J0ZWQgYXMgTk9UIGJlaW5nIHdpdGhpbiBhIHN0cmluZyBvciBjb21tZW50LidcclxuICAgICAgICBdLmpvaW4oJycpKTtcclxuICAgIH0pO1xyXG4gICAgdGVzdCgnRW5zdXJlIGlzUG9zaXRpb25JbnNpZGVTdHJpbmdPckNvbW1lbnQgaXMgYmVoYXZpbmcgYXMgZXhwZWN0ZWQgaW1tZWRpYXRlbHkgYmVmb3JlIGEgc3RyaW5nLicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgcHJpbnQoXFwnSGVsbG8gd29ybGQhXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gODtcclxuICAgICAgICBjb25zdCBpc0luc2lkZVN0ckNvbW1lbnQgPSB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzSW5zaWRlU3RyQ29tbWVudCkudG8uYmUuZXF1YWwoZmFsc2UsIFtcclxuICAgICAgICAgICAgYFBvc2l0aW9uIHNldCB0byBqdXN0IGJlZm9yZSB0aGUgc3RyaW5nIGluICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBiZWluZyB3aXRoaW4gYSBzdHJpbmcgb3IgY29tbWVudC4nXHJcbiAgICAgICAgXS5qb2luKCcnKSk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBpc1Bvc2l0aW9uSW5zaWRlU3RyaW5nT3JDb21tZW50IGlzIGJlaGF2aW5nIGFzIGV4cGVjdGVkIGltbWVkaWF0ZWx5IGluIGEgc3RyaW5nLicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgcHJpbnQoXFwnSGVsbG8gd29ybGQhXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gOTtcclxuICAgICAgICBjb25zdCBpc0luc2lkZVN0ckNvbW1lbnQgPSB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzSW5zaWRlU3RyQ29tbWVudCkudG8uYmUuZXF1YWwodHJ1ZSwgW1xyXG4gICAgICAgICAgICBgUG9zaXRpb24gc2V0IHRvIHRoZSBzdGFydCBvZiB0aGUgc3RyaW5nIGluICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBiZWluZyB3aXRoaW4gYSBzdHJpbmcgb3IgY29tbWVudC4nXHJcbiAgICAgICAgXS5qb2luKCcnKSk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBpc1Bvc2l0aW9uSW5zaWRlU3RyaW5nT3JDb21tZW50IGlzIGJlaGF2aW5nIGFzIGV4cGVjdGVkIHdpdGhpbiBhIGNvbW1lbnQuJywgKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZUxpbmUgPSAnIyAgcHJpbnQoXFwnSGVsbG8gd29ybGQhXFwnKVxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gMTY7XHJcbiAgICAgICAgY29uc3QgaXNJbnNpZGVTdHJDb21tZW50ID0gdGVzdElzSW5zaWRlU3RyaW5nT3JDb21tZW50KHNvdXJjZUxpbmUsIHNvdXJjZVBvcyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc0luc2lkZVN0ckNvbW1lbnQpLnRvLmJlLmVxdWFsKHRydWUsIFtcclxuICAgICAgICAgICAgYFBvc2l0aW9uIHNldCB3aXRoaW4gYSBmdWxsIGxpbmUgY29tbWVudCAke3NvdXJjZUxpbmV9IChwb3NpdGlvbiAke3NvdXJjZVBvc30pIGJ1dCBgLFxyXG4gICAgICAgICAgICAnaXMgcmVwb3J0ZWQgYXMgTk9UIGJlaW5nIHdpdGhpbiBhIHN0cmluZyBvciBjb21tZW50LidcclxuICAgICAgICBdLmpvaW4oJycpKTtcclxuICAgIH0pO1xyXG4gICAgdGVzdCgnRW5zdXJlIGlzUG9zaXRpb25JbnNpZGVTdHJpbmdPckNvbW1lbnQgaXMgYmVoYXZpbmcgYXMgZXhwZWN0ZWQgd2l0aGluIGEgdHJhaWxpbmcgY29tbWVudC4nLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc291cmNlTGluZSA9ICcgIHByaW50KFxcJ0hlbGxvIHdvcmxkIVxcJykgIyBzb21lIGNvbW1lbnQuLi5cXG4nO1xyXG4gICAgICAgIGNvbnN0IHNvdXJjZVBvcyA9IDM0O1xyXG4gICAgICAgIGNvbnN0IGlzSW5zaWRlU3RyQ29tbWVudCA9IHRlc3RJc0luc2lkZVN0cmluZ09yQ29tbWVudChzb3VyY2VMaW5lLCBzb3VyY2VQb3MpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoaXNJbnNpZGVTdHJDb21tZW50KS50by5iZS5lcXVhbCh0cnVlLCBbXHJcbiAgICAgICAgICAgIGBQb3NpdGlvbiBzZXQgd2l0aGluIGEgdHJhaWxpbmcgbGluZSBjb21tZW50ICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBOT1QgYmVpbmcgd2l0aGluIGEgc3RyaW5nIG9yIGNvbW1lbnQuJ1xyXG4gICAgICAgIF0uam9pbignJykpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgaXNQb3NpdGlvbkluc2lkZVN0cmluZ09yQ29tbWVudCBpcyBiZWhhdmluZyBhcyBleHBlY3RlZCBhdCB0aGUgdmVyeSBlbmQgb2YgYSB0cmFpbGluZyBjb21tZW50LicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgcHJpbnQoXFwnSGVsbG8gd29ybGQhXFwnKSAjIHNvbWUgY29tbWVudC4uLlxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gc291cmNlTGluZS5sZW5ndGggLSAxO1xyXG4gICAgICAgIGNvbnN0IGlzSW5zaWRlU3RyQ29tbWVudCA9IHRlc3RJc0luc2lkZVN0cmluZ09yQ29tbWVudChzb3VyY2VMaW5lLCBzb3VyY2VQb3MpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoaXNJbnNpZGVTdHJDb21tZW50KS50by5iZS5lcXVhbCh0cnVlLCBbXHJcbiAgICAgICAgICAgIGBQb3NpdGlvbiBzZXQgd2l0aGluIGEgdHJhaWxpbmcgbGluZSBjb21tZW50ICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBOT1QgYmVpbmcgd2l0aGluIGEgc3RyaW5nIG9yIGNvbW1lbnQuJ1xyXG4gICAgICAgIF0uam9pbignJykpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgaXNQb3NpdGlvbkluc2lkZVN0cmluZ09yQ29tbWVudCBpcyBiZWhhdmluZyBhcyBleHBlY3RlZCB3aXRoaW4gYSBtdWx0aWxpbmUgc3RyaW5nLicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgc3RyaW5nVmFsID0gXFwnXFwnXFwnVGhpcyBpcyBhIG11bHRpbGluZVxcbnN0cmluZyB0aGF0IHlvdSBjYW4gdXNlXFxudG8gdGVzdCB0aGlzIHN0dWZmIG91dCB3aXRoXFxuZXZlcnlkYXkhXFwnXFwnXFwnXFxuJztcclxuICAgICAgICBjb25zdCBzb3VyY2VQb3MgPSA0ODtcclxuICAgICAgICBjb25zdCBpc0luc2lkZVN0ckNvbW1lbnQgPSB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzSW5zaWRlU3RyQ29tbWVudCkudG8uYmUuZXF1YWwodHJ1ZSwgW1xyXG4gICAgICAgICAgICBgUG9zaXRpb24gc2V0IHdpdGhpbiBhIG11bHRpLWxpbmUgc3RyaW5nICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBOT1QgYmVpbmcgd2l0aGluIGEgc3RyaW5nIG9yIGNvbW1lbnQuJ1xyXG4gICAgICAgIF0uam9pbignJykpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgaXNQb3NpdGlvbkluc2lkZVN0cmluZ09yQ29tbWVudCBpcyBiZWhhdmluZyBhcyBleHBlY3RlZCBhdCB0aGUgdmVyeSBsYXN0IHF1b3RlIG9uIGEgbXVsdGlsaW5lIHN0cmluZy4nLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc291cmNlTGluZSA9ICcgIHN0cmluZ1ZhbCA9IFxcJ1xcJ1xcJ1RoaXMgaXMgYSBtdWx0aWxpbmVcXG5zdHJpbmcgdGhhdCB5b3UgY2FuIHVzZVxcbnRvIHRlc3QgdGhpcyBzdHVmZiBvdXQgd2l0aFxcbmV2ZXJ5ZGF5IVxcJ1xcJ1xcJ1xcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gc291cmNlTGluZS5sZW5ndGggLSAyOyAvLyBqdXN0IGF0IHRoZSBsYXN0ICdcclxuICAgICAgICBjb25zdCBpc0luc2lkZVN0ckNvbW1lbnQgPSB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzSW5zaWRlU3RyQ29tbWVudCkudG8uYmUuZXF1YWwodHJ1ZSwgW1xyXG4gICAgICAgICAgICBgUG9zaXRpb24gc2V0IHdpdGhpbiBhIG11bHRpLWxpbmUgc3RyaW5nICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBOT1QgYmVpbmcgd2l0aGluIGEgc3RyaW5nIG9yIGNvbW1lbnQuJ1xyXG4gICAgICAgIF0uam9pbignJykpO1xyXG4gICAgfSk7XHJcbiAgICB0ZXN0KCdFbnN1cmUgaXNQb3NpdGlvbkluc2lkZVN0cmluZ09yQ29tbWVudCBpcyBiZWhhdmluZyBhcyBleHBlY3RlZCB3aXRoaW4gYSBtdWx0aWxpbmUgc3RyaW5nIChkb3VibGUtcXVvdGVkKS4nLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc291cmNlTGluZSA9ICcgIHN0cmluZ1ZhbCA9IFwiXCJcIlRoaXMgaXMgYSBtdWx0aWxpbmVcXG5zdHJpbmcgdGhhdCB5b3UgY2FuIHVzZVxcbnRvIHRlc3QgdGhpcyBzdHVmZiBvdXQgd2l0aFxcbmV2ZXJ5ZGF5IVwiXCJcIlxcbic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gNDg7XHJcbiAgICAgICAgY29uc3QgaXNJbnNpZGVTdHJDb21tZW50ID0gdGVzdElzSW5zaWRlU3RyaW5nT3JDb21tZW50KHNvdXJjZUxpbmUsIHNvdXJjZVBvcyk7XHJcbiAgICAgICAgY2hhaV8xLmV4cGVjdChpc0luc2lkZVN0ckNvbW1lbnQpLnRvLmJlLmVxdWFsKHRydWUsIFtcclxuICAgICAgICAgICAgYFBvc2l0aW9uIHNldCB3aXRoaW4gYSBtdWx0aS1saW5lIHN0cmluZyAke3NvdXJjZUxpbmV9IChwb3NpdGlvbiAke3NvdXJjZVBvc30pIGJ1dCBgLFxyXG4gICAgICAgICAgICAnaXMgcmVwb3J0ZWQgYXMgTk9UIGJlaW5nIHdpdGhpbiBhIHN0cmluZyBvciBjb21tZW50LidcclxuICAgICAgICBdLmpvaW4oJycpKTtcclxuICAgIH0pO1xyXG4gICAgdGVzdCgnRW5zdXJlIGlzUG9zaXRpb25JbnNpZGVTdHJpbmdPckNvbW1lbnQgaXMgYmVoYXZpbmcgYXMgZXhwZWN0ZWQgYXQgdGhlIHZlcnkgbGFzdCBxdW90ZSBvbiBhIG11bHRpbGluZSBzdHJpbmcgKGRvdWJsZS1xdW90ZWQpLicsICgpID0+IHtcclxuICAgICAgICBjb25zdCBzb3VyY2VMaW5lID0gJyAgc3RyaW5nVmFsID0gXCJcIlwiVGhpcyBpcyBhIG11bHRpbGluZVxcbnN0cmluZyB0aGF0IHlvdSBjYW4gdXNlXFxudG8gdGVzdCB0aGlzIHN0dWZmIG91dCB3aXRoXFxuZXZlcnlkYXkhXCJcIlwiXFxuJztcclxuICAgICAgICBjb25zdCBzb3VyY2VQb3MgPSBzb3VyY2VMaW5lLmxlbmd0aCAtIDI7IC8vIGp1c3QgYXQgdGhlIGxhc3QgJ1xyXG4gICAgICAgIGNvbnN0IGlzSW5zaWRlU3RyQ29tbWVudCA9IHRlc3RJc0luc2lkZVN0cmluZ09yQ29tbWVudChzb3VyY2VMaW5lLCBzb3VyY2VQb3MpO1xyXG4gICAgICAgIGNoYWlfMS5leHBlY3QoaXNJbnNpZGVTdHJDb21tZW50KS50by5iZS5lcXVhbCh0cnVlLCBbXHJcbiAgICAgICAgICAgIGBQb3NpdGlvbiBzZXQgd2l0aGluIGEgbXVsdGktbGluZSBzdHJpbmcgJHtzb3VyY2VMaW5lfSAocG9zaXRpb24gJHtzb3VyY2VQb3N9KSBidXQgYCxcclxuICAgICAgICAgICAgJ2lzIHJlcG9ydGVkIGFzIE5PVCBiZWluZyB3aXRoaW4gYSBzdHJpbmcgb3IgY29tbWVudC4nXHJcbiAgICAgICAgXS5qb2luKCcnKSk7XHJcbiAgICB9KTtcclxuICAgIHRlc3QoJ0Vuc3VyZSBpc1Bvc2l0aW9uSW5zaWRlU3RyaW5nT3JDb21tZW50IGlzIGJlaGF2aW5nIGFzIGV4cGVjdGVkIGR1cmluZyBjb25zdHJ1Y3Rpb24gb2YgYSBtdWx0aWxpbmUgc3RyaW5nIChkb3VibGUtcXVvdGVkKS4nLCAoKSA9PiB7XHJcbiAgICAgICAgY29uc3Qgc291cmNlTGluZSA9ICcgIHN0cmluZ1ZhbCA9IFwiXCJcIlRoaXMgaXMgYSBtdWx0aWxpbmVcXG5zdHJpbmcgdGhhdCB5b3UgY2FuIHVzZVxcbnRvIHRlc3QgdGhpcyBzdHVmZic7XHJcbiAgICAgICAgY29uc3Qgc291cmNlUG9zID0gc291cmNlTGluZS5sZW5ndGggLSAxOyAvLyBqdXN0IGF0IHRoZSBsYXN0IHBvc2l0aW9uIGluIHRoZSBzdHJpbmcgYmVmb3JlIGl0J3MgdGVybWluYXRpb25cclxuICAgICAgICBjb25zdCBpc0luc2lkZVN0ckNvbW1lbnQgPSB0ZXN0SXNJbnNpZGVTdHJpbmdPckNvbW1lbnQoc291cmNlTGluZSwgc291cmNlUG9zKTtcclxuICAgICAgICBjaGFpXzEuZXhwZWN0KGlzSW5zaWRlU3RyQ29tbWVudCkudG8uYmUuZXF1YWwodHJ1ZSwgW1xyXG4gICAgICAgICAgICBgUG9zaXRpb24gc2V0IHdpdGhpbiBhIG11bHRpLWxpbmUgc3RyaW5nICR7c291cmNlTGluZX0gKHBvc2l0aW9uICR7c291cmNlUG9zfSkgYnV0IGAsXHJcbiAgICAgICAgICAgICdpcyByZXBvcnRlZCBhcyBOT1QgYmVpbmcgd2l0aGluIGEgc3RyaW5nIG9yIGNvbW1lbnQuJ1xyXG4gICAgICAgIF0uam9pbignJykpO1xyXG4gICAgfSk7XHJcbn0pO1xyXG4vLyMgc291cmNlTWFwcGluZ1VSTD1weXRob25TaWduYXR1cmVQcm92aWRlci51bml0LnRlc3QuanMubWFwIl19