"use strict";

var __awaiter = void 0 && (void 0).__awaiter || function (thisArg, _arguments, P, generator) {
  return new (P || (P = Promise))(function (resolve, reject) {
    function fulfilled(value) {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    }

    function rejected(value) {
      try {
        step(generator["throw"](value));
      } catch (e) {
        reject(e);
      }
    }

    function step(result) {
      result.done ? resolve(result.value) : new P(function (resolve) {
        resolve(result.value);
      }).then(fulfilled, rejected);
    }

    step((generator = generator.apply(thisArg, _arguments || [])).next());
  });
};

Object.defineProperty(exports, "__esModule", {
  value: true
});

const assert = require("assert");

const child_process = require("child_process");

const path = require("path");

const vscode_1 = require("vscode");

const configSettings_1 = require("../../client/common/configSettings");

const shebangCodeLensProvider_1 = require("../../client/interpreter/display/shebangCodeLensProvider");

const helpers_1 = require("../../client/interpreter/helpers");

const initialize_1 = require("../initialize");

const serviceRegistry_1 = require("../unittests/serviceRegistry");

const autoCompPath = path.join(__dirname, '..', '..', '..', 'src', 'test', 'pythonFiles', 'shebang');
const fileShebang = path.join(autoCompPath, 'shebang.py');
const fileShebangEnv = path.join(autoCompPath, 'shebangEnv.py');
const fileShebangInvalid = path.join(autoCompPath, 'shebangInvalid.py');
const filePlain = path.join(autoCompPath, 'plain.py'); // tslint:disable-next-line:max-func-body-length

suite('Shebang detection', () => {
  let ioc;
  suiteSetup(initialize_1.initialize);
  suiteTeardown(() => __awaiter(void 0, void 0, void 0, function* () {
    yield initialize_1.initialize();
    yield initialize_1.closeActiveWindows();
  }));
  setup(() => __awaiter(void 0, void 0, void 0, function* () {
    initializeDI();
    yield initialize_1.initializeTest();
  }));
  teardown(() => ioc.dispose());

  function initializeDI() {
    ioc = new serviceRegistry_1.UnitTestIocContainer();
    ioc.registerCommonTypes();
    ioc.registerVariableTypes();
    ioc.registerProcessTypes();
  }

  test('A code lens will appear when sheban python and python in settings are different', () => __awaiter(void 0, void 0, void 0, function* () {
    const pythonPath = 'someUnknownInterpreter';
    const document = yield openFile(fileShebang);
    configSettings_1.PythonSettings.getInstance(document.uri).pythonPath = pythonPath;
    const codeLenses = yield setupCodeLens(document);
    assert.equal(codeLenses.length, 1, 'No CodeLens available');
    const codeLens = codeLenses[0];
    assert(codeLens.range.isSingleLine, 'Invalid CodeLens Range');
    assert.equal(codeLens.command.command, 'python.setShebangInterpreter');
  }));
  test('Code lens will not appear when sheban python and python in settings are the same', () => __awaiter(void 0, void 0, void 0, function* () {
    configSettings_1.PythonSettings.dispose();
    const pythonPath = yield getFullyQualifiedPathToInterpreter('python');
    const document = yield openFile(fileShebang);
    configSettings_1.PythonSettings.getInstance(document.uri).pythonPath = pythonPath;
    const codeLenses = yield setupCodeLens(document);
    assert.equal(codeLenses.length, 0, 'CodeLens available although interpreters are equal');
  }));
  test('Code lens will not appear when sheban python is invalid', () => __awaiter(void 0, void 0, void 0, function* () {
    const document = yield openFile(fileShebangInvalid);
    const codeLenses = yield setupCodeLens(document);
    assert.equal(codeLenses.length, 0, 'CodeLens available even when shebang is invalid');
  }));

  if (!configSettings_1.IS_WINDOWS) {
    test('A code lens will appear when shebang python uses env and python settings are different', () => __awaiter(void 0, void 0, void 0, function* () {
      const document = yield openFile(fileShebangEnv);
      configSettings_1.PythonSettings.getInstance(document.uri).pythonPath = 'p1';
      const codeLenses = yield setupCodeLens(document);
      assert.equal(codeLenses.length, 1, 'No CodeLens available');
      const codeLens = codeLenses[0];
      assert(codeLens.range.isSingleLine, 'Invalid CodeLens Range');
      assert.equal(codeLens.command.command, 'python.setShebangInterpreter');
    }));
    test('Code lens will not appear even when shebang python uses env and python settings are the same', () => __awaiter(void 0, void 0, void 0, function* () {
      const pythonPath = yield getFullyQualifiedPathToInterpreter('python');
      const document = yield openFile(fileShebangEnv);
      configSettings_1.PythonSettings.getInstance(document.uri).pythonPath = pythonPath;
      const codeLenses = yield setupCodeLens(document);
      assert.equal(codeLenses.length, 0, 'CodeLens available although interpreters are equal');
    }));
  }

  test('Code lens will not appear as there is no shebang', () => __awaiter(void 0, void 0, void 0, function* () {
    const document = yield openFile(filePlain);
    const codeLenses = yield setupCodeLens(document);
    assert.equal(codeLenses.length, 0, 'CodeLens available although no shebang');
  }));

  function openFile(fileName) {
    return __awaiter(this, void 0, void 0, function* () {
      return vscode_1.workspace.openTextDocument(fileName);
    });
  }

  function getFullyQualifiedPathToInterpreter(pythonPath) {
    return __awaiter(this, void 0, void 0, function* () {
      return new Promise(resolve => {
        child_process.execFile(pythonPath, ['-c', 'import sys;print(sys.executable)'], (_, stdout) => {
          resolve(helpers_1.getFirstNonEmptyLineFromMultilineString(stdout));
        });
      }).catch(() => undefined);
    });
  }

  function setupCodeLens(document) {
    return __awaiter(this, void 0, void 0, function* () {
      const codeLensProvider = new shebangCodeLensProvider_1.ShebangCodeLensProvider(ioc.serviceContainer);
      return codeLensProvider.provideCodeLenses(document, new vscode_1.CancellationTokenSource().token);
    });
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNoZWJhbmdDb2RlTGVuc2VQcm92aWRlci50ZXN0LmpzIl0sIm5hbWVzIjpbIl9fYXdhaXRlciIsInRoaXNBcmciLCJfYXJndW1lbnRzIiwiUCIsImdlbmVyYXRvciIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwiZnVsZmlsbGVkIiwidmFsdWUiLCJzdGVwIiwibmV4dCIsImUiLCJyZWplY3RlZCIsInJlc3VsdCIsImRvbmUiLCJ0aGVuIiwiYXBwbHkiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJhc3NlcnQiLCJyZXF1aXJlIiwiY2hpbGRfcHJvY2VzcyIsInBhdGgiLCJ2c2NvZGVfMSIsImNvbmZpZ1NldHRpbmdzXzEiLCJzaGViYW5nQ29kZUxlbnNQcm92aWRlcl8xIiwiaGVscGVyc18xIiwiaW5pdGlhbGl6ZV8xIiwic2VydmljZVJlZ2lzdHJ5XzEiLCJhdXRvQ29tcFBhdGgiLCJqb2luIiwiX19kaXJuYW1lIiwiZmlsZVNoZWJhbmciLCJmaWxlU2hlYmFuZ0VudiIsImZpbGVTaGViYW5nSW52YWxpZCIsImZpbGVQbGFpbiIsInN1aXRlIiwiaW9jIiwic3VpdGVTZXR1cCIsImluaXRpYWxpemUiLCJzdWl0ZVRlYXJkb3duIiwiY2xvc2VBY3RpdmVXaW5kb3dzIiwic2V0dXAiLCJpbml0aWFsaXplREkiLCJpbml0aWFsaXplVGVzdCIsInRlYXJkb3duIiwiZGlzcG9zZSIsIlVuaXRUZXN0SW9jQ29udGFpbmVyIiwicmVnaXN0ZXJDb21tb25UeXBlcyIsInJlZ2lzdGVyVmFyaWFibGVUeXBlcyIsInJlZ2lzdGVyUHJvY2Vzc1R5cGVzIiwidGVzdCIsInB5dGhvblBhdGgiLCJkb2N1bWVudCIsIm9wZW5GaWxlIiwiUHl0aG9uU2V0dGluZ3MiLCJnZXRJbnN0YW5jZSIsInVyaSIsImNvZGVMZW5zZXMiLCJzZXR1cENvZGVMZW5zIiwiZXF1YWwiLCJsZW5ndGgiLCJjb2RlTGVucyIsInJhbmdlIiwiaXNTaW5nbGVMaW5lIiwiY29tbWFuZCIsImdldEZ1bGx5UXVhbGlmaWVkUGF0aFRvSW50ZXJwcmV0ZXIiLCJJU19XSU5ET1dTIiwiZmlsZU5hbWUiLCJ3b3Jrc3BhY2UiLCJvcGVuVGV4dERvY3VtZW50IiwiZXhlY0ZpbGUiLCJfIiwic3Rkb3V0IiwiZ2V0Rmlyc3ROb25FbXB0eUxpbmVGcm9tTXVsdGlsaW5lU3RyaW5nIiwiY2F0Y2giLCJ1bmRlZmluZWQiLCJjb2RlTGVuc1Byb3ZpZGVyIiwiU2hlYmFuZ0NvZGVMZW5zUHJvdmlkZXIiLCJzZXJ2aWNlQ29udGFpbmVyIiwicHJvdmlkZUNvZGVMZW5zZXMiLCJDYW5jZWxsYXRpb25Ub2tlblNvdXJjZSIsInRva2VuIl0sIm1hcHBpbmdzIjoiQUFBQTs7QUFDQSxJQUFJQSxTQUFTLEdBQUksVUFBUSxTQUFLQSxTQUFkLElBQTRCLFVBQVVDLE9BQVYsRUFBbUJDLFVBQW5CLEVBQStCQyxDQUEvQixFQUFrQ0MsU0FBbEMsRUFBNkM7QUFDckYsU0FBTyxLQUFLRCxDQUFDLEtBQUtBLENBQUMsR0FBR0UsT0FBVCxDQUFOLEVBQXlCLFVBQVVDLE9BQVYsRUFBbUJDLE1BQW5CLEVBQTJCO0FBQ3ZELGFBQVNDLFNBQVQsQ0FBbUJDLEtBQW5CLEVBQTBCO0FBQUUsVUFBSTtBQUFFQyxRQUFBQSxJQUFJLENBQUNOLFNBQVMsQ0FBQ08sSUFBVixDQUFlRixLQUFmLENBQUQsQ0FBSjtBQUE4QixPQUFwQyxDQUFxQyxPQUFPRyxDQUFQLEVBQVU7QUFBRUwsUUFBQUEsTUFBTSxDQUFDSyxDQUFELENBQU47QUFBWTtBQUFFOztBQUMzRixhQUFTQyxRQUFULENBQWtCSixLQUFsQixFQUF5QjtBQUFFLFVBQUk7QUFBRUMsUUFBQUEsSUFBSSxDQUFDTixTQUFTLENBQUMsT0FBRCxDQUFULENBQW1CSyxLQUFuQixDQUFELENBQUo7QUFBa0MsT0FBeEMsQ0FBeUMsT0FBT0csQ0FBUCxFQUFVO0FBQUVMLFFBQUFBLE1BQU0sQ0FBQ0ssQ0FBRCxDQUFOO0FBQVk7QUFBRTs7QUFDOUYsYUFBU0YsSUFBVCxD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QyxHQUFHLENBQUMwQyxnQkFBMUQsQ0FBekI7QUFDQSxhQUFPRixnQkFBZ0IsQ0FBQ0csaUJBQWpCLENBQW1DM0IsUUFBbkMsRUFBNkMsSUFBSTlCLFFBQVEsQ0FBQzBELHVCQUFiLEdBQXVDQyxLQUFwRixDQUFQO0FBQ0gsS0FIZSxDQUFoQjtBQUlIO0FBQ0osQ0FwRkksQ0FBTCIsInNvdXJjZXNDb250ZW50IjpbIlwidXNlIHN0cmljdFwiO1xyXG52YXIgX19hd2FpdGVyID0gKHRoaXMgJiYgdGhpcy5fX2F3YWl0ZXIpIHx8IGZ1bmN0aW9uICh0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59O1xyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XHJcbmNvbnN0IGFzc2VydCA9IHJlcXVpcmUoXCJhc3NlcnRcIik7XHJcbmNvbnN0IGNoaWxkX3Byb2Nlc3MgPSByZXF1aXJlKFwiY2hpbGRfcHJvY2Vzc1wiKTtcclxuY29uc3QgcGF0aCA9IHJlcXVpcmUoXCJwYXRoXCIpO1xyXG5jb25zdCB2c2NvZGVfMSA9IHJlcXVpcmUoXCJ2c2NvZGVcIik7XHJcbmNvbnN0IGNvbmZpZ1NldHRpbmdzXzEgPSByZXF1aXJlKFwiLi4vLi4vY2xpZW50L2NvbW1vbi9jb25maWdTZXR0aW5nc1wiKTtcclxuY29uc3Qgc2hlYmFuZ0NvZGVMZW5zUHJvdmlkZXJfMSA9IHJlcXVpcmUoXCIuLi8uLi9jbGllbnQvaW50ZXJwcmV0ZXIvZGlzcGxheS9zaGViYW5nQ29kZUxlbnNQcm92aWRlclwiKTtcclxuY29uc3QgaGVscGVyc18xID0gcmVxdWlyZShcIi4uLy4uL2NsaWVudC9pbnRlcnByZXRlci9oZWxwZXJzXCIpO1xyXG5jb25zdCBpbml0aWFsaXplXzEgPSByZXF1aXJlKFwiLi4vaW5pdGlhbGl6ZVwiKTtcclxuY29uc3Qgc2VydmljZVJlZ2lzdHJ5XzEgPSByZXF1aXJlKFwiLi4vdW5pdHRlc3RzL3NlcnZpY2VSZWdpc3RyeVwiKTtcclxuY29uc3QgYXV0b0NvbXBQYXRoID0gcGF0aC5qb2luKF9fZGlybmFtZSwgJy4uJywgJy4uJywgJy4uJywgJ3NyYycsICd0ZXN0JywgJ3B5dGhvbkZpbGVzJywgJ3NoZWJhbmcnKTtcclxuY29uc3QgZmlsZVNoZWJhbmcgPSBwYXRoLmpvaW4oYXV0b0NvbXBQYXRoLCAnc2hlYmFuZy5weScpO1xyXG5jb25zdCBmaWxlU2hlYmFuZ0VudiA9IHBhdGguam9pbihhdXRvQ29tcFBhdGgsICdzaGViYW5nRW52LnB5Jyk7XHJcbmNvbnN0IGZpbGVTaGViYW5nSW52YWxpZCA9IHBhdGguam9pbihhdXRvQ29tcFBhdGgsICdzaGViYW5nSW52YWxpZC5weScpO1xyXG5jb25zdCBmaWxlUGxhaW4gPSBwYXRoLmpvaW4oYXV0b0NvbXBQYXRoLCAncGxhaW4ucHknKTtcclxuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOm1heC1mdW5jLWJvZHktbGVuZ3RoXHJcbnN1aXRlKCdTaGViYW5nIGRldGVjdGlvbicsICgpID0+IHtcclxuICAgIGxldCBpb2M7XHJcbiAgICBzdWl0ZVNldHVwKGluaXRpYWxpemVfMS5pbml0aWFsaXplKTtcclxuICAgIHN1aXRlVGVhcmRvd24oKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIHlpZWxkIGluaXRpYWxpemVfMS5pbml0aWFsaXplKCk7XHJcbiAgICAgICAgeWllbGQgaW5pdGlhbGl6ZV8xLmNsb3NlQWN0aXZlV2luZG93cygpO1xyXG4gICAgfSkpO1xyXG4gICAgc2V0dXAoKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGluaXRpYWxpemVESSgpO1xyXG4gICAgICAgIHlpZWxkIGluaXRpYWxpemVfMS5pbml0aWFsaXplVGVzdCgpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVhcmRvd24oKCkgPT4gaW9jLmRpc3Bvc2UoKSk7XHJcbiAgICBmdW5jdGlvbiBpbml0aWFsaXplREkoKSB7XHJcbiAgICAgICAgaW9jID0gbmV3IHNlcnZpY2VSZWdpc3RyeV8xLlVuaXRUZXN0SW9jQ29udGFpbmVyKCk7XHJcbiAgICAgICAgaW9jLnJlZ2lzdGVyQ29tbW9uVHlwZXMoKTtcclxuICAgICAgICBpb2MucmVnaXN0ZXJWYXJpYWJsZVR5cGVzKCk7XHJcbiAgICAgICAgaW9jLnJlZ2lzdGVyUHJvY2Vzc1R5cGVzKCk7XHJcbiAgICB9XHJcbiAgICB0ZXN0KCdBIGNvZGUgbGVucyB3aWxsIGFwcGVhciB3aGVuIHNoZWJhbiBweXRob24gYW5kIHB5dGhvbiBpbiBzZXR0aW5ncyBhcmUgZGlmZmVyZW50JywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IHB5dGhvblBhdGggPSAnc29tZVVua25vd25JbnRlcnByZXRlcic7XHJcbiAgICAgICAgY29uc3QgZG9jdW1lbnQgPSB5aWVsZCBvcGVuRmlsZShmaWxlU2hlYmFuZyk7XHJcbiAgICAgICAgY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpLnB5dGhvblBhdGggPSBweXRob25QYXRoO1xyXG4gICAgICAgIGNvbnN0IGNvZGVMZW5zZXMgPSB5aWVsZCBzZXR1cENvZGVMZW5zKGRvY3VtZW50KTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoY29kZUxlbnNlcy5sZW5ndGgsIDEsICdObyBDb2RlTGVucyBhdmFpbGFibGUnKTtcclxuICAgICAgICBjb25zdCBjb2RlTGVucyA9IGNvZGVMZW5zZXNbMF07XHJcbiAgICAgICAgYXNzZXJ0KGNvZGVMZW5zLnJhbmdlLmlzU2luZ2xlTGluZSwgJ0ludmFsaWQgQ29kZUxlbnMgUmFuZ2UnKTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoY29kZUxlbnMuY29tbWFuZC5jb21tYW5kLCAncHl0aG9uLnNldFNoZWJhbmdJbnRlcnByZXRlcicpO1xyXG4gICAgfSkpO1xyXG4gICAgdGVzdCgnQ29kZSBsZW5zIHdpbGwgbm90IGFwcGVhciB3aGVuIHNoZWJhbiBweXRob24gYW5kIHB5dGhvbiBpbiBzZXR0aW5ncyBhcmUgdGhlIHNhbWUnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5kaXNwb3NlKCk7XHJcbiAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IHlpZWxkIGdldEZ1bGx5UXVhbGlmaWVkUGF0aFRvSW50ZXJwcmV0ZXIoJ3B5dGhvbicpO1xyXG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0geWllbGQgb3BlbkZpbGUoZmlsZVNoZWJhbmcpO1xyXG4gICAgICAgIGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZ2V0SW5zdGFuY2UoZG9jdW1lbnQudXJpKS5weXRob25QYXRoID0gcHl0aG9uUGF0aDtcclxuICAgICAgICBjb25zdCBjb2RlTGVuc2VzID0geWllbGQgc2V0dXBDb2RlTGVucyhkb2N1bWVudCk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNvZGVMZW5zZXMubGVuZ3RoLCAwLCAnQ29kZUxlbnMgYXZhaWxhYmxlIGFsdGhvdWdoIGludGVycHJldGVycyBhcmUgZXF1YWwnKTtcclxuICAgIH0pKTtcclxuICAgIHRlc3QoJ0NvZGUgbGVucyB3aWxsIG5vdCBhcHBlYXIgd2hlbiBzaGViYW4gcHl0aG9uIGlzIGludmFsaWQnLCAoKSA9PiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgY29uc3QgZG9jdW1lbnQgPSB5aWVsZCBvcGVuRmlsZShmaWxlU2hlYmFuZ0ludmFsaWQpO1xyXG4gICAgICAgIGNvbnN0IGNvZGVMZW5zZXMgPSB5aWVsZCBzZXR1cENvZGVMZW5zKGRvY3VtZW50KTtcclxuICAgICAgICBhc3NlcnQuZXF1YWwoY29kZUxlbnNlcy5sZW5ndGgsIDAsICdDb2RlTGVucyBhdmFpbGFibGUgZXZlbiB3aGVuIHNoZWJhbmcgaXMgaW52YWxpZCcpO1xyXG4gICAgfSkpO1xyXG4gICAgaWYgKCFjb25maWdTZXR0aW5nc18xLklTX1dJTkRPV1MpIHtcclxuICAgICAgICB0ZXN0KCdBIGNvZGUgbGVucyB3aWxsIGFwcGVhciB3aGVuIHNoZWJhbmcgcHl0aG9uIHVzZXMgZW52IGFuZCBweXRob24gc2V0dGluZ3MgYXJlIGRpZmZlcmVudCcsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgY29uc3QgZG9jdW1lbnQgPSB5aWVsZCBvcGVuRmlsZShmaWxlU2hlYmFuZ0Vudik7XHJcbiAgICAgICAgICAgIGNvbmZpZ1NldHRpbmdzXzEuUHl0aG9uU2V0dGluZ3MuZ2V0SW5zdGFuY2UoZG9jdW1lbnQudXJpKS5weXRob25QYXRoID0gJ3AxJztcclxuICAgICAgICAgICAgY29uc3QgY29kZUxlbnNlcyA9IHlpZWxkIHNldHVwQ29kZUxlbnMoZG9jdW1lbnQpO1xyXG4gICAgICAgICAgICBhc3NlcnQuZXF1YWwoY29kZUxlbnNlcy5sZW5ndGgsIDEsICdObyBDb2RlTGVucyBhdmFpbGFibGUnKTtcclxuICAgICAgICAgICAgY29uc3QgY29kZUxlbnMgPSBjb2RlTGVuc2VzWzBdO1xyXG4gICAgICAgICAgICBhc3NlcnQoY29kZUxlbnMucmFuZ2UuaXNTaW5nbGVMaW5lLCAnSW52YWxpZCBDb2RlTGVucyBSYW5nZScpO1xyXG4gICAgICAgICAgICBhc3NlcnQuZXF1YWwoY29kZUxlbnMuY29tbWFuZC5jb21tYW5kLCAncHl0aG9uLnNldFNoZWJhbmdJbnRlcnByZXRlcicpO1xyXG4gICAgICAgIH0pKTtcclxuICAgICAgICB0ZXN0KCdDb2RlIGxlbnMgd2lsbCBub3QgYXBwZWFyIGV2ZW4gd2hlbiBzaGViYW5nIHB5dGhvbiB1c2VzIGVudiBhbmQgcHl0aG9uIHNldHRpbmdzIGFyZSB0aGUgc2FtZScsICgpID0+IF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgY29uc3QgcHl0aG9uUGF0aCA9IHlpZWxkIGdldEZ1bGx5UXVhbGlmaWVkUGF0aFRvSW50ZXJwcmV0ZXIoJ3B5dGhvbicpO1xyXG4gICAgICAgICAgICBjb25zdCBkb2N1bWVudCA9IHlpZWxkIG9wZW5GaWxlKGZpbGVTaGViYW5nRW52KTtcclxuICAgICAgICAgICAgY29uZmlnU2V0dGluZ3NfMS5QeXRob25TZXR0aW5ncy5nZXRJbnN0YW5jZShkb2N1bWVudC51cmkpLnB5dGhvblBhdGggPSBweXRob25QYXRoO1xyXG4gICAgICAgICAgICBjb25zdCBjb2RlTGVuc2VzID0geWllbGQgc2V0dXBDb2RlTGVucyhkb2N1bWVudCk7XHJcbiAgICAgICAgICAgIGFzc2VydC5lcXVhbChjb2RlTGVuc2VzLmxlbmd0aCwgMCwgJ0NvZGVMZW5zIGF2YWlsYWJsZSBhbHRob3VnaCBpbnRlcnByZXRlcnMgYXJlIGVxdWFsJyk7XHJcbiAgICAgICAgfSkpO1xyXG4gICAgfVxyXG4gICAgdGVzdCgnQ29kZSBsZW5zIHdpbGwgbm90IGFwcGVhciBhcyB0aGVyZSBpcyBubyBzaGViYW5nJywgKCkgPT4gX19hd2FpdGVyKHRoaXMsIHZvaWQgMCwgdm9pZCAwLCBmdW5jdGlvbiogKCkge1xyXG4gICAgICAgIGNvbnN0IGRvY3VtZW50ID0geWllbGQgb3BlbkZpbGUoZmlsZVBsYWluKTtcclxuICAgICAgICBjb25zdCBjb2RlTGVuc2VzID0geWllbGQgc2V0dXBDb2RlTGVucyhkb2N1bWVudCk7XHJcbiAgICAgICAgYXNzZXJ0LmVxdWFsKGNvZGVMZW5zZXMubGVuZ3RoLCAwLCAnQ29kZUxlbnMgYXZhaWxhYmxlIGFsdGhvdWdoIG5vIHNoZWJhbmcnKTtcclxuICAgIH0pKTtcclxuICAgIGZ1bmN0aW9uIG9wZW5GaWxlKGZpbGVOYW1lKSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZzY29kZV8xLndvcmtzcGFjZS5vcGVuVGV4dERvY3VtZW50KGZpbGVOYW1lKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGZ1bmN0aW9uIGdldEZ1bGx5UXVhbGlmaWVkUGF0aFRvSW50ZXJwcmV0ZXIocHl0aG9uUGF0aCkge1xyXG4gICAgICAgIHJldHVybiBfX2F3YWl0ZXIodGhpcywgdm9pZCAwLCB2b2lkIDAsIGZ1bmN0aW9uKiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHtcclxuICAgICAgICAgICAgICAgIGNoaWxkX3Byb2Nlc3MuZXhlY0ZpbGUocHl0aG9uUGF0aCwgWyctYycsICdpbXBvcnQgc3lzO3ByaW50KHN5cy5leGVjdXRhYmxlKSddLCAoXywgc3Rkb3V0KSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZShoZWxwZXJzXzEuZ2V0Rmlyc3ROb25FbXB0eUxpbmVGcm9tTXVsdGlsaW5lU3RyaW5nKHN0ZG91dCkpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHVuZGVmaW5lZCk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBmdW5jdGlvbiBzZXR1cENvZGVMZW5zKGRvY3VtZW50KSB7XHJcbiAgICAgICAgcmV0dXJuIF9fYXdhaXRlcih0aGlzLCB2b2lkIDAsIHZvaWQgMCwgZnVuY3Rpb24qICgpIHtcclxuICAgICAgICAgICAgY29uc3QgY29kZUxlbnNQcm92aWRlciA9IG5ldyBzaGViYW5nQ29kZUxlbnNQcm92aWRlcl8xLlNoZWJhbmdDb2RlTGVuc1Byb3ZpZGVyKGlvYy5zZXJ2aWNlQ29udGFpbmVyKTtcclxuICAgICAgICAgICAgcmV0dXJuIGNvZGVMZW5zUHJvdmlkZXIucHJvdmlkZUNvZGVMZW5zZXMoZG9jdW1lbnQsIG5ldyB2c2NvZGVfMS5DYW5jZWxsYXRpb25Ub2tlblNvdXJjZSgpLnRva2VuKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxufSk7XHJcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXNoZWJhbmdDb2RlTGVuc2VQcm92aWRlci50ZXN0LmpzLm1hcCJdfQ==